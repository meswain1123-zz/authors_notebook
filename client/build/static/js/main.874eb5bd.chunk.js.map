{"version":3,"sources":["assets/img/ANB.png","redux/actions/index.js","redux/constants/actionTypes.js","smartAPI.js","views/Home.js","views/Template.js","components/Navigation/routes.js","components/Navigation/MobileMenu.js","components/Navigation/UserMenu.js","components/Navigation/Navbar.js","components/Navigation/Sidebar.js","views/Forum/ForumMenu.js","views/User/Profile.js","views/World/Index.js","views/World/Details.js","views/World/Edit.js","views/User/LoginControl.js","views/World/Collaborate.js","views/World/EditCollaborators.js","views/Type/Details.js","views/Type/AttributeControl.js","views/Type/AttributeDefaultControl.js","views/Type/AttributesControl.js","components/Inputs/TextBox.js","components/Modals/NewTypeModal.js","components/Modals/NewThingModal.js","views/Type/Edit.js","components/Displays/ThingTable.js","views/Thing/Details.js","views/Thing/AttributeControl.js","views/Thing/AttributesControl.js","views/Thing/Edit.js","views/User/ResetPassword.js","views/User/ConfirmEmail.js","views/MainPage.js","App.js","serviceWorker.js","redux/reducers/index.js","redux/store/index.js","index.js"],"names":["module","exports","logout","payload","type","setWorlds","updateWorld","setPublicWorlds","selectWorld","setAttributes","setTypes","addType","setThings","addThing","updateType","updateSelectedType","updateThing","updateSelectedThing","toggleMenu","toggleLogin","notFromLogin","setFollowingWorlds","UnauthorizedError","message","this","name","prototype","Error","API","instance","getInstance","APIClass","logErrorReason","reason","console","log","Promise","reject","checkStatus","response","status","unauthorizedError","statusText","error","getVersion","a","real","fetchData","processResponse","version","getAllUsers","retry","relogin","_id","email","username","login","user","stayLoggedIn","sessionObj","body","expiresAt","sessionStorage","setItem","JSON","stringify","postData","removeItem","register","confirmEmail","code","patchData","sendReset","checkResetPasswordCode","resetPassword","newPassword","emailTest","updateUser","getWorldsForUser","getWorldsForUserFromAPI","data","getSessionData","OwnerID","Name","Public","getPublicWorlds","getPublicWorldsFromAPI","getWorld","worldID","refresh","getAttributesForWorld","attributes","getTypesForWorld","types","getThingsForWorld","things","attributesByID","attributesByName","forEach","attribute","TypeIDs","t","Supers","SuperIDs","sID","concat","filter","t2","AttributesArr","Attributes","attr","attrID","undefined","push","index","length","trim","AttributeType","Options","DefinedType","ListType","defHash","Defaults","def","DefaultsHash","Types","tID","createWorld","world","deleteWorld","deleteData","generateCollabLink","addNewCollaborator","userID","emailCollaborator","deleteCollab","collabID","updateCollaboratorPermission","editPermission","checkCollabID","requestToCollaborate","declineCollabInvite","acceptCollabInvite","acceptCollabRequest","getAttributesForWorldFromAPI","getAttribute","Description","createAttribute","upsertAttributes","getTypesForWorldFromAPI","getType","typeID","createType","deleteType","getThingsForWorldFromAPI","getThing","thingID","createThing","thing","deleteThing","path","options","fetch","mode","credentials","headers","Accept","then","catch","method","putData","sessionName","noExpiry","json","Date","setHours","getHours","sessionStr","getItem","parse","Page","props","state","redirectTo","fromLogin","to","Component","HomePage","connect","app","dispatch","className","TemplatePage","selectedPage","menuRoutes","icon","Home","component","Forum","Menu","toggleFollow","follow","followingWorlds","indexOf","splice","api","handleUserInput","e","target","value","checked","setState","browse","Filter","res","worlds","map","prop","key","ListItem","onClick","_","style","width","activeClassName","button","Icon","ListItemText","primary","otherWorlds","publicWorlds","w","toLowerCase","includes","Grid","container","spacing","direction","item","FormControl","variant","fullWidth","InputLabel","htmlFor","OutlinedInput","id","autoComplete","onChange","labelWidth","List","Fab","size","color","Star","links","display","Tooltip","title","Search","Add","myWorlds","MobileMenu","worldIDs","StyledMenu","withStyles","paper","border","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","UserMenu","React","useState","anchorEl","setAnchorEl","aria-controls","aria-haspopup","cursor","event","currentTarget","keepMounted","open","Boolean","onClose","MenuItem","onLogout","Bar","loadFromStorage","AppBar","position","Toolbar","xs","IconButton","aria-label","selectedWorld","mobileMenuOpen","Box","sm","NavBar","menuOpen","page","setTimeout","src","logo","alt","logoText","brand","Divider","light","Sidebar","window","location","pathname","ForumMenuPage","inputBlur","validation","validateField","fieldValidation","valid","fieldName","allUsers","u","match","validateForm","respond","nameValid","emailValid","formValid","onSubmit","waiting","submitThroughAPI","errors","loginError","show","userLogin","onLogin","load","finishLoading","res2","loaded","Helmet","ProfilePage","attrs","Index","handleChange","panel","updateIndexExpandedPanel","indexExpandedPanel","Button","i","majorLess","Major","majorless","editButtons","Owner","Collaborators","c","createButtons","maxWidth","PluralName","j","ThingIndex","delete","selectedWorldID","res3","modalOpen","getModalStyle","top","Math","round","innerHeight","left","innerWidth","transform","updatePublicWorldForCollab","respondToInvite","invite","getTypes","updateAttributes","getThings","params","People","AcceptingCollaborators","Modal","aria-labelledby","aria-describedby","WorldDetailsPage","a11yProps","addWorld","err","ArrowBack","onBlur","FormHelperText","FormControlLabel","control","Checkbox","label","disabled","marginLeft","Object","keys","WorldEditPage","Control","componentDidMount","remember","handleClickShowPassword","showPassword","handleMouseDownPassword","preventDefault","password","confirmEmailValid","passwordValid","confirmPasswordValid","usernameValid","formMode","confirmPassword","loginClick","registerClick","passwordClick","cookies","Cookies","emailCookie","get","passCookie","endAdornment","InputAdornment","onMouseDown","edge","Link","LoginControl","accept","accepted","submitAccept","getWorlds","refreshWorld","onLoginAccept","decline","submitDecline","codeValid","CollaboratePage","TabPanel","children","p","selectedUser","collabs","inviteMessage","inviteEmail","collaborator","permission","collabLink","collabLinkCopied","collab","acceptCollab","copyCollabLink","generatedLink","select","document","execCommand","actuallyFinishLoading","newCollaborators","newCollabTab","collabTab","invites","requests","userMenuItems","Tabs","newValue","Tab","Select","labelId","ref","input","multiline","FileCopyOutlined","fontColor","direcion","Check","EditCollaboratorPage","redirectToNext","selectedType","references","ReferenceIDs","inheritedAttributes","superType","definedType","option","DefaultValue","DefaultListValues","defaultValue","defaultThing","subTypes","sub","instances","TypeDetails","handleDefinedTypeChange","onNewType","handleOptionsChange","AttributeControl","changeName","attributeTypes","listTypes","selectedListType","selectedDefinedType","fromTypes","FromTypeIDs","handleTypeChange","chips","handleListTypeChange","onDelete","AttributeDefaultControl","changeValue","attributeType","selectedTypeValue","listOptions","listOptionValues","o","onNewThing","placeholder","handleTextListChange","selectedValues","onSelect","selectedItem","addOption","onRemove","selectedList","removeOption","displayValue","addThingOfType","removeType","newAttribute","uuid","changeAttribute","changeDefault","blurAttribute","deleteAttribute","defaults","addNewType","addNewThing","defaultsMode","s","inheritedAttribute","AttributesControl","TextBox","Value","displayName","NewTypeModal","changeMessage","changeWaiting","validate","onSave","saveNewType","onCancel","NewThingModal","newThingType","saveNewThing","resetForm","resetting","attrByName","attrArrValid","addMore","superIDs","typeAttributes","DefaultReferenceIDs","FromTypeID","supersChange","supers","addSuper","s2","duplicateAttributes","d","addSelectedAttribute","browseAttributesSelected","browseTypesSelected","addBrowsedType","attrType","removeSuper","removedItem","removeUs","checkMe","renderAttributes","typeModalOpen","putTypeOnAttribute","thingModalOpen","putThingOnAttribute","browseAttributes","newType","additionalAttributes","selectedAttributeTypes","selectedAttributeName","found","desc","TypeEditPage","addAttributes","rows","descendingComparator","b","orderBy","ThingTableHead","classes","order","onRequestSort","columnMap","TableHead","TableRow","headCell","TableCell","align","numeric","padding","disablePadding","sortDirection","TableSortLabel","active","property","visuallyHidden","useToolbarStyles","makeStyles","theme","root","paddingLeft","paddingRight","highlight","palette","secondary","main","backgroundColor","lighten","text","dark","flex","ThingTableToolbar","Typography","useStyles","marginBottom","table","clip","height","margin","overflow","ThingTable","newRow","attrThing","allThings","ListValues","v","Type","setOrder","setOrderBy","selected","setSelected","setPage","rowsPerPage","setRowsPerPage","Paper","TableContainer","Table","numSelected","onSelectAllClick","newSelecteds","n","rowCount","TableBody","array","comparator","stabilizedThis","el","sort","stableSort","getComparator","slice","row","isItemSelected","hover","role","aria-checked","tabIndex","column","buttonClick","TablePagination","rowsPerPageOptions","count","onChangePage","newPage","onChangeRowsPerPage","parseInt","finishDelete","majorType","selectedThing","listValue","ThingDetails","FromTypes","infoModal","optionsChange","onInfo","typeIDs","modalSubmit","infoModalOpen","createThingFromType","newAttributes","existing","finishResettingForm","substring","handleInfoAttrNameChange","infoAttribute","inputBlur2","attr2","attrValid","validateAttrForm","infoAttributeName","typesChange","newTypes","addType2","selectNewTypeForAttribute","newTypeForAttribute","saveInfoAttribute","submitAttributeThroughAPI","theType","newFromTypeIDs","browseAttributesFilter","typeStr","connectedTypes","otherTypes","fontSize","newThing","renderHeader","ThingEditPage","resetPasswordCode","ResetPasswordPage","confirmEmailCode","ConfirmEmailPage","loginOpen","exact","EditCollaboratorsPage","TypeDetailsPage","ThingDetailsPage","MainPage","AppLayout","updateDimensions","addEventListener","bind","removeEventListener","setWidth","setAPI","marginRight","marginTop","App","hostname","initialState","articles","redirectToURL","loadIt","rootReducer","reducers","action","assign","worldArr","wasPublic","publicWorld","changedType","changedAt","now","changedThing","session","sessionReducer","reducer","combineReducers","store","createStore","refreshFromLocalStorage","refreshOnCheckAuth","redirectPath","driver","validateSession","sessionService","initSessionService","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.874eb5bd.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import {\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOGOUT,\r\n  REDIRECT_TO,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_ATTRIBUTES,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  TOGGLE_LOGIN,\r\n  NOT_FROM_LOGIN,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH,\r\n  UPDATE_INDEX_EXPANDED_PANEL\r\n} from \"../constants/actionTypes\";\r\n\r\nexport function updateIndexExpandedPanel(payload) {\r\n  return { type: UPDATE_INDEX_EXPANDED_PANEL, payload };\r\n}\r\nexport function setAPI(payload) {\r\n  return { type: SET_API, payload };\r\n}\r\nexport function addArticle(payload) {\r\n  return { type: ADD_ARTICLE, payload };\r\n}\r\nexport function userLogin(payload) {\r\n  return { type: LOGIN, payload };\r\n}\r\nexport function logout(payload) {\r\n  return { type: LOGOUT, payload };\r\n}\r\nexport function redirectTo(payload) {\r\n  return { type: REDIRECT_TO, payload };\r\n}\r\nexport function setWorlds(payload) {\r\n  return { type: SET_WORLDS, payload };\r\n}\r\nexport function addWorld(payload) {\r\n  return { type: ADD_WORLD, payload };\r\n}\r\nexport function updateWorld(payload) {\r\n  return { type: UPDATE_WORLD, payload };\r\n}\r\nexport function updatePublicWorldForCollab(payload) {\r\n  return { type: UPDATE_PUBLIC_WORLD_COLLAB, payload };\r\n}\r\nexport function setPublicWorlds(payload) {\r\n  return { type: SET_PUBLIC_WORLDS, payload };\r\n}\r\nexport function selectWorld(payload) {\r\n  return { type: SELECT_WORLD, payload };\r\n}\r\nexport function setAttributes(payload) {\r\n  return { type: SET_ATTRIBUTES, payload };\r\n}\r\nexport function addAttributes(payload) {\r\n  return { type: ADD_ATTRIBUTES, payload };\r\n}\r\nexport function updateAttributes(payload) {\r\n  return { type: UPDATE_ATTRIBUTES, payload };\r\n}\r\nexport function setTypes(payload) {\r\n  return { type: SET_TYPES, payload };\r\n}\r\nexport function addType(payload) {\r\n  return { type: ADD_TYPE, payload };\r\n}\r\nexport function setThings(payload) {\r\n  return { type: SET_THINGS, payload };\r\n}\r\nexport function addThing(payload) {\r\n  return { type: ADD_THING, payload };\r\n}\r\nexport function updateType(payload) {\r\n  return { type: UPDATE_TYPE, payload };\r\n}\r\nexport function updateSelectedType(payload) {\r\n  return { type: UPDATE_SELECTED_TYPE, payload };\r\n}\r\nexport function updateThing(payload) {\r\n  return { type: UPDATE_THING, payload };\r\n}\r\nexport function updateSelectedThing(payload) {\r\n  return { type: UPDATE_SELECTED_THING, payload };\r\n}\r\nexport function loadFromStorage(payload) {\r\n  return { type: LOAD_FROM_STORAGE, payload };\r\n}\r\nexport function toggleMenu(payload) {\r\n  return { type: TOGGLE_MENU, payload };\r\n}\r\nexport function toggleLogin(payload) {\r\n  return { type: TOGGLE_LOGIN, payload };\r\n}\r\nexport function notFromLogin(payload) {\r\n  return { type: NOT_FROM_LOGIN, payload };\r\n}\r\nexport function setFollowingWorlds(payload) {\r\n  return { type: SET_FOLLOWING_WORLDS, payload };\r\n}\r\nexport function setWidth(payload) {\r\n  return { type: SET_WIDTH, payload };\r\n}\r\n","\r\nexport const UPDATE_INDEX_EXPANDED_PANEL = \"UPDATE_INDEX_EXPANDED_PANEL\";\r\nexport const SET_API = \"SET_API\";\r\nexport const ADD_ARTICLE = \"ADD_ARTICLE\";\r\nexport const LOGIN = \"LOGIN\";\r\nexport const LOGOUT = \"LOGOUT\";\r\nexport const REDIRECT_TO = \"REDIRECT_TO\";\r\nexport const SET_WORLDS = \"SET_WORLDS\";\r\nexport const SET_PUBLIC_WORLDS = \"SET_PUBLIC_WORLDS\";\r\nexport const ADD_WORLD = \"ADD_WORLD\";\r\nexport const UPDATE_WORLD = \"UPDATE_WORLD\";\r\nexport const UPDATE_PUBLIC_WORLD_COLLAB = \"UPDATE_PUBLIC_WORLD_COLLAB\";\r\nexport const SELECT_WORLD = \"SELECT_WORLD\";\r\nexport const SET_TYPES = \"SET_TYPES\";\r\nexport const ADD_TYPE = \"ADD_TYPE\";\r\nexport const SET_THINGS = \"SET_THINGS\";\r\nexport const ADD_THING = \"ADD_THING\";\r\nexport const UPDATE_TYPE = \"UPDATE_TYPE\";\r\n// export const UPDATE_ATTRIBUTES_ARR = \"UPDATE_ATTRIBUTES_ARR\";\r\nexport const SET_ATTRIBUTES = \"SET_ATTRIBUTES\";\r\nexport const ADD_ATTRIBUTES = \"ADD_ATTRIBUTES\";\r\nexport const UPDATE_ATTRIBUTES = \"UPDATE_ATTRIBUTES\";\r\nexport const UPDATE_SELECTED_TYPE = \"UPDATE_SELECTED_TYPE\";\r\nexport const UPDATE_THING = \"UPDATE_THING\";\r\nexport const UPDATE_SELECTED_THING = \"UPDATE_SELECTED_THING\";\r\nexport const LOAD_FROM_STORAGE = \"LOAD_FROM_STORAGE\";\r\nexport const TOGGLE_MENU = \"TOGGLE_MENU\";\r\nexport const TOGGLE_LOGIN = \"TOGGLE_LOGIN\";\r\nexport const NOT_FROM_LOGIN = \"NOT_FROM_LOGIN\";\r\nexport const SET_FOLLOWING_WORLDS = \"SET_FOLLOWING_WORLDS\";\r\nexport const SET_WIDTH = \"SET_WIDTH\";\r\n","\r\n// This is our special type of Error that represents\r\n// when a request got a 401 Unauthorized response\r\nfunction UnauthorizedError(message) {\r\n  this.name = \"UnauthorizedError\";\r\n  this.message = message;\r\n}\r\nUnauthorizedError.prototype = new Error();\r\n\r\nvar API = (function() {\r\n  var instance;\r\n\r\n  function createInstance() {\r\n    var api = new APIClass();\r\n    return api;\r\n  }\r\n\r\n  return {\r\n    getInstance: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nclass APIClass {\r\n  constructor() {\r\n    this.real = true;\r\n  }\r\n\r\n  logErrorReason = reason => {\r\n    // log the error reason but keep the rejection\r\n    console.log(\"Response error reason:\", reason);\r\n    return Promise.reject(reason);\r\n  };\r\n\r\n  checkStatus = response => {\r\n    if (response.status >= 200 && response.status < 300) {\r\n      return response;\r\n    } else if (response.status === 401) {\r\n      var unauthorizedError = new UnauthorizedError(response.statusText);\r\n      unauthorizedError.response = response;\r\n      return Promise.reject(unauthorizedError);\r\n    } else {\r\n      var error = new Error(response.statusText);\r\n      error.response = response;\r\n      return Promise.reject(error);\r\n    }\r\n  };\r\n\r\n  getVersion = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/version\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return { version: \"0.0.1\" };\r\n    }\r\n  };\r\n\r\n  // User\r\n  getAllUsers = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/user/getAllUsers\");\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\"/api/user/getAllUsers\");\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return [{\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      }];\r\n    }\r\n  };\r\n\r\n  login = async (user, stayLoggedIn) => {\r\n    if (this.real) {\r\n      if (stayLoggedIn) {\r\n        const sessionObj = {\r\n          body: user,\r\n          expiresAt: \"never\"\r\n        };\r\n        sessionStorage.setItem(\"loginUser\", JSON.stringify(sessionObj));\r\n      }\r\n      const response = await this.postData(\"/api/user/login\", user);\r\n      return this.processResponse(response, null, \"user\", stayLoggedIn);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  }\r\n\r\n  logout = async user => {\r\n    if (this.real) {\r\n      await this.postData(\"/api/user/logout\");\r\n      sessionStorage.removeItem(\"user\");\r\n    }\r\n  };\r\n\r\n  register = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/register\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  confirmEmail = async (code) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/confirmEmail\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  sendReset = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/sendReset\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkResetPasswordCode = async code => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/checkResetPasswordCode\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  resetPassword = async (code, newPassword) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/resetPassword\", {code, newPassword});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  emailTest = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/emailTest\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  updateUser = async user => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/update\", user);\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/user/update\", user);\r\n        return this.processResponse(response, null);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  // World\r\n  getWorldsForUser = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getWorldsForUserFromAPI();\r\n    }\r\n    else {\r\n      const data = this.getSessionData(\"worlds\");\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getWorldsForUserFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getWorldsForUserFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n        return this.processResponse(response, null, \"worlds\");\r\n      }\r\n      return this.processResponse(response, retry, \"worlds\");\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getPublicWorlds = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getPublicWorldsFromAPI();\r\n    }\r\n    else {\r\n      const data = this.getSessionData(\"publicWorlds\");\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getPublicWorldsFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getPublicWorldsFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n        return this.processResponse(response, null, \"publicWorlds\");\r\n      }\r\n      return this.processResponse(response, retry, \"publicWorlds\");\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getWorld = async (worldID, refresh = false) => {\r\n    try {\r\n      let attributes = await this.getAttributesForWorld(worldID, refresh);\r\n      attributes = attributes.attributes;\r\n      let types = await this.getTypesForWorld(worldID, refresh);\r\n      types = types.types;\r\n      let things = await this.getThingsForWorld(worldID, refresh);\r\n      things = things.things;\r\n\r\n      // Now connect them all as is appropriate.\r\n      const attributesByID = {};\r\n      const attributesByName = {};\r\n      attributes.forEach(attribute => {\r\n        attribute.TypeIDs = [];\r\n        attributesByID[attribute._id] = attribute;\r\n        attributesByName[attribute.Name] = attribute;\r\n      });\r\n      types.forEach(t=> {\r\n        t.Supers = [];\r\n        t.SuperIDs.forEach(sID=> {\r\n          t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n        });\r\n        t.AttributesArr = [];\r\n        t.Attributes.forEach(a => {\r\n          const attr = attributesByID[a.attrID];\r\n          if (attr === undefined) {\r\n          }\r\n          else {\r\n            attr.TypeIDs.push(t._id);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name.trim(),\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          }\r\n        });\r\n        const defHash = {};\r\n        if (t.Defaults !== undefined) {\r\n          t.Defaults.forEach(def => {\r\n            defHash[def.attrID] = def;\r\n          });\r\n        }\r\n        t.DefaultsHash = defHash;\r\n      });\r\n      things.forEach(t=> {\r\n        t.Types = [];\r\n        t.TypeIDs.forEach(tID=> {\r\n          t.Types = t.Types.concat(types.filter(t2=>t2._id === tID));\r\n        });\r\n      });\r\n      return {\r\n        attributes,\r\n        attributesByID,\r\n        attributesByName,\r\n        types,\r\n        things\r\n      };\r\n    }\r\n    catch (error) {\r\n      console.log(error);\r\n      return { error };\r\n    }\r\n  };\r\n\r\n  createWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  generateCollabLink = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/generateCollabLink\", { worldID: worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/generateCollabLink\", { worldID: worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  addNewCollaborator = async (worldID, userID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/addNewCollaborator\", { worldID, userID, email });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/addNewCollaborator\", { worldID, userID, email });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  emailCollaborator = async (worldID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/emailCollaborator\", { worldID, email });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/emailCollaborator\", { worldID, email });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  deleteCollab = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteCollab\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteCollab\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateCollaboratorPermission = async (worldID, collabID, editPermission) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateCollaboratorPermission\", { worldID, collabID, editPermission });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateCollaboratorPermission\", { worldID, collabID, editPermission });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkCollabID = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/checkCollabID\", {worldID, collabID});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  requestToCollaborate = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/requestToCollaborate\", { worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/requestToCollaborate\", { worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  declineCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/declineCollabInvite\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/declineCollabInvite\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  acceptCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/acceptCollabInvite\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/acceptCollabInvite\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  acceptCollabRequest = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/acceptCollabRequest\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/acceptCollabRequest\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  selectWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Attribute\r\n  getAttributesForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getAttributesForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`attributes_${worldID}`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getAttributesForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getAttributesForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttributesForWorld/${worldID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getAttributesForWorld/${worldID}`\r\n        );\r\n        return this.processResponse(response, null, `attributes_${worldID}`);\r\n      }\r\n      return this.processResponse(response, retry, `attributes_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getAttribute = async (worldID, attrID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttribute/${worldID}/${attrID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getAttribute/${worldID}/${attrID}`\r\n        );\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createAttribute = async (attribute) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createAttribute\", { attribute: attribute });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createAttribute\", { attribute: attribute });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  // deleteAttribute = async (worldID, attrID) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.deleteData(\"/api/world/deleteAttribute\", { worldID: worldID, attrID: attrID });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  // updateAttribute = async (attribute) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.patchData(\"/api/world/updateAttribute\", { attribute: attribute });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  upsertAttributes = async (worldID, attributes) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/upsertAttributes\", { worldID, attributes: attributes });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/upsertAttributes\", { worldID, attributes: attributes });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  // Type\r\n  getTypesForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getTypesForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`types_${worldID}`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getTypesForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getTypesForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getTypesForWorld/${worldID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getTypesForWorld/${worldID}`\r\n        );\r\n        return this.processResponse(response, null, `types_${worldID}`);\r\n      }\r\n      return this.processResponse(response, retry, `types_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getType/${worldID}/${typeID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getType/${worldID}/${typeID}`\r\n        );\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createType\", { type: type });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createType\", { type: type });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Thing\r\n  getThingsForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getThingsForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`things_${worldID}`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getThingsForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getThingsForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getThingsForWorld/${worldID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getThingsForWorld/${worldID}`\r\n        );\r\n        return this.processResponse(response, null, `things_${worldID}`);\r\n      }\r\n      return this.processResponse(response, retry, `things_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  getThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Types: [-1],\r\n        Name: \"Alice\",\r\n        Description: \"\"\r\n      };\r\n    }\r\n  };\r\n\r\n  createThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Core API Calls\r\n  fetchData = async (path, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        ...options.headers\r\n      }\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  postData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  putData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  patchData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  deleteData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"DELETE\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  processResponse = async (response, retry = null, sessionName = null, noExpiry = false) => {\r\n    const body = await response.json();\r\n    if (response.status !== 200) { \r\n      throw Error(body.message);\r\n    }\r\n    else if (body.error !== undefined && retry !== null) {\r\n      return retry();\r\n    } \r\n    else {\r\n      if (sessionName !== null) {\r\n        let expiresAt = new Date();\r\n        if (noExpiry) \r\n          expiresAt = \"never\";\r\n        else \r\n          expiresAt.setHours(expiresAt.getHours() + 1);\r\n        const sessionObj = {\r\n          expiresAt,\r\n          body\r\n        };\r\n        sessionStorage.setItem(sessionName, JSON.stringify(sessionObj));\r\n      }\r\n      return body;\r\n    };\r\n  };\r\n\r\n  relogin = async () => {\r\n    try {\r\n      const user = this.getSessionData(\"loginUser\");\r\n      if (user !== null) {\r\n        const response = await this.postData(\"/api/user/login\", user);\r\n        this.processResponse(response, null, \"user\", true);\r\n      }\r\n    }\r\n    catch {}\r\n  }\r\n\r\n  getSessionData = (sessionName) => {\r\n    const sessionStr = sessionStorage.getItem(sessionName);\r\n    if (sessionStr !== null) {\r\n      const sessionObj = JSON.parse(sessionStr);\r\n      if (sessionObj.expiresAt !== undefined && \r\n        (sessionObj.expiresAt === \"never\" || sessionObj.expiresAt > new Date())) {\r\n        return sessionObj.body;\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n}\r\n\r\nexport default API;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  notFromLogin\r\n} from \"../redux/actions/index\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\",\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else {\r\n      return (\r\n        <div>\r\n          <h3>Author's Notebook</h3>\r\n          <p>\r\n            This is something that I've been wanting to build for a while. It's\r\n            purpose is to provide a place for keeping track of various aspects of\r\n            books that an author is writing. It is able to keep track of details\r\n            about characters, organizations, systems, and even storylines. I would\r\n            like to make it so it's publicly available, and that any authors\r\n            (aspiring and published) can use it to help them organize their\r\n            stories. I want to make it automate a number of things, but the\r\n            biggest part is to make it very dynamic and to allow for storage of\r\n            all different kinds of notes. In order to make it publicly available\r\n            however, it needs to at least be able to pay for itself. I'm not\r\n            talking about the time I spent/spend working on it, but the costs of\r\n            hosting the website, the db, and the url. Until I'm sure it's capable\r\n            of doing those things, I can't let everyone have access to it.\r\n          </p>\r\n          <p>\r\n            This is version 1 of instructions of how to use it. If I make it\r\n            available for anyone, I'll update it with some video instructions.\r\n          </p>\r\n          <p>\r\n            One thing you need to know is that this is a hobby project of mine.\r\n            I'm working on it by myself for now. I've got a real job, and I've got\r\n            a family, so this isn't my top priority, but that being said I do care\r\n            about this probject, and I do plan to get to all the things that are\r\n            on my to do list.\r\n          </p>\r\n          <p>\r\n            If you want to do more than just look at the things others have put on\r\n            (and which they're allowing you to see), then you'll have to register.\r\n            Making it use Facebook and/or Google authentication is on my to do\r\n            list. I know how to do that, but I just haven't gotten around to it.\r\n            So, for now, just register and login. It currently doesn't send any\r\n            emails, so if you forget your password or something, you'll have to\r\n            reach out to me, and I can straighten it out. Again, that kind of\r\n            thing is also on my to do list.\r\n          </p>\r\n          <p>\r\n            Once you're logged in then you're able to start keeping track of\r\n            things.\r\n          </p>\r\n          <p>\r\n            The first thing you create is currently called a World. This is a\r\n            holdover from when I was calling this my World Building App because I\r\n            was aiming it for Fantasy/Sci-Fi authors (like me), but I realized\r\n            that it could be used for anything really. If anyone has any\r\n            suggestions for something to call this instead of World, I'm open to\r\n            considering other options. Currently I'm considering changing it to\r\n            'Project', and I may do that before showing it to anyone other than\r\n            family and close friends. Anyway, a World is basically the root of\r\n            everything. Different Worlds aren't connected to each other. Each\r\n            World has a Name, and you can choose whether or not to make it Public.\r\n            If it's not Public then only the Owner (whoever created it) is able to\r\n            see it. If it is Public then anyone can see it, but only the Owner can\r\n            edit it. (Planned Future Features: When you create a new world you can\r\n            use a template which will include generic Types common to that type of\r\n            World, such as Character, Location, etc. I'm also planning to add the\r\n            ability for Owners to add Collaborators to their World. Collaborators\r\n            would be able to see the World, and the Owner would be able to control\r\n            their other permissions as well (create/edit type, delete type,\r\n            create/edit thing, and delete thing.). Only the Owner will have the\r\n            ability to Edit or Delete the World itself, but they will be able to\r\n            make someone else the Owner.)\r\n          </p>\r\n          <p>\r\n            Within a World you are able to define Types. Basically a Type is just\r\n            that. It's a Type of Thing that you want to keep track of. In each\r\n            Type you are able to define attributes which that Type of Thing share,\r\n            such as Characters having Age, Race, Gender, Height, Weight, Skin\r\n            Color, Eye Color, etc. Types can also be hierarchical through\r\n            inheritance. For example, in Harry Potter I would have a 'Character'\r\n            Type with all the attributes I listed above, but then I could have a\r\n            'Witch or Wizard' Type which has 'Character' as a Super Type. This\r\n            means that 'Witch or Wizard' already has all those same Attributes as\r\n            'Character', but you can add more Attributes like Wand, Known Spells,\r\n            etc. The way to set the Super Types for a type is with a control\r\n            called a Multi Select. It's basically a textbox, but as you type it\r\n            gives you suggestions. You click a suggestion and it adds a chip\r\n            showing it as selected. Clicking the x on the right of the chip\r\n            unselects it. When selecting a Type to be a Super Type it adds all the\r\n            Attributes of that Type to the Type you're creating or editing, but\r\n            they are greyed out and disabled for editing. The reason they're grey\r\n            and disabled is that they come from a Super Type, so their definition\r\n            is there. If a Super Type is removed then the Attributes remain, but\r\n            are no longer grey and disabled. They can then be edited. There are a\r\n            few more things to note however. First is that when adding a Super\r\n            Type which has Super Types, those Super Types will be added as well.\r\n            An example of this could be the 'Animagus' Type in Harry Potter.\r\n            'Animagus' has the Super Type 'Witch or Wizard', which has the Super\r\n            Type 'Character', so when defining 'Animagus' I could add 'Witch or\r\n            Wizard' as a Super Type, and that will automatically add 'Character'\r\n            as well. Removing a Super Type of other Super Types will remove all\r\n            Sub Types of the Super Type removed. An example of that would be\r\n            removing 'Character' from 'Animagus'. This would automatically remove\r\n            'Witch or Wizard' as well. It doesn't make sense to do that for\r\n            'Animagus', but it may be necessary for you if you want to rethink how\r\n            you're organizing things. The last thing to note about removing Super\r\n            Types is that so long as a single Super Type exists which has an\r\n            Attribute with that name, it will be greyed out and disabled. Another\r\n            note about Attributes is that their names have to be unique on the\r\n            Type (or Thing). It's generally a good idea to make sure that any\r\n            Attributes you define with the same name also have the same Attribute\r\n            type as well, otherwise you may run into Attribute name collisions.\r\n            One last thing about Types. I've added an option to Types called Major\r\n            Type. If it's checked then the Type is considered a Major Type and\r\n            will show up in places of the UI where a regular Type will not. This\r\n            makes finding, creating, and editing Things of that Type easier. I\r\n            would make 'Character' a Major Type, but 'Witch or Wizard' and\r\n            'Animagus' would be regular Types. (Planned Future Features: Template\r\n            Types like I have above for Template Worlds, but they're individual\r\n            Types. Also add Plural Name field which will be used in the UI for\r\n            places where we put the plural name of something. Currently it just\r\n            adds an 's' to the end of the Type name, and I want to continue to do\r\n            that if the Plural Name is left empty, but if it's not empty then\r\n            display the Plural Name instead.)\r\n          </p>\r\n          <p>\r\n            Types have Attributes (as mentioned above). Things (which I'll get\r\n            into more below) also have Attributes. The same Attributes really. In\r\n            the Harry Potter World the Attributes on the 'Character' Type would\r\n            then be given to every character you create afterward, but now instead\r\n            of naming the Attribute and saying what type of Attribute it is, you\r\n            get to specify a value for the Attribute.\r\n          </p>\r\n          <p>\r\n            An Attribute is anything you may wish to keep track of for anything.\r\n            These do not include Name or Description, because all Types and Things\r\n            always have Name and Description by default. Attributes are for\r\n            anything else you want to keep track of. It could be a relationship\r\n            like 'Friend', 'Family Member', 'Significant Other', 'Coworker', etc.\r\n            It could be skills and abilities, or possessions, or jobs, or home\r\n            address, or work or school schedule. Really anything you want to keep\r\n            track of which is part of something can be an Attribute. Currently\r\n            there are six types of Attributes that are supported: Text, Number,\r\n            True/False, Options, Type, and List. Text is just that. A Text\r\n            Attribute gives you a textbox where you can type anything you want to\r\n            keep track of. Number gives you a number box, which is like a textbox\r\n            but it only accepts numbers, and it has arrows on the right which can\r\n            be used to increment or decrement the number. True/False gives you a\r\n            checkbox. Options allows you to specify possible choices for the\r\n            Attribute, and then they show up in a drop down list (A quick example\r\n            of this could be 'Gender' having 'Male', 'Female', and others if you\r\n            wanted. They can have as many options as you want, and it can be used\r\n            for whatever Attribute you want.). Specifying the choices is done\r\n            using a control called a Chip Input. This looks like a regular\r\n            textbox, but whenever you hit enter the text in it is added as a chip.\r\n            Chips show the text, but have an x on their right which can be used to\r\n            remove them. It's basically like the Multiselect except without the\r\n            suggestions. The Chips are the choices that will be in the drop down\r\n            list which the user has when creating or editing a Thing with that\r\n            Attribute.\r\n          </p>\r\n          <p>The last two Attribute types are a little more complicated.</p>\r\n          <p>\r\n            When adding Attributes to a Type, the 'Type' Attribute type allows you\r\n            to then choose from the various Types you've defined for the World,\r\n            and then when you're creating or editing a Thing (such as the\r\n            'Character' 'Harry Potter') you would get all the Things of that Type\r\n            as choices in a drop down list. For example you could have a 'Best\r\n            Friend' Attribute which has the Attribute type of 'Type' and uses the\r\n            Defined Type of 'Character'. Then when editing Harry you would have a\r\n            drop down list which shows all the 'Characters' you've added to the\r\n            World as possible 'Best Friends'. You would of course then choose 'Ron\r\n            Weasley' (Sorry, Hermione, but you're a close second.).\r\n          </p>\r\n          <p>\r\n            The Attribute Type 'List' is still more complicated than 'Type'. It\r\n            allows you to decide which type of 'List' it's going to be. For now it\r\n            only supports 'Text', 'Options', and 'Type'. (I'm not planning to add\r\n            any others, but if it's requested I may consider it. A List of Text\r\n            could be anything really, so other types shouldn't be necessary.) If\r\n            an Attribute is defined as a List of Text then when creating or\r\n            editing a Thing the Attribute gives a Chip Input, which works the same\r\n            as it does for Options (described above). A List of Options allows you\r\n            to define the choices when creating or editing the Type, the same as\r\n            with a regular Options Attribute, and then when creating or editing a\r\n            Thing of that Type it gives a Multiselect which works the same as when\r\n            choosing Super Types (described above) with the Options defined\r\n            previously on the Type as the suggestions. A List of 'Type' allows you\r\n            to choose a Defined Type (like with the Attribute type 'Type'), but\r\n            when creating or editing a Thing it gives you a Multiselect instead of\r\n            a regular drop down list so you can select more than one. With all\r\n            'List' Attributes, the items in the list are displayed separated by\r\n            commas when looking at the details page rather than creating or\r\n            editing.\r\n          </p>\r\n          <p>\r\n            One last note about Attributes of type 'Type' or 'List' of 'Type'.\r\n            I've made it so that if you want to choose a Defined Type which you\r\n            haven't defined yet you can choose '+ Create New Type' and it opens a\r\n            quick little window (modal for those who care) which lets you define a\r\n            Type using just the name you want it to have. You'll have to edit that\r\n            Type later to give it any Super Types or Attributes it should have,\r\n            but you can create it there so you can continue defining the Type\r\n            you're already working on rather than having to leave and come back to\r\n            it. The same thing can be done when creating or editing a Thing with\r\n            an Attribute of type 'Type' or 'List' of 'Type', but for Things the\r\n            Type has already been chosen. Now you will be creating a Thing of that\r\n            Type. An example of this would be if you're editing the 'Character'\r\n            'Harry Potter', but when you get to 'Best Friend' you realize you\r\n            haven't added the 'Ron Weasley' 'Character' yet. You would choose '+\r\n            Create New Character', and then in the quick little window you would\r\n            type 'Ron Weasley'. He would get added as a blank character with just\r\n            his Name, but he would then be selected as Harry's 'Best Friend', and\r\n            you could finish defining Harry, and get to Ron later.\r\n          </p>\r\n          <p>\r\n            And one more thing about Attributes in general.  I added the ability to\r\n            set Default values for attributes on the Type.  Default Values will \r\n            automatically be set on any Things of that Type.  I made it as user \r\n            friendly as I could think to make it.\r\n          </p>\r\n          <p>\r\n            (Planned Future Features: Other Attribute types, including: Image,\r\n            Event, and External Link. If you have any suggestions of others, feel\r\n            free to recommend them.  Also need to put in validation to detect \r\n            Name and Default collisions.)\r\n          </p>\r\n          <p>\r\n            And that brings us to Things. If you've gotten to this point, then you\r\n            probably already understand what Things are, but I'll outline it\r\n            anyway. The generic term Thing is used to mean any actual thing you're\r\n            keeping track of. This would be your Characters, your Places, your\r\n            Items, Spells, whatever. When creating or editing a Thing you are able\r\n            to choose Types for the Thing (works the same as Super Types for\r\n            Types), and all the Attributes of those Types are added to the Thing,\r\n            but now you're able to give values for them. Again remember to avoid\r\n            Attribute Name collisions (If for some reason you've defined 2\r\n            unrelated Types with an Attribute that has the same name but different\r\n            Attribute types then you won't be able to have a Thing of both\r\n            Types.). If a Type is edited to remove an Attribute, Things which use\r\n            that Type and existed already will still have that Attribute. It will\r\n            just be an orphaned Attribute. Currently there's no way to remove\r\n            Attributes from Things. If a Type is edited to add Attributes then\r\n            Things which already existed will gain those Attributes as soon as\r\n            they're edited again. If a Type is edited and an Attribute is\r\n            changed... I'm not actually sure what would happen to Things that\r\n            already exist which have that Type. I'll have to test that. That's\r\n            really it for Things. They're the simple part. (Planned Future\r\n            Features: I'm planning to add the ability to add/remove/edit orphaned\r\n            Attributes for Things. When I do, I'll probably try to find a way to\r\n            make it so with adding/editing orphaned Attributes you'll be able to\r\n            add the Attribute to a selected Type already on the Thing.)\r\n          </p>\r\n          <p>I probably should have put Attributes below Things, but oh well.</p>\r\n          <p>Other Planned Future Features:</p>\r\n          <div>\r\n            <p>\r\n              Forums: I'm going to have a General Site Forum, and each World will\r\n              automatically get its own Forum.\r\n            </p>\r\n            <p>\r\n              Direct Messages: I'll add a simple messaging system to allow people\r\n              to communicate directly with one another.\r\n            </p>\r\n            <p>\r\n              Auto-links: For both Forums and DMs I'll allow users to put links to\r\n              pages through a simple system similar to hashtags in Social Media.\r\n              I'm thinking I also want to add this capability to Descriptions on\r\n              Types and Things.\r\n            </p>\r\n            <p>\r\n              Following Public Worlds: Currently all Public Worlds are listed in\r\n              the menu, but I should make it so only those that the user follows\r\n              are shown there, and have a button to pull up the full list, and add\r\n              a button for people who neither own or collaborate on a Public World\r\n              to 'Follow' the World.\r\n            </p>\r\n            <p>\r\n              Home Page content: I'm planning to have actual Home Page content.\r\n              This will have a link to a video tutorial for new users (which I\r\n              have yet to make, and will need occasional updating after it's\r\n              made), as well as things like recent software changes. I also want\r\n              to make it so it can automatically have links to recently added or\r\n              edited Types or Things and recent Forum posts which may be of\r\n              interest to the user.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst HomePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default HomePage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\n// import {\r\n//   // notFromLogin,\r\n//   redirectTo\r\n// } from \"../redux/actions/index\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    selectedPage: state.app.selectedPage\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\",\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else {\r\n      return (\r\n        <div className=\"col-sm-12\">\r\n          Template Page\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\nconst TemplatePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TemplatePage;\r\n","\r\nimport Home from \"@material-ui/icons/Home\";\r\nimport Forum from \"@material-ui/icons/Forum\";\r\nimport HomePage from \"../../views/Home\";\r\nimport TemplatePage from \"../../views/Template\";\r\n\r\n\r\nconst menuRoutes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home\",\r\n    icon: Home,\r\n    component: HomePage,\r\n  },\r\n  {\r\n    path: \"/Forums\",\r\n    name: \"Forums\",\r\n    icon: Forum,\r\n    component: TemplatePage,\r\n  }\r\n];\r\n\r\nexport default menuRoutes;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport StarBorderIcon from \"@material-ui/icons/StarBorder\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds,\r\n  toggleMenu,\r\n  logout,\r\n  // toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds,\r\n    width: state.app.width\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    toggleMenu: () => dispatch(toggleMenu({})),\r\n    // toggleLogin: () => dispatch(toggleLogin({}))\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Menu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds().then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    if (this.props.user !== null) {\r\n      this.api.getWorldsForUser().then(res => {\r\n        if (res.worlds !== undefined) {\r\n          this.props.setWorlds(res.worlds);\r\n        }\r\n        else {\r\n          // User's login is no longer valid.\r\n          this.props.logout();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      <div>\r\n        {menuRoutes.map((prop, key) => (\r\n          <ListItem key={key} className=\"curvedButton\">\r\n            <NavLink\r\n              to={prop.path}\r\n              onClick={_ => {\r\n                this.props.toggleMenu();\r\n              }}\r\n              style={{\r\n                width: `${this.props.width}px`\r\n              }}\r\n              className=\"MyButton\"\r\n              activeClassName=\"active\"\r\n            >\r\n              <ListItem button>\r\n                {typeof prop.icon === \"string\" ? (\r\n                  <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n                ) : (\r\n                  <prop.icon className=\"marginLeft\" />\r\n                )}\r\n                &nbsp;\r\n                <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n              </ListItem>\r\n            </NavLink>\r\n          </ListItem>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (\r\n      this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined\r\n    ) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (\r\n            this.state.Filter === \"\" ||\r\n            w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())\r\n          ) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            } else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {followingWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/world/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, false);\r\n                    }}\r\n                  >\r\n                    <Star />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n              {otherWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/world/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, true);\r\n                    }}\r\n                  >\r\n                    <StarBorderIcon />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return followingWorlds.map((w, key) => (\r\n      <ListItem key={key} className=\"curvedButton\">\r\n        <NavLink\r\n          to={`/world/details/${w._id}`}\r\n          onClick={_ => {\r\n            this.props.toggleMenu();\r\n          }}\r\n          style={{\r\n            width: `${this.props.width}px`\r\n          }}\r\n          className=\"MyButton\"\r\n          activeClassName=\"active\"\r\n        >\r\n          <ListItem button>\r\n            <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n          </ListItem>\r\n        </NavLink>\r\n      </ListItem>\r\n    ));\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => (\r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink\r\n                  to={`/world/details/${w._id}`}\r\n                  onClick={_ => {\r\n                    this.props.toggleMenu();\r\n                  }}\r\n                  style={{\r\n                    width: `${this.props.width}px`\r\n                  }}\r\n                  className=\"MyButton\"\r\n                  activeClassName=\"active\"\r\n                >\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            ));\r\n      return worldLinks;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Tooltip title={`Browse Public Worlds`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        <ListItem>\r\n          <ListItemText primary={\"My Worlds\"} />\r\n        </ListItem>\r\n        <ListItem className=\"curvedButton\">\r\n          <NavLink\r\n            to={`/world/create`}\r\n            onClick={_ => {\r\n              this.props.toggleMenu();\r\n            }}\r\n            style={{\r\n              width: `${this.props.width}px`\r\n            }}\r\n            className=\"MyButton\"\r\n            activeClassName=\"active\"\r\n          >\r\n            <ListItem button>\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst MobileMenu = connect(mapStateToProps, mapDispatchToProps)(Menu);\r\nexport default MobileMenu;\r\n","import React from 'react';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport {\r\n  Menu, MenuItem,\r\n  ListItem, ListItemText,\r\n  Icon, // ListItemIcon\r\n} from '@material-ui/core';\r\n// import {\r\n//   // InboxIcon,\r\n//   // DraftsIcon,\r\n//   // SendIcon\r\n// } from '@material-ui/icons';\r\n\r\nconst StyledMenu = withStyles({\r\n  paper: {\r\n    border: '1px solid #d3d4d5',\r\n  },\r\n})((props) => (\r\n  <Menu\r\n    elevation={0}\r\n    getContentAnchorEl={null}\r\n    anchorOrigin={{\r\n      vertical: 'bottom',\r\n      horizontal: 'center',\r\n    }}\r\n    transformOrigin={{\r\n      vertical: 'top',\r\n      horizontal: 'center',\r\n    }}\r\n    {...props}\r\n  />\r\n));\r\n\r\n// const StyledMenuItem = withStyles((theme) => ({\r\n//   root: {\r\n//     '&:focus': {\r\n//       backgroundColor: theme.palette.primary.main,\r\n//       '& .MuiListItemIcon-root, & .MuiListItemText-primary': {\r\n//         color: theme.palette.common.white,\r\n//       },\r\n//     },\r\n//   },\r\n// }))(MenuItem);\r\n\r\nexport default function UserMenu(props) {\r\n  const [anchorEl, setAnchorEl] = React.useState(null);\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  return (\r\n    <span className=\"float-right blue whiteFont\">\r\n      <ListItem \r\n        aria-controls=\"user-menu\" aria-haspopup=\"true\"\r\n        style={{cursor: \"pointer\"}} \r\n        onClick={handleClick} \r\n        className=\"curvedButton float-right\">\r\n        <Icon>person</Icon>\r\n        <ListItemText primary={` ${props.username}`}/>\r\n      </ListItem>\r\n      <StyledMenu\r\n        id=\"customized-menu\"\r\n        anchorEl={anchorEl}\r\n        keepMounted\r\n        open={Boolean(anchorEl)}\r\n        onClose={_ => {setAnchorEl(null)}}\r\n      >\r\n        <MenuItem onClick={_ => {\r\n          // if (props.onProfile !== undefined)\r\n          //   props.onProfile();\r\n          setAnchorEl(null);\r\n        }}>\r\n          <NavLink\r\n            to=\"/User/Profile\"\r\n            // onClick={_ => {\r\n            //   this.props.toggleMenu();\r\n            // }}\r\n            style={{\r\n              color:\"black\"\r\n            }}\r\n            // className=\"MyButton\"\r\n            // activeClassName=\"active\"\r\n          >\r\n            <ListItemText primary=\"Profile\" />\r\n          </NavLink>\r\n        </MenuItem>\r\n        <MenuItem\r\n          style={{\r\n            color:\"black\"\r\n          }} \r\n          onClick={_ => {\r\n            if (props.onLogout !== undefined)\r\n              props.onLogout();\r\n            setAnchorEl(null);\r\n          }}>\r\n          <ListItemText primary=\"Logout\" />\r\n        </MenuItem>\r\n      </StyledMenu>\r\n    </span>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport {\r\n  AppBar, Toolbar, ListItem, \r\n  ListItemText, Icon, IconButton, \r\n  // Button\r\n} from \"@material-ui/core\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\n// import { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  setWorlds,\r\n  loadFromStorage,\r\n  toggleMenu,\r\n  toggleLogin,\r\n  logout,\r\n  redirectTo\r\n} from \"../../redux/actions/index\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport API from \"../../smartAPI\";\r\nimport MobileMenu from \"./MobileMenu\";\r\nimport UserMenu from \"./UserMenu\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    user: state.app.user,\r\n    selectedWorld: state.app.selectedWorld,\r\n    mobileMenuOpen: !state.app.menuOpen // This defaults to closed instead of open\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    loadFromStorage: () => dispatch(loadFromStorage({})),\r\n    toggleMenu: () => dispatch(toggleMenu({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    redirectTo: page => dispatch(redirectTo(page))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.loadFromStorage();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Grid container spacing={0}>\r\n            <Grid item xs>\r\n              <IconButton\r\n                style={{ color: \"white\" }}\r\n                aria-label=\"Menu\"\r\n                onClick={_ => {\r\n                  this.props.toggleMenu();\r\n                }}\r\n              >\r\n                <MenuIcon />\r\n              </IconButton>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <ListItem className=\"curvedButton\">\r\n                <ListItemText\r\n                  primary={\r\n                    this.props.selectedWorld === null\r\n                      ? \"Welcome!\"\r\n                      : this.props.selectedWorld.Name\r\n                  }\r\n                />\r\n              </ListItem>\r\n            </Grid>\r\n            <Grid item xs>\r\n              { this.props.user === null || this.props.user.username === undefined ? \r\n                <span style={{cursor: \"pointer\"}} \r\n                  onClick={_ => {\r\n                    this.props.toggleLogin();\r\n                  }}\r\n                  className=\"float-right blue whiteFont\">\r\n                  <ListItem className=\"curvedButton float-right\">\r\n                    <Icon>person</Icon>\r\n                    <ListItemText primary=\" Login/Register\"/>\r\n                  </ListItem>\r\n                </span>\r\n              : \r\n                <UserMenu \r\n                  username={this.props.user.username}\r\n                  onLogout={_ => {\r\n                    this.api.logout().then(_ => {\r\n                      this.props.logout();\r\n                    });\r\n                  }}\r\n                />\r\n              }\r\n            </Grid>\r\n          </Grid>\r\n        </Toolbar>\r\n        {this.props.mobileMenuOpen &&\r\n          <Box display={{ xs: 'inline', sm: 'none' }}>\r\n            <MobileMenu />\r\n          </Box>\r\n        }\r\n      </AppBar>\r\n    );\r\n  }\r\n}\r\n\r\nconst NavBar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default NavBar;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\n// import logo from \"../../logo.svg\";\r\nimport logo from \"../../assets/img/ANB.png\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  Divider,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds(true).then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    // These kinds of things can also be done in render,\r\n    // but I prefer to put it here because it's only run once.\r\n    // The downside is that it's run before props gets populated\r\n    // so, it needs to be put into setTimeout to give the props\r\n    // a chance to get populated.\r\n    setTimeout(() => {\r\n      if (this.props.user !== null) {\r\n        this.api.getWorldsForUser().then(res => {\r\n          if (res.worlds !== undefined) {\r\n            this.props.setWorlds(res.worlds);\r\n          }\r\n          else {\r\n            // User's login is no longer valid.\r\n            this.props.logout();\r\n          }\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      menuRoutes.map((prop, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={prop.path} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              {typeof prop.icon === \"string\" ? (\r\n                <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n              ) : (\r\n                <prop.icon className=\"marginLeft\" />\r\n              )}\r\n              &nbsp;\r\n              <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  brand() {\r\n    return (\r\n      <NavLink to={`/`} className=\"BlackTextButton\" activeClassName=\"active\">\r\n        <ListItem>\r\n          <img src={logo} alt=\"logo\" className=\"App-logo\" />\r\n          <ListItemText primary={this.props.logoText} />\r\n        </ListItem>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (this.state.Filter === \"\" || w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            }\r\n            else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {\r\n                followingWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/world/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, false);\r\n                      }}\r\n                    >\r\n                      <Star />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n              {\r\n                otherWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/world/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, true);\r\n                      }}\r\n                    >\r\n                      <StarBorderIcon />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return (\r\n      followingWorlds.map((w, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={`/world/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => \r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink to={`/world/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            );\r\n      return (worldLinks);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.brand()}\r\n        <Divider light />\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Tooltip title={`Browse Public Worlds`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        <ListItem>\r\n          <ListItemText primary={\"My Worlds\"} />\r\n        </ListItem>\r\n        <ListItem className=\"curvedButton\">\r\n          <NavLink to={`/world/create`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst Sidebar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default Sidebar;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport {\r\n  notFromLogin\r\n} from \"../../redux/actions/index\";\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    selectedPage: state.app.selectedPage,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    if (\r\n      this.props.selectedPage === null ||\r\n      `/${this.props.selectedPage}` === window.location.pathname\r\n    ) {\r\n      return (\r\n        <div className=\"col-sm-12\">\r\n          Forum Menu Page!\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <Redirect\r\n          to={`/${this.props.selectedPage}`}\r\n        />\r\n      );\r\n    }\r\n  }\r\n}\r\nconst ForumMenuPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ForumMenuPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\n// import uuid from 'react-uuid';\r\n// import { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport { \r\n  Grid, \r\n  //Button, \r\n  // Checkbox, FormControl, FormControlLabel,\r\n  // InputLabel, Tooltip, Fab,\r\n  // Select, MenuItem \r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\n// import { Multiselect } from 'multiselect-react-dropdown';\r\nimport {\r\n  // updateSelectedType,\r\n  // addType,\r\n  // updateType,\r\n  // addAttributes,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n// import TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: \"\",\r\n      email: \"\",\r\n      fieldValidation: {\r\n        username: { valid: true, message: \"\" },\r\n        email: { valid: true, message: \"\" },\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      loaded: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"username\":\r\n        value = this.state.username;\r\n        // valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        // if (!valid)\r\n        //   message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        // else \r\n        if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Username is too short\";\r\n        } else if (this.state.allUsers.filter(u=>u.username === value && u._id !== this.props.user._id).length !== 0) {\r\n          valid = false;\r\n          message = \"This Username is taken\";\r\n        }\r\n        break;\r\n      case \"email\":\r\n        value = this.state.email;\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        if (valid && value !== this.props.user.email)\r\n          message = \"You will be sent a confirmation email at your new email upon submission.  Please use the link.\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  }\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"username\");\r\n    const emailValid = this.validateField(\"email\");\r\n    const formValid = nameValid.valid && emailValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  }\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      _id: this.props.user._id,\r\n      username: this.state.username.trim(),\r\n      email: this.state.email.trim()\r\n    };\r\n\r\n    this.api.updateUser(user).then(res => {\r\n      // Should do all the same stuff that is done on login.\r\n      if (res.user === null) {\r\n        let errors = this.state.fieldValidation;\r\n        errors.loginError = { message: res.error, valid: false, show: true };\r\n        this.setState({ fieldValidation: errors, waiting: false });\r\n      }\r\n      else {\r\n        this.props.userLogin(res.user);\r\n        this.api.getWorldsForUser(res.user._id).then(res => {\r\n          this.props.setWorlds(res.worlds);\r\n          this.props.onLogin(res.user);\r\n          // this.setState({ redirectTo: \"/\" });\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  load = () => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        redirectTo: null,\r\n        message: \"Loading...\"\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    this.api.getAllUsers().then(res2 => {\r\n      this.setState({\r\n        allUsers: res2, \r\n        username: this.props.user.username, \r\n        email: this.props.user.email,\r\n        loaded: true,\r\n        message: \"\"\r\n      });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (!this.state.loaded)\r\n      this.load();\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.user === null) {\r\n      return <span>Please log in to be able to access your profile.</span>;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ `Author's Notebook: User Profile` }</title>\r\n          </Helmet>\r\n          <Grid item>\r\n            <h2>User Profile</h2>\r\n          </Grid>\r\n          <Grid item>\r\n            Username: {this.props.user.username}\r\n            {/* { this.state.loaded && <span>{this.state.username}</span> \r\n              // <TextBox \r\n              //   Value={this.state.username} \r\n              //   fieldName=\"username\" \r\n              //   displayName=\"Username\" \r\n              //   message={this.state.fieldValidation.username.message}\r\n              //   onBlur={name => {\r\n              //     this.setState({ username: name }, this.validateForm);\r\n              //   }}\r\n              //   labelWidth={70}/>\r\n            } */}\r\n          </Grid>\r\n          <Grid item>\r\n            Email: {this.props.user.email}\r\n            {/* { this.state.loaded &&  \r\n              <TextBox \r\n                Value={this.state.email} \r\n                fieldName=\"email\" \r\n                displayName=\"Email\" \r\n                message={this.state.fieldValidation.email.message}\r\n                onBlur={email => {\r\n                  this.setState({ email }, this.validateForm);\r\n                }}\r\n                labelWidth={43}/>\r\n            } */}\r\n          </Grid>\r\n          <Grid item>I'll add more profile elements here as the website grows</Grid>\r\n          {/* <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\" color=\"primary\"\r\n                style={{marginLeft: \"4px\"}}\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={e => {this.onSubmit(false);}}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item style={{color:\"red\"}}>{this.state.message}</Grid> */}\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ProfilePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ProfilePage;\r\n","import React, { Component } from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n// import { Fab } from \"@material-ui/core\";\r\nimport {\r\n  updateIndexExpandedPanel\r\n} from \"../../redux/actions/index\";\r\n\r\n/* \r\n  This component will be used by the WorldDetails component.  It will\r\n  have a link at the top for creating new Things, and will list all\r\n  Things in the selected World, allowing navigation to their Details.  \r\n  The List will have pagination and filtering controls to make it \r\n  easier to manage.\r\n*/\r\nconst mapStateToProps = state => {\r\n  return { \r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorld: state.app.selectedWorld,\r\n    user: state.app.user,\r\n    indexExpandedPanel: state.app.indexExpandedPanel\r\n  };\r\n}\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateIndexExpandedPanel: panel => dispatch(updateIndexExpandedPanel(panel))\r\n  };\r\n}\r\nclass Index extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleChange = panel => {\r\n    this.props.updateIndexExpandedPanel(this.props.indexExpandedPanel === panel ? false : panel);\r\n  }\r\n\r\n  renderListForType(type) {\r\n    // TODO: Add a PluralName field to types so I can use it here.  It may end up being useful other places too.\r\n    const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n              <Add/><ListItemText primary={`Create New ${type.Name}`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            things.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMajorTypelessThings() {\r\n    const majorLess = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n              <Add/><ListItemText primary={`Create New Thing`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            majorLess.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    }\r\n    else {\r\n      const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n      const editButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n      const createButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n\r\n      return (\r\n        <div>\r\n          <List>\r\n            <ListItem>\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  {this.props.indexExpandedPanel === \"TYPES\" ? \r\n                    <Tooltip title={`Collapse Types`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                          <KeyboardArrowDownIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  :\r\n                    <Tooltip title={`Expand Types`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                          <KeyboardArrowRightIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Types (${this.props.types.length})`}</span>\r\n                  { createButtons &&\r\n                    <Tooltip title={`Create New Type`}>\r\n                      <Button \r\n                        onClick={ _ => {this.setState({redirectTo:`/type/create`})}}>\r\n                        <Add/>\r\n                      </Button>\r\n                    </Tooltip> \r\n                  }\r\n                </Grid>\r\n                {this.props.indexExpandedPanel === \"TYPES\" &&\r\n                  <Grid item>\r\n                    <List style={{ maxWidth: \"300px\" }}>\r\n                      {\r\n                        this.props.types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Tooltip title={`Details for ${type.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                                  <ListItemText primary={type.Name} className=\"marginLeft\" />\r\n                                </Button>\r\n                              </Tooltip>\r\n                              { createButtons &&\r\n                                <Grid container spacing={0} direction=\"row\">\r\n                                  <Grid item xs={6}>\r\n                                    <Tooltip title={`Create New ${type.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                                        <Add/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                  <Grid item xs={6}>\r\n                                    <Tooltip title={`Edit ${type.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                                        <Edit/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                </Grid>\r\n                              }\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                }\r\n              </Grid>\r\n            </ListItem>\r\n            { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n              const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      {this.props.indexExpandedPanel === type._id ? \r\n                        <Tooltip title={`Collapse ${type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName}`}>\r\n                          <Button \r\n                            onClick={_ => {this.handleChange(type._id)}}>\r\n                            <KeyboardArrowDownIcon/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                        :\r\n                        <Tooltip title={`Expand ${type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName}`}>\r\n                          <Button \r\n                            onClick={_ => {this.handleChange(type._id)}}>\r\n                            <KeyboardArrowRightIcon/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                      }\r\n                      <Tooltip title={`Details for ${type.Name}`}>\r\n                        <Button \r\n                          onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                          <ListItemText>{type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName} ({things.length})</ListItemText>\r\n                        </Button>\r\n                      </Tooltip>\r\n                      { createButtons &&\r\n                        <span>\r\n                          <Tooltip title={`Create New ${type.Name}`}>\r\n                            <Button \r\n                              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                              <Add/>\r\n                            </Button>\r\n                          </Tooltip>\r\n                          <Tooltip title={`Edit ${type.Name}`}>\r\n                            <Button \r\n                              onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                              <Edit/>\r\n                            </Button>\r\n                          </Tooltip>\r\n                        </span>\r\n                      }\r\n                    </Grid>\r\n                    {this.props.indexExpandedPanel === type._id &&\r\n                      <Grid item>\r\n                        <List style={{ maxWidth: \"300px\" }}>\r\n                          {\r\n                            things.map((thing, j) => {\r\n                              return (\r\n                                <ListItem key={j}>\r\n                                  <Tooltip title={`Details for ${thing.Name}`}>\r\n                                    <Button \r\n                                      fullWidth variant=\"contained\" color=\"primary\" \r\n                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                      <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                    </Button>\r\n                                  </Tooltip>\r\n                                  { editButtons &&\r\n                                    <Tooltip title={`Edit ${thing.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                        <Edit/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  }\r\n                                </ListItem>\r\n                              );\r\n                            })\r\n                          }\r\n                        </List>\r\n                      </Grid>\r\n                    }\r\n                  </Grid>\r\n                </ListItem>\r\n              );\r\n            })}\r\n            <ListItem>\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  {this.props.indexExpandedPanel === \"OTHER\" ? \r\n                    <Tooltip title={`Collapse Other Things`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                        <KeyboardArrowDownIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  :\r\n                    <Tooltip title={`Expand Other Things`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                        <KeyboardArrowRightIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Other Things (${majorless.length})`}</span>\r\n                  { createButtons &&\r\n                    <Tooltip title={`Create New Thing`}>\r\n                      <Button \r\n                        onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n                        <Add/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  }\r\n                </Grid>\r\n                {this.props.indexExpandedPanel === \"OTHER\" &&\r\n                  <Grid item>\r\n                    <List style={{ maxWidth: \"300px\" }}>\r\n                      {\r\n                        majorless.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Tooltip title={`Details for ${thing.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                  <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                </Button>\r\n                              </Tooltip>\r\n                              { editButtons &&\r\n                                <Tooltip title={`Edit ${thing.Name}`}>\r\n                                  <Button \r\n                                    onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                    <Edit/>\r\n                                  </Button>\r\n                                </Tooltip>\r\n                              }\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                }\r\n              </Grid>\r\n            </ListItem>\r\n          </List>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingIndex = connect(mapStateToProps, mapDispatchToProps)(Index);\r\nexport default ThingIndex;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  selectWorld, setTypes, setThings, setWorlds, \r\n  setPublicWorlds, updatePublicWorldForCollab,\r\n  setAttributes, updateAttributes,\r\n  notFromLogin,\r\n  toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport Index from \"./Index\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Delete from \"@material-ui/icons/Delete\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { Fab } from \"@material-ui/core\";\r\nimport { People } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    updatePublicWorldForCollab: world => dispatch(updatePublicWorldForCollab(world)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    updateAttributes: attributes => dispatch(updateAttributes(attributes)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      world: null,\r\n      modalOpen: false,\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n  componentDidMount() {\r\n  }\r\n\r\n  getAttributes() {\r\n    this.api.getAttributesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // We store the attributes in two hashes, by name and by id\r\n        this.props.setAttributes(res.attributes);\r\n        this.getTypes();\r\n      }\r\n    });\r\n  }\r\n\r\n  getTypes() {\r\n    this.api.getTypesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // Add Supers to each type\r\n        const types = res.types;\r\n        const updateAttributes = [];\r\n        types.forEach(t=> {\r\n          t.Supers = [];\r\n          t.SuperIDs.forEach(sID=> {\r\n            t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n          });\r\n          t.AttributesArr = [];\r\n          t.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            attr.TypeIDs.push(t._id);\r\n            updateAttributes.push(attr);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: a.TypeIDs\r\n            });\r\n          });\r\n          const defHash = {};\r\n          if (t.Defaults !== undefined) {\r\n            t.Defaults.forEach(def => {\r\n              defHash[def.attrID] = def;\r\n            });\r\n          }\r\n          t.DefaultsHash = defHash;\r\n        });\r\n        this.props.updateAttributes(updateAttributes);\r\n        this.props.setTypes(types);\r\n        this.getThings();\r\n      }\r\n    });\r\n  }\r\n\r\n  getThings() {\r\n    this.api.getThingsForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        const things = res.things;\r\n        things.forEach(t=> {\r\n          t.Types = [];\r\n          t.TypeIDs.forEach(tID=> {\r\n            t.Types = t.Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n          });\r\n        });\r\n        this.props.setThings(things);\r\n      }\r\n    });\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteWorld(this.props.selectedWorldID).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getPublicWorlds(true).then(res2 => {\r\n          if (res2.worlds !== undefined) this.props.setPublicWorlds(res2.worlds);\r\n          this.api.getWorldsForUser(true).then(res3 => {\r\n            if (res3.worlds !== undefined) this.props.setWorlds(res3.worlds);\r\n            this.api.selectWorld(null);\r\n            this.props.selectWorld(null);\r\n            this.setState({modalOpen: false, redirectTo: `/`});\r\n          });\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error });\r\n      }\r\n    });\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  load = (id) => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    setTimeout(() => {\r\n      this.props.selectWorld(id);\r\n      this.api.getWorld(id).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n      });\r\n    }, 500);\r\n  }\r\n\r\n  requestToCollaborate = () => {\r\n    this.api.requestToCollaborate(this.props.selectedWorldID).then(res => {\r\n      const world = this.props.selectedWorld;\r\n      world.Collaborators.push(res);\r\n      this.props.updatePublicWorldForCollab(world);\r\n    });\r\n  }\r\n\r\n  respondToInvite = () => {\r\n    const invite = this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\")[0];\r\n    this.setState({ redirectTo: `/world/collaborate/${this.props.selectedWorldID}/${invite.collabID}` });\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.props.selectedWorldID === null || this.props.selectedWorldID !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          {this.props.selectedWorld === null ? (\r\n            \"\"\r\n          ) : (\r\n            <Grid item container spacing={0} direction=\"row\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item xs={9}>\r\n                <h2>{this.props.selectedWorld.Name}</h2>\r\n              </Grid>\r\n              { this.props.user !== null &&\r\n                <Grid item xs={3}>\r\n                  { this.props.selectedWorld.Owner === this.props.user._id ?\r\n                    <List>\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.props.selectedWorld.Name}`}>\r\n                          <Fab size=\"small\" color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/world/edit/${this.props.selectedWorldID}`})}}\r\n                          >\r\n                          <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit Collaborators`}>\r\n                          <Fab size=\"small\" color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/world/collaborators/${this.props.selectedWorldID}`})}}\r\n                          >\r\n                          <People />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.props.selectedWorld.Name}`}>\r\n                          <Fab size=\"small\" color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    </List>\r\n                  : \r\n                    <List>\r\n                      { this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id).length === 0 ?\r\n                        <ListItem>\r\n                          { this.props.selectedWorld.AcceptingCollaborators && \r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={this.requestToCollaborate}\r\n                              type=\"button\"\r\n                            >\r\n                              Request to Collaborate\r\n                            </Button>\r\n                          }\r\n                        </ListItem>\r\n                      : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"request\").length > 0 ?\r\n                        <ListItem>\r\n                          Waiting on Collaboration Request\r\n                        </ListItem>\r\n                      : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\").length > 0 &&\r\n                        <ListItem>\r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={this.respondToInvite}\r\n                            type=\"button\"\r\n                          >\r\n                            You've been invited to Collaborate\r\n                          </Button>\r\n                        </ListItem>\r\n                      }\r\n                    </List>\r\n                  }\r\n                </Grid>\r\n              }\r\n            </Grid>\r\n          )}\r\n          <Grid item>\r\n            <Index />\r\n          </Grid>\r\n          <Modal\r\n              aria-labelledby=\"delete-thing-modal\"\r\n              aria-describedby=\"delete-thing-modal-description\"\r\n              open={this.state.modalOpen}\r\n              onClose={e => {this.setState({modalOpen: false})}}\r\n            >\r\n              <div style={this.getModalStyle()} className=\"paper\">\r\n                <Grid container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    Are you sure you want to delete {this.props.selectedWorld !== null ? this.props.selectedWorld.Name : \"\"}?\r\n                  </Grid>\r\n                  <Grid item>\r\n                    (All external references to it will be left alone and may not work correctly)\r\n                  </Grid>\r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={this.delete}\r\n                      >\r\n                        Yes\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        onClick={e => {this.setState({modalOpen: false})}}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\nconst WorldDetailsPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldDetailsPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectWorld,\r\n  addWorld,\r\n  updateWorld,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, Tooltip, Fab\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    addWorld: world => dispatch(addWorld(world)),\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Public: false,\r\n      AcceptingCollaborators: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      loaded: true\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  }\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in World Names\";\r\n        else if (value.length < 4) {\r\n          valid = false;\r\n          message = \"World Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.worlds.filter(\r\n              w => w.Name === value && w._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This World Name is already in use\";\r\n        }\r\n        break;\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  }\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  }\r\n\r\n  submitThroughAPI = () => {\r\n    const world = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Public: this.state.Public,\r\n      AcceptingCollaborators: this.state.AcceptingCollaborators,\r\n      Owner: this.props.user._id\r\n    };\r\n\r\n    if (world._id === null) {\r\n      this.api\r\n        .createWorld(world)\r\n        .then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({ message: res.error }, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n          else {\r\n            world._id = res.worldID;\r\n            this.props.addWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${res.worldID}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateWorld(world)\r\n        .then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({ message: res.error }, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n          else {\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.state._id === null) {\r\n      this.setState({\r\n        Name: \"\",\r\n        Public: false,\r\n        loaded: true\r\n      });\r\n    }\r\n    else {\r\n      this.api.selectWorld(this.state._id).then(res => {\r\n        this.props.selectWorld(this.state._id);\r\n        this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n\r\n          this.setState({\r\n            Name: this.props.selectedWorld.Name,\r\n            Public: this.props.selectedWorld.Public,\r\n            loaded: true\r\n          });\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading...</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      this.props.selectedWorld.Owner !== this.props.user._id) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              { this.props.selectedWorld !== null &&\r\n                <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                  <Fab size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>\r\n              }\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>\r\n                {this.state._id === null ? \"Create New World\" : \"Edit World\"}\r\n              </h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.Public}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"Public\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Public\"\r\n            />\r\n            { this.state.Public ?\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.AcceptingCollaborators}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"AcceptingCollaborators\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Accepting Collaborator Requests\"\r\n            /> : \"\" }\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                style={{ marginLeft: \"4px\" }}\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  this.setState({\r\n                    redirectTo: this.state._id === null ? `/` : `/world/details/${this.state._id}`\r\n                  });\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst WorldEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldEditPage;","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport { userLogin, setWorlds, setFollowingWorlds } from \"../../redux/actions/index\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Cookies from \"universal-cookie\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    // selectedPage: state.app.selectedPage, \r\n    user: state.app.user, \r\n    loginError: state.app.loginError,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    userLogin: user => dispatch(userLogin(user)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const cookies = new Cookies();\r\n    const emailCookie = cookies.get('email');\r\n    const passCookie = cookies.get('password');\r\n    this.state = {\r\n      formMode: \"login\",\r\n      email: (emailCookie === undefined ? \"\" : emailCookie),\r\n      password: (passCookie === undefined ? \"\" : passCookie),\r\n      confirmEmail: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        email: { valid: true, message: \"\" }, \r\n        password: { valid: true, message: \"\" }, \r\n        confirmEmail: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" },\r\n        username: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      remember: false,\r\n      message: \"\",\r\n      username: \"\",\r\n      // redirectTo: null,\r\n      allUsers: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    if (this.state.email) {\r\n      this.validateField(\"email\");\r\n      this.validateField(\"password\");\r\n      this.setState({remember: true});\r\n    }\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        if (valid && this.state.allUsers.filter(u=>u.username === value).length !== 0) {\r\n          valid = false;\r\n          message = \"This Username is taken\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const emailValid = this.validateField(\"email\");\r\n    let confirmEmailValid = { valid: true, message: \"\" };\r\n    let passwordValid = { valid: true, message: \"\" };\r\n    let confirmPasswordValid = { valid: true, message: \"\" };\r\n    let usernameValid = { valid: true, message: \"\" };\r\n    switch (this.state.formMode) {\r\n      case \"Login\":\r\n        passwordValid = this.validateField(\"password\");\r\n        break;\r\n      case \"Register\":\r\n        confirmEmailValid = this.validateField(\"confirmEmail\");\r\n        passwordValid = this.validateField(\"password\");\r\n        confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n        usernameValid = this.validateField(\"username\");\r\n      break;\r\n      default:\r\n      break;\r\n    }\r\n    const formValid = \r\n      emailValid.valid && \r\n      passwordValid.valid && \r\n      confirmEmailValid.valid && \r\n      confirmPasswordValid.valid && \r\n      usernameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.email = emailValid;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmEmail = confirmEmailValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    fieldValidation.username = usernameValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      email: this.state.email.trim(),\r\n      password: this.state.password,\r\n      username: this.state.username.trim(),\r\n      followingWorlds: this.props.followingWorlds\r\n    };\r\n    if (this.state.formMode === \"login\") {\r\n      this.api.login(user, this.state.remember).then(res => {\r\n        if (res.user === null) {\r\n          let errors = this.state.fieldValidation;\r\n          errors.loginError = { message: res.error, valid: false, show: true };\r\n          this.setState({ fieldValidation: errors, waiting: false });\r\n        }\r\n        else {\r\n          this.props.userLogin(res.user);\r\n          this.api.getWorldsForUser(res.user._id).then(res => {\r\n            this.props.setWorlds(res.worlds);\r\n            this.props.onLogin(res.user);\r\n            // this.setState({ redirectTo: \"/\" });\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"register\") {\r\n      this.api.register(user).then(res => {\r\n        if (res.error === undefined) {\r\n          this.setState({ \r\n            message: res.message, \r\n            formMode: \"login\", \r\n            fieldValidation: { \r\n              email: { valid: true, message: \"\" }, \r\n              password: { valid: true, message: \"\" }, \r\n              confirmEmail: { valid: true, message: \"\" }, \r\n              confirmPassword: { valid: true, message: \"\" },\r\n              username: { valid: true, message: \"\" }\r\n            },\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({ \r\n            message: res.error,\r\n            waiting: false\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"password\") {\r\n      this.api.sendReset(user).then(res => {\r\n        this.setState({ message: res.message, \r\n          formMode: \"login\", \r\n          fieldValidation: { \r\n            email: { valid: true, message: \"\" }, \r\n            password: { valid: true, message: \"\" }, \r\n            confirmEmail: { valid: true, message: \"\" }, \r\n            confirmPassword: { valid: true, message: \"\" },\r\n            username: { valid: true, message: \"\" }\r\n          },\r\n          waiting: false \r\n        });\r\n      })\r\n      .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  loginClick = () => {\r\n    this.setState({ formMode: \"login\" });\r\n  };\r\n\r\n  registerClick = () => {\r\n    this.setState({ formMode: \"register\" });\r\n  };\r\n\r\n  passwordClick = () => {\r\n    this.setState({ formMode: \"password\" });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.allUsers === null) {\r\n      this.api.getAllUsers().then(res => {\r\n        this.setState({allUsers: res});\r\n      });\r\n      return (<div></div>);\r\n    }\r\n    // else if (this.state.redirectTo !== null && \r\n    //   this.props.user !== null && \r\n    //   this.props.user !== undefined && \r\n    //   this.props.user.username !== undefined && \r\n    //   this.props.user.username !== \"\") {\r\n    //   return (<Redirect to={this.state.redirectTo} />);\r\n    // }\r\n    else {\r\n      if (this.state.formMode === \"login\") {\r\n        return (\r\n          <div>\r\n            <h2>Login</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        value={this.state.email}\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          checked={this.state.remember}\r\n                          onChange={this.handleUserInput}\r\n                          name=\"remember\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Stay Signed In\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"register\") {\r\n        return (\r\n          <div>\r\n            <h2>Register</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"username\">Username</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"username\"\r\n                            name=\"username\"\r\n                            type=\"text\"\r\n                            value={this.state.username}\r\n                            error={ !this.state.fieldValidation.username.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={80}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.username.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={this.state.email}\r\n                            error={ !this.state.fieldValidation.email.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={40}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                          fullWidth>\r\n                          <InputLabel htmlFor=\"confirmEmail\">Confirm Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"confirmEmail\"\r\n                            name=\"confirmEmail\"\r\n                            type=\"email\"\r\n                            error={ !this.state.fieldValidation.confirmEmail.valid }\r\n                            value={this.state.confirmEmail}\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={100}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.confirmEmail.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div> \r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"confirm-password\"\r\n                        name=\"confirmPassword\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.confirmPassword}\r\n                        error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={130}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>{\" \"}\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"password\") {\r\n        return (\r\n          <div>\r\n            <h2>Forgot Password?</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        value={this.state.email}\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default LoginControl;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Button,\r\n  Grid\r\n} from \"@material-ui/core\";\r\nimport LoginControl from '../User/LoginControl';\r\nimport {\r\n  setWorlds,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      worldID: null,\r\n      collabID: null,\r\n      codeValid: false,\r\n      accepted: null,\r\n      message: \"Please wait.  Validating code.\",\r\n      world: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  accept = () => {\r\n    if (this.props.user === null) {\r\n      this.setState({waiting: false, accepted: true});\r\n    }\r\n    else {\r\n      this.setState({waiting: true},\r\n        this.submitAccept\r\n      );\r\n    }\r\n  }\r\n\r\n  submitAccept = () => {\r\n    this.api.acceptCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: true}, this.getWorlds);\r\n    });\r\n  }\r\n\r\n  getWorlds = () => {\r\n    this.api.getWorldsForUser().then(res => {\r\n      if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n      this.refreshWorld();\r\n    });\r\n  }\r\n\r\n  refreshWorld = () => {\r\n    this.api.getWorld(this.state.worldID, true).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n    });\r\n  }\r\n\r\n  onLoginAccept = (user) => {\r\n    this.setState({waiting: true},\r\n      this.submitAccept\r\n    );\r\n  }\r\n\r\n  decline = () => {\r\n    this.setState({waiting: true},\r\n      this.submitDecline\r\n    );\r\n  }\r\n\r\n  submitDecline = () => {\r\n    this.api.declineCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: false}, this.refreshWorld);\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.collabID === null) {\r\n      const { worldID, collabID } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkCollabID(worldID, collabID).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({collabID, worldID, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({collabID, worldID, world: res.world, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      if (this.state.accepted === null) {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              <h2>You've been invited to collaborate on {this.state.world.Name}</h2>\r\n            </Grid>\r\n            <Grid item xs={12} container spacing={1}>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.accept}\r\n                  type=\"button\">\r\n                  Accept\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.decline}\r\n                  type=\"button\">\r\n                  Decline\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n      else if (this.state.accepted) {\r\n        if (this.props.user === null) {\r\n          return (\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <h2>Please log in (or register and then log in if you're new) so we can add you as a collaborator on {this.state.world.Name}.</h2>\r\n              </Grid>\r\n              <Grid item>\r\n                <LoginControl onLogin={this.onLoginAccept}/>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={12}>\r\n                <h2>Congratulations! You can now collaborate on {this.state.world.Name}</h2>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              Okay.  Well, we hope you enjoy working on other worlds.\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst CollaboratePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default CollaboratePage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateWorld, selectWorld,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, \r\n  ListItem, ListItemText, \r\n  Tooltip, Fab, AppBar, Tabs, Tab, Box, \r\n  InputAdornment, IconButton,\r\n  Select, MenuItem\r\n} from \"@material-ui/core\";\r\nimport { Add, ArrowBack, FileCopyOutlined, Delete, Check } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index } = props;\r\n\r\n  return (\r\n    <div>{value === index && <Box p={3}>{children}</Box>}</div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Collaborators: [],\r\n      allUsers: null,\r\n      fieldValidation: {\r\n        inviteEmail: { valid: true, message: \"\" }\r\n      },\r\n      message: \"\",\r\n      redirectTo: null,\r\n      newCollaborators: false,\r\n      newCollabTab: 0,\r\n      collabTab: 0,\r\n      collabLink: null,\r\n      collabLinkCopied: false,\r\n      selectedUser: \"\",\r\n      inviteEmail: \"\",\r\n      inviteMessage: \"\", \r\n      waiting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  addNewCollaborator = () => {\r\n    function respond() {\r\n      this.api.addNewCollaborator(this.props.selectedWorldID, this.state.selectedUser._id, this.state.selectedUser.email).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, \r\n            inviteMessage: \"Invite Sent\",\r\n            selectedUser: \"\",\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  emailCollaborator = () => {\r\n    const emailValid = this.validateField(\"inviteEmail\");\r\n    if (emailValid) {\r\n      function respond() {\r\n        this.api.emailCollaborator(this.props.selectedWorldID, this.state.inviteEmail).then(res => {\r\n          if (res.error === undefined) {\r\n            const collabs = [...this.state.Collaborators];\r\n            collabs.push(res);\r\n            const world = this.props.selectedWorld;\r\n            world.Collaborators = collabs;\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              Collaborators: collabs, \r\n              inviteMessage: \"Email Sent\", \r\n              inviteEmail: \"\",\r\n              waiting: false\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error, waiting: false}, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n        });\r\n      }\r\n      this.setState({waiting: true}, respond);\r\n    }\r\n  }\r\n\r\n  updateCollaboratorPermission = (collaborator, permission) => {\r\n    collaborator.editPermission = permission;\r\n    function respond() {\r\n      this.api.updateCollaboratorPermission(this.props.selectedWorldID, collaborator.collabID, permission).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          const collab = collabs.filter(c=>c.collabID === collaborator.collabID)[0];\r\n          collab.editPermission = permission;\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Creates a collab invite on the world, but no user or email associated\r\n  generateCollabLink = () => {\r\n    function respond() {\r\n      this.api.generateCollabLink(this.props.selectedWorldID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  deleteCollab = (collab) => {\r\n    function respond() {\r\n      this.api.deleteCollab(this.props.selectedWorldID, collab.collabID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = this.state.Collaborators.filter(c=>c.collabID !== collab.collabID);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  acceptCollab = (collab) => {\r\n    function respond() {\r\n      this.api.acceptCollabRequest(this.props.selectedWorldID, collab.collabID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          const collab2 = collabs.filter(c => c.collabID === collab.collabID)[0];\r\n          collab2.type = \"collab\";\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Copies the collaborator link to the user's clipboard\r\n  copyCollabLink = () => {\r\n    const el = this.generatedLink;\r\n    const textarea = el.children[0];\r\n    textarea.select();\r\n    document.execCommand(\"copy\");\r\n    this.setState({collabLinkCopied: true});\r\n  }\r\n\r\n  load = (id) => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    \r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    this.api.selectWorld(this.state._id);\r\n    this.props.selectWorld(this.state._id);\r\n    this.api.getWorld(this.state._id).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n      \r\n      this.api.getAllUsers().then(res => {\r\n        this.setState({allUsers: res, loaded: true}, \r\n          this.actuallyFinishLoading);\r\n      });\r\n    });\r\n  }\r\n\r\n  actuallyFinishLoading = () => {\r\n    let world = this.props.worlds.filter(w => w._id === this.state._id);\r\n    if (world.length > 0) {\r\n      world = world[0];\r\n      this.setState({\r\n        Name: world.Name,\r\n        Public: world.Public,\r\n        AcceptingCollaborators: world.AcceptingCollaborators === undefined || world.AcceptingCollaborators === null ? false : world.AcceptingCollaborators,\r\n        Collaborators: world.Collaborators === undefined ? [] : world.Collaborators\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading...</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      this.props.selectedWorld.Owner !== this.props.user._id) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const collabs = this.state.Collaborators.filter(c=>c.type===\"collab\");\r\n      const invites = this.state.Collaborators.filter(c=>c.type===\"invite\");\r\n      const requests = this.state.Collaborators.filter(c=>c.type===\"request\");\r\n      const selectUsers = this.state.allUsers.filter(u=>u._id !== this.props.selectedWorld.Owner && this.state.Collaborators.filter(c=>c.userID === u._id).length === 0);\r\n      const userMenuItems = selectUsers.map((u, i) => {\r\n        return (\r\n          <MenuItem key={i} value={u}>\r\n            {u.username}\r\n          </MenuItem>\r\n        );\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name} Collaborators` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                <Fab size=\"small\"\r\n                  color=\"primary\"\r\n                  onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                >\r\n                  <ArrowBack />\r\n                </Fab>\r\n              </Tooltip>\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>Edit Collaborators</h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <ListItem style={{maxWidth: \"200px\"}}>\r\n              <ListItemText primary=\"Collaborators\" />\r\n              { this.state.newCollaborators ?\r\n                <Tooltip title={`Manage Existing Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: false });\r\n                    }}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>  :\r\n                <Tooltip title={`Add New Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: true });\r\n                    }}\r\n                  >\r\n                    <Add />\r\n                  </Fab>\r\n                </Tooltip> \r\n              }\r\n            </ListItem>\r\n          </Grid>\r\n          { this.state.newCollaborators ?\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.newCollabTab} onChange={(_, newValue) => { this.setState({newCollabTab: newValue, inviteMessage: \"\"})}} aria-label=\"Add Collaborator Method\">\r\n                    <Tab label=\"Find Existing User\" {...this.a11yProps(0)} />\r\n                    <Tab label=\"Invite via Email\" {...this.a11yProps(1)} />\r\n                    <Tab label=\"Get an Invite Link\" {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.newCollabTab} index={0}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"user-select\" id=\"user-select-label\">\r\n                          Select a User\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"user-select-label\"\r\n                          id=\"user-select\"\r\n                          value={this.state.selectedUser}\r\n                          onChange={e => {\r\n                            this.setState({selectedUser: e.target.value, inviteMessage: \"\" })\r\n                          }}\r\n                          labelWidth={90}\r\n                        >\r\n                          {userMenuItems}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.selectedUser === \"\" || this.state.waiting}\r\n                        onClick={this.addNewCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={1}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"inviteEmail\">Collaborator Email</InputLabel>\r\n                        <OutlinedInput\r\n                          id=\"inviteEmail\"\r\n                          name=\"inviteEmail\"\r\n                          type=\"email\"\r\n                          autoComplete=\"Off\"\r\n                          error={!this.state.fieldValidation.inviteEmail.valid}\r\n                          value={this.state.inviteEmail}\r\n                          onChange={this.handleUserInput}\r\n                          onBlur={this.inputBlur}\r\n                          labelWidth={140}\r\n                          fullWidth\r\n                        />\r\n                        <FormHelperText>\r\n                          {this.state.fieldValidation.inviteEmail.message}\r\n                        </FormHelperText>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.emailCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={2}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Generate a single use link to send someone yourself\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.generateCollabLink}\r\n                      >\r\n                        Generate Link\r\n                      </Button> \r\n                    </Grid>\r\n                      { this.state.collabLink !== null && \r\n                        <Grid item>\r\n                          <OutlinedInput\r\n                            id=\"generatedLink\"\r\n                            name=\"generatedLink\"\r\n                            ref={(input) => this.generatedLink = input}\r\n                            type=\"text\"\r\n                            multiline={true}\r\n                            value={this.state.collabLink}\r\n                            // disabled={true}\r\n                            endAdornment={\r\n                              <InputAdornment position=\"end\">\r\n                                <IconButton\r\n                                  aria-label=\"copy to clipboard\"\r\n                                  onClick={this.copyCollabLink}\r\n                                  edge=\"end\"\r\n                                >\r\n                                  <FileCopyOutlined />\r\n                                </IconButton>\r\n                              </InputAdornment>\r\n                            }\r\n                            labelWidth={70}\r\n                            fullWidth\r\n                          />\r\n                          { this.state.collabLinkCopied && \r\n                            <span style={{fontColor: \"red\"}}>\r\n                              Link Copied to Clipboard\r\n                            </span>\r\n                          }\r\n                        </Grid>\r\n                      }\r\n                  </Grid>\r\n                  \r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid> :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.collabTab} onChange={(_, newValue) => { this.setState({collabTab: newValue})}} aria-label=\"Collaborators\">\r\n                    <Tab label={`Collaborators (${collabs.length})`} {...this.a11yProps(0)} />\r\n                    <Tab label={`Invites (${invites.length})`} {...this.a11yProps(1)} />\r\n                    <Tab label={`Requests (${requests.length})`} {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.collabTab} index={0}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { collabs.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={3}>\r\n                            {this.state.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <FormControlLabel\r\n                              control={\r\n                                <Checkbox \r\n                                  checked={c.editPermission} \r\n                                  disabled={this.state.waiting}\r\n                                  onChange={e => {\r\n                                    this.updateCollaboratorPermission(c, e.target.checked);\r\n                                  }}\r\n                                  color=\"primary\" />\r\n                              }\r\n                              label=\"Full Permissions\"\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Remove Collaborator`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={1}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { invites.map((c, key) => {\r\n                      let user = this.state.allUsers.filter(u=>u._id === c.userID);\r\n                      if (user.length === 0)\r\n                        user = null;\r\n                      else {\r\n                        user = user[0];\r\n                      }\r\n                      return (\r\n                        <Grid item container spacing={1} direction=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={9} container spacing={1} direction=\"column\">\r\n                            { user !== null &&\r\n                              <Grid item>\r\n                                Username: {user.username}\r\n                              </Grid>\r\n                            }\r\n                            { c.email !== \"\" &&\r\n                              <Grid item>\r\n                                Email: {c.email}\r\n                              </Grid>\r\n                            }\r\n                            <Grid item>\r\n                              Invite Link: {c.collabLink}\r\n                            </Grid>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Invite`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>  \r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={2}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { requests.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={6}>\r\n                            {this.state.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Accept Request`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={_ => {this.acceptCollab(c)}}\r\n                              >\r\n                                <Check />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Request`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={_ => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst EditCollaboratorPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default EditCollaboratorPage;","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  setTypes,\r\n  setAttributes,\r\n  setThings,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport { Edit, Delete, Add, ArrowBack } from \"@material-ui/icons\";\r\nimport { Fab, Modal, Grid, Button, Tooltip, List, ListItem, ListItemText } from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  const type = state.app.selectedType;\r\n  const subTypes =\r\n    type === null\r\n      ? []\r\n      : state.app.types.filter(t => t.SuperIDs.includes(type._id));\r\n  const things =\r\n    type === null\r\n      ? []\r\n      : state.app.things.filter(t => t.TypeIDs.includes(type._id));\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: type,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    subTypes: subTypes,\r\n    instances: things,\r\n    user: state.app.user,\r\n    things: state.app.things,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin,\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    // load();\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteType(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n\r\n          this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`});\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error }, () => {\r\n          this.props.logout();\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    // const { id } = this.props.match.params;\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    const id = this.state._id;\r\n    if (id !== undefined) {\r\n      this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n\r\n        if (id !== null) {\r\n          let type = res.types.filter(t => t._id === id);\r\n          if (type.length > 0) {\r\n            type = type[0];\r\n\r\n            this.props.updateSelectedType(type);\r\n          }\r\n          else {\r\n            this.setState({ message: \"Invalid ID\", loaded: true });\r\n          }\r\n        } else {\r\n          this.props.updateSelectedType({\r\n            _id: null,\r\n            Name: \"\",\r\n            Description: \"\",\r\n            Supers: [],\r\n            SuperIDs: [],\r\n            AttributesArr: [],\r\n            Attributes: [],\r\n            Major: false,\r\n            DefaultsHash: {}\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      this.props.updateSelectedType({\r\n        _id: null,\r\n        Name: \"\",\r\n        Description: \"\",\r\n        Supers: [],\r\n        AttributesArr: [],\r\n        Attributes: [],\r\n        Major: false\r\n      });\r\n    }\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next type\r\n    let index = 0;\r\n    while (this.props.types[index]._id !== this.props.selectedType._id)\r\n      index++;\r\n    index++;\r\n    if (index === this.props.types.length)\r\n      index = 0;\r\n    this.setState({ redirectTo: `/type/details/${this.props.types[index]._id}` });\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedType === undefined || this.props.selectedType === null) {\r\n      return (<span>Loading</span>);\r\n    } else {\r\n      const references = this.props.types.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      const inheritedAttributes = [];\r\n      this.props.selectedType.Supers.forEach(superType => {\r\n        superType.AttributesArr.forEach(attribute => {\r\n          if (inheritedAttributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n        });\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={5}>\r\n                  <h2>{this.props.selectedType.Name}</h2>\r\n                </Grid>\r\n                <Grid item sm={3} xs={6}>\r\n                  <h3>{this.props.selectedType.Major ? \"Major Type\" : \"\"}</h3>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Create New ${this.props.selectedType.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${this.state._id}`})}}\r\n                          >\r\n                            <Add />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.props.selectedType.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/edit/${this.state._id}`})}}\r\n                          >\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.props.selectedType.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    <ListItem>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary=\"Next Type\"/>\r\n                      </Button>\r\n                    </ListItem>\r\n                  </List>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n                  <Grid item>{this.props.selectedType.Description}</Grid>\r\n                  <Grid item>\r\n                    Attributes\r\n                    <List>\r\n                      { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n                        inheritedAttributes.map((attribute, i) => {\r\n                          let definedType = this.props.types.filter(t=>t._id === attribute.DefinedType);\r\n                          definedType = definedType.length === 0 ? {Name:\"\"} : definedType[0];\r\n                          const def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <ListItemText>\r\n                                {attribute.Name}:&nbsp;\r\n                                {attribute.AttributeType === \"Options\" ? (\r\n                                  <span>\r\n                                    Options:\r\n                                    {attribute.Options.map((option, j) => {\r\n                                      return (\r\n                                        <span key={j}>\r\n                                          {j === 0 ? \" \" : \", \"}\r\n                                          {option}\r\n                                        </span>\r\n                                      );\r\n                                    })}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    }\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"Type\" ? (\r\n                                  <span>\r\n                                    <Button\r\n                                      variant=\"contained\"\r\n                                      color=\"primary\"\r\n                                      onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                    >\r\n                                      <ListItemText primary={definedType.Name}/>\r\n                                    </Button>\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" && this.props.things.filter(t=> def.DefaultValue === t._id).length > 0 &&\r\n                                      ` (Default: ${this.props.things.filter(t=>t._id === def.DefaultValue)[0].Name})`\r\n                                    }\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"List\" ? (\r\n                                  <span>\r\n                                    List:&nbsp;\r\n                                    {attribute.ListType === \"Options\" ? (\r\n                                      <span>\r\n                                        Options:\r\n                                        {attribute.Options.map((option, j) => {\r\n                                          return (\r\n                                            <span key={j}>\r\n                                              {j === 0 ? \" \" : \", \"}\r\n                                              {option}\r\n                                            </span>\r\n                                          );\r\n                                        })}\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {defaultValue}\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    ) : attribute.ListType === \"Type\" ? (\r\n                                      <span>\r\n                                        <Button\r\n                                          variant=\"contained\"\r\n                                          color=\"primary\"\r\n                                          onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                        >\r\n                                          <ListItemText primary={definedType.Name}/>\r\n                                        </Button>\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 && this.props.things.filter(t=> def.DefaultListValues.includes(t._id)).length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              let defaultThing = this.props.things.filter(t=>t._id === defaultValue);\r\n                                              if (defaultThing.length === 0)\r\n                                                return (<span key={j}></span>);\r\n                                              else {\r\n                                                defaultThing = defaultThing[0];\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    <Button\r\n                                                      variant=\"contained\"\r\n                                                      color=\"primary\"\r\n                                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${defaultValue}`})}}\r\n                                                    >\r\n                                                      <ListItemText primary={defaultThing.Name}/>\r\n                                                    </Button>\r\n                                                  </span>\r\n                                                );\r\n                                              }\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    ) : (\r\n                                      <span>\r\n                                        {attribute.ListType}\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {defaultValue}\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    )}\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"True/False\" ? (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" ?\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    : \" (Default: False)\"}\r\n                                  </span>\r\n                                ) : (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    }\r\n                                  </span>\r\n                                )}\r\n                              </ListItemText>\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                      { this.props.selectedType !== null &&\r\n                        this.props.selectedType !== undefined && \r\n                          this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                            let definedType = this.props.types.filter(t=>t._id === attribute.DefinedType);\r\n                            definedType = definedType.length === 0 ? {Name:\"\"} : definedType[0];\r\n                            const def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                            return (\r\n                              <ListItem key={i}>\r\n                                <ListItemText>\r\n                                  {attribute.Name}:&nbsp;\r\n                                  {attribute.AttributeType === \"Options\" ? (\r\n                                    <span>\r\n                                      Options:\r\n                                      {attribute.Options.map((option, j) => {\r\n                                        return (\r\n                                          <span key={j}>\r\n                                            {j === 0 ? \" \" : \", \"}\r\n                                            {option}\r\n                                          </span>\r\n                                        );\r\n                                      })}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      }\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"Type\" ? (\r\n                                    <span>\r\n                                      <Button\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                        onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                      >\r\n                                        <ListItemText primary={definedType.Name}/>\r\n                                      </Button>\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" && this.props.things.filter(t=> def.DefaultValue === t._id).length > 0 &&\r\n                                        ` (Default: ${this.props.things.filter(t=>t._id === def.DefaultValue)[0].Name})`\r\n                                      }\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"List\" ? (\r\n                                    <span>\r\n                                      List:&nbsp;\r\n                                      {attribute.ListType === \"Options\" ? (\r\n                                        <span>\r\n                                          Options:\r\n                                          {attribute.Options.map((option, j) => {\r\n                                            return (\r\n                                              <span key={j}>\r\n                                                {j === 0 ? \" \" : \", \"}\r\n                                                {option}\r\n                                              </span>\r\n                                            );\r\n                                          })}\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    {defaultValue}\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      ) : attribute.ListType === \"Type\" ? (\r\n                                        <span>\r\n                                          <Button\r\n                                            variant=\"contained\"\r\n                                            color=\"primary\"\r\n                                            onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                          >\r\n                                            <ListItemText primary={definedType.Name}/>\r\n                                          </Button>\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 && this.props.things.filter(t=> def.DefaultListValues.includes(t._id)).length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                let defaultThing = this.props.things.filter(t=>t._id === defaultValue);\r\n                                                if (defaultThing.length === 0)\r\n                                                  return (<span key={j}></span>);\r\n                                                else {\r\n                                                  defaultThing = defaultThing[0];\r\n                                                  return (\r\n                                                    <span key={j}>\r\n                                                      {j === 0 ? \" \" : \", \"}\r\n                                                      <Button\r\n                                                        variant=\"contained\"\r\n                                                        color=\"primary\"\r\n                                                        onClick={ _ => {this.setState({redirectTo:`/thing/details/${defaultValue}`})}}\r\n                                                      >\r\n                                                        <ListItemText primary={defaultThing.Name}/>\r\n                                                      </Button>\r\n                                                    </span>\r\n                                                  );\r\n                                                }\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      ) : (\r\n                                        <span>\r\n                                          {attribute.ListType}\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    {defaultValue}\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      )}\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"True/False\" ? (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" ?\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      : \" (Default: False)\"}\r\n                                    </span>\r\n                                  ) : (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      }\r\n                                    </span>\r\n                                  )}\r\n                                </ListItemText>\r\n                              </ListItem>\r\n                            );\r\n                          })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n                  {this.props.selectedType.Supers.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Super Types\"} />\r\n                        </ListItem>\r\n                        {this.props.selectedType.Supers.map((superType, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${superType._id}`})}}\r\n                              >\r\n                                <ListItemText primary={superType.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.subTypes.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Sub Types\"} />\r\n                        </ListItem>\r\n                        {this.props.subTypes.map((sub, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${sub._id}`})}}\r\n                              >\r\n                                <ListItemText primary={sub.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {references.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.instances.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Instances\"} />\r\n                        </ListItem>\r\n                        {this.props.instances.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-type-modal\"\r\n                aria-describedby=\"delete-type-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.props.selectedType.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport {Delete} from \"@material-ui/icons\";\r\nimport {Fab, Tooltip} from \"@material-ui/core\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ChipInput from \"material-ui-chip-input\";\r\n\r\nconst handleTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"AttributeType\"] = e.target.value;\r\n  attr[\"ListType\"] = \"Text\";\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleDefinedTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    // function respond(newType) {\r\n    //   attr[\"DefinedType\"] = newType._id;\r\n    //   props.onChange(attr);\r\n    // }\r\n    // props.onNewType(respond);\r\n    props.onNewType(attr);\r\n  }\r\n  else \r\n    props.onChange(attr);\r\n};\r\n\r\nconst handleListTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"ListType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleOptionsChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.Options = e;\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [name, changeName] = useState(props.attribute.Name);\r\n\r\n  const attributeTypes = [\r\n    \"Text\",\r\n    \"Number\",\r\n    \"True/False\",\r\n    \"Options\", \r\n    \"Type\", \r\n    \"List\"\r\n  ];\r\n  const listTypes = [\r\n    \"Text\",\r\n    \"Options\", \r\n    \"Type\"\r\n  ];\r\n\r\n  const selectedType =\r\n    props.attribute.AttributeType === undefined || props.attribute.AttributeType === null || props.attribute.AttributeType === \"\" ? attributeTypes[0] : props.attribute.AttributeType;\r\n\r\n  const selectedListType =\r\n    props.attribute.ListType === undefined || props.attribute.ListType === \"\" ? listTypes[0] : props.attribute.ListType;\r\n\r\n  const selectedDefinedType =\r\n    props.attribute.DefinedType === undefined || props.attribute.DefinedType === \"\" ? \"\" : props.attribute.DefinedType;\r\n\r\n  let fromTypes = props.attribute.FromTypeIDs === undefined ? [] : props.types.filter(t=> props.attribute.FromTypeIDs.includes(t._id));\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}>Name</InputLabel>\r\n          <OutlinedInput\r\n            disabled={props.disabled}\r\n            id={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            name={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={name}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = props.attribute;\r\n              attr.Name = name;\r\n              // const attr = {\r\n              //   index: props.attribute.index,\r\n              //   Name: name,\r\n              //   Type: props.attribute.AttributeType,\r\n              //   Options: props.attribute.Options,\r\n              //   ListType: props.attribute.ListType,\r\n              //   FromSupers: props.attribute.FromSupers,\r\n              //   DefinedType: props.attribute.DefinedType,\r\n              //   AttributeTypes: props.attribute.AttributeTypes,\r\n              //   DefaultValue: defaultValue,\r\n              //   DefaultListValues: defaultListValues\r\n              // };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n            Attribute Type\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"attribute-type-label\"\r\n            id=\"attribute-type\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0} \r\n            value={selectedType}\r\n            onChange={e => {handleTypeChange(e, props)}}\r\n            fullWidth\r\n            labelWidth={100}\r\n          >\r\n            {attributeTypes.map((type, i) => {\r\n              return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        {selectedType === \"Options\" ? (\r\n          <ChipInput\r\n            variant=\"outlined\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0}\r\n            defaultValue={props.attribute.Options}\r\n            onChange={chips => handleOptionsChange(chips, props)}\r\n          />\r\n        ) : selectedType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n              Defined Type\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"definedType-label\"\r\n              id=\"definedType\"\r\n              disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0} \r\n              value={selectedDefinedType}\r\n              onChange={e => {handleDefinedTypeChange(e, props)}}\r\n              fullWidth\r\n              labelWidth={100}\r\n            >\r\n              <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n              {props.types.map((type, i) => {\r\n                return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : selectedType === \"List\" ? (\r\n          <Grid container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                  List Type\r\n                </InputLabel>\r\n                <Select\r\n                  labelId=\"list-type-label\"\r\n                  id=\"list-type\"\r\n                  disabled={props.disabled}\r\n                  // disabled={props.attribute.FromSupers.length > 0} \r\n                  value={selectedListType}\r\n                  onChange={e => {handleListTypeChange(e, props)}}\r\n                  fullWidth\r\n                  labelWidth={70}\r\n                >\r\n                  {listTypes.map((type, i) => {\r\n                    return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                  })}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            { props.attribute.ListType === \"Type\" ? \r\n              (\r\n                <Grid item>\r\n                  <FormControl variant=\"outlined\" fullWidth>\r\n                    <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                      Defined Type\r\n                    </InputLabel>\r\n                    <Select\r\n                      labelId=\"definedType-label\"\r\n                      id=\"definedType\"\r\n                      disabled={props.disabled}\r\n                      // disabled={props.attribute.FromSupers.length > 0} \r\n                      value={selectedDefinedType}\r\n                      onChange={e => {handleDefinedTypeChange(e, props)}}\r\n                      fullWidth\r\n                      labelWidth={100}\r\n                    >\r\n                      <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                      {props.types.map((type, i) => {\r\n                        return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                      })}\r\n                    </Select>\r\n                  </FormControl>\r\n                </Grid>\r\n              ) : props.attribute.ListType === \"Options\" ?\r\n              (\r\n                <Grid item>\r\n                  <ChipInput\r\n                    variant=\"outlined\"\r\n                    disabled={props.disabled}\r\n                    // disabled={props.attribute.FromSupers.length > 0}\r\n                    defaultValue={props.attribute.Options}\r\n                    onChange={chips => handleOptionsChange(chips, props)}\r\n                  />\r\n                </Grid>\r\n              ) : \"\"\r\n            }\r\n          </Grid>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item xs={3}>\r\n        { fromTypes.length === 1 ? \r\n          `From Type: ${fromTypes[0].Name}`\r\n        : fromTypes.length > 1 ?\r\n          <span>\r\n            From Types: \r\n            { fromTypes.map((type, i) => {\r\n              return (<span key={i}>{i > 0 && \", \"}{type.Name}</span>)\r\n            })}\r\n          </span>\r\n        : \r\n          <Tooltip title={`Delete Attribute`}>\r\n            <Fab size=\"small\"\r\n              color=\"primary\"\r\n              // disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0}\r\n              onClick={_ => props.onDelete(props.attribute)}\r\n            >\r\n              <Delete />\r\n            </Fab>\r\n          </Tooltip>\r\n        }\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = e;\r\n  props.onChange(def);\r\n};\r\nconst handleDefinedTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  if (e.target.value === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   // attr[\"DefinedType\"] = newType._id;\r\n    //   // props.onChange(attr);\r\n    //   const def = props.def;\r\n    //   def.DefaultValue = newThing._id;\r\n    //   props.onChange(def);\r\n    //   respond(newThing._id);\r\n    // }\r\n    // const attr = props.attribute;\r\n    props.onNewThing(\r\n      // respond2,\r\n      attr,\r\n      // props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    attr[\"DefaultValue\"] = e.target.value;\r\n    props.onChange(attr);\r\n    // respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues.push(selectedItem.Name);\r\n  props.onChange(def);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o.Name);\r\n  });\r\n  props.onChange(def);\r\n};\r\nconst addThingOfType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   const def = props.def;\r\n    //   def.DefaultListValues.push(newThing._id);\r\n    //   props.onChange(def);\r\n    // }\r\n    // props.onNewThing(\r\n    //   respond2,\r\n      \r\n    // );\r\n    // function respond(newThing) {\r\n    //   const def = props.def;\r\n    //   def.DefaultListValues.push(newThing._id);\r\n    //   props.onChange(def);\r\n    // }\r\n    setTimeout(() => {\r\n      const attr = props.attribute;\r\n      // const thingType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n      props.onNewThing(attr);// , thingType);\r\n    }, 500);\r\n  } else {\r\n    const def = props.def;\r\n    def.DefaultListValues.push(selectedItem._id);\r\n    props.onChange(def);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o._id);\r\n  });\r\n  props.onChange(def);\r\n};\r\n\r\nexport default function AttributeDefaultControl(props) {\r\n  // I'm passing in attribute and def.\r\n  const [value, changeValue] = useState(props.def.DefaultValue);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n  \r\n  const selectedTypeValue = attributeType !== \"Type\" ? \"\" :\r\n    (props.def.DefaultValue === undefined || props.def.DefaultValue === \"\" ? \"\" : props.def.DefaultValue);\r\n  \r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.def.DefaultListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n    props.things\r\n      .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n      .forEach(t => {\r\n        listOptions.push({ Name: t.Name, _id: t._id });\r\n      });\r\n    listOptions\r\n      .filter(t => props.def.DefaultListValues.includes(t._id))\r\n      .forEach(t => {\r\n        listOptionValues.push(t);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item xs={12}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`attribute_name_${props.attribute.attrID}`}>{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id={`attribute_name_${props.attribute.attrID}`}\r\n              name={`attribute_name_${props.attribute.attrID}`}\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.def.DefaultValue===\"True\"} onChange={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(def);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={`${props.attribute.Name} Default True`}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={selectedTypeValue}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props);\r\n              }}\r\n              // onBlur={e => {\r\n              //   const def = props.def;\r\n              //   def.DefaultValue = value;\r\n              //   props.onChange(def);\r\n              // }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                variant=\"outlined\"\r\n                defaultValue={props.def.DefaultListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addThingOfType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport uuid from 'react-uuid';\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  addThing\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport AttributeDefaultControl from \"./AttributeDefaultControl\";\r\nimport API from \"../../smartAPI\";\r\n\r\n// It will let you add and remove attributes.\r\n// Each needs to have a unique name as part of validation.\r\n// Each also needs to have a valid type.\r\n// The type can be string, integer, double, enum, any Type\r\n// already defined for this world, or a list of any of the\r\n// other types.\r\n// In future versions I will add support for additional types:\r\n// Color, DateTime, Schedule.\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedType: state.app.selectedType,\r\n    // attributesArr: state.app.attributesArr,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    // updateAttributesArr: arr => dispatch(updateAttributesArr(arr)),\r\n    addType: type => dispatch(addType(type)),\r\n    addThing: thing => dispatch(addThing(thing))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      message: \"\",\r\n      waiting: false,\r\n      defaultsMode: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\"\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  changeDefault = value => {\r\n    const type = this.props.selectedType;\r\n    type.DefaultsHash[value.attrID] = {\r\n      attrID: value.attrID,\r\n      DefaultValue: value.DefaultValue,\r\n      DefaultListValues: value.DefaultListValues,\r\n      FromTypeIDs: value.FromTypeIDs\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  blurAttribute = e => {\r\n  }\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributes = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributes.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    let defaults = {...type.DefaultsHash};\r\n    if (defaults[value.attrID] !== undefined) {\r\n      delete defaults[value.attrID];\r\n    }\r\n    type.DefaultsHash = {};\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributes;\r\n      type.DefaultsHash = defaults;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  }\r\n\r\n  addNewType = (attribute) => {\r\n    this.props.addNewType(attribute);\r\n  }\r\n\r\n  addNewThing = (attribute) => {\r\n    this.props.addNewThing(attribute);\r\n  }\r\n\r\n  render() {\r\n    // I should move this somewhere else so it's not happening on every render.\r\n    const inheritedAttributes = [];\r\n    this.props.selectedType.SuperIDs.forEach(s => {\r\n      let superType = this.props.types.filter(t => t._id === s);\r\n      if (superType.length > 0) {\r\n        superType = superType[0];\r\n        superType.AttributesArr.forEach(attribute => {\r\n          let inheritedAttribute = inheritedAttributes.filter(a=>a.attrID === attribute.attrID);\r\n          if (inheritedAttribute.length === 0) {\r\n            attribute.FromTypeIDs = [superType._id];\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n          else {\r\n            inheritedAttribute = inheritedAttribute[0];\r\n            inheritedAttribute.FromTypeIDs.push(superType._id);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item>\r\n          <List>\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              inheritedAttributes.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.props.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        disabled={true}\r\n                        attribute={attribute}\r\n                        // onChange={this.changeAttribute}\r\n                        // onDelete={this.deleteAttribute}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                \r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.props.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        onChange={this.changeAttribute}\r\n                        onDelete={this.deleteAttribute}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n          </List>\r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText\r\n} from \"@material-ui/core\";\r\n  \r\n\r\nexport default function TextBox(props) {\r\n  const [value, changeValue] = useState(props.Value === undefined || props.Value === null ? \"\" : props.Value);\r\n  const displayName = props.displayName === undefined ? props.fieldName : props.displayName;\r\n  \r\n  return (\r\n    <FormControl variant=\"outlined\" fullWidth>\r\n      <InputLabel htmlFor={`text_field_${props.fieldName}`}>{displayName}</InputLabel>\r\n      { props.multiline !== undefined && props.multiline ?\r\n        <OutlinedInput\r\n          id={`text_field_${props.fieldName}`}\r\n          name={`text_field_${props.fieldName}`}\r\n          type=\"text\"\r\n          autoComplete=\"Off\"\r\n          multiline\r\n          error={props.message !== undefined && props.message !== \"\"}\r\n          value={value}\r\n          onChange={e => {\r\n            changeValue(e.target.value);\r\n          }}\r\n          onBlur={e => {\r\n            props.onBlur(value);\r\n          }}\r\n          labelWidth={props.labelWidth}\r\n          fullWidth\r\n        />\r\n      :\r\n        <OutlinedInput\r\n          id={`text_field_${props.fieldName}`}\r\n          name={`text_field_${props.fieldName}`}\r\n          type=\"text\"\r\n          autoComplete=\"Off\"\r\n          error={props.message !== undefined && props.message !== \"\"}\r\n          value={value}\r\n          onChange={e => {\r\n            changeValue(e.target.value);\r\n          }}\r\n          onBlur={e => {\r\n            props.onBlur(value);\r\n          }}\r\n          labelWidth={props.labelWidth}\r\n          fullWidth\r\n        />\r\n      }\r\n      <FormHelperText>\r\n        {props.message}\r\n      </FormHelperText>\r\n    </FormControl>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  // Modal,\r\n  Button,\r\n} from \"@material-ui/core\";\r\n\r\n// const getModalStyle = () => {\r\n//   const top = Math.round(window.innerHeight / 2) - 100;\r\n//   const left = Math.round(window.innerWidth / 2) - 200;\r\n\r\n//   return {\r\n//     top: `${top}%`,\r\n//     left: `${left}%`,\r\n//     transform: `translate(${left}px, ${top}px)`,\r\n//   };\r\n// };\r\n\r\nconst validate = (value, props, changeMessage) => {\r\n  const valid = props.types.filter((t) => t.Name === value).length === 0;\r\n  changeMessage(valid ? \"\" : \"This Type Name is already in use\");\r\n};\r\n\r\nconst saveNewType = (value, props, changeName, changeMessage, changeWaiting) => {\r\n  // if (props.onSave !== undefined && props.onSave !== null)\r\n  //   props.onSave();\r\n\r\n  const type = {\r\n    _id: null,\r\n    Name: value.trim(),\r\n    Description: \"\",\r\n    SuperIDs: [],\r\n    AttributesArr: [],\r\n    Attributes: [],\r\n    worldID: props.selectedWorldID,\r\n    Major: false,\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .createType(type)\r\n    .then((res) => {\r\n      if (res.typeID !== undefined) {\r\n        type._id = res.typeID;\r\n        type.Supers = [];\r\n        // Adds to redux\r\n        if (props.addType) props.addType(type);\r\n        // Calls respond back to Attribute to set the type\r\n\r\n        changeWaiting(false);\r\n        if (props.onSave) {\r\n          // setTimeout(() => {\r\n          changeName(\"\");\r\n          props.onSave(type);\r\n          // }, 500);\r\n        }\r\n        // this.state.modalSubmit(type);\r\n        // this.setState({\r\n        //   waiting: false,\r\n        //   typeModalOpen: false\r\n        // });\r\n      } else if (res.error !== undefined) {\r\n        // this.setState({\r\n        //   waiting: false,\r\n        //   message: res.error\r\n        // });\r\n        changeWaiting(false);\r\n        changeMessage(res.error);\r\n        props.logout();\r\n      }\r\n    })\r\n    .catch((err) => console.log(err));\r\n};\r\n\r\nexport default function NewTypeModal(props) {\r\n  const [name, changeName] = useState(\"\");\r\n  const [message, changeMessage] = useState(\"\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      <Grid item>Just give the new Type a name.</Grid>\r\n      <Grid item>(You can do the rest later.)</Grid>\r\n      <Grid item>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n          <OutlinedInput\r\n            id=\"name\"\r\n            name=\"Name\"\r\n            type=\"text\"\r\n            autoComplete=\"Off\"\r\n            error={message !== \"\"}\r\n            value={name}\r\n            onChange={(e) => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={(e) => {\r\n              validate(name, props, changeMessage);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={(e) => {\r\n              changeWaiting(true);\r\n              saveNewType(name, props, changeName, changeMessage, changeWaiting);\r\n            }}\r\n          >\r\n            {waiting ? \"Please Wait\" : \"Submit\"}\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={(e) => {\r\n              if (props.onCancel !== undefined && props.onCancel !== null)\r\n                props.onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  // Modal,\r\n  Button,\r\n} from \"@material-ui/core\";\r\n\r\n// const getModalStyle = () => {\r\n//   const top = Math.round(window.innerHeight / 2) - 100;\r\n//   const left = Math.round(window.innerWidth / 2) - 200;\r\n\r\n//   return {\r\n//     top: `${top}%`,\r\n//     left: `${left}%`,\r\n//     transform: `translate(${left}px, ${top}px)`,\r\n//   };\r\n// };\r\n\r\nconst validate = (value, props, changeMessage) => {\r\n  const valid = props.things.filter((t) => t.Name === value).length === 0;\r\n  changeMessage(valid ? \"\" : \"This Thing Name is already in use\");\r\n};\r\n\r\nconst saveNewThing = (value, props, changeName, changeMessage, changeWaiting) => {\r\n  // if (props.onSave !== undefined && props.onSave !== null)\r\n  //   props.onSave();\r\n\r\n  changeWaiting(true);\r\n  const thing = {\r\n    _id: null,\r\n    Name: value.trim(),\r\n    Description: \"\",\r\n    TypeIDs: props.newThingType === undefined ? [] : [props.newThingType._id],\r\n    // AttributesArr: this.props.selectedThing.AttributesArr,\r\n    Attributes: [],\r\n    worldID: props.selectedWorldID,\r\n    ReferenceIDs: []\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .createThing(thing)\r\n    .then((res) => {\r\n      if (res.thingID !== undefined) {\r\n        thing._id = res.thingID;\r\n        thing.Types = props.newThingType === undefined ? [] : [props.newThingType];\r\n        thing.AttributesArr = [];\r\n        // Adds to props \r\n        props.addThing(thing);\r\n        // Calls respond back to Attribute to set the thing\r\n        changeName(\"\");\r\n        changeWaiting(false);\r\n        props.onSave(thing);\r\n\r\n        // this.state.modalSubmit(thing);\r\n        // this.setState({\r\n        //   waiting: false, \r\n        //   thingModalOpen: false,\r\n        //   Name: \"\"\r\n        // });\r\n      }\r\n      else if (res.error !== undefined) {\r\n        // this.setState({\r\n        //   waiting: false, \r\n        //   message: res.error \r\n        // });\r\n        changeMessage(res.error);\r\n        changeWaiting(false);\r\n        props.logout();\r\n      }\r\n    })\r\n    .catch(err => console.log(err));\r\n};\r\n\r\nexport default function NewThingModal(props) {\r\n  const [name, changeName] = useState(\"\");\r\n  const [message, changeMessage] = useState(\"\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      <Grid item>Just give the new {props.newThingType.Name === undefined ? \"Thing\" : props.newThingType.Name} a name.</Grid>\r\n      <Grid item>(You can do the rest later.)</Grid>\r\n      <Grid item>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n          <OutlinedInput\r\n            id=\"name\"\r\n            name=\"Name\"\r\n            type=\"text\"\r\n            autoComplete=\"Off\"\r\n            error={message !== \"\"}\r\n            value={name}\r\n            onChange={(e) => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={(e) => {\r\n              validate(name, props, changeMessage);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={(e) => {\r\n              changeWaiting(true);\r\n              saveNewThing(name, props, changeName, changeMessage, changeWaiting);\r\n            }}\r\n          >\r\n            {waiting ? \"Please Wait\" : \"Submit\"}\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={(e) => {\r\n              if (props.onCancel !== undefined && props.onCancel !== null)\r\n                props.onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport uuid from 'react-uuid';\r\nimport { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport { \r\n  Grid, Button, Checkbox, FormControl, FormControlLabel,\r\n  InputLabel, Tooltip, Fab,\r\n  Select, MenuItem,\r\n  ListItem, ListItemText\r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport AttributesControl from \"./AttributesControl\";\r\n// import AttributeControl from \"./AttributeControl\";\r\n// import AttributeDefaultControl from \"./AttributeDefaultControl\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  addAttributes,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin,\r\n  addThing,\r\n  toggleLogin,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\nimport NewTypeModal from \"../../components/Modals/NewTypeModal\";\r\nimport NewThingModal from \"../../components/Modals/NewThingModal\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: state.app.selectedType,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addAttributes: attrs => dispatch(addAttributes(attrs)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      // Name: \"\",\r\n      // Description: \"\",\r\n      // Supers: [],\r\n      // Attributes: [],\r\n      Major: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: \"\",\r\n      resetting: false,\r\n      browseAttributes: false,\r\n      browseAttributesSelected: \"\",\r\n      browseTypesSelected: \"\",\r\n      newThingType: {}\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        this.setState({\r\n          resetting: false, \r\n          redirectTo: `/type/create`});\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  // handleUserInput = e => {\r\n  //   const name = e.target.name;\r\n  //   const value =\r\n  //     e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n  //   this.setState({ [name]: value });\r\n  // };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.props.selectedType[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          const attrByName = this.props.attributesByName[value[i].Name];\r\n          if (attrByName !== undefined && \r\n            attrByName._id !== value[i].attrID) {\r\n            valid = false;\r\n            message = `An attribute with the name '${value[i].Name}' already exists`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      case \"Attributes\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          const attrByName = this.props.attributesByName[value[i].Name];\r\n          if (attrByName !== undefined && \r\n            attrByName._id !== value[i].attrID) {\r\n            valid = false;\r\n            message = `An attribute with this name already exists`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  }\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrArrValid = this.validateField(\"AttributesArr\");\r\n    // const attrValid = this.validateField(\"Attributes\");\r\n    const formValid = nameValid.valid && attrArrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.AttributesArr = attrArrValid;\r\n    // fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  }\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true, addMore: addMore }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  }\r\n\r\n  submitThroughAPI = () => {\r\n    const superIDs = this.props.selectedType.Supers.map(s => {\r\n      return s._id;\r\n    });\r\n\r\n    const attributes = this.props.selectedType.AttributesArr.map(a => {\r\n      return {\r\n        _id: a.attrID,\r\n        Name: a.Name.trim(),\r\n        AttributeType: a.AttributeType,\r\n        Options: a.Options,\r\n        DefinedType: a.DefinedType,\r\n        ListType: a.ListType\r\n      };\r\n    });\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      const typeAttributes = [];\r\n      this.props.selectedType.AttributesArr.forEach(a => {\r\n        const id = a.attrID.includes(\"null\") ? res.attributes[a.Name] : a.attrID;\r\n        typeAttributes.push({\r\n          attrID: id,\r\n          index: a.index,\r\n          // Name: a.Name,\r\n          // AttributeType: a.AttributeType,\r\n          // Options: a.Options,\r\n          // DefinedType: a.DefinedType,\r\n          // ListType: a.ListType\r\n        });\r\n      });\r\n\r\n      const type = {\r\n        _id: this.state._id,\r\n        Name: this.props.selectedType.Name.trim(),\r\n        PluralName: this.props.selectedType.PluralName === undefined ? \"\" : this.props.selectedType.PluralName.trim(),\r\n        Description: this.props.selectedType.Description,\r\n        SuperIDs: superIDs,\r\n        // AttributesArr: this.props.selectedType.AttributesArr,\r\n        Attributes: typeAttributes,\r\n        Defaults: [],\r\n        worldID: this.props.selectedWorld._id,\r\n        Major: this.props.selectedType.Major,\r\n        ReferenceIDs: [],\r\n        DefaultReferenceIDs: []\r\n      };\r\n      // this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n      //   if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n      //     type.ReferenceIDs.push(a.DefinedType);\r\n      //   }\r\n      // });\r\n      this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n        if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n          type.ReferenceIDs.push(a.DefinedType);\r\n        }\r\n      });\r\n      this.props.selectedType.Supers.forEach(s=> {\r\n        s.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n          if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n            type.ReferenceIDs.push(a.DefinedType);\r\n          }\r\n        });\r\n      });\r\n      Object.keys(this.props.selectedType.DefaultsHash).forEach(attrID => {\r\n        // There's the situation which can happen here where a default thing gets deleted (not removed as default).\r\n        // I really should filter it out, but it's not hurting anything for now, so I'm going to leave it.\r\n        const def = this.props.selectedType.DefaultsHash[attrID];\r\n        type.Defaults.push({\r\n          attrID, \r\n          FromTypeID: def.FromTypeID, \r\n          DefaultValue: def.DefaultValue, \r\n          DefaultListValues: def.DefaultListValues \r\n        });\r\n      });\r\n  \r\n      if (type._id === null) {\r\n        this.api\r\n          .createType(type)\r\n          .then(res => {\r\n            if (res.typeID !== undefined) {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n\r\n                if (this.state.addMore === \"add\") {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    PluralName: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    // Name: \"\",\r\n                    // Description: \"\",\r\n                    // Supers: [],\r\n                    // Attributes: [],\r\n                    // Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true\r\n                  }, this.resetForm);\r\n                } else if (this.state.addMore === \"next\") {\r\n                  this.redirectToNext();\r\n                } else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            else if (res.error !== undefined) {\r\n              this.setState({\r\n                waiting: false, \r\n                message: res.error \r\n              }, () => {\r\n                this.props.logout();\r\n              });\r\n            }\r\n          })\r\n          .catch(err => console.log(err));\r\n      } else {\r\n        this.api\r\n          .updateType(type)\r\n          .then(res => {\r\n            if (res.error === undefined) {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n\r\n                if (this.state.addMore === \"add\") {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    PluralName: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    // Name: \"\",\r\n                    // Description: \"\",\r\n                    // Supers: [],\r\n                    // Attributes: [],\r\n                    // Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true\r\n                  }, this.resetForm);\r\n                } else if (this.state.addMore === \"next\") {\r\n                  this.redirectToNext();\r\n                } else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            else {\r\n              this.setState({\r\n                waiting: false, \r\n                message: res.error \r\n              }, () => {\r\n                this.props.logout();\r\n              });\r\n            }\r\n          })\r\n          .catch(err => console.log(err));\r\n      }\r\n    });\r\n  }\r\n\r\n  supersChange = (e, value) => {\r\n    let supers = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      supers.push(t);\r\n      supers = supers.concat(t.Supers);\r\n    }\r\n    const type = this.props.selectedType;\r\n    type.Supers = supers;\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: supers });\r\n  }\r\n\r\n  addSuper = (selectedList, selectedItem) => {\r\n    const type = this.props.selectedType;\r\n    type.SuperIDs.push(selectedItem._id);\r\n    selectedItem.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    // We need to go through all the attributes on type, \r\n    // and make sure that none of them are also on a super type\r\n    let duplicateAttributes = [];\r\n    selectedList.forEach(t => {\r\n      duplicateAttributes = duplicateAttributes.concat(type.AttributesArr.filter(a => a.TypeIDs.includes(t._id)));\r\n    });\r\n    type.AttributesArr = type.AttributesArr.filter(a => duplicateAttributes.filter(d => d.attrID === a.attrID).length === 0);\r\n    \r\n    type.Supers = selectedList;\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: selectedList });\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\",\r\n      TypeIDs: []\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  addSelectedAttribute = () => {\r\n    const attr = this.props.attributesByID[this.state.browseAttributesSelected];\r\n    \r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: attr._id,\r\n      Name: attr.Name,\r\n      AttributeType: attr.AttributeType,\r\n      Options: attr.Options,\r\n      DefinedType: attr.DefinedType,\r\n      ListType: attr.ListType,\r\n      TypeIDs: attr.TypeIDs\r\n    });\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ \r\n      browseAttributesSelected: \"\",\r\n      browseTypesSelected: \"\" \r\n    });\r\n  }\r\n\r\n  addBrowsedType = (typeID) => {\r\n    const type = this.props.selectedType;\r\n    let attrType = this.props.types.filter(t => t._id === typeID)[0];\r\n    \r\n    type.SuperIDs.push(attrType._id);\r\n    const selectedList = type.Supers;\r\n    selectedList.push(attrType);\r\n\r\n    attrType.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    // We need to go through all the attributes on type, \r\n    // and make sure that none of them are also on a super type\r\n    let duplicateAttributes = [];\r\n    selectedList.forEach(t => {\r\n      duplicateAttributes = duplicateAttributes.concat(type.AttributesArr.filter(a => a.TypeIDs.includes(t._id)));\r\n    });\r\n    type.AttributesArr = type.AttributesArr.filter(a => duplicateAttributes.filter(d => d.attrID === a.attrID).length === 0);\r\n    \r\n    type.Supers = [];\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: [] });\r\n    setTimeout(() => {\r\n      type.Supers = selectedList;\r\n      this.props.updateSelectedType(type);\r\n      this.setState({ \r\n        browseAttributesSelected: \"\", \r\n        browseTypesSelected: \"\", \r\n        // Supers: selectedList \r\n      });\r\n    }, 500);\r\n  }\r\n  \r\n  removeSuper = (selectedList, removedItem) => {\r\n    let supers = [];\r\n    let superIDs = [];\r\n    let removeUs = [removedItem._id];\r\n    const type = this.props.selectedType;\r\n    for (let i = 0; i < type.Supers.length; i++) {\r\n      const checkMe = this.props.types.filter(\r\n        t => t._id === type.Supers[i]._id\r\n      )[0];\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else {\r\n        supers.push(checkMe);\r\n        superIDs.push(checkMe._id);\r\n      }\r\n    }\r\n    type.Supers = []; // supers;\r\n    type.SuperIDs = []; // superIDs;\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ \r\n      // Supers: supers, \r\n      loaded: false \r\n    });\r\n    setTimeout(() => {\r\n      type.Supers = supers;\r\n      type.SuperIDs =  superIDs;\r\n      this.props.updateSelectedType(type);\r\n      this.setState({ loaded: true });\r\n    }, 500);\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next type\r\n    let index = 0;\r\n    while (this.props.types[index]._id !== this.props.selectedType._id)\r\n      index++;\r\n    index++;\r\n    if (index === this.props.types.length)\r\n      index = 0;\r\n    this.setState({ \r\n      waiting: false, \r\n      redirectTo: `/type/edit/${this.props.types[index]._id}` \r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false,\r\n        message: \"Loading...\"\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n      this.setState({\r\n        _id: id,\r\n        loaded: true,\r\n        message: \"\"\r\n      });\r\n    }\r\n    else {\r\n      this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n        if (id !== null) {\r\n          let type = res.types.filter(t => t._id === id);\r\n          if (type.length > 0) {\r\n            type = type[0];\r\n\r\n            const supers = this.props.types.filter(t =>\r\n              type.SuperIDs.includes(t._id)\r\n            );\r\n            type.Supers = supers;\r\n            this.props.updateSelectedType(type);\r\n            this.setState({\r\n              // Name: type.Name,\r\n              // Description: type.Description,\r\n              _id: id,\r\n              // Supers: supers,\r\n              // Major: type.Major,\r\n              loaded: true,\r\n              message: \"\"\r\n            });\r\n          }\r\n          else {\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n              if (id !== null) {\r\n                let type = res2.types.filter(t => t._id === id);\r\n                if (type.length > 0) {\r\n                  type = type[0];\r\n      \r\n                  const supers = this.props.types.filter(t =>\r\n                    type.SuperIDs.includes(t._id)\r\n                  );\r\n                  type.Supers = supers;\r\n                  this.props.updateSelectedType(type);\r\n                  this.setState({\r\n                    // Name: type.Name,\r\n                    // Description: type.Description,\r\n                    _id: id,\r\n                    // Supers: supers,\r\n                    // Major: type.Major,\r\n                    loaded: true,\r\n                    message: \"\"\r\n                  });\r\n                }\r\n                else {\r\n                  // I had it get here with an ID from Cosmere, when I was supposed to be looking at a Type from Ozzie.\r\n                  // Need to figure out how it got the wrong ID.\r\n                  this.setState({ \r\n                    message: `Invalid ID: ${id}`, \r\n                    loaded: true \r\n                  });\r\n                }\r\n              } else {\r\n                this.props.updateSelectedType({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  PluralName: \"\",\r\n                  Description: \"\",\r\n                  Supers: [],\r\n                  SuperIDs: [],\r\n                  AttributesArr: [],\r\n                  Attributes: [],\r\n                  Major: false,\r\n                  DefaultsHash: {}\r\n                });\r\n                this.setState({ \r\n                  message: \"\", \r\n                  loaded: true \r\n                });\r\n              }\r\n            });\r\n          }\r\n        } else {\r\n          this.props.updateSelectedType({\r\n            _id: null,\r\n            Name: \"\",\r\n            PluralName: \"\",\r\n            Description: \"\",\r\n            Supers: [],\r\n            SuperIDs: [],\r\n            AttributesArr: [],\r\n            Attributes: [],\r\n            Major: false,\r\n            DefaultsHash: {}\r\n          });\r\n          this.setState({ \r\n            message: \"\",\r\n            loaded: true \r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  changeDefault = value => {\r\n    const type = this.props.selectedType;\r\n    type.DefaultsHash[value.attrID] = {\r\n      attrID: value.attrID,\r\n      DefaultValue: value.DefaultValue,\r\n      DefaultListValues: value.DefaultListValues,\r\n      FromTypeIDs: value.FromTypeIDs\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\"\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributes = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributes.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    let defaults = {...type.DefaultsHash};\r\n    if (defaults[value.attrID] !== undefined) {\r\n      delete defaults[value.attrID];\r\n    }\r\n    type.DefaultsHash = {};\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributes;\r\n      type.DefaultsHash = defaults;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  }\r\n\r\n  renderAttributes = () => {\r\n    return (\r\n      <AttributesControl \r\n        defaultsMode={this.state.defaultsMode} \r\n        addNewType={attribute => {\r\n          this.setState({ \r\n            typeModalOpen: true,\r\n            putTypeOnAttribute: attribute\r\n          });\r\n        }}\r\n        addNewThing={attribute => {\r\n          this.setState({ \r\n            thingModalOpen: true,\r\n            newThingType: this.props.types.filter(t => t._id === attribute.DefinedType)[0],\r\n            putThingOnAttribute: attribute\r\n          });\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    }\r\n    else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedType === null || this.props.selectedType._id !== id) {\r\n      return <span>{this.state.message}</span>;\r\n    } else if (this.state.typeModalOpen) {\r\n      return (\r\n        <NewTypeModal \r\n          types={this.props.types}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({\r\n              typeModalOpen: false\r\n            });\r\n          }}\r\n          addType={type => {\r\n            this.props.addType(type);\r\n          }}\r\n          onSave={newType => {\r\n            const type = this.props.selectedType;\r\n            const attr = type.AttributesArr.filter(a => a.attrID === this.state.putTypeOnAttribute.attrID)[0];\r\n            attr.DefinedType = newType._id;\r\n            this.props.updateSelectedType(type);\r\n            this.setState({\r\n              typeModalOpen: false\r\n            });\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else if (this.state.thingModalOpen) {\r\n      return (\r\n        <NewThingModal \r\n          things={this.props.things}\r\n          newThingType={this.state.newThingType}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            });\r\n          }}\r\n          addThing={thing => {\r\n            this.props.addThing(thing);\r\n          }}\r\n          onSave={thing => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            }, _ => {\r\n              // Need to put it on putThingOnAttribute\r\n              const type = this.props.selectedType;\r\n              const attr = type.AttributesArr.filter(a => a.attrID === this.state.putThingOnAttribute.attrID)[0];\r\n              let def = this.props.selectedType.DefaultsHash[attr.attrID];\r\n              if (def === undefined)\r\n                def = { attrID: attr.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n              if (attr.AttributeType === \"Type\") {\r\n                def.DefaultValue = thing._id;\r\n              }\r\n              else {\r\n                // The only way it can be here is if it's List and ListType is Type\r\n                def.DefaultListValues.push(thing._id);\r\n              }\r\n              this.props.updateSelectedType(type);\r\n            });\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else {\r\n      const types =\r\n        this.props.types === undefined || this.state._id === null\r\n          ? this.props.types\r\n          : this.props.types.filter(type => type._id !== this.state._id);\r\n      let additionalAttributes = [];\r\n      let selectedAttributeTypes = [];\r\n      let selectedAttributeName = \"\";\r\n      if (this.state.browseAttributes) {\r\n        Object.keys(this.props.attributesByID).forEach(id => {\r\n          const attr = this.props.attributesByID[id];\r\n          if (!attr.TypeIDs.includes(this.props.selectedType._id) && \r\n            this.props.selectedType.AttributesArr.filter(a => a.attrID === attr._id).length === 0) { // This second condition will make newly added attributes not show up.\r\n            let found = false;\r\n            for (let i = 0; i < this.props.selectedType.Supers.length; i++) {\r\n              if (attr.TypeIDs.includes(this.props.selectedType.Supers[i]._id)) {\r\n                found = true;\r\n                break;\r\n              }\r\n            }\r\n            if (!found) {\r\n              additionalAttributes.push({\r\n                _id: attr._id,\r\n                Name: attr.Name\r\n              });\r\n            }\r\n          }\r\n        });\r\n\r\n        if (this.state.browseAttributesSelected !== \"\") {\r\n          selectedAttributeName = this.props.attributesByID[this.state.browseAttributesSelected].Name;\r\n          selectedAttributeTypes = this.props.types.filter(t => this.props.attributesByID[this.state.browseAttributesSelected].TypeIDs.includes(t._id));\r\n        }\r\n      }\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={7} sm={9}>\r\n                  <h2>{this.state._id === null ? \"Create New Type\" : \"Edit Type\"}</h2>\r\n                </Grid>\r\n                <Grid item xs={4} sm={2}>\r\n                  <ListItem>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      onClick={_ => {\r\n                        this.redirectToNext();\r\n                      }}\r\n                    >\r\n                      <ListItemText primary=\"Next Type\"/>\r\n                    </Button>\r\n                  </ListItem>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedType.Name} \r\n                    fieldName=\"Name\" \r\n                    message={this.state.fieldValidation.Name.message}\r\n                    onBlur={name => {\r\n                      const type = this.props.selectedType;\r\n                      type.Name = name;\r\n                      this.props.updateSelectedType(type);\r\n                      this.validateForm();\r\n                      // this.setState({ Name: name }, \r\n                      //   this.validateForm);\r\n                    }}\r\n                    labelWidth={43}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedType.PluralName} \r\n                    fieldName=\"PluralName\" \r\n                    displayName=\"Plural Name\" \r\n                    onBlur={name => {\r\n                      const type = this.props.selectedType;\r\n                      type.PluralName = name;\r\n                      this.props.updateSelectedType(type);\r\n                      this.validateForm();\r\n                      // this.setState({ Name: name }, \r\n                      //   this.validateForm);\r\n                    }}\r\n                    labelWidth={85}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedType.Description} \r\n                    fieldName=\"Description\" \r\n                    multiline={true}\r\n                    onBlur={desc => {\r\n                      const type = this.props.selectedType;\r\n                      type.Description = desc;\r\n                      this.props.updateSelectedType(type);\r\n                    }}\r\n                    labelWidth={82}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Checkbox\r\n                      checked={this.props.selectedType.Major}\r\n                      onChange={ e => {\r\n                        const value = e.target.checked;\r\n                        const type = this.props.selectedType;\r\n                        type.Major = value;\r\n                        this.props.updateSelectedType(type);\r\n                        // this.setState({ [name]: value });\r\n                        // this.handleUserInput(e);\r\n                      }}\r\n                      name=\"Major\"\r\n                      color=\"primary\"\r\n                    />\r\n                  }\r\n                  label=\"Major Type\"\r\n                />\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.resetting ? \"\" :\r\n                  <Multiselect\r\n                    placeholder=\"Super Types\"\r\n                    options={types}\r\n                    selectedValues={this.props.selectedType.Supers}\r\n                    onSelect={this.addSuper}\r\n                    onRemove={this.removeSuper}\r\n                    displayValue=\"Name\"\r\n                  />\r\n                }\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <span>Attributes&nbsp;\r\n                    <Tooltip \r\n                      title={`Add New Attribute`}>\r\n                      <span>\r\n                        <Fab size=\"small\"\r\n                          color=\"primary\"\r\n                          disabled={this.state.defaultsMode}\r\n                          onClick={ _ => { this.newAttribute()}}\r\n                        >\r\n                          <Add />\r\n                        </Fab>\r\n                      </span>\r\n                    </Tooltip>\r\n                    <Tooltip \r\n                      title={`Browse Additional Attributes`}>\r\n                      <span>\r\n                        <Fab\r\n                          size=\"small\"\r\n                          color=\"primary\" \r\n                          disabled={this.state.defaultsMode}\r\n                          onClick={e => {\r\n                            this.setState({ browseAttributes: !this.state.browseAttributes });\r\n                          }}\r\n                        >\r\n                          <Search />\r\n                        </Fab>\r\n                      </span>\r\n                    </Tooltip>\r\n                  </span>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button variant=\"contained\" color=\"primary\" onClick={e => { this.setState({defaultsMode: !this.state.defaultsMode}) }}>\r\n                    { this.state.defaultsMode ? \"Set Attribute Types\" : \"Set Defaults\"}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n              { this.state.browseAttributes && \r\n                <Grid item container spacing={1} direction=\"row\">\r\n                  <Grid item xs={12} sm={6}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"browseForAttributes\" id=\"browseForAttributes-label\">\r\n                        Browse Attributes\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"browseForAttributes-label\"\r\n                        id=\"browseForAttributes\"\r\n                        value={this.state.browseAttributesSelected}\r\n                        onChange={e => {\r\n                          this.setState({ browseAttributesSelected: e.target.value });\r\n                        }}\r\n                        fullWidth\r\n                        labelWidth={130}\r\n                      >\r\n                        {\r\n                          additionalAttributes.map((attr, i) => {\r\n                            return (\r\n                              <MenuItem key={i} value={attr._id}>\r\n                                {attr.Name}\r\n                              </MenuItem>\r\n                            );\r\n                          })\r\n                        }\r\n                      </Select>\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item xs={12} sm={6}>\r\n                    <Button\r\n                      variant=\"contained\" color=\"primary\"\r\n                      disabled={ this.state.browseAttributesSelected === \"\" }\r\n                      onClick={e => {this.addSelectedAttribute();}}\r\n                      type=\"submit\"\r\n                    >\r\n                      Add Attribute\r\n                    </Button>\r\n                  </Grid>\r\n                  { selectedAttributeTypes.length === 1 ?\r\n                    <Grid style={{color: \"red\"}} item xs={12} container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12}>\r\n                        This Attribute is also found on the Type '{selectedAttributeTypes[0].Name}'.  You may want to add '{selectedAttributeTypes[0].Name}' as a Super Type instead of adding the Attribute.\r\n                      </Grid>                      \r\n                      <Grid item xs={12} sm={6}>\r\n                        <Button\r\n                          variant=\"contained\" color=\"primary\"\r\n                          onClick={e => {this.addBrowsedType(selectedAttributeTypes[0]._id);}}\r\n                          type=\"submit\"\r\n                        >\r\n                          Add {selectedAttributeTypes[0].Name}\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  : selectedAttributeTypes.length > 1 &&\r\n                    <Grid style={{color: \"red\"}} item xs={12} container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12}>\r\n                        This Attribute is also found on other Types.  You may want to add one as a Super Type instead of adding the Attribute.\r\n                      </Grid>                      \r\n                      <Grid item xs={12} sm={6}>\r\n                        <FormControl variant=\"outlined\" fullWidth>\r\n                          <InputLabel htmlFor=\"browseTypesWithAttribute\" id=\"browseTypesWithAttribute-label\">\r\n                            Browse Types with {selectedAttributeName}\r\n                          </InputLabel>\r\n                          <Select\r\n                            labelId=\"browseTypesWithAttribute-label\"\r\n                            id=\"browseTypesWithAttribute\"\r\n                            value={this.state.browseTypesSelected}\r\n                            onChange={e => {\r\n                              this.setState({ browseTypesSelected: e.target.value });\r\n                            }}\r\n                            fullWidth\r\n                            labelWidth={140 + selectedAttributeName.length * 9}\r\n                          >\r\n                            { selectedAttributeTypes.map((type, i) => {\r\n                              return (\r\n                                <MenuItem key={i} value={type._id}>\r\n                                  {type.Name}\r\n                                </MenuItem>\r\n                              );\r\n                            })}\r\n                          </Select>\r\n                        </FormControl>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <Button\r\n                          variant=\"contained\" color=\"primary\"\r\n                          disabled={ this.state.browseTypesSelected === \"\" }\r\n                          onClick={e => {this.addBrowsedType(this.state.browseTypesSelected);}}\r\n                          type=\"submit\"\r\n                        >\r\n                          Add Type\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  }\r\n                </Grid>\r\n              }\r\n              <Grid item>\r\n                { this.state.loaded &&\r\n                  this.renderAttributes()\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                  if (\r\n                    this.state.fieldValidation[fieldName] !== undefined &&\r\n                    this.state.fieldValidation[fieldName].message.length > 0\r\n                  ) {\r\n                    return (\r\n                      <p className=\"redFont\" key={i}>\r\n                        {this.state.fieldValidation[fieldName].message}\r\n                      </p>\r\n                    );\r\n                  } else {\r\n                    return \"\";\r\n                  }\r\n                })}\r\n              </Grid>\r\n              <Grid item>\r\n                <div className=\"float-right\">\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(\"next\")}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Edit Next\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(\"add\")}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    className=\"w-200\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(\"\")}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={_ => {\r\n                      if (this.props.selectedType._id === null) {\r\n                        this.setState({\r\n                          redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                        });\r\n                      }\r\n                      else {\r\n                        this.setState({\r\n                          redirectTo: `/type/details/${this.props.selectedType._id}`\r\n                        });\r\n                      }\r\n                    }}\r\n                    type=\"button\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </Grid>\r\n              <Grid item style={{color:\"red\"}}>{this.state.message}</Grid>\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeEditPage;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n// import clsx from 'clsx';\r\nimport { lighten, makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport TableSortLabel from '@material-ui/core/TableSortLabel';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { \r\n  Button, ListItemText\r\n} from \"@material-ui/core\";\r\n\r\nlet rows = [];\r\n\r\nfunction descendingComparator(a, b, orderBy) {\r\n  if (b[orderBy] < a[orderBy]) {\r\n    return -1;\r\n  }\r\n  if (b[orderBy] > a[orderBy]) {\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getComparator(order, orderBy) {\r\n  return order === 'desc'\r\n    ? (a, b) => descendingComparator(a, b, orderBy)\r\n    : (a, b) => -descendingComparator(a, b, orderBy);\r\n}\r\n\r\nfunction stableSort(array, comparator) {\r\n  const stabilizedThis = array.map((el, index) => [el, index]);\r\n  stabilizedThis.sort((a, b) => {\r\n    const order = comparator(a[0], b[0]);\r\n    if (order !== 0) return order;\r\n    return a[1] - b[1];\r\n  });\r\n  return stabilizedThis.map((el) => el[0]);\r\n}\r\n\r\nfunction ThingTableHead(props) {\r\n  const { classes, order, orderBy, onRequestSort, columnMap } = props;\r\n  const createSortHandler = (property) => (event) => {\r\n    onRequestSort(event, property);\r\n  };\r\n\r\n  return (\r\n    <TableHead>\r\n      <TableRow>\r\n        {columnMap.map((headCell) => (\r\n          <TableCell\r\n            key={headCell.id}\r\n            align={headCell.numeric ? 'right' : 'left'}\r\n            padding={headCell.disablePadding ? 'none' : 'default'}\r\n            sortDirection={orderBy === headCell.id ? order : false}\r\n          >\r\n            <TableSortLabel\r\n              active={orderBy === headCell.id}\r\n              direction={orderBy === headCell.id ? order : 'asc'}\r\n              onClick={createSortHandler(headCell.id)}\r\n            >\r\n              {headCell.label}\r\n              {orderBy === headCell.id ? (\r\n                <span className={classes.visuallyHidden}>\r\n                  {order === 'desc' ? 'sorted descending' : 'sorted ascending'}\r\n                </span>\r\n              ) : null}\r\n            </TableSortLabel>\r\n          </TableCell>\r\n        ))}\r\n      </TableRow>\r\n    </TableHead>\r\n  );\r\n}\r\n\r\nThingTableHead.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  numSelected: PropTypes.number.isRequired,\r\n  onRequestSort: PropTypes.func.isRequired,\r\n  onSelectAllClick: PropTypes.func.isRequired,\r\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\r\n  orderBy: PropTypes.string.isRequired,\r\n  rowCount: PropTypes.number.isRequired,\r\n  columnMap: PropTypes.array.isRequired\r\n};\r\n\r\nconst useToolbarStyles = makeStyles((theme) => ({\r\n  root: {\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(1),\r\n  },\r\n  highlight:\r\n    theme.palette.type === 'light'\r\n      ? {\r\n          color: theme.palette.secondary.main,\r\n          backgroundColor: lighten(theme.palette.secondary.light, 0.85),\r\n        }\r\n      : {\r\n          color: theme.palette.text.primary,\r\n          backgroundColor: theme.palette.secondary.dark,\r\n        },\r\n  title: {\r\n    flex: '1 1 100%',\r\n  },\r\n}));\r\n\r\nconst ThingTableToolbar = (props) => {\r\n  const classes = useToolbarStyles();\r\n  const { label } = props;\r\n\r\n  return (\r\n    <Toolbar>\r\n      <Typography className={classes.title} variant=\"h6\" id=\"tableTitle\" component=\"div\">\r\n        {label}\r\n      </Typography>\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nThingTableToolbar.propTypes = {\r\n  // numSelected: PropTypes.number.isRequired,\r\n  label: PropTypes.string.isRequired\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '100%',\r\n  },\r\n  paper: {\r\n    width: '100%',\r\n    marginBottom: theme.spacing(2),\r\n  },\r\n  table: {\r\n    // minWidth: 750,\r\n  },\r\n  visuallyHidden: {\r\n    border: 0,\r\n    clip: 'rect(0 0 0 0)',\r\n    height: 1,\r\n    margin: -1,\r\n    overflow: 'hidden',\r\n    padding: 0,\r\n    position: 'absolute',\r\n    top: 20,\r\n    width: 1,\r\n  },\r\n}));\r\n\r\nexport default function ThingTable(props) {\r\n  const columnMap = [\r\n    { \r\n      id: 'Name', \r\n      numeric: false, \r\n      disablePadding: true, \r\n      label: 'Name' \r\n    },\r\n    { \r\n      id: 'Description', \r\n      numeric: false, \r\n      disablePadding: true, \r\n      label: 'Description' \r\n    }\r\n  ];\r\n  rows = [];\r\n  props.things.forEach(thing => {\r\n    const newRow = {\r\n      _id: thing._id,\r\n      Name: thing.Name,\r\n      Description: thing.Description\r\n    };\r\n    thing.Attributes.forEach(attr => {\r\n      const attribute = props.attributesByID[attr.attrID];\r\n      if (attribute.AttributeType === \"Type\") {\r\n        let attrThing = props.allThings.filter(t => t._id === attr.Value);\r\n        if (attrThing.length > 0) {\r\n          attrThing = attrThing[0];\r\n          newRow[attr.attrID] = attrThing.Name;\r\n        }\r\n      } else if (attribute.AttributeType === \"List\") {\r\n        newRow[attr.attrID] = \"\";\r\n        if (attribute.ListType === \"Type\") {\r\n          attr.ListValues.forEach(v => {\r\n            let attrThing = props.allThings.filter(t => t._id === v);\r\n            if (attrThing.length > 0) {\r\n              attrThing = attrThing[0];\r\n              newRow[attr.attrID] += (newRow[attr.attrID].length > 0 ? \", \" : \"\") + attrThing.Name;\r\n            }\r\n          });\r\n        }\r\n        else {\r\n          attr.ListValues.forEach(v => {\r\n            newRow[attr.attrID] += (newRow[attr.attrID].length > 0 ? \", \" : \"\") + v;\r\n          });\r\n        }\r\n      } else {\r\n        newRow[attr.attrID] = attr.Value;\r\n      }\r\n      if (columnMap.filter(c => c.id === attr.attrID).length === 0) {\r\n        columnMap.push({\r\n          id: attribute._id, \r\n          numeric: attribute.Type === \"Number\", \r\n          disablePadding: true, \r\n          label: attribute.Name\r\n        });\r\n      }\r\n    });\r\n    rows.push(newRow);\r\n  });\r\n\r\n  const classes = useStyles();\r\n  const [order, setOrder] = React.useState('asc');\r\n  const [orderBy, setOrderBy] = React.useState('Name');\r\n  const [selected, setSelected] = React.useState([]);\r\n  const [page, setPage] = React.useState(0);\r\n  // const [dense, setDense] = React.useState(false);\r\n  const dense = true;\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(5);\r\n\r\n  const handleRequestSort = (event, property) => {\r\n    const isAsc = orderBy === property && order === 'asc';\r\n    setOrder(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(property);\r\n  };\r\n\r\n  const handleSelectAllClick = (event) => {\r\n    if (event.target.checked) {\r\n      const newSelecteds = rows.map((n) => n.name);\r\n      setSelected(newSelecteds);\r\n      return;\r\n    }\r\n    setSelected([]);\r\n  };\r\n\r\n  // const handleClick = (event, name) => {\r\n  //   const selectedIndex = selected.indexOf(name);\r\n  //   let newSelected = [];\r\n\r\n  //   if (selectedIndex === -1) {\r\n  //     newSelected = newSelected.concat(selected, name);\r\n  //   } else if (selectedIndex === 0) {\r\n  //     newSelected = newSelected.concat(selected.slice(1));\r\n  //   } else if (selectedIndex === selected.length - 1) {\r\n  //     newSelected = newSelected.concat(selected.slice(0, -1));\r\n  //   } else if (selectedIndex > 0) {\r\n  //     newSelected = newSelected.concat(\r\n  //       selected.slice(0, selectedIndex),\r\n  //       selected.slice(selectedIndex + 1),\r\n  //     );\r\n  //   }\r\n\r\n  //   setSelected(newSelected);\r\n  // };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  // const handleChangeDense = (event) => {\r\n  //   setDense(event.target.checked);\r\n  // };\r\n\r\n  const isSelected = (name) => selected.indexOf(name) !== -1;\r\n\r\n  // const emptyRows = rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Paper className={classes.paper}>\r\n        <ThingTableToolbar label={props.label} />\r\n        <TableContainer>\r\n          <Table\r\n            className={classes.table}\r\n            aria-labelledby=\"tableTitle\"\r\n            size={dense ? 'small' : 'medium'}\r\n            aria-label=\"enhanced table\"\r\n          >\r\n            <ThingTableHead\r\n              classes={classes}\r\n              numSelected={selected.length}\r\n              order={order}\r\n              orderBy={orderBy}\r\n              onSelectAllClick={handleSelectAllClick}\r\n              onRequestSort={handleRequestSort}\r\n              rowCount={rows.length}\r\n              columnMap={columnMap}\r\n            />\r\n            <TableBody>\r\n              {stableSort(rows, getComparator(order, orderBy))\r\n                .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\r\n                .map((row, index) => {\r\n                  const isItemSelected = isSelected(row.name);\r\n                  \r\n                  return (\r\n                    <TableRow\r\n                      hover\r\n                      role=\"checkbox\"\r\n                      aria-checked={isItemSelected}\r\n                      tabIndex={-1}\r\n                      key={index}\r\n                      selected={isItemSelected}\r\n                    >\r\n                      {columnMap.map((column, key) => {\r\n                        return (\r\n                          <TableCell key={key}>\r\n                            {column.id === \"Name\" ?\r\n                              <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => { props.buttonClick(row._id)}}\r\n                              >\r\n                                <ListItemText primary={row.Name}/>\r\n                              </Button>\r\n                            :\r\n                              <span>{row[column.id]}</span>\r\n                            }\r\n                          </TableCell>\r\n                        );\r\n                      })}\r\n                    </TableRow>\r\n                  );\r\n                })}\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n        { rows.length > 5 &&\r\n          <TablePagination\r\n            rowsPerPageOptions={[5, 10, 25]}\r\n            component=\"div\"\r\n            count={rows.length}\r\n            rowsPerPage={rowsPerPage}\r\n            page={page}\r\n            onChangePage={handleChangePage}\r\n            onChangeRowsPerPage={handleChangeRowsPerPage}\r\n          />\r\n        }\r\n      </Paper>\r\n      {/* <FormControlLabel\r\n        control={<Switch checked={dense} onChange={handleChangeDense} />}\r\n        label=\"Dense padding\"\r\n      /> */}\r\n    </div>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { ArrowBack, Edit, Delete } from \"@material-ui/icons\";\r\nimport { \r\n  Fab, Tooltip, Modal, Grid, Button, \r\n  List, ListItem, ListItemText\r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport ThingTable from \"../../components/Displays/ThingTable\";\r\n\r\nconst mapStateToProps = state => {\r\n  const thing = state.app.selectedThing;\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: thing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      AttributesArr: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false,\r\n      majorType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.setState({ waiting: true }, this.finishDelete);\r\n  }\r\n\r\n  finishDelete = e => {\r\n    this.api.deleteThing(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n\r\n          this.setState({ waiting: false, redirectTo: `/world/details/${this.props.selectedWorldID}`});\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error }, () => {\r\n          this.props.logout();\r\n        });\r\n      }\r\n      // const things = this.props.things.filter(t=>t._id!==this.state._id);\r\n      // this.props.setThings(things);\r\n      // this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next thing\r\n    const things = this.state.majorType === null ? this.props.things : this.props.things.filter(t => t.TypeIDs.includes(this.state.majorType._id));\r\n    let index = 0;\r\n    while (things[index]._id !== this.props.selectedThing._id)\r\n      index++;\r\n    index++;\r\n    if (index === things.length)\r\n      index = 0;\r\n    this.setState({ \r\n      waiting: false, \r\n      redirectTo: `/thing/edit/${things[index]._id}` \r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    const id = this.state._id;\r\n    this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n      \r\n      if (id !== undefined) {\r\n        let thing = res.things.filter(t => t._id === id);\r\n        if (thing.length === 0) {\r\n          this.setState({ message: \"Invalid Thing ID\" });\r\n        }\r\n        else {\r\n          thing = thing[0];\r\n          thing.AttributesArr = [];\r\n          thing.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            thing.AttributesArr.push({\r\n              index: thing.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              Value: a.Value,\r\n              ListValues: a.ListValues,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          });\r\n          if (this.state.majorType === null) {\r\n            let majorType = thing.Types.filter(t=>t.Major);\r\n            if (majorType.length > 0) {\r\n              majorType = majorType[0];\r\n              \r\n              this.setState({\r\n                Name: thing.Name,\r\n                Description: thing.Description,\r\n                _id: id,\r\n                Types: thing.Types,\r\n                majorType\r\n              });\r\n            }\r\n            else {\r\n              this.setState({\r\n                Name: thing.Name,\r\n                Description: thing.Description,\r\n                _id: id,\r\n                Types: thing.Types\r\n              });\r\n            }\r\n          }\r\n          else {\r\n            this.setState({\r\n              Name: thing.Name,\r\n              Description: thing.Description,\r\n              _id: id,\r\n              Types: thing.Types\r\n            });\r\n          }\r\n        }\r\n        this.props.updateSelectedThing(thing);\r\n      } else {\r\n        this.props.updateSelectedThing({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Types: [],\r\n          Attributes: [],\r\n          AttributesArr: []\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const references = this.props.things.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={8}>\r\n                  <h2>{this.state.Name}</h2>\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/edit/${this.state._id}`})}}\r\n                          >\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { this.state.majorType === null ?\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary=\"Next\" />\r\n                      </Button>\r\n                    :\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary={`Next ${this.state.majorType.Name}`}/>\r\n                      </Button>\r\n                    }\r\n                  </List> \r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n                  <Grid item>{this.state.Description}</Grid>\r\n                  <Grid item>\r\n                    Attributes\r\n                    <List>\r\n                      { this.props.selectedThing !== null && this.props.selectedThing !== undefined &&\r\n                        this.props.selectedThing.AttributesArr.map(\r\n                          (attribute, i) => {\r\n                            return (\r\n                              <ListItem key={i}>\r\n                                <ListItemText>\r\n                                  { attribute.AttributeType === \"Type\" && attribute.Value !== \"\" ?\r\n                                    <ThingTable \r\n                                      attributesByID={this.props.attributesByID} \r\n                                      label={attribute.Name} \r\n                                      things={this.props.things.filter(t=>t._id === attribute.Value)} \r\n                                      allThings={this.props.things}\r\n                                    />\r\n                                  : attribute.AttributeType === \"List\" && attribute.ListType === \"Type\" ?\r\n                                    <ThingTable \r\n                                      attributesByID={this.props.attributesByID} \r\n                                      label={attribute.Name} \r\n                                      things={this.props.things.filter(t=>attribute.ListValues.includes(t._id))} \r\n                                      allThings={this.props.things}\r\n                                      buttonClick={thingID => {\r\n                                        this.setState({redirectTo:`/thing/details/${thingID}`});\r\n                                      }}\r\n                                    />\r\n                                  : attribute.AttributeType === \"List\" ?\r\n                                    attribute.ListValues.map(\r\n                                      (listValue, i) => {\r\n                                        return(\r\n                                          <span key={i}>\r\n                                            { \r\n                                              i > 0 ? `, ${listValue}` : `${listValue}`\r\n                                            }\r\n                                          </span>\r\n                                        );\r\n                                      })\r\n                                  : \r\n                                    <span>{attribute.Name}:&nbsp;{attribute.Value}</span>\r\n                                  }\r\n                                </ListItemText>\r\n                              </ListItem>\r\n                            );\r\n                          }\r\n                        )\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n                  { this.state.Types.length > 0 && \r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Types\"} />\r\n                        </ListItem>\r\n                        {this.state.Types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  }\r\n                  { references.length > 0 &&\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  }\r\n                </Grid>\r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-thing-modal\"\r\n                aria-describedby=\"delete-thing-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.state.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = e;\r\n  props.onChange(attr);\r\n};\r\nconst handleDefinedTypeChange = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   // attr[\"DefinedType\"] = newType._id;\r\n    //   // props.onChange(attr);\r\n    //   respond(newThing._id);\r\n    // }\r\n    // props.onNewThing(\r\n    //   // respond2,\r\n    //   props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    // );\r\n    const attr = props.attribute;\r\n    props.onNewThing(attr);\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues.push(selectedItem.Name);\r\n  props.onChange(attr);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o.Name);\r\n  });\r\n  props.onChange(attr);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   const attr = props.attribute;\r\n    //   attr.ListValues.push(newThing._id);\r\n    //   props.onChange(attr);\r\n    // }\r\n    \r\n    setTimeout(() => {\r\n      const attr = props.attribute;\r\n      props.onNewThing(attr);\r\n    }, 500);\r\n    // props.onNewThing(\r\n    //   // respond2,\r\n    //   // props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    //   props.attribute\r\n    // );\r\n  } else {\r\n    const attr = props.attribute;\r\n    attr.ListValues.push(selectedItem._id);\r\n    props.onChange(attr);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o._id);\r\n  });\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [value, changeValue] = useState(props.attribute.Value);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n\r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.attribute.ListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    if (definedType !== undefined) {\r\n      listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n      props.things\r\n        .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n        .forEach(t => {\r\n          listOptions.push({ Name: t.Name, _id: t._id });\r\n        });\r\n      listOptions\r\n        .filter(t => props.attribute.ListValues.includes(t._id))\r\n        .forEach(t => {\r\n          listOptionValues.push(t);\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Grid item container spacing={1} direction=\"row\">\r\n      <Grid item xs={11}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`attribute_name_${props.attribute.attrID}`}>{props.attribute.Name}</InputLabel>\r\n            <OutlinedInput\r\n              id={`attribute_name_${props.attribute.attrID}`}\r\n              name={`attribute_name_${props.attribute.attrID}`}\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name}</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.attribute.Value===\"True\"} onChange={e => {\r\n                const attr = props.attribute;\r\n                attr.Value = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(attr);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={props.attribute.Name}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name}\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name}\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props, changeValue);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={props.attribute.Name}\r\n                variant=\"outlined\"\r\n                defaultValue={props.attribute.ListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={props.attribute.Name}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={props.attribute.Name}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item xs={1}>\r\n        <InfoIcon\r\n          style={{ cursor: \"pointer\" }}\r\n          onClick={ _ => {\r\n            props.infoModal(props.attribute);\r\n          }} \r\n        />\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  Grid, Modal, FormControl, InputLabel, \r\n  OutlinedInput, FormHelperText, Button,\r\n  // List,\r\n  // ListItem,\r\n} from \"@material-ui/core\";\r\nimport { \r\n  updateSelectedThing, addThing, logout\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedThing: state.app.selectedThing,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n      infoModalOpen: false,\r\n      // infoAttribute: null,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.push({\r\n      index: thing.AttributesArr.length,\r\n      _id: null,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"Text\",\r\n      FromTypes: [],\r\n      Value: \"\",\r\n      ListValues: [],\r\n      FromTypeIDs: [],\r\n      TypeIDs: []\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    const attribute = thing.AttributesArr.filter(a=>a.attrID === value.attrID)[0];\r\n    attribute.Value = value.Value;\r\n    attribute.ListValues = value.ListValues;\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.splice(value.index);\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  optionsChange = (e, props) => {\r\n  }\r\n\r\n  // addNewThing = (respond, type) => {\r\n  //   // Opens a Modal where they enter a name.\r\n  //   this.setState({modalOpen: true, modalSubmit: respond, newThingType: type});\r\n  // }\r\n\r\n  addNewThing = (attribute) => {\r\n    this.props.addNewThing(attribute);\r\n  }\r\n\r\n  infoModal = (attribute) => {\r\n    this.props.onInfo(attribute);\r\n  }\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 100;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          thing.AttributesArr = [];\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            modalOpen: false\r\n          });\r\n        }\r\n        else if (res.error !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.error \r\n          }, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={1} direction=\"column\">\r\n        {this.props.selectedThing !== null && this.props.selectedThing !== undefined &&\r\n          this.props.selectedThing.AttributesArr.map((attribute, i) => {\r\n            return (\r\n              <AttributeControl\r\n                key={i}\r\n                thingID={this.props.selectedThing._id}\r\n                attribute={attribute}\r\n                onChange={this.changeAttribute}\r\n                onDelete={this.deleteAttribute}\r\n                onBlur={this.blurAttribute}\r\n                things={this.props.things}\r\n                types={this.props.types}\r\n                onNewThing={this.addNewThing}\r\n                infoModal={this.infoModal}\r\n              />\r\n            );\r\n          })\r\n        }\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.modalOpen}\r\n          onClose={e => {this.setState({modalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({modalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  updateType,\r\n  addType,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport { \r\n  Button, FormControl, \r\n  OutlinedInput, InputLabel, \r\n  FormHelperText, Grid, \r\n  Fab, Tooltip,\r\n  List, ListItem, ListItemText,\r\n  Select, MenuItem,\r\n  // Modal\r\n} from \"@material-ui/core\";\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\nimport NewTypeModal from \"../../components/Modals/NewTypeModal\";\r\nimport NewThingModal from \"../../components/Modals/NewThingModal\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Thing.  It will allow the use of Types to make\r\n  it faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: state.app.selectedThing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      // Name: \"\",\r\n      // Description: \"\",\r\n      // Types: [],\r\n      // AttributesArr: [],\r\n      // Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        // AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" },\r\n        infoAttributeName: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: \"\",\r\n      resetting: false,\r\n      loaded: true,\r\n      errors: [],\r\n      infoAttribute: null,\r\n      typeModalOpen: false,\r\n      newTypeForAttribute: \"\",\r\n      browseAttributes: false,\r\n      browseAttributesFilter: \"\",\r\n      browseAttributesSelected: \"\",\r\n      thingModalOpen: false,\r\n      newThingType: null,\r\n      putThingOnAttribute: null,\r\n      majorType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  createThingFromType = type => {\r\n    let types = [];\r\n    types.push(type);\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n          types.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      Attributes: []\r\n    };\r\n    let newAttributes = [];\r\n    types.forEach(type=> {\r\n      for (let i = 0; i < type.Attributes.length; i++) {\r\n        const attribute = {...type.Attributes[i]};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      }\r\n    });\r\n    types.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      thing.AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    thing.Types = types;\r\n    this.props.updateSelectedThing(thing);\r\n    this.setState({ \r\n      _id: null, \r\n      // Types: types, \r\n      loaded: true,\r\n      majorType: type\r\n    }); //, errors });\r\n  };\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined && !id.includes(\"type_id_\")) {\r\n        this.setState({\r\n          resetting: false, \r\n          redirectTo: `/thing/create`\r\n        });\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        }, this.finishResettingForm);\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  finishResettingForm = () => {\r\n    const { id } = this.props.match.params;\r\n    if (id !== undefined && id.includes(\"type_id_\")) {\r\n      // We're creating it from a type rather than from blank\r\n      const typeID = id.substring(8);\r\n      let type = this.props.types.filter(t=> t._id === typeID);\r\n      if (type.length > 0) {\r\n        type = type[0];\r\n        this.createThingFromType(type);\r\n      }\r\n      else {\r\n        this.setState({ message: \"Invalid Type\" });\r\n      }\r\n    }\r\n  }\r\n\r\n  // handleUserInput = e => {\r\n  //   const name = e.target.name;\r\n  //   const value =\r\n  //     e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n  //   this.setState({ [name]: value });\r\n  // };\r\n\r\n  handleInfoAttrNameChange = e => {\r\n    const infoAttribute = this.state.infoAttribute;\r\n    infoAttribute.Name = e.target.value;\r\n    this.setState({ infoAttribute });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      (fieldValidation[name].valid !== validation.valid ||\r\n        fieldValidation[name].message !== validation.message)\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  inputBlur2 = e => {\r\n    const name = \"infoAttributeName\";\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      (fieldValidation[name].valid !== validation.valid ||\r\n        fieldValidation[name].message !== validation.message)\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  addSelectedAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    const attr = this.props.attributesByID[this.state.browseAttributesSelected];\r\n    const attributes = thing.Attributes;\r\n    const AttributesArr = thing.AttributesArr;\r\n    attributes.push({\r\n      attrID: this.state.browseAttributesSelected,\r\n      Value: \"\",\r\n      ListValues: [],\r\n      index: attributes.length,\r\n      FromTypeIDs: []\r\n    });\r\n    AttributesArr.push({\r\n      attrID: this.state.browseAttributesSelected,\r\n      index: AttributesArr.length,\r\n      Value: \"\",\r\n      ListValues: [],\r\n      Name: attr.Name,\r\n      AttributeType: attr.AttributeType,\r\n      Options: attr.Options,\r\n      DefinedType: attr.DefinedType,\r\n      ListType: attr.ListType,\r\n      FromTypeIDs: [],\r\n      TypeIDs: attr.TypeIDs\r\n    });\r\n    thing.Attributes = [];\r\n    thing.AttributesArr = [];\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n      this.setState({ browseAttributesSelected: \"\" });\r\n    }, 500);\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.props.selectedThing[fieldName].trim();\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      case \"infoAttributeName\":\r\n        value = this.state.infoAttribute.Name.trim();\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Attribute Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Attribute Name is too short\";\r\n        } else {\r\n          const attrByName = this.props.attributesByName[value];\r\n          valid = attrByName === undefined || attrByName._id === this.state.infoAttribute.attrID;\r\n          if (!valid) message = \"There is another Attribute with this name.\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedThing[fieldName];\r\n        value.forEach(a => {\r\n          if (valid && value.filter(attr2 => attr2.Name === a.Name).length > 1) {\r\n            valid = false;\r\n          }\r\n        });\r\n        message = valid ? \"\" : \"Attribute Names must be unique\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrValid = this.validateField(\"AttributesArr\");\r\n    const formValid = nameValid.valid && attrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  validateAttrForm = respond => {\r\n    const nameValid = this.validateField(\"infoAttributeName\");\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.infoAttributeName = nameValid;\r\n    this.setState(\r\n      {\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ \r\n          waiting: true, \r\n          addMore: addMore \r\n        }, \r\n        this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const typeIDs = this.props.selectedThing.Types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.props.selectedThing.Name.trim(),\r\n      Description: this.props.selectedThing.Description.trim(),\r\n      TypeIDs: typeIDs,\r\n      // AttributesArr: this.props.selectedThing.AttributesArr,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorld._id,\r\n      ReferenceIDs: []\r\n    };\r\n    this.props.selectedThing.AttributesArr.forEach(a => {\r\n      thing.Attributes.push({\r\n        attrID: a.attrID,\r\n        index: a.index,\r\n        Value: a.Value.trim(),\r\n        ListValues: a.ListValues\r\n      });\r\n      if (a.AttributeType === \"Type\") {\r\n        if (!thing.ReferenceIDs.includes(a.Value)) {\r\n          thing.ReferenceIDs.push(a.Value);\r\n        }\r\n      }\r\n      if (a.AttributeType === \"List\" && a.ListType === \"Type\") {\r\n        a.ListValues.forEach(v=> {\r\n          if (!thing.ReferenceIDs.includes(v)) {\r\n            thing.ReferenceIDs.push(v);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    if (thing._id === null) {\r\n      this.api\r\n        .createThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined){\r\n            // thing._id = res.thingID;\r\n            // thing.Types = this.state.Types;\r\n            // thing.AttributesArr = this.props.selectedThing.AttributesArr;\r\n            // this.props.addThing(thing);\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n\r\n              if (this.state.addMore === \"add\") {\r\n                this.props.updateSelectedThing({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  Description: \"\",\r\n                  Types: [],\r\n                  Attributes: [],\r\n                  AttributesArr: []\r\n                });\r\n                this.setState({\r\n                  _id: null,\r\n                  // Name: \"\",\r\n                  // Description: \"\",\r\n                  // Types: [],\r\n                  // Attributes: [],\r\n                  fieldValidation: {\r\n                    Name: { valid: true, message: \"\" },\r\n                    Attributes: { valid: true, message: \"\" }\r\n                  },\r\n                  formValid: false,\r\n                  message: \"\",\r\n                  waiting: false,\r\n                  resetting: true\r\n                }, this.resetForm);\r\n              } else if (this.state.addMore === \"next\") {\r\n                this.redirectToNext();\r\n              } else {\r\n                this.setState({\r\n                  waiting: false,\r\n                  redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                });\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error}, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined) {\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n              \r\n              if (this.state.addMore === \"add\") {\r\n                this.props.updateSelectedThing({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  Description: \"\",\r\n                  Types: [],\r\n                  Attributes: [],\r\n                  AttributesArr: []\r\n                });\r\n                this.setState({\r\n                  // Name: \"\",\r\n                  // Description: \"\",\r\n                  // Types: [],\r\n                  // Attributes: [],\r\n                  fieldValidation: {\r\n                    Name: { valid: true, message: \"\" },\r\n                    Attributes: { valid: true, message: \"\" }\r\n                  },\r\n                  formValid: false,\r\n                  message: \"\",\r\n                  waiting: false,\r\n                  addMore: false,\r\n                  resetting: true\r\n                }, this.resetForm);\r\n              } else if (this.state.addMore === \"next\") {\r\n                this.redirectToNext();\r\n              } else {\r\n                this.setState({\r\n                  waiting: false,\r\n                  redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                });\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error}, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  typesChange = (e, value) => {\r\n    let types = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      types.push(t);\r\n      types = types.concat(t.Types);\r\n    }\r\n    const thing = this.props.selectedThing;\r\n    thing.Types = types;\r\n    this.props.updateSelectedThing(thing);\r\n    // this.setState({ Types: types });\r\n  };\r\n\r\n  addType = (selectedList, selectedItem) => {\r\n    const thing = this.props.selectedThing;\r\n    const newTypes = {};\r\n    newTypes[selectedItem._id] = selectedItem;\r\n    selectedItem.Supers.forEach(s=>{\r\n      if (selectedList.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && selectedList.filter(t=>t._id === superType[0]._id).length === 0){\r\n          selectedList.push(superType[0]);\r\n          newTypes[superType[0]._id] = superType[0];\r\n        }\r\n      }\r\n      if (this.props.selectedThing.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes[s._id] = s;\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    Object.keys(newTypes).forEach(typeID => {\r\n      const type = newTypes[typeID];\r\n      type.Attributes.forEach(a => {\r\n        const attribute = {...a};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      });\r\n    });\r\n    Object.keys(newTypes).forEach(typeID => {\r\n      const type = newTypes[typeID];\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          if (attribute.Value === undefined) {\r\n            attribute.Value = \"\";\r\n            attribute.ListValues = [];\r\n          }\r\n          if (attribute.Value === \"\") {\r\n            attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          }\r\n          type.DefaultsHash[attribute.attrID].DefaultListValues.forEach(listValue => {\r\n            if (!attribute.ListValues.includes(listValue))\r\n              attribute.ListValues.push(listValue);\r\n          });\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    // this.setState({ Types: selectedList });\r\n    thing.Types = selectedList;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    const AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n    }, 500);\r\n  }\r\n\r\n  addType2 = (type) => {\r\n    const types = this.props.selectedThing.Types;\r\n    types.push(type);\r\n    // this.addType(types, type);\r\n\r\n    const newTypes = [type];\r\n    const thing = this.props.selectedThing;\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && types.filter(t=>t._id === superType[0]._id).length === 0){\r\n          types.push(superType[0]);\r\n          newTypes.push(superType[0]);\r\n        }\r\n      }\r\n      if (this.props.selectedThing.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes.push(s);\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    newTypes.forEach(type => {\r\n      type.Attributes.forEach(a => {\r\n        const attribute = {...a};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      });\r\n    });\r\n    newTypes.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    this.setState({ \r\n      // Types: types, \r\n      resetting: true \r\n    });\r\n    thing.Types = types;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    const AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n      this.setState({ resetting: false, infoAttribute: null });\r\n    }, 500);\r\n  }\r\n\r\n  selectNewTypeForAttribute = (e) => {\r\n    if (e.target.value === \"new\") {\r\n      function respond(newType) {\r\n        // attr[\"DefinedType\"] = newType._id;\r\n        this.setState({ newTypeForAttribute: newType._id });\r\n      }\r\n      this.setState({ typeModalOpen: true, modalSubmit: respond});\r\n    }\r\n    else \r\n      this.setState({ newTypeForAttribute: e.target.value });\r\n  }\r\n\r\n  saveInfoAttribute = () => {\r\n    function respond() {\r\n      if (this.state.fieldValidation.infoAttributeName.valid) {\r\n        this.setState({ \r\n          waiting: true\r\n        }, \r\n        this.submitAttributeThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateAttrForm(respond);\r\n  }\r\n\r\n  submitAttributeThroughAPI = () => {\r\n    // Need to upsert the attribute, and then move forward\r\n\r\n    const attributes = [{\r\n      _id: this.state.infoAttribute.attrID,\r\n      Name: this.state.infoAttribute.Name.trim(),\r\n      AttributeType: this.state.infoAttribute.AttributeType,\r\n      Options: this.state.infoAttribute.Options,\r\n      DefinedType: this.state.infoAttribute.DefinedType,\r\n      ListType: this.state.infoAttribute.ListType\r\n    }];\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      if (res.error === undefined) {\r\n        // res.attributes is a hash with the name as key and id as value\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n          \r\n          const attribute = this.state.infoAttribute;\r\n          if (this.state.newTypeForAttribute !== \"\") {\r\n            attribute.TypeIDs.push(this.state.newTypeForAttribute);\r\n            attribute.FromTypeIDs.push(this.state.newTypeForAttribute);\r\n          }\r\n          const thing = this.props.selectedThing;\r\n          if (attribute.attrID === null) {\r\n            attribute.attrID = res.attributes[attribute.Name];\r\n            // Add it to the Thing's attributes\r\n            const attr2 = {\r\n              attrID: attribute.attrID,\r\n              index: thing.Attributes.length,\r\n              Value: \"\",\r\n              ListValues: []\r\n            };\r\n            thing.Attributes.push(attr2);\r\n            thing.AttributesArr.push({\r\n              attrID: attribute.attrID,\r\n              index: attr2.index,\r\n              Value: \"\",\r\n              ListValues: [],\r\n              Name: attribute.Name,\r\n              AttributeType: attribute.AttributeType,\r\n              Options: attribute.Options,\r\n              DefinedType: attribute.DefinedType,\r\n              ListType: attribute.ListType,\r\n              FromTypeIDs: attribute.FromTypeIDs,\r\n              TypeIDs: attribute.TypeIDs\r\n            });\r\n          }\r\n          else {\r\n            // Update the attribute on the Thing\r\n            const attr2 = thing.AttributesArr.filter(a => a.attrID === attribute.attrID)[0];\r\n            attr2.Name = attribute.Name;\r\n            attr2.AttributeType = attribute.AttributeType;\r\n            attr2.Options = attribute.Options;\r\n            attr2.DefinedType = attribute.DefinedType;\r\n            attr2.ListType = attribute.ListType;\r\n            attr2.FromTypeIDs = attribute.FromTypeIDs;\r\n            attr2.TypeIDs = attribute.TypeIDs;\r\n          }\r\n          if (attribute.FromTypeIDs.length === 0) {\r\n            this.props.updateSelectedThing(thing);\r\n            this.setState({infoAttribute: null, waiting: false});\r\n          }\r\n          else {\r\n            // Need to add it to the type\r\n            const theType = this.props.types.filter(t => t._id === attribute.FromTypeIDs[0])[0];\r\n            const type = {\r\n              _id: theType._id,\r\n              Name: theType.Name,\r\n              Description: theType.Description,\r\n              SuperIDs: theType.SuperIDs,\r\n              // AttributesArr: this.props.selectedType.AttributesArr,\r\n              Attributes: theType.Attributes,\r\n              Defaults: theType.Defaults,\r\n              worldID: this.props.selectedWorld._id,\r\n              Major: theType.Major,\r\n              ReferenceIDs: theType.ReferenceIDs,\r\n              DefaultReferenceIDs: theType.DefaultReferenceIDs\r\n            };\r\n            type.Attributes.push({\r\n              attrID: attribute.attrID,\r\n              index: type.Attributes.length,\r\n              // Name: a.Name,\r\n              // AttributeType: a.AttributeType,\r\n              // Options: a.Options,\r\n              // DefinedType: a.DefinedType,\r\n              // ListType: a.ListType\r\n            });\r\n            this.api\r\n              .updateType(type)\r\n              .then(res => {\r\n                if (res.error === undefined) {\r\n                  type.Supers = [];\r\n                  type.SuperIDs.forEach(sID=> {\r\n                    type.Supers = type.Supers.concat(this.props.types.filter(t2=>t2._id === sID));\r\n                  });\r\n                  type.AttributesArr = [];\r\n                  type.Attributes.forEach(a => {\r\n                    const attr = this.props.attributesByID[a.attrID];\r\n                    type.AttributesArr.push({\r\n                      index: type.AttributesArr.length,\r\n                      Name: attr.Name,\r\n                      AttributeType: attr.AttributeType,\r\n                      Options: attr.Options,\r\n                      DefinedType: attr.DefinedType,\r\n                      ListType: attr.ListType,\r\n                      attrID: a.attrID\r\n                    });\r\n                  });\r\n                  const defHash = {};\r\n                  if (type.Defaults !== undefined) {\r\n                    type.Defaults.forEach(def => {\r\n                      defHash[def.attrID] = def;\r\n                    });\r\n                  }\r\n                  type.DefaultsHash = defHash;\r\n                  this.props.updateType(type);\r\n\r\n                  function respond() {\r\n                    this.addType2(type);\r\n                  }\r\n                  \r\n                  this.setState({\r\n                    infoAttribute: null, waiting: false\r\n                  }, respond);\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false, \r\n                    message: res.error \r\n                  }, () => {\r\n                    this.props.logout();\r\n                  });\r\n                }\r\n              })\r\n              .catch(err => console.log(err));\r\n          }\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ message: res.error, waiting: false }, () => {\r\n          this.props.logout();\r\n        });\r\n      }\r\n    });\r\n  }\r\n  \r\n  removeType = (selectedList, removedItem) => {\r\n    // TODO: Add a confirmation before doing this\r\n    // to let them know it will also remove sub-types.\r\n    let types = [];\r\n    let removeUs = [];\r\n    this.props.selectedThing.Types.forEach(checkMe => {\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else types.push(checkMe);\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.Attributes];\r\n    attributes.forEach(attribute => {\r\n      const newFromTypeIDs = [];\r\n      attribute.FromTypeIDs.forEach(typeID => {\r\n        if (!removeUs.includes(typeID))\r\n          newFromTypeIDs.push(typeID);\r\n      });\r\n      attribute.FromTypeIDs = newFromTypeIDs;\r\n    });\r\n    // this.setState({ Types: types });\r\n    thing.Types = types;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      thing.AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next thing\r\n    const things = this.state.majorType === null ? this.props.things : this.props.things.filter(t => t.TypeIDs.includes(this.state.majorType._id));\r\n    let index = 0;\r\n    if (this.props.selectedThing === undefined || this.props.selectedThing._id !== null) {\r\n      while (things[index]._id !== this.props.selectedThing._id)\r\n        index++;\r\n      index++;\r\n    }\r\n    if (index === things.length)\r\n      index = 0;\r\n    this.setState({ \r\n      waiting: false, \r\n      redirectTo: `/thing/edit/${things[index]._id}` \r\n    });\r\n  }\r\n\r\n  renderHeader() {\r\n    let typeStr = \"Thing\";\r\n    this.props.selectedThing.Types.forEach(t=>{\r\n      if (t.Major) { \r\n        if (typeStr === \"Thing\") {\r\n          typeStr = t.Name;\r\n        }\r\n        else {\r\n          typeStr += \"/\" + t.Name;\r\n        }\r\n      }\r\n    });\r\n    return <h2>{this.state._id === null ? `Create New ${typeStr}` : `Edit ${typeStr}`}</h2>;\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n      \r\n      if (this.props.fromLogin) {\r\n        this.props.notFromLogin();\r\n        this.setState({\r\n          // _id: id,\r\n          loaded: true,\r\n          message: \"\"\r\n        });\r\n      }\r\n      else {\r\n        if (this.state._id !== null) {\r\n          // We're editing an existing Thing\r\n          let thing = res.things.filter(t => t._id === this.state._id);\r\n          if (thing.length === 0) {\r\n            this.setState({ message: \"Invalid ID\" });\r\n          }\r\n          else {\r\n            thing = thing[0];\r\n            // const things = this.props.things.filter(\r\n            //   t => t._id !== thing._id\r\n            // );\r\n            let Types = [];\r\n            thing.TypeIDs.forEach(tID=> {\r\n              Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n            });\r\n            let newAttributes = [];\r\n            Types.forEach(type=> {\r\n              for (let i = 0; i < type.Attributes.length; i++) {\r\n                const attribute = {...type.Attributes[i]};\r\n                let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n                if (existing.length === 0) {\r\n                  attribute.FromTypeIDs = [type._id];\r\n                  attribute.index = thing.Attributes.length + newAttributes.length;\r\n                  newAttributes.push(attribute);\r\n                }\r\n                else {\r\n                  existing = existing[0];\r\n                  if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n                    existing.FromTypeIDs = [];\r\n                  existing.FromTypeIDs.push(type._id);\r\n                }\r\n              }\r\n            });\r\n            Types.forEach(type=> {\r\n              newAttributes.forEach(attribute => {\r\n                if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n                  attribute.Value = \"\";\r\n                  attribute.ListValues = [];\r\n                }\r\n                else {\r\n                  attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n                  attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n                }\r\n              })\r\n            });\r\n            let attributes = [...thing.Attributes, ...newAttributes];\r\n            thing.Attributes = attributes;\r\n            thing.AttributesArr = [];\r\n            thing.Attributes.forEach(a => {\r\n              const attr = this.props.attributesByID[a.attrID];\r\n              thing.AttributesArr.push({\r\n                index: thing.AttributesArr.length,\r\n                Name: attr.Name,\r\n                AttributeType: attr.AttributeType,\r\n                Options: attr.Options,\r\n                DefinedType: attr.DefinedType,\r\n                ListType: attr.ListType,\r\n                attrID: a.attrID,\r\n                Value: a.Value,\r\n                ListValues: a.ListValues,\r\n                FromTypeIDs: a.FromTypeIDs,\r\n                TypeIDs: attr.TypeIDs\r\n              });\r\n            });\r\n            thing.Types = Types;\r\n            this.props.updateSelectedThing(thing);\r\n            if (this.state.majorType === null) {\r\n              let majorType = thing.Types.filter(t=>t.Major);\r\n              if (majorType.length > 0) {\r\n                majorType = majorType[0];\r\n                \r\n                this.setState({\r\n                  loaded: true,\r\n                  majorType\r\n                });\r\n              }\r\n              else {\r\n                this.setState({\r\n                  loaded: true\r\n                });\r\n              }\r\n            }\r\n            else {\r\n              this.setState({\r\n                loaded: true\r\n              });\r\n            }\r\n          }\r\n        } else {\r\n          let { id } = this.props.match.params;\r\n          if (id !== undefined && id.includes(\"type_id_\")) {\r\n            // We're creating it from a type rather than from blank\r\n            const typeID = id.substring(8);\r\n            let type = this.props.types.filter(t=> t._id === typeID);\r\n            if (type.length > 0) {\r\n              type = type[0];\r\n              this.createThingFromType(type);\r\n            }\r\n            else {\r\n              this.setState({ message: \"Invalid Type\", loaded: true });\r\n            }\r\n          }\r\n          else {\r\n            // We're creating a new thing from blank.\r\n            this.props.updateSelectedThing({\r\n              _id: null,\r\n              Name: \"\",\r\n              Description: \"\",\r\n              Types: [],\r\n              Attributes: [],\r\n              AttributesArr: []\r\n            });\r\n            this.setState({ loaded: true });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined || id.includes(\"type_id_\"))\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedThing === null || this.props.selectedThing._id !== id) {\r\n      return <span>Loading...</span>;\r\n    } else if (this.state.typeModalOpen) {\r\n      return (\r\n        <NewTypeModal \r\n          types={this.props.types}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({typeModalOpen: false});\r\n          }}\r\n          addType={type => {\r\n            this.props.addType(type);\r\n          }}\r\n          onSave={type => {\r\n            this.setState({typeModalOpen: false, newTypeForAttribute: type._id});\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else if (this.state.infoAttribute !== null) {\r\n      const connectedTypes = this.props.types.filter(t=> this.state.infoAttribute.FromTypeIDs.includes(t._id));\r\n      const otherTypes = this.props.types.filter(t=> !this.state.infoAttribute.FromTypeIDs.includes(t._id) && this.state.infoAttribute.TypeIDs.includes(t._id));\r\n      if (connectedTypes.length === 0) {\r\n        if (otherTypes.length === 0) {\r\n          const attributeTypes = [\r\n            \"Text\",\r\n            \"Number\",\r\n            \"True/False\",\r\n            \"Options\", \r\n            \"Type\", \r\n            \"List\"\r\n          ];\r\n          const listTypes = [\r\n            \"Text\",\r\n            \"Options\", \r\n            \"Type\"\r\n          ];\r\n          // This attribute isn't on any types, so we need to give the ability to add it to a type, as well as to edit it.\r\n          return (\r\n            <Grid item xs={12} container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <List>\r\n                  <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"infoAttributeName\">Name</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"infoAttributeName\"\r\n                        name=\"infoAttributeName\"\r\n                        type=\"text\"\r\n                        autoComplete=\"Off\"\r\n                        error={!this.state.fieldValidation.infoAttributeName.valid}\r\n                        value={this.state.infoAttribute.Name}\r\n                        onChange={this.handleInfoAttrNameChange}\r\n                        onBlur={this.inputBlur2}\r\n                        labelWidth={43}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>\r\n                        {this.state.fieldValidation.infoAttributeName.message}\r\n                      </FormHelperText>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n                        Attribute Type\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"attribute-type-label\"\r\n                        id=\"attribute-type\"\r\n                        disabled={this.state.waiting}\r\n                        // disabled={props.attribute.FromSupers.length > 0} \r\n                        value={this.state.infoAttribute.AttributeType}\r\n                        onChange={e => {\r\n                          const attr = this.state.infoAttribute;\r\n                          attr[\"AttributeType\"] = e.target.value;\r\n                          this.setState({ infoAttribute: attr });\r\n                        }}\r\n                        fullWidth\r\n                        labelWidth={100}\r\n                      >\r\n                        {attributeTypes.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  { this.state.infoAttribute.AttributeType === \"List\" && \r\n                    <ListItem>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                          List Type\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"list-type-label\"\r\n                          id=\"list-type\"\r\n                          disabled={this.state.waiting}\r\n                          // disabled={props.attribute.FromSupers.length > 0} \r\n                          value={this.state.infoAttribute.ListType}\r\n                          onChange={e => {\r\n                            const attr = this.state.infoAttribute;\r\n                            attr[\"ListType\"] = e.target.value;\r\n                            this.setState({ infoAttribute: attr });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={70}\r\n                        >\r\n                          {listTypes.map((type, i) => {\r\n                            return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                    <ListItem>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                          Defined Type\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"definedType-label\"\r\n                          id=\"definedType\"\r\n                          disabled={this.state.waiting}\r\n                          // disabled={props.attribute.FromSupers.length > 0} \r\n                          value={this.state.infoAttribute.DefinedType}\r\n                          onChange={e => {\r\n                            const attr = this.state.infoAttribute;\r\n                            attr[\"DefinedType\"] = e.target.value;\r\n                            if (e.target.value === \"new\") {\r\n                              function respond(newType) {\r\n                                attr[\"DefinedType\"] = newType._id;\r\n                                this.setState({ typeModalOpen: false, infoAttribute: attr });\r\n                              }\r\n                              this.setState({ typeModalOpen: true, modalSubmit: respond});\r\n                            }\r\n                            else \r\n                              this.setState({ infoAttribute: attr });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={100}\r\n                        >\r\n                          <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                          {this.props.types.map((type, i) => {\r\n                            return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                    <ListItem>\r\n                      <ChipInput\r\n                        variant=\"outlined\"\r\n                        disabled={this.state.waiting}\r\n                        // disabled={props.attribute.FromSupers.length > 0}\r\n                        defaultValue={this.state.infoAttribute.Options}\r\n                        onChange={chips => {\r\n                          const attr = this.state.infoAttribute;\r\n                          attr[\"Options\"] = chips;\r\n                          this.setState({ infoAttribute: attr });\r\n                        }}\r\n                      />\r\n                    </ListItem>\r\n                  }\r\n                  <ListItem>\r\n                    Select a Type to add this attribute to, and to add to {this.props.selectedThing.Name}\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"newTypeForAttribute\" id=\"newTypeForAttribute-label\">\r\n                        Type For Attribute\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"newTypeForAttribute-label\"\r\n                        id=\"newTypeForAttribute\"\r\n                        value={this.state.newTypeForAttribute}\r\n                        onChange={e => {this.selectNewTypeForAttribute(e)}}\r\n                        fullWidth\r\n                        labelWidth={125}\r\n                      >\r\n                        <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                        {this.props.types.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                </List>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveInfoAttribute}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={_ => {this.setState({infoAttribute: null})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid item xs={12} container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <List>\r\n                  <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                  <ListItem>Name: {this.state.infoAttribute.Name}</ListItem>\r\n                  <ListItem>Type: {this.state.infoAttribute.AttributeType}</ListItem>\r\n                  { this.state.infoAttribute.AttributeType === \"List\" && \r\n                    <ListItem>List Type: {this.state.infoAttribute.ListType}</ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                    <ListItem>\r\n                      Defined Type: \r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={ _ => {this.setState({redirectTo:`/type/details/${this.state.infoAttribute.DefinedType}`})}}\r\n                      >\r\n                        {this.props.types.filter(t=>t._id === this.state.infoAttribute.DefinedType)[0].Name}\r\n                      </Button>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                    <ListItem>\r\n                      Options: \r\n                      {this.state.infoAttribute.Options.map((option, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            {j === 0 ? \" \" : \", \"}\r\n                            {option}\r\n                          </span>\r\n                        );\r\n                      })}\r\n                    </ListItem>\r\n                  }\r\n                  <ListItem>\r\n                    { otherTypes.length === 1 ? \"Type associated with this attribute:\" : \"Types associated with this attribute:\" }\r\n                    <List>\r\n                      { otherTypes.map((type, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                            >\r\n                              {type.Name}\r\n                            </Button>\r\n\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.addType2(type)}}\r\n                            >\r\n                              Add {type.Name} to {this.props.selectedThing.Name}\r\n                            </Button>\r\n                          </span>\r\n                        );\r\n                      })}\r\n                    </List>\r\n                  </ListItem>\r\n                </List>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  {/* <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button> */}\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({infoAttribute: null})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid item xs={12} container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <List>\r\n                <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                <ListItem>Name: {this.state.infoAttribute.Name}</ListItem>\r\n                <ListItem>Type: {this.state.infoAttribute.AttributeType}</ListItem>\r\n                { this.state.infoAttribute.AttributeType === \"List\" && \r\n                  <ListItem>List Type: {this.state.infoAttribute.ListType}</ListItem> \r\n                }\r\n                { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                  <ListItem>\r\n                    Defined Type: \r\n                    <Button\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/type/details/${this.state.infoAttribute.DefinedType}`})}}\r\n                    >\r\n                      {this.props.types.filter(t=>t._id === this.state.infoAttribute.DefinedType)[0].Name}\r\n                    </Button>\r\n                  </ListItem> \r\n                }\r\n                { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                  <ListItem>\r\n                    Options: \r\n                    {this.state.infoAttribute.Options.map((option, j) => {\r\n                      return (\r\n                        <span key={j}>\r\n                          {j === 0 ? \" \" : \", \"}\r\n                          {option}\r\n                        </span>\r\n                      );\r\n                    })}\r\n                  </ListItem>\r\n                }\r\n                { connectedTypes.length > 0 &&\r\n                  <ListItem>\r\n                    { connectedTypes.length === 1 ? \"From Type:\" : \"From Types:\" }\r\n                    {\r\n                      connectedTypes.map((type, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            {j === 0 ? \" \" : \", \"}\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                            >\r\n                              {type.Name}\r\n                            </Button>\r\n                          </span>\r\n                        );\r\n                      })\r\n                    }\r\n                  </ListItem>\r\n                }\r\n                { otherTypes.length > 0 &&\r\n                  <ListItem>\r\n                    { otherTypes.length === 1 ? \"Other Associated Type:\" : \"Other Associated Types:\" }\r\n                    { otherTypes.map((type, j) => {\r\n                      return (\r\n                        <span key={j}>\r\n                          {j === 0 ? \" \" : \", \"}\r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                          >\r\n                            {type.Name}\r\n                          </Button>\r\n                        </span>\r\n                      );\r\n                    })}\r\n                  </ListItem>\r\n                }\r\n              </List>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button\r\n                variant=\"contained\"\r\n                onClick={e => {this.setState({infoAttribute: null})}}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    } else if (this.state.thingModalOpen) {\r\n      return (\r\n        <NewThingModal \r\n          things={this.props.things}\r\n          newThingType={this.state.newThingType}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            });\r\n          }}\r\n          addThing={thing => {\r\n            this.props.addThing(thing);\r\n          }}\r\n          onSave={newThing => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            }, _ => {\r\n              // Need to put it on putThingOnAttribute\r\n              const thing = this.props.selectedThing;\r\n              const attr = thing.AttributesArr.filter(a => a.attrID === this.state.putThingOnAttribute.attrID)[0];\r\n              if (attr.AttributeType === \"Type\") {\r\n                attr.Value = newThing._id;\r\n              }\r\n              else {\r\n                // The only way it can be here is if it's List and ListType is Type\r\n                attr.ListValues.push(newThing._id);\r\n              }\r\n              this.props.updateSelectedThing(thing);\r\n            });\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else {\r\n      let additionalAttributes = [];\r\n      if (this.state.browseAttributes) {\r\n        Object.keys(this.props.attributesByID).forEach(id => {\r\n          if (this.props.selectedThing.Attributes.filter(a => a.attrID === id).length === 0){\r\n            additionalAttributes.push(this.props.attributesByID[id]);\r\n          }\r\n        });\r\n      }\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld !== null &&\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={7} sm={9}>\r\n                  {this.renderHeader()}\r\n                </Grid>\r\n                <Grid item xs={4} sm={2}>\r\n                  <ListItem>\r\n                    { this.state.majorType === null ?\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary=\"Next\" />\r\n                      </Button>\r\n                    :\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary={`Next ${this.state.majorType.Name}`}/>\r\n                      </Button>\r\n                    }\r\n                  </ListItem>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedThing.Name} \r\n                    fieldName=\"Name\" \r\n                    message={this.state.fieldValidation.Name.message}\r\n                    onBlur={name => {\r\n                      const thing = this.props.selectedThing;\r\n                      thing.Name = name;\r\n                      this.props.updateSelectedThing(thing);\r\n                      this.validateForm();\r\n                      // this.setState({ Name: name }, this.validateForm);\r\n                    }}\r\n                    labelWidth={43}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedThing.Description} \r\n                    fieldName=\"Description\" \r\n                    multiline={true}\r\n                    onBlur={desc => {\r\n                      const thing = this.props.selectedThing;\r\n                      thing.Description = desc;\r\n                      this.props.updateSelectedThing(thing);\r\n                      // this.setState({ Description: desc });\r\n                    }}\r\n                    labelWidth={82}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { !this.state.resetting &&\r\n                  <Multiselect\r\n                    placeholder=\"Types\"\r\n                    options={this.props.types}\r\n                    selectedValues={this.props.selectedThing.Types}\r\n                    onSelect={this.addType}\r\n                    onRemove={this.removeType}\r\n                    displayValue=\"Name\"\r\n                  />\r\n                }\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  <span>Attributes&nbsp;\r\n                    <Tooltip title={`Add New Attribute`}>\r\n                      <Fab size=\"small\"\r\n                        color=\"primary\"\r\n                        onClick={ _ => {\r\n                          this.setState({ infoAttribute: {\r\n                            index: this.props.selectedThing.AttributesArr.length,\r\n                            Name: \"\",\r\n                            AttributeType: \"Text\",\r\n                            Options: [],\r\n                            DefinedType: \"\",\r\n                            ListType: \"\",\r\n                            attrID: null,\r\n                            Value: \"\",\r\n                            ListValues: [],\r\n                            FromTypeIDs: [],\r\n                            TypeIDs: []\r\n                          }});\r\n                        }}\r\n                      >\r\n                        <Add />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                    <Tooltip title={`Browse Additional Attributes`}>\r\n                      <Fab\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        onClick={e => {\r\n                          this.setState({ browseAttributes: !this.state.browseAttributes });\r\n                        }}\r\n                      >\r\n                        <Search />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                  </span>\r\n                </Grid>\r\n                { this.state.browseAttributes && \r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={12} sm={6}>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"browseForAttributes\" id=\"browseForAttributes-label\">\r\n                          Browse Additional Attributes\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"browseForAttributes-label\"\r\n                          id=\"browseForAttributes\"\r\n                          value={this.state.browseAttributesSelected}\r\n                          onChange={e => {\r\n                            this.setState({ browseAttributesSelected: e.target.value });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={200}\r\n                        >\r\n                          {additionalAttributes.map((attr, i) => {\r\n                            return (<MenuItem key={i} value={attr._id}>{attr.Name}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={6}>\r\n                      <Button\r\n                        variant=\"contained\" color=\"primary\"\r\n                        disabled={ this.state.browseAttributesSelected === \"\" }\r\n                        onClick={e => {this.addSelectedAttribute();}}\r\n                        type=\"submit\"\r\n                      >\r\n                        Add Attribute\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                }\r\n                { !this.state.resetting && this.state.loaded &&\r\n                  <AttributesControl \r\n                    addNewThing={attribute => {\r\n                      this.setState({ \r\n                        thingModalOpen: true,\r\n                        newThingType: this.props.types.filter(t => t._id === attribute.DefinedType)[0],\r\n                        putThingOnAttribute: attribute\r\n                      });\r\n                    }} \r\n                    onInfo={e => {\r\n                      this.setState({ infoAttribute: e});\r\n                    }} />\r\n                }\r\n                <FormHelperText>\r\n                  {this.state.fieldValidation.Attributes.message}\r\n                </FormHelperText>\r\n              </Grid>\r\n              <Grid item>\r\n                <div className=\"float-right\">\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(\"next\")}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Edit Next\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(\"add\")}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    className=\"w200\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(\"\")}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={_ => {\r\n                      if (this.props.selectedThing._id === null) {\r\n                        this.setState({\r\n                          redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                        });\r\n                      }\r\n                      else {\r\n                        this.setState({\r\n                          redirectTo: `/thing/details/${this.props.selectedThing._id}`\r\n                        });\r\n                      }\r\n                    }}\r\n                    type=\"button\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n              <Grid item>\r\n                {this.state.errors.map((e, key) => {\r\n                  return (<div key={key}>{e}</div>);\r\n                })}\r\n              </Grid>\r\n              <Grid item>\r\n                {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                  if (\r\n                    this.state.fieldValidation[fieldName] !== undefined &&\r\n                    this.state.fieldValidation[fieldName].message.length > 0\r\n                  ) {\r\n                    return (\r\n                      <p className=\"redFont\" key={i}>\r\n                        {this.state.fieldValidation[fieldName].message}\r\n                      </p>\r\n                    );\r\n                  } else {\r\n                    return \"\";\r\n                  }\r\n                })}\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport API from '../../smartAPI';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      resetPasswordCode: null,\r\n      codeValid: false,\r\n      password: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        password: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const passwordValid = this.validateField(\"password\");\r\n    const confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n    const formValid = \r\n      passwordValid.valid && \r\n      confirmPasswordValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    this.api.resetPassword(this.state.resetPasswordCode, this.state.password).then(res => {\r\n      this.setState({ \r\n        message: res.message,\r\n        waiting: false\r\n      });\r\n    })\r\n    .catch(err => console.log(err));\r\n  }\r\n\r\n  render() {\r\n    if (this.state.resetPasswordCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkResetPasswordCode(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({resetPasswordCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({resetPasswordCode: id, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"outlined-adornment-password\"\r\n                      name=\"password\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.password}\r\n                      error={ !this.state.fieldValidation.password.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={70}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"confirm-password\"\r\n                      name=\"confirmPassword\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.confirmPassword}\r\n                      error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={130}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"float-right\">\r\n                <Button className=\"w200\" disabled={this.state.waiting}\r\n                  onClick={this.onSubmit}\r\n                  type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {this.state.message}\r\n          {\r\n            Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })\r\n          }\r\n        </div>\r\n      );\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ResetPasswordPage = connect()(Page);\r\nexport default ResetPasswordPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      confirmEmailCode: null,\r\n      codeValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  render() {\r\n    if (this.state.confirmEmailCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.confirmEmail(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({confirmEmailCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({confirmEmailCode: id, codeValid: true, message: res.message});\r\n          }\r\n        });\r\n      }, 500);\r\n    }\r\n    return (\r\n      <div>\r\n        <h2>Confirming Email</h2>\r\n        {this.state.message}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst ConfirmEmailPage = connect()(Page);\r\nexport default ConfirmEmailPage;\r\n","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { \r\n  Route, \r\n  Switch } from \"react-router-dom\";\r\n  import { connect } from \"react-redux\";\r\nimport HomePage from \"./Home\";\r\nimport ForumMenuPage from \"./Forum/ForumMenu\";\r\nimport ProfilePage from \"./User/Profile\";\r\n// import UserEditPage from \"./User/Edit\";\r\nimport WorldDetailsPage from \"./World/Details\";\r\nimport WorldEditPage from \"./World/Edit\";\r\nimport CollaboratePage from \"./World/Collaborate\";\r\nimport EditCollaboratorsPage from \"./World/EditCollaborators\";\r\n// import WorldDeletePage from \"./World/Delete\";\r\nimport TypeDetailsPage from \"./Type/Details\";\r\nimport TypeEditPage from \"./Type/Edit\";\r\n// import TypeDeletePage from \"./Type/Delete\";\r\nimport ThingDetailsPage from \"./Thing/Details\";\r\nimport ThingEditPage from \"./Thing/Edit\";\r\nimport ResetPasswordPage from \"./User/ResetPassword\";\r\nimport ConfirmEmailPage from \"./User/ConfirmEmail\";\r\n// import ThingDeletePage from \"./Thing/Delete\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport LoginControl from './User/LoginControl';\r\nimport {\r\n  toggleLogin\r\n} from \"../redux/actions/index\";\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    loginOpen: state.app.loginOpen\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} className=\"h-100 margined\">\r\n        { this.props.loginOpen ?\r\n          <LoginControl onLogin={_ => { \r\n            this.props.toggleLogin();\r\n          }}/>\r\n        :\r\n          <Switch>\r\n            {/* <Route exact path=\"/Template\" component={TemplatePage} /> */}\r\n            <Route exact path=\"/\" component={HomePage} />\r\n            <Route exact path=\"/home\" component={HomePage} />\r\n            <Route exact path=\"/User/Profile\" component={ProfilePage} />\r\n            <Route exact path=\"/User/resetPassword/:id\" component={ResetPasswordPage} />\r\n            <Route exact path=\"/User/confirmEmail/:id\" component={ConfirmEmailPage} />\r\n            {/* <Route exact path=\"/profile\" component={UserEditPage} /> */}\r\n            \r\n            {/* <Route exact path=\"/test/:testtext\" component={Test} /> */}\r\n            <Route exact path=\"/forums\" component={ForumMenuPage} />\r\n            <Route exact path=\"/world/details/:id\" component={WorldDetailsPage} />\r\n            <Route exact path=\"/world/create\" component={WorldEditPage} />\r\n            <Route exact path=\"/world/edit/:id\" component={WorldEditPage} />\r\n            <Route exact path=\"/world/collaborators/:id\" component={EditCollaboratorsPage} />\r\n            <Route exact path=\"/world/collaborate/:worldID/:collabID\" component={CollaboratePage} />\r\n            {/* <Route exact path=\"/world/delete/:id\" component={WorldDeletePage} /> */}\r\n            <Route exact path=\"/type/create\" component={TypeEditPage} />\r\n            <Route exact path=\"/type/details/:id\" component={TypeDetailsPage} />\r\n            <Route exact path=\"/type/edit/:id\" component={TypeEditPage} />\r\n            {/* <Route exact path=\"/type/delete/:id\" component={TypeDeletePage} /> */}\r\n            <Route exact path=\"/thing/create\" component={ThingEditPage} />\r\n            <Route exact path=\"/thing/create/:id\" component={ThingEditPage} />\r\n            <Route exact path=\"/thing/details/:id\" component={ThingDetailsPage} />\r\n            <Route exact path=\"/thing/edit/:id\" component={ThingEditPage} />\r\n            {/* <Route exact path=\"/thing/delete/:id\" component={ThingDeletePage} /> */}\r\n          </Switch>\r\n        }\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst MainPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default MainPage;\r\n","\nimport React, { Component } from \"react\";\nimport \"./assets/css/material-dashboard-react.css\";\nimport {\n  BrowserRouter as Router\n} from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport NavBar from \"./components/Navigation/Navbar\";\nimport Sidebar from \"./components/Navigation/Sidebar\";\nimport MainPage from \"./views/MainPage\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport { \n  setWidth,\n  setAPI\n} from \"./redux/actions/index\";\nimport API from \"./smartAPI\";\n\nconst mapStateToProps = state => {\n  return {\n    menuOpen: state.app.menuOpen,\n    api: state.app.api\n  };\n};\nfunction mapDispatchToProps(dispatch) {\n  return {\n    setWidth: width => dispatch(setWidth(width)),\n    setAPI: api => dispatch(setAPI(api))\n  };\n}\nclass AppLayout extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      version: \"0\",\n      width: 0,\n      marginLeft: 220\n    };\n    this.api = API.getInstance();\n  }\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    let w = window.innerWidth;\n    if (w >= 600) {\n      w -= 200;\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 220, innerWidth: window.innerWidth });\n    }\n    else {\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 0, innerWidth: window.innerWidth });\n    }\n  }\n\n  render() {\n    if (this.props.api === null) {\n      this.props.setAPI(this.api);\n    }\n    return (\n      <Router>\n        {this.props.menuOpen ? \n          <Box display={{ xs: 'none', sm: 'inline' }} className=\"Sidebar\">\n            <Sidebar className=\"\" logoText={\"Author's Notebook\"} />\n          </Box>\n        : \"\" }\n        <Grid container>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft : 0}px`, \n              width: `${this.props.menuOpen ? this.state.width : this.state.innerWidth}px` \n            }}>\n            <NavBar />\n          </Grid>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft + 10 : 10}px`, \n              width: `${this.props.menuOpen ? this.state.width - 20 : this.state.innerWidth - 20}px`,\n              marginRight: \"10px\",\n              marginTop: \"10px\" \n            }}>\n            <MainPage />\n          </Grid>\n        </Grid>\n      </Router>\n    );\n  }\n}\n\nconst App = connect(mapStateToProps, mapDispatchToProps)(AppLayout);\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\r\n  UPDATE_INDEX_EXPANDED_PANEL,\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOGOUT,\r\n  REDIRECT_TO,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  // UPDATE_ATTRIBUTES_ARR,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_ATTRIBUTES,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  TOGGLE_LOGIN,\r\n  NOT_FROM_LOGIN,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH\r\n} from \"../constants/actionTypes\";\r\n\r\nconst initialState = {\r\n  indexExpandedPanel: false,\r\n  api: null,\r\n  articles: [],\r\n  user: null,\r\n  redirectToURL: null,\r\n  loginError: \"\",\r\n  worlds: [],\r\n  publicWorlds: [],\r\n  followingWorlds: [],\r\n  selectedWorld: null,\r\n  selectedWorldID: null,\r\n  types: [],\r\n  things: [],\r\n  selectedType: null,\r\n  // attributesArr: [],\r\n  // attributes: [],\r\n  attributesByID: {},\r\n  attributesByName: {},\r\n  selectedThing: null,\r\n  loadIt: true,\r\n  menuOpen: true,\r\n  loginOpen: false,\r\n  fromLogin: false,\r\n  width: 0\r\n};\r\nfunction rootReducer(state = initialState, action) {\r\n  if (action.type === UPDATE_INDEX_EXPANDED_PANEL) {\r\n    return Object.assign({}, state, {\r\n      indexExpandedPanel: action.payload\r\n    });\r\n  } else if (action.type === LOAD_FROM_STORAGE) {\r\n    let user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n    if (user !== undefined && user !== null && user.body !== undefined && user.body.user !== undefined)\r\n      user = user.body.user;\r\n    else \r\n      user = null;\r\n    // const worlds = JSON.parse(sessionStorage.getItem(\"worlds\"));\r\n    // const publicWorlds = JSON.parse(sessionStorage.getItem(\"publicWorlds\"));\r\n    const selectedWorld = JSON.parse(sessionStorage.getItem(\"selectedWorld\"));\r\n    const selectedWorldID = sessionStorage.getItem(\"selectedWorldID\");\r\n    const types = JSON.parse(sessionStorage.getItem(\"types\"));\r\n    const things = JSON.parse(sessionStorage.getItem(\"things\"));\r\n    const followingWorlds = JSON.parse(sessionStorage.getItem(\"followingWorlds\"));\r\n    // const attributes = JSON.parse(sessionStorage.getItem(\"attributes\"));\r\n    const attributesByID = JSON.parse(sessionStorage.getItem(\"attributesByID\"));\r\n    const attributesByName = JSON.parse(sessionStorage.getItem(\"attributesByName\"));\r\n    \r\n    return Object.assign({}, state, {\r\n      user: user,\r\n      // worlds: worlds === null ? [] : worlds,\r\n      // publicWorlds: publicWorlds === null ? [] : publicWorlds,\r\n      selectedWorld,\r\n      selectedWorldID,\r\n      types: types === null ? [] : types,\r\n      things: things === null ? [] : things,\r\n      followingWorlds: followingWorlds === null ? [] : followingWorlds,\r\n      // attributes: attributes === null ? [] : attributes,\r\n      attributesByID: attributesByID === null ? {} : attributesByID,\r\n      attributesByName: attributesByName === null ? {} : attributesByName,\r\n    });\r\n  } else if (action.type === SET_API) {\r\n    return Object.assign({}, state, {\r\n      api: action.payload\r\n    });\r\n  } else if (action.type === ADD_ARTICLE) {\r\n    return Object.assign({}, state, {\r\n      articles: state.articles.concat(action.payload)\r\n    });\r\n  } else if (action.type === LOGIN) {\r\n    // sessionStorage.setItem(\"user\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload.followingWorlds));\r\n    return Object.assign({}, state, {\r\n      user: action.payload, \r\n      followingWorlds: action.payload.followingWorlds\r\n    });\r\n  } else if (action.type === LOGOUT) {\r\n    // sessionStorage.removeItem(\"user\");\r\n    return Object.assign({}, state, {\r\n      user: null\r\n    });\r\n  } else if (action.type === REDIRECT_TO) {\r\n    return Object.assign({}, state, {\r\n      redirectToURL: action.payload\r\n    });\r\n  } else if (action.type === SET_WORLDS) {\r\n    if (action.payload.error === undefined){\r\n      // sessionStorage.setItem(\"worlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            selectedWorld: world,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          worlds: action.payload,\r\n          // attributes: [],\r\n          // attributesByID: {},\r\n          // attributesByName: {}\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === SET_PUBLIC_WORLDS) {\r\n    if (action.payload.error === undefined){\r\n      // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload,\r\n            selectedWorld: world,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          publicWorlds: action.payload\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === ADD_WORLD) {\r\n    if (action.payload.Public) {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      const publicWorlds = state.publicWorlds.concat(action.payload);\r\n      // sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      // const worlds = state.worlds.concat(action.payload);\r\n      // sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      return Object.assign({}, state, {\r\n        worlds: state.worlds.concat(action.payload)\r\n      });\r\n    }\r\n  } else if (action.type === UPDATE_WORLD) {\r\n    const worlds = [...state.worlds];\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = worlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Name = action.payload.Name;\r\n    const wasPublic = world.Public;\r\n    world.Public = action.payload.Public;\r\n    world.AcceptingCollaborators = action.payload.AcceptingCollaborators;\r\n    world.Collaborators = action.payload.Collaborators;\r\n    // sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n    if (world.Public) {\r\n      if (wasPublic) {\r\n        // It was already public so we just need to update the name\r\n        const publicWorld = publicWorlds.filter(t => t._id === world._id)[0];\r\n        publicWorld.Name = world.Name;\r\n      }\r\n      else {\r\n        // It's been changed to public, so we need to add it\r\n        publicWorlds = publicWorlds.concat(world);\r\n      }\r\n      // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      if (wasPublic) {\r\n        // It used to be public, so we need to remove it\r\n        publicWorlds = publicWorlds.filter(t => t._id !== world._id);\r\n        // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n        return Object.assign({}, state, {\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      }\r\n      else {\r\n        // It's still not public, so we can leave it\r\n        return Object.assign({}, state, {\r\n          worlds\r\n        });\r\n      }\r\n    }\r\n  } else if (action.type === UPDATE_PUBLIC_WORLD_COLLAB) {\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = publicWorlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Collaborators = action.payload.Collaborators;\r\n    // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n    return Object.assign({}, state, {\r\n      publicWorlds\r\n    });\r\n  } else if (action.type === SELECT_WORLD) {\r\n    let world = state.worlds.filter(world => world._id === action.payload);\r\n    if (world.length === 0)\r\n      world = state.publicWorlds.filter(world => world._id === action.payload);\r\n    if (world.length > 0) {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world[0]));\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: world[0],\r\n        // attributes: [],\r\n        attributesByID: {},\r\n        attributesByName: {}\r\n      });\r\n    } else {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.removeItem(\"selectedWorld\");\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: null,\r\n        // attributes: [],\r\n        attributesByID: {},\r\n        attributesByName: {}\r\n      });\r\n    }\r\n  } else if (action.type === SET_ATTRIBUTES) {\r\n    const attributesByID = {};\r\n    const attributesByName = {};\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      // attributes: action.payload,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === UPDATE_ATTRIBUTES) {\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      // attributes: action.payload,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === ADD_ATTRIBUTES) {\r\n    // const attributes = state.attributes.concat(action.payload);\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(attributes));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n    \r\n    return Object.assign({}, state, {\r\n      // attributes: attributes,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === SET_TYPES) {\r\n    sessionStorage.setItem(\"types\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      types: action.payload\r\n    });\r\n  } else if (action.type === ADD_TYPE) {\r\n    const types = state.types.concat(action.payload);\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  } else if (action.type === SET_THINGS) {\r\n    sessionStorage.setItem(\"things\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      things: action.payload\r\n    });\r\n  } else if (action.type === ADD_THING) {\r\n    const things = state.things.concat(action.payload);\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === UPDATE_SELECTED_TYPE) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedType = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedType: changedType\r\n    });\r\n  } else if (action.type === UPDATE_TYPE) {\r\n    const types = [...state.types];\r\n    const type = types.filter(t => t._id === action.payload._id)[0];\r\n    type.Name = action.payload.Name;\r\n    type.Description = action.payload.Description;\r\n    type.Supers = action.payload.Supers;\r\n    type.AttributesArr = action.payload.AttributesArr;\r\n    type.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  // } else if (action.type === UPDATE_ATTRIBUTES_ARR) {\r\n  //   return Object.assign({}, state, {\r\n  //     attributesArr: action.payload\r\n  //   });\r\n  } else if (action.type === UPDATE_SELECTED_THING) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedThing = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedThing: changedThing\r\n    });\r\n  } else if (action.type === UPDATE_THING) {\r\n    const things = [...state.things];\r\n    const thing = things.filter(t => t._id === action.payload._id)[0];\r\n    thing.Name = action.payload.Name;\r\n    thing.Description = action.payload.Description;\r\n    thing.Types = action.payload.Types;\r\n    thing.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === TOGGLE_MENU) {\r\n    return Object.assign({}, state, {\r\n      menuOpen: !state.menuOpen\r\n    });\r\n  } else if (action.type === TOGGLE_LOGIN) {\r\n    return Object.assign({}, state, {\r\n      fromLogin: state.loginOpen,\r\n      loginOpen: !state.loginOpen\r\n    });\r\n  } else if (action.type === NOT_FROM_LOGIN) {\r\n    return Object.assign({}, state, {\r\n      fromLogin: false\r\n    });\r\n  } else if (action.type === SET_WIDTH) {\r\n    return Object.assign({}, state, {\r\n      width: action.payload\r\n    });\r\n  } else if (action.type === SET_FOLLOWING_WORLDS) {\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      followingWorlds: action.payload\r\n    });\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default rootReducer;\r\n\r\nexport const login = (user, history) => {};\r\n\r\nexport const logout = history => {};\r\n","import { createStore, combineReducers } from \"redux\";\r\nimport { sessionService, sessionReducer } from \"redux-react-session\";\r\nimport rootReducer from \"../reducers/index\";\r\nconst reducers = {\r\n  app: rootReducer,\r\n  session: sessionReducer\r\n};\r\n\r\nconst reducer = combineReducers(reducers);\r\nconst store = createStore(reducer);\r\nconst validateSession = session => {\r\n  // check if your session is still valid\r\n  return true;\r\n};\r\nconst options = {\r\n  refreshFromLocalStorage: true,\r\n  refreshOnCheckAuth: true,\r\n  redirectPath: \"/home\",\r\n  driver: \"COOKIES\",\r\n  validateSession\r\n};\r\n\r\nsessionService\r\n  .initSessionService(store, options)\r\n  .then(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and a session was refreshed from your storage\"\r\n    )\r\n  )\r\n  .catch(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and there is no session in your storage\"\r\n    )\r\n  );\r\nexport default store;\r\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store/index\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}
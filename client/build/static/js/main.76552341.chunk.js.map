{"version":3,"sources":["assets/img/ANB.png","redux/actions/index.js","redux/constants/actionTypes.js","api.js","views/Home.js","views/Template.js","components/Navigation/routes.js","components/Navigation/MobileMenu.js","components/Navigation/Navbar.js","components/Navigation/Sidebar.js","views/Forum/ForumMenu.js","views/User/Login.js","views/User/Edit.js","views/World/Index.js","views/World/Details.js","views/World/Edit.js","views/Type/Details.js","views/Type/AttributeControl.js","views/Type/AttributesControl.js","views/Type/Edit.js","views/Thing/Details.js","views/Thing/AttributeControl.js","views/Thing/AttributesControl.js","views/Thing/Edit.js","views/MainPage.js","App.js","serviceWorker.js","redux/reducers/index.js","redux/store/index.js","index.js"],"names":["module","exports","selectPage","payload","type","setWorlds","setPublicWorlds","selectWorld","setTypes","addType","setThings","addThing","updateType","updateSelectedType","updateThing","updateSelectedThing","setFollowingWorlds","UnauthorizedError","message","this","name","prototype","Error","API","instance","getInstance","APIClass","logErrorReason","reason","console","log","Promise","reject","checkStatus","response","status","unauthorizedError","statusText","error","getVersion","a","real","fetchData","processResponse","version","login","user","postData","_id","email","firstName","lastName","logout","register","sendReset","updateUser","patchData","getWorldsForUser","OwnerID","Name","Public","getPublicWorlds","createWorld","world","deleteWorld","worldID","deleteData","updateWorld","getTypesForWorld","getType","typeID","Description","Attributes","createType","deleteType","getThingsForWorld","getThing","thingID","Types","createThing","thing","deleteThing","path","options","fetch","mode","credentials","headers","Accept","then","catch","data","method","body","JSON","stringify","putData","json","Page","props","state","Component","HomePage","connect","className","TemplatePage","selectedPage","app","dispatch","page","menuRoutes","icon","Home","component","Forum","Menu","toggleFollow","follow","followingWorlds","push","index","indexOf","splice","api","handleUserInput","e","target","value","checked","setState","browse","Filter","res","worlds","undefined","map","prop","key","ListItem","Button","fullWidth","variant","color","href","Icon","ListItemText","primary","otherWorlds","publicWorlds","forEach","w","toLowerCase","includes","display","Fab","size","onClick","Search","Grid","container","spacing","direction","item","FormControl","InputLabel","htmlFor","OutlinedInput","id","autoComplete","onChange","labelWidth","List","Star","worldLinks","Add","links","myWorlds","MobileMenu","worldIDs","Bar","menuClick","toggleMenu","loadFromStorage","AppBar","position","Toolbar","xs","IconButton","style","aria-label","selectedWorld","to","activeClassName","mobileMenuOpen","Box","sm","NavBar","menuOpen","setTimeout","button","src","logo","alt","logoText","brand","Divider","light","Sidebar","window","location","pathname","ForumMenuPage","componentDidMount","validateField","remember","inputBlur","validation","fieldValidation","valid","handleClickShowPassword","showPassword","handleMouseDownPassword","event","preventDefault","fieldName","match","length","password","validateForm","respond","emailValid","confirmEmailValid","passwordValid","confirmPasswordValid","firstNameValid","lastNameValid","formMode","formValid","confirmEmail","confirmPassword","onSubmit","waiting","submitThroughAPI","errors","loginError","show","cookies","Cookies","set","userLogin","redirectTo","err","loginClick","registerClick","passwordClick","emailCookie","get","passCookie","Helmet","onBlur","FormHelperText","endAdornment","InputAdornment","onMouseDown","edge","FormControlLabel","control","Checkbox","label","Link","disabled","Object","keys","i","LoginPage","UserEditPage","Index","handleChange_old","panel","isExpanded","expandedPanel","handleChange","things","filter","TypeIDs","width","majorLess","t","Major","majorless","ExpansionPanel","expanded","ExpansionPanelSummary","expandIcon","types","ExpansionPanelDetails","buttons","Owner","Tooltip","title","_","maxWidth","j","ThingIndex","delete","selectedWorldID","modalOpen","getModalStyle","top","Math","round","innerHeight","left","innerWidth","transform","params","getTypes","Supers","SuperIDs","sID","concat","t2","getThings","tID","Modal","aria-labelledby","aria-describedby","open","onClose","WorldDetailsPage","nameValid","addWorld","marginLeft","WorldEditPage","AttributesArr","supers","references","ReferenceIDs","selectedType","attribute","Type","Options","option","Type2","ListType","superType","subTypes","sub","instances","TypeDetails","handleType2Change","attr","onNewType","newType","handleOptionsChange","AttributeControl","useState","changeName","attributeTypes","FromSupers","AttributeTypes","Select","labelId","handleTypeChange","MenuItem","defaultValue","chips","handleListTypeChange","onDelete","Label","styled","Control","newAttribute","changeAttribute","blurAttribute","deleteAttribute","attributesArr","addNewType","modalSubmit","saveNewType","AttributesControl","updateAttributesArr","arr","attr2","attrArrValid","superIDs","s","supersChange","addSuper","selectedList","selectedItem","s2","attributes","matches","superID","removeSuper","removedItem","removeUs","checkMe","placeholder","selectedValues","onSelect","onRemove","displayValue","TypeEditPage","selectedThing","Value","ListValues","listValue","ThingDetails","changeValue","listOptions","listOptionValues","o","type2","FromTypes","onNewThing","newThing","handleTextListChange","addOption","removeOption","removeType","optionsChange","addNewThing","newThingType","saveNewThing","typeIDs","createThingFromType","v","typesChange","substring","Things","typeStr","renderHeader","ThingEditPage","exact","TypeDetailsPage","ThingDetailsPage","MainPage","AppLayout","updateDimensions","addEventListener","bind","removeEventListener","marginRight","marginTop","App","Boolean","hostname","initialState","articles","loadIt","rootReducer","reducers","action","parse","sessionStorage","getItem","assign","setItem","removeItem","worldArr","wasPublic","publicWorld","changedType","changedAt","Date","now","changedThing","session","sessionReducer","reducer","combineReducers","store","createStore","refreshFromLocalStorage","refreshOnCheckAuth","redirectPath","driver","validateSession","sessionService","initSessionService","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.76552341.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import {\r\n  SELECT_PAGE,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOG_OUT,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  SELECT_WORLD,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  UPDATE_ATTRIBUTES_ARR,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  SET_FOLLOWING_WORLDS\r\n} from \"../constants/actionTypes\";\r\n\r\nexport function selectPage(payload) {\r\n  return { type: SELECT_PAGE, payload };\r\n}\r\nexport function addArticle(payload) {\r\n  return { type: ADD_ARTICLE, payload };\r\n}\r\nexport function userLogin(payload) {\r\n  return { type: LOGIN, payload };\r\n}\r\nexport function logOut(payload) {\r\n  return { type: LOG_OUT, payload };\r\n}\r\nexport function setWorlds(payload) {\r\n  return { type: SET_WORLDS, payload };\r\n}\r\nexport function addWorld(payload) {\r\n  return { type: ADD_WORLD, payload };\r\n}\r\nexport function updateWorld(payload) {\r\n  return { type: UPDATE_WORLD, payload };\r\n}\r\nexport function setPublicWorlds(payload) {\r\n  return { type: SET_PUBLIC_WORLDS, payload };\r\n}\r\nexport function selectWorld(payload) {\r\n  return { type: SELECT_WORLD, payload };\r\n}\r\nexport function setTypes(payload) {\r\n  return { type: SET_TYPES, payload };\r\n}\r\nexport function addType(payload) {\r\n  return { type: ADD_TYPE, payload };\r\n}\r\nexport function setThings(payload) {\r\n  return { type: SET_THINGS, payload };\r\n}\r\nexport function addThing(payload) {\r\n  return { type: ADD_THING, payload };\r\n}\r\nexport function updateType(payload) {\r\n  return { type: UPDATE_TYPE, payload };\r\n}\r\nexport function updateAttributesArr(payload) {\r\n  return { type: UPDATE_ATTRIBUTES_ARR, payload };\r\n}\r\nexport function updateSelectedType(payload) {\r\n  return { type: UPDATE_SELECTED_TYPE, payload };\r\n}\r\nexport function updateThing(payload) {\r\n  return { type: UPDATE_THING, payload };\r\n}\r\nexport function updateSelectedThing(payload) {\r\n  return { type: UPDATE_SELECTED_THING, payload };\r\n}\r\nexport function loadFromStorage(payload) {\r\n  return { type: LOAD_FROM_STORAGE, payload };\r\n}\r\nexport function toggleMenu(payload) {\r\n  return { type: TOGGLE_MENU, payload };\r\n}\r\nexport function setFollowingWorlds(payload) {\r\n  return { type: SET_FOLLOWING_WORLDS, payload };\r\n}\r\n","\r\nexport const SELECT_PAGE = \"SELECT_PAGE\";\r\nexport const ADD_ARTICLE = \"ADD_ARTICLE\";\r\nexport const LOGIN = \"LOGIN\";\r\nexport const LOG_OUT = \"LOG_OUT\";\r\nexport const SET_WORLDS = \"SET_WORLDS\";\r\nexport const SET_PUBLIC_WORLDS = \"SET_PUBLIC_WORLDS\";\r\nexport const ADD_WORLD = \"ADD_WORLD\";\r\nexport const UPDATE_WORLD = \"UPDATE_WORLD\";\r\nexport const SELECT_WORLD = \"SELECT_WORLD\";\r\nexport const SET_TYPES = \"SET_TYPES\";\r\nexport const ADD_TYPE = \"ADD_TYPE\";\r\nexport const SET_THINGS = \"SET_THINGS\";\r\nexport const ADD_THING = \"ADD_THING\";\r\nexport const UPDATE_TYPE = \"UPDATE_TYPE\";\r\nexport const UPDATE_ATTRIBUTES_ARR = \"UPDATE_ATTRIBUTES_ARR\";\r\nexport const UPDATE_SELECTED_TYPE = \"UPDATE_SELECTED_TYPE\";\r\nexport const UPDATE_THING = \"UPDATE_THING\";\r\nexport const UPDATE_SELECTED_THING = \"UPDATE_SELECTED_THING\";\r\nexport const LOAD_FROM_STORAGE = \"LOAD_FROM_STORAGE\";\r\nexport const TOGGLE_MENU = \"TOGGLE_MENU\";\r\nexport const SET_FOLLOWING_WORLDS = \"SET_FOLLOWING_WORLDS\";\r\n","\r\n// This is our special type of Error that represents\r\n// when a request got a 401 Unauthorized response\r\nfunction UnauthorizedError(message) {\r\n  this.name = \"UnauthorizedError\";\r\n  this.message = message;\r\n}\r\nUnauthorizedError.prototype = new Error();\r\n\r\nvar API = (function() {\r\n  var instance;\r\n\r\n  function createInstance() {\r\n    var api = new APIClass();\r\n    return api;\r\n  }\r\n\r\n  return {\r\n    getInstance: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nclass APIClass {\r\n  constructor() {\r\n    this.real = true;\r\n  }\r\n\r\n  logErrorReason = reason => {\r\n    // log the error reason but keep the rejection\r\n    console.log(\"Response error reason:\", reason);\r\n    return Promise.reject(reason);\r\n  };\r\n\r\n  checkStatus = response => {\r\n    if (response.status >= 200 && response.status < 300) {\r\n      return response;\r\n    } else if (response.status === 401) {\r\n      var unauthorizedError = new UnauthorizedError(response.statusText);\r\n      unauthorizedError.response = response;\r\n      return Promise.reject(unauthorizedError);\r\n    } else {\r\n      var error = new Error(response.statusText);\r\n      error.response = response;\r\n      return Promise.reject(error);\r\n    }\r\n  };\r\n\r\n  getVersion = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/version\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return { version: \"0.0.1\" };\r\n    }\r\n  };\r\n\r\n  // User\r\n  login = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/login\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        firstName: \"Liar Liar\",\r\n        lastName: \"Pants on Fire\"\r\n      };\r\n    }\r\n  };\r\n\r\n  logout = async user => {\r\n    if (this.real) {\r\n      await this.postData(\"/api/user/logout\");\r\n    }\r\n  };\r\n\r\n  register = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/register\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  sendReset = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/sendReset\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  updateUser = async user => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/update\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        firstName: \"Liar Liar\",\r\n        lastName: \"Pants on Fire\"\r\n      };\r\n    }\r\n  };\r\n\r\n  // World\r\n  getWorldsForUser = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getPublicWorlds = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  createWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  selectWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Type\r\n  getTypesForWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getTypesForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getType/${worldID}/${typeID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createType\", { type: type });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Thing\r\n  getThingsForWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getThingsForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  getThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Types: [-1],\r\n        Name: \"Alice\",\r\n        Description: \"\"\r\n      };\r\n    }\r\n  };\r\n\r\n  createThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  fetchData = async (path, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        ...options.headers\r\n      }\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  postData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  putData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  patchData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  deleteData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"DELETE\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  processResponse = async response => {\r\n    const body = await response.json();\r\n    if (response.status !== 200) throw Error(body.message);\r\n    else return body;\r\n  };\r\n}\r\n\r\nexport default API;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h3>Author's Notebook</h3>\r\n        <p>\r\n          This is something that I've been wanting to build for a while. It's\r\n          purpose is to provide a place for keeping track of various aspects of\r\n          books that an author is writing. It is able to keep track of details\r\n          about characters, organizations, systems, and even storylines. I would\r\n          like to make it so it's publicly available, and that any authors\r\n          (aspiring and published) can use it to help them organize their\r\n          stories. I want to make it automate a number of things, but the\r\n          biggest part is to make it very dynamic and to allow for storage of\r\n          all different kinds of notes. In order to make it publicly available\r\n          however, it needs to at least be able to pay for itself. I'm not\r\n          talking about the time I spent/spend working on it, but the costs of\r\n          hosting the website, the db, and the url. Until I'm sure it's capable\r\n          of doing those things, I can't let everyone have access to it.\r\n        </p>\r\n        <p>\r\n          This is version 1 of instructions of how to use it. If I make it\r\n          available for anyone, I'll update it with some video instructions.\r\n        </p>\r\n        <p>\r\n          One thing you need to know is that this is a hobby project of mine.\r\n          I'm working on it by myself for now. I've got a real job, and I've got\r\n          a family, so this isn't my top priority, but that being said I do care\r\n          about this probject, and I do plan to get to all the things that are\r\n          on my to do list.\r\n        </p>\r\n        <p>\r\n          If you want to do more than just look at the things others have put on\r\n          (and which they're allowing you to see), then you'll have to register.\r\n          Making it use Facebook and/or Google authentication is on my to do\r\n          list. I know how to do that, but I just haven't gotten around to it.\r\n          So, for now, just register and login. It currently doesn't send any\r\n          emails, so if you forget your password or something, you'll have to\r\n          reach out to me, and I can straighten it out. Again, that kind of\r\n          thing is also on my to do list.\r\n        </p>\r\n        <p>\r\n          Once you're logged in then you're able to start keeping track of\r\n          things.\r\n        </p>\r\n        <p>\r\n          The first thing you create is currently called a World. This is a\r\n          holdover from when I was calling this my World Building App because I\r\n          was aiming it for Fantasy/Sci-Fi authors (like me), but I realized\r\n          that it could be used for anything really. If anyone has any\r\n          suggestions for something to call this instead of World, I'm open to\r\n          considering other options. Currently I'm considering changing it to\r\n          'Project', and I may do that before showing it to anyone other than\r\n          family and close friends. Anyway, a World is basically the root of\r\n          everything. Different Worlds aren't connected to each other. Each\r\n          World has a Name, and you can choose whether or not to make it Public.\r\n          If it's not Public then only the Owner (whoever created it) is able to\r\n          see it. If it is Public then anyone can see it, but only the Owner can\r\n          edit it. (Planned Future Features: When you create a new world you can\r\n          use a template which will include generic Types common to that type of\r\n          World, such as Character, Location, etc. I'm also planning to add the\r\n          ability for Owners to add Collaborators to their World. Collaborators\r\n          would be able to see the World, and the Owner would be able to control\r\n          their other permissions as well (create/edit type, delete type,\r\n          create/edit thing, and delete thing.). Only the Owner will have the\r\n          ability to Edit or Delete the World itself, but they will be able to\r\n          make someone else the Owner.)\r\n        </p>\r\n        <p>\r\n          Within a World you are able to define Types. Basically a Type is just\r\n          that. It's a Type of Thing that you want to keep track of. In each\r\n          Type you are able to define attributes which that Type of Thing share,\r\n          such as Characters having Age, Race, Gender, Height, Weight, Skin\r\n          Color, Eye Color, etc. Types can also be hierarchical through\r\n          inheritance. For example, in Harry Potter I would have a 'Character'\r\n          Type with all the attributes I listed above, but then I could have a\r\n          'Witch or Wizard' Type which has 'Character' as a Super Type. This\r\n          means that 'Witch or Wizard' already has all those same Attributes as\r\n          'Character', but you can add more Attributes like Wand, Known Spells,\r\n          etc. The way to set the Super Types for a type is with a control\r\n          called a Multi Select. It's basically a textbox, but as you type it\r\n          gives you suggestions. You click a suggestion and it adds a chip\r\n          showing it as selected. Clicking the x on the right of the chip\r\n          unselects it. When selecting a Type to be a Super Type it adds all the\r\n          Attributes of that Type to the Type you're creating or editing, but\r\n          they are greyed out and disabled for editing. The reason they're grey\r\n          and disabled is that they come from a Super Type, so their definition\r\n          is there. If a Super Type is removed then the Attributes remain, but\r\n          are no longer grey and disabled. They can then be edited. There are a\r\n          few more things to note however. First is that when adding a Super\r\n          Type which has Super Types, those Super Types will be added as well.\r\n          An example of this could be the 'Animagus' Type in Harry Potter.\r\n          'Animagus' has the Super Type 'Witch or Wizard', which has the Super\r\n          Type 'Character', so when defining 'Animagus' I could add 'Witch or\r\n          Wizard' as a Super Type, and that will automatically add 'Character'\r\n          as well. Removing a Super Type of other Super Types will remove all\r\n          Sub Types of the Super Type removed. An example of that would be\r\n          removing 'Character' from 'Animagus'. This would automatically remove\r\n          'Witch or Wizard' as well. It doesn't make sense to do that for\r\n          'Animagus', but it may be necessary for you if you want to rethink how\r\n          you're organizing things. The last thing to note about removing Super\r\n          Types is that so long as a single Super Type exists which has an\r\n          Attribute with that name, it will be greyed out and disabled. Another\r\n          note about Attributes is that their names have to be unique on the\r\n          Type (or Thing). It's generally a good idea to make sure that any\r\n          Attributes you define with the same name also have the same Attribute\r\n          type as well, otherwise you may run into Attribute name collisions.\r\n          One last thing about Types. I've added an option to Types called Major\r\n          Type. If it's checked then the Type is considered a Major Type and\r\n          will show up in places of the UI where a regular Type will not. This\r\n          makes finding, creating, and editing Things of that Type easier. I\r\n          would make 'Character' a Major Type, but 'Witch or Wizard' and\r\n          'Animagus' would be regular Types. (Planned Future Features: Template\r\n          Types like I have above for Template Worlds, but they're individual\r\n          Types. Also add Plural Name field which will be used in the UI for\r\n          places where we put the plural name of something. Currently it just\r\n          adds an 's' to the end of the Type name, and I want to continue to do\r\n          that if the Plural Name is left empty, but if it's not empty then\r\n          display the Plural Name instead.)\r\n        </p>\r\n        <p>\r\n          Types have Attributes (as mentioned above). Things (which I'll get\r\n          into more below) also have Attributes. The same Attributes really. In\r\n          the Harry Potter World the Attributes on the 'Character' Type would\r\n          then be given to every character you create afterward, but now instead\r\n          of naming the Attribute and saying what type of Attribute it is, you\r\n          get to specify a value for the Attribute.\r\n        </p>\r\n        <p>\r\n          An Attribute is anything you may wish to keep track of for anything.\r\n          These do not include Name or Description, because all Types and Things\r\n          always have Name and Description by default. Attributes are for\r\n          anything else you want to keep track of. It could be a relationship\r\n          like 'Friend', 'Family Member', 'Significant Other', 'Coworker', etc.\r\n          It could be skills and abilities, or possessions, or jobs, or home\r\n          address, or work or school schedule. Really anything you want to keep\r\n          track of which is part of something can be an Attribute. Currently\r\n          there are six types of Attributes that are supported: Text, Number,\r\n          True/False, Options, Type, and List. Text is just that. A Text\r\n          Attribute gives you a textbox where you can type anything you want to\r\n          keep track of. Number gives you a number box, which is like a textbox\r\n          but it only accepts numbers, and it has arrows on the right which can\r\n          be used to increment or decrement the number. True/False gives you a\r\n          checkbox. Options allows you to specify possible choices for the\r\n          Attribute, and then they show up in a drop down list (A quick example\r\n          of this could be 'Gender' having 'Male', 'Female', and others if you\r\n          wanted. They can have as many options as you want, and it can be used\r\n          for whatever Attribute you want.). Specifying the choices is done\r\n          using a control called a Chip Input. This looks like a regular\r\n          textbox, but whenever you hit enter the text in it is added as a chip.\r\n          Chips show the text, but have an x on their right which can be used to\r\n          remove them. It's basically like the Multiselect except without the\r\n          suggestions. The Chips are the choices that will be in the drop down\r\n          list which the user has when creating or editing a Thing with that\r\n          Attribute.\r\n        </p>\r\n        <p>The last two Attribute types are a little more complicated.</p>\r\n        <p>\r\n          When adding Attributes to a Type, the 'Type' Attribute type allows you\r\n          to then choose from the various Types you've defined for the World,\r\n          and then when you're creating or editing a Thing (such as the\r\n          'Character' 'Harry Potter') you would get all the Things of that Type\r\n          as choices in a drop down list. For example you could have a 'Best\r\n          Friend' Attribute which has the Attribute type of 'Type' and uses the\r\n          Defined Type of 'Character'. Then when editing Harry you would have a\r\n          drop down list which shows all the 'Characters' you've added to the\r\n          World as possible 'Best Friends'. You would of course then choose 'Ron\r\n          Weasley' (Sorry, Hermione, but you're a close second.).\r\n        </p>\r\n        <p>\r\n          The Attribute Type 'List' is still more complicated than 'Type'. It\r\n          allows you to decide which type of 'List' it's going to be. For now it\r\n          only supports 'Text', 'Options', and 'Type'. (I'm not planning to add\r\n          any others, but if it's requested I may consider it. A List of Text\r\n          could be anything really, so other types shouldn't be necessary.) If\r\n          an Attribute is defined as a List of Text then when creating or\r\n          editing a Thing the Attribute gives a Chip Input, which works the same\r\n          as it does for Options (described above). A List of Options allows you\r\n          to define the choices when creating or editing the Type, the same as\r\n          with a regular Options Attribute, and then when creating or editing a\r\n          Thing of that Type it gives a Multiselect which works the same as when\r\n          choosing Super Types (described above) with the Options defined\r\n          previously on the Type as the suggestions. A List of 'Type' allows you\r\n          to choose a Defined Type (like with the Attribute type 'Type'), but\r\n          when creating or editing a Thing it gives you a Multiselect instead of\r\n          a regular drop down list so you can select more than one. With all\r\n          'List' Attributes, the items in the list are displayed separated by\r\n          commas when looking at the details page rather than creating or\r\n          editing.\r\n        </p>\r\n        <p>\r\n          One last note about Attributes of type 'Type' or 'List' of 'Type'.\r\n          I've made it so that if you want to choose a Defined Type which you\r\n          haven't defined yet you can choose '+ Create New Type' and it opens a\r\n          quick little window (modal for those who care) which lets you define a\r\n          Type using just the name you want it to have. You'll have to edit that\r\n          Type later to give it any Super Types or Attributes it should have,\r\n          but you can create it there so you can continue defining the Type\r\n          you're already working on rather than having to leave and come back to\r\n          it. The same thing can be done when creating or editing a Thing with\r\n          an Attribute of type 'Type' or 'List' of 'Type', but for Things the\r\n          Type has already been chosen. Now you will be creating a Thing of that\r\n          Type. An example of this would be if you're editing the 'Character'\r\n          'Harry Potter', but when you get to 'Best Friend' you realize you\r\n          haven't added the 'Ron Weasley' 'Character' yet. You would choose '+\r\n          Create New Character', and then in the quick little window you would\r\n          type 'Ron Weasley'. He would get added as a blank character with just\r\n          his Name, but he would then be selected as Harry's 'Best Friend', and\r\n          you could finish defining Harry, and get to Ron later.\r\n        </p>\r\n        <p>\r\n          (Planned Future Features: Other Attribute types, including: Image,\r\n          Event, and External Link. If you have any suggestions of others, feel\r\n          free to recommend them. Also allow Types to have Default values for\r\n          Attributes, but that will create the possibility of Default\r\n          Collisions, similar to Name Collisions.)\r\n        </p>\r\n        <p>\r\n          And that brings us to Things. If you've gotten to this point, then you\r\n          probably already understand what Things are, but I'll outline it\r\n          anyway. The generic term Thing is used to mean any actual thing you're\r\n          keeping track of. This would be your Characters, your Places, your\r\n          Items, Spells, whatever. When creating or editing a Thing you are able\r\n          to choose Types for the Thing (works the same as Super Types for\r\n          Types), and all the Attributes of those Types are added to the Thing,\r\n          but now you're able to give values for them. Again remember to avoid\r\n          Attribute Name collisions (If for some reason you've defined 2\r\n          unrelated Types with an Attribute that has the same name but different\r\n          Attribute types then you won't be able to have a Thing of both\r\n          Types.). If a Type is edited to remove an Attribute, Things which use\r\n          that Type and existed already will still have that Attribute. It will\r\n          just be an orphaned Attribute. Currently there's no way to remove\r\n          Attributes from Things. If a Type is edited to add Attributes then\r\n          Things which already existed will gain those Attributes as soon as\r\n          they're edited again. If a Type is edited and an Attribute is\r\n          changed... I'm not actually sure what would happen to Things that\r\n          already exist which have that Type. I'll have to test that. That's\r\n          really it for Things. They're the simple part. (Planned Future\r\n          Features: I'm planning to add the ability to add/remove/edit orphaned\r\n          Attributes for Things. When I do, I'll probably try to find a way to\r\n          make it so with adding/editing orphaned Attributes you'll be able to\r\n          add the Attribute to a selected Type already on the Thing.)\r\n        </p>\r\n        <p>I probably should have put Attributes below Things, but oh well.</p>\r\n        <p>Other Planned Future Features:</p>\r\n        <div>\r\n          <p>\r\n            Forums: I'm going to have a General Site Forum, and each World will\r\n            automatically get its own Forum.\r\n          </p>\r\n          <p>\r\n            Direct Messages: I'll add a simple messaging system to allow people\r\n            to communicate directly with one another.\r\n          </p>\r\n          <p>\r\n            Auto-links: For both Forums and DMs I'll allow users to put links to\r\n            pages through a simple system similar to hashtags in Social Media.\r\n            I'm thinking I also want to add this capability to Descriptions on\r\n            Types and Things.\r\n          </p>\r\n          <p>\r\n            Following Public Worlds: Currently all Public Worlds are listed in\r\n            the menu, but I should make it so only those that the user follows\r\n            are shown there, and have a button to pull up the full list, and add\r\n            a button for people who neither own or collaborate on a Public World\r\n            to 'Follow' the World.\r\n          </p>\r\n          <p>\r\n            Home Page content: I'm planning to have actual Home Page content.\r\n            This will have a link to a video tutorial for new users (which I\r\n            have yet to make, and will need occasional updating after it's\r\n            made), as well as things like recent software changes. I also want\r\n            to make it so it can automatically have links to recently added or\r\n            edited Types or Things and recent Forum posts which may be of\r\n            interest to the user.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst HomePage = connect()(Page);\r\nexport default HomePage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { selectPage } from \"../redux/actions/index\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-12\">\r\n        Template Page\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst TemplatePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TemplatePage;\r\n","\r\nimport Home from \"@material-ui/icons/Home\";\r\nimport Forum from \"@material-ui/icons/Forum\";\r\nimport HomePage from \"../../views/Home\";\r\nimport TemplatePage from \"../../views/Template\";\r\n\r\n\r\nconst menuRoutes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home\",\r\n    icon: Home,\r\n    component: HomePage,\r\n  },\r\n  {\r\n    path: \"/Forums\",\r\n    name: \"Forums\",\r\n    icon: Forum,\r\n    component: TemplatePage,\r\n  }\r\n];\r\n\r\nexport default menuRoutes;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\nimport {\r\n  Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport { \r\n  selectPage, setWorlds, setPublicWorlds, setFollowingWorlds\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Menu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds().then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    if (this.props.user !== null) {\r\n      this.api.getWorldsForUser().then(res => {\r\n        if (res.worlds !== undefined)\r\n          this.props.setWorlds(res.worlds);\r\n      });\r\n    }\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      <div>\r\n        {menuRoutes.map((prop, key) => {\r\n          return (\r\n            <ListItem key={key}>\r\n              <Button \r\n                fullWidth variant=\"contained\" color=\"primary\" \r\n                href={prop.path}>\r\n                {typeof prop.icon === \"string\" ? (\r\n                  <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n                ) : (\r\n                  <prop.icon className=\"marginLeft\" />\r\n                )}\r\n                &nbsp;<ListItemText primary={prop.name} className=\"marginLeft\" />\r\n              </Button>\r\n            </ListItem>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    console.log(this.props.followingWorlds);\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      console.log(worldID);\r\n      const index = followingWorlds.indexOf(worldID);\r\n      console.log(index);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    console.log(followingWorlds);\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.message === undefined) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (this.state.Filter === \"\" || w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            }\r\n            else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    console.log(this.props.publicWorlds);\r\n    console.log(this.props.followingWorlds);\r\n    console.log(followingWorlds);\r\n    console.log(otherWorlds);\r\n    return (\r\n      <div>\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Fab\r\n            size=\"small\"\r\n            color=\"primary\"\r\n            onClick={e => {\r\n              this.setState({ browse: !this.state.browse });\r\n            }}\r\n          >\r\n            <Search />\r\n          </Fab>\r\n        </ListItem>\r\n        { this.state.browse ?\r\n          <Grid container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n                <OutlinedInput\r\n                  id=\"filter\"\r\n                  name=\"Filter\"\r\n                  type=\"text\"\r\n                  autoComplete=\"Off\"\r\n                  value={this.state.Filter}\r\n                  onChange={this.handleUserInput}\r\n                  labelWidth={43}\r\n                  fullWidth\r\n                />\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item>\r\n              <List>\r\n                {\r\n                  followingWorlds.map((w, key) => {\r\n                    return (\r\n                      <ListItem key={key}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          href={`/world/details/${w._id}`}\r\n                        >\r\n                          <ListItemText primary={w.Name} />\r\n                        </Button>\r\n                        <Fab\r\n                          size=\"small\"\r\n                          color=\"primary\"\r\n                          onClick={e => {\r\n                            this.toggleFollow(w._id, false);\r\n                          }}\r\n                        >\r\n                          <Star />\r\n                        </Fab>\r\n                      </ListItem>\r\n                    );\r\n                  })\r\n                }\r\n                {\r\n                  otherWorlds.map((w, key) => {\r\n                    return (\r\n                      <ListItem key={key}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          href={`/world/details/${w._id}`}\r\n                        >\r\n                          <ListItemText primary={w.Name} />\r\n                        </Button>\r\n                        <Fab\r\n                          size=\"small\"\r\n                          color=\"primary\"\r\n                          onClick={e => {\r\n                            this.toggleFollow(w._id, true);\r\n                          }}\r\n                        >\r\n                          <StarBorderIcon />\r\n                        </Fab>\r\n                      </ListItem>\r\n                    );\r\n                  })\r\n                }\r\n              </List>\r\n            </Grid>\r\n          </Grid> :\r\n          <div>\r\n            {\r\n              followingWorlds.map((w, key) => {\r\n                return (\r\n                  <ListItem key={key}>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      href={`/world/details/${w._id}`}\r\n                    >\r\n                      <ListItemText primary={w.Name} />\r\n                    </Button>\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n          </div>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    }\r\n    else {\r\n      const worldLinks = (this.props.worlds === undefined ? \"\" : this.props.worlds.map((prop, key) => {\r\n        return (\r\n          <ListItem key={key}>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              href={`/world/details/${prop._id}`}>\r\n              <ListItemText primary={prop.Name} />\r\n            </Button>\r\n          </ListItem>\r\n        );\r\n      }));\r\n      return (\r\n        <div>\r\n          <ListItem>\r\n            <ListItemText primary={\"My Worlds\"} />\r\n          </ListItem>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              href={`/world/create`}>\r\n              <Add/><ListItemText primary={\"Create New\"} />\r\n            </Button>\r\n          </ListItem>\r\n          {worldLinks}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.links()}\r\n        {this.publicWorlds()}\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst MobileMenu = connect(mapStateToProps, mapDispatchToProps)(Menu);\r\nexport default MobileMenu;\r\n","import React, { Component } from \"react\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectPage,\r\n  setWorlds,\r\n  // setPublicWorlds,\r\n  loadFromStorage,\r\n  toggleMenu\r\n} from \"../../redux/actions/index\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport API from \"../../api\";\r\nimport MobileMenu from \"./MobileMenu\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    user: state.app.user,\r\n    selectedWorld: state.app.selectedWorld,\r\n    mobileMenuOpen: !state.app.menuOpen // This defaults to closed instead of open\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    // setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    loadFromStorage: () => dispatch(loadFromStorage({})),\r\n    toggleMenu: () => dispatch(toggleMenu({}))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.loadFromStorage();\r\n  }\r\n\r\n  menuClick = () => {\r\n    this.props.toggleMenu();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Grid container spacing={0}>\r\n            <Grid item xs>\r\n              <IconButton\r\n                style={{ color: \"white\" }}\r\n                aria-label=\"Menu\"\r\n                onClick={this.menuClick}\r\n              >\r\n                <MenuIcon />\r\n              </IconButton>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <ListItem className=\"curvedButton\">\r\n                <ListItemText\r\n                  primary={\r\n                    this.props.selectedWorld === null\r\n                      ? \"Welcome!\"\r\n                      : this.props.selectedWorld.Name\r\n                  }\r\n                />\r\n              </ListItem>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <NavLink\r\n                className=\"float-right blue whiteFont\"\r\n                to=\"/User/Login\"\r\n                activeClassName=\"active\"\r\n              >\r\n                <ListItem className=\"curvedButton float-right\">\r\n                  <Icon>person</Icon>\r\n                  <ListItemText\r\n                    primary={\r\n                      this.props.user === null ||\r\n                      this.props.user.firstName === undefined\r\n                        ? \" Login/Register\"\r\n                        : ` ${this.props.user.firstName} ${this.props.user.lastName}`\r\n                    }\r\n                  />\r\n                </ListItem>\r\n              </NavLink>\r\n            </Grid>\r\n          </Grid>\r\n        </Toolbar>\r\n        {this.props.mobileMenuOpen ? \r\n          <Box display={{ xs: 'inline', sm: 'none' }}>\r\n            <MobileMenu />\r\n          </Box>\r\n        : \"\" }\r\n      </AppBar>\r\n    );\r\n  }\r\n}\r\n\r\nconst NavBar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default NavBar;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\n// import logo from \"../../logo.svg\";\r\nimport logo from \"../../assets/img/ANB.png\";\r\nimport {\r\n  Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  Divider,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  selectPage,\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds().then(res => {\r\n      console.log(res);\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    // These kinds of things can also be done in render,\r\n    // but I prefer to put it here because it's only run once.\r\n    // The downside is that it's run before props gets populated\r\n    // so, it needs to be put into setTimeout to give the props\r\n    // a chance to get populated.\r\n    setTimeout(() => {\r\n      if (this.props.user !== null) {\r\n        this.api.getWorldsForUser().then(res => {\r\n          if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      <div>\r\n        {menuRoutes.map((prop, key) => {\r\n          return (\r\n            <ListItem key={key}>\r\n              <Button\r\n                fullWidth\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                href={prop.path}\r\n              >\r\n                {typeof prop.icon === \"string\" ? (\r\n                  <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n                ) : (\r\n                  <prop.icon className=\"marginLeft\" />\r\n                )}\r\n                &nbsp;\r\n                <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n              </Button>\r\n            </ListItem>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  brand() {\r\n    return (\r\n      <NavLink to={`/`} className=\"blue blackFont\" activeClassName=\"active\">\r\n        <ListItem button className=\"curvedButton\">\r\n          <img src={logo} alt=\"logo\" className=\"App-logo\" />\r\n          <ListItemText primary={this.props.logoText} />\r\n        </ListItem>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    console.log(this.props.followingWorlds);\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      console.log(worldID);\r\n      const index = followingWorlds.indexOf(worldID);\r\n      console.log(index);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    console.log(followingWorlds);\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.message === undefined) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (this.state.Filter === \"\" || w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            }\r\n            else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    console.log(this.props.publicWorlds);\r\n    console.log(this.props.followingWorlds);\r\n    console.log(followingWorlds);\r\n    console.log(otherWorlds);\r\n    return (\r\n      <div>\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Fab\r\n            size=\"small\"\r\n            color=\"primary\"\r\n            onClick={e => {\r\n              this.setState({ browse: !this.state.browse });\r\n            }}\r\n          >\r\n            <Search />\r\n          </Fab>\r\n        </ListItem>\r\n        { this.state.browse ?\r\n          <Grid container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n                <OutlinedInput\r\n                  id=\"filter\"\r\n                  name=\"Filter\"\r\n                  type=\"text\"\r\n                  autoComplete=\"Off\"\r\n                  value={this.state.Filter}\r\n                  onChange={this.handleUserInput}\r\n                  labelWidth={43}\r\n                  fullWidth\r\n                />\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item>\r\n              <List>\r\n                {\r\n                  followingWorlds.map((w, key) => {\r\n                    return (\r\n                      <ListItem key={key}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          href={`/world/details/${w._id}`}\r\n                        >\r\n                          <ListItemText primary={w.Name} />\r\n                        </Button>\r\n                        <Fab\r\n                          size=\"small\"\r\n                          color=\"primary\"\r\n                          onClick={e => {\r\n                            this.toggleFollow(w._id, false);\r\n                          }}\r\n                        >\r\n                          <Star />\r\n                        </Fab>\r\n                      </ListItem>\r\n                    );\r\n                  })\r\n                }\r\n                {\r\n                  otherWorlds.map((w, key) => {\r\n                    return (\r\n                      <ListItem key={key}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          href={`/world/details/${w._id}`}\r\n                        >\r\n                          <ListItemText primary={w.Name} />\r\n                        </Button>\r\n                        <Fab\r\n                          size=\"small\"\r\n                          color=\"primary\"\r\n                          onClick={e => {\r\n                            this.toggleFollow(w._id, true);\r\n                          }}\r\n                        >\r\n                          <StarBorderIcon />\r\n                        </Fab>\r\n                      </ListItem>\r\n                    );\r\n                  })\r\n                }\r\n              </List>\r\n            </Grid>\r\n          </Grid> :\r\n          <div>\r\n            {\r\n              followingWorlds.map((w, key) => {\r\n                return (\r\n                  <ListItem key={key}>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      href={`/world/details/${w._id}`}\r\n                    >\r\n                      <ListItemText primary={w.Name} />\r\n                    </Button>\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n          </div>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((prop, key) => {\r\n              return (\r\n                <ListItem key={key}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    href={`/world/details/${prop._id}`}\r\n                  >\r\n                    <ListItemText primary={prop.Name} />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            });\r\n      return (\r\n        <div>\r\n          <ListItem>\r\n            <ListItemText primary={\"My Worlds\"} />\r\n          </ListItem>\r\n          <ListItem>\r\n            <Button\r\n              fullWidth\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              href={`/world/create`}\r\n            >\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </Button>\r\n          </ListItem>\r\n          {worldLinks}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // I normally like to put things like this in componentDidMount,\r\n    // but there it won't have access to anything in this.props.\r\n    // console.log(this.props.user);\r\n    // if (this.props.user !== null) {\r\n    //   this.api.getWorldsForUser().then(res => {\r\n    //     if (res.worlds !== undefined)\r\n    //       this.props.setWorlds(res.worlds);\r\n    //   });\r\n    // }\r\n    return (\r\n      <List>\r\n        {this.brand()}\r\n        <Divider light />\r\n        {this.links()}\r\n        {this.publicWorlds()}\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst Sidebar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default Sidebar;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { selectPage } from \"../../redux/actions/index\";\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    if (\r\n      this.props.selectedPage === null ||\r\n      `/${this.props.selectedPage}` === window.location.pathname\r\n    ) {\r\n      return (\r\n        <div className=\"col-sm-12\">\r\n          Forum Menu Page!\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <Redirect\r\n          to={`/${this.props.selectedPage}`}\r\n        />\r\n      );\r\n    }\r\n  }\r\n}\r\nconst ForumMenuPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ForumMenuPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport { userLogin, selectPage, setWorlds, setFollowingWorlds } from \"../../redux/actions/index\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Cookies from \"universal-cookie\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from '../../api';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    selectedPage: state.app.selectedPage, \r\n    user: state.app.user, \r\n    loginError: state.app.loginError,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    userLogin: user => dispatch(userLogin(user)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const cookies = new Cookies();\r\n    const emailCookie = cookies.get('email');\r\n    const passCookie = cookies.get('password');\r\n    this.state = {\r\n      formMode: \"login\",\r\n      email: (emailCookie === undefined ? \"\" : emailCookie),\r\n      password: (passCookie === undefined ? \"\" : passCookie),\r\n      confirmEmail: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        email: { valid: true, message: \"\" }, \r\n        password: { valid: true, message: \"\" }, \r\n        confirmEmail: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" },\r\n        firstName: { valid: true, message: \"\" },\r\n        lastName: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      remember: false,\r\n      message: \"\",\r\n      firstName: \"\",\r\n      lastName: \"\",\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    if (this.state.email) {\r\n      this.validateField(\"email\");\r\n      this.validateField(\"password\");\r\n      this.setState({remember: true});\r\n    }\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"firstName\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"First Name is too short\";\r\n        break;\r\n      case \"lastName\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Last Name is too short\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const emailValid = this.validateField(\"email\");\r\n    let confirmEmailValid = { valid: true, message: \"\" };\r\n    let passwordValid = { valid: true, message: \"\" };\r\n    let confirmPasswordValid = { valid: true, message: \"\" };\r\n    let firstNameValid = { valid: true, message: \"\" };\r\n    let lastNameValid = { valid: true, message: \"\" };\r\n    switch (this.state.formMode) {\r\n      case \"Login\":\r\n        passwordValid = this.validateField(\"password\");\r\n        break;\r\n      case \"Register\":\r\n        confirmEmailValid = this.validateField(\"confirmEmail\");\r\n        passwordValid = this.validateField(\"password\");\r\n        confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n        firstNameValid = this.validateField(\"firstName\");\r\n        lastNameValid = this.validateField(\"lastName\");\r\n      break;\r\n      default:\r\n      break;\r\n    }\r\n    const formValid = \r\n      emailValid.valid && \r\n      passwordValid.valid && \r\n      confirmEmailValid.valid && \r\n      confirmPasswordValid.valid && \r\n      firstNameValid.valid &&\r\n      lastNameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.email = emailValid;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmEmail = confirmEmailValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    fieldValidation.firstName = firstNameValid;\r\n    fieldValidation.lastName = lastNameValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      email: this.state.email,\r\n      password: this.state.password,\r\n      firstName: this.state.firstName,\r\n      lastName: this.state.lastName,\r\n      followingWorlds: this.props.followingWorlds\r\n    };\r\n    if (this.state.formMode === \"login\") {\r\n      this.api.login(user).then(res => {\r\n        if (res.user === null) {\r\n          let errors = this.state.fieldValidation;\r\n          errors.loginError = { message: res.message, valid: false, show: true };\r\n          this.setState({ fieldValidation: errors, waiting: false });\r\n        }\r\n        else {\r\n          if (this.state.remember) {\r\n            const cookies = new Cookies();\r\n            cookies.set('email', this.state.email);\r\n            cookies.set('password', this.state.password);\r\n          }\r\n          this.api.getWorldsForUser(res.user._id).then(res => {\r\n            this.props.setWorlds(res.worlds);\r\n          });\r\n          console.log(res.user);\r\n          this.props.userLogin(res.user);\r\n          // this.props.setFollowingWorlds(res.user.followingWorlds);\r\n          this.setState({ redirectTo: \"/\" });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"register\") {\r\n      this.api.register(user).then(res => {\r\n        this.setState({ message: res.message, formMode: \"login\", fieldValidation: { \r\n          email: { valid: false, message: \"\" }, \r\n          password: { valid: false, message: \"\" }, \r\n          confirmEmail: { valid: false, message: \"\" }, \r\n          confirmPassword: { valid: false, message: \"\" },\r\n          firstName: { valid: false, message: \"\" },\r\n          lastName: { valid: false, message: \"\" },\r\n          waiting: false\r\n        }});\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"password\") {\r\n      this.api.sendReset(user).then(res => {\r\n        this.setState({ message: res.message, formMode: \"login\", fieldValidation: { \r\n          email: { valid: false, message: \"\" }, \r\n          password: { valid: false, message: \"\" }, \r\n          confirmEmail: { valid: false, message: \"\" }, \r\n          confirmPassword: { valid: false, message: \"\" },\r\n          firstName: { valid: false, message: \"\" },\r\n          lastName: { valid: false, message: \"\" }\r\n        },\r\n          waiting: false \r\n        });\r\n      })\r\n      .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  loginClick = () => {\r\n    this.setState({ formMode: \"login\" });\r\n  };\r\n\r\n  registerClick = () => {\r\n    this.setState({ formMode: \"register\" });\r\n  };\r\n\r\n  passwordClick = () => {\r\n    this.setState({ formMode: \"password\" });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null && \r\n      this.props.user !== null && \r\n      this.props.user !== undefined && \r\n      this.props.user.firstName !== undefined && \r\n      this.props.user.firstName !== \"\") {\r\n      return (<Redirect to={this.state.redirectTo} />);\r\n    }\r\n    else {\r\n      if (this.state.formMode === \"login\") {\r\n        return (\r\n          <div>\r\n            <Helmet>\r\n              <title>Author's Notebook: Login</title>\r\n            </Helmet>\r\n            <h2>Login</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        value={this.state.email}\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          checked={this.state.remember}\r\n                          onChange={this.handleUserInput}\r\n                          name=\"remember\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Remember Me\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"register\") {\r\n        return (\r\n          <div>\r\n            <h2>Register</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"firstName\">First Name</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"firstName\"\r\n                            name=\"firstName\"\r\n                            type=\"text\"\r\n                            value={this.state.firstName}\r\n                            error={ !this.state.fieldValidation.firstName.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={80}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.firstName.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                          fullWidth>\r\n                          <InputLabel htmlFor=\"lastName\">Last Name</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"lastName\"\r\n                            name=\"lastName\"\r\n                            type=\"text\"\r\n                            value={this.state.lastName}\r\n                            error={ !this.state.fieldValidation.lastName.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={80}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.lastName.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={this.state.email}\r\n                            error={ !this.state.fieldValidation.email.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={40}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                          fullWidth>\r\n                          <InputLabel htmlFor=\"confirmEmail\">Confirm Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"confirmEmail\"\r\n                            name=\"confirmEmail\"\r\n                            type=\"email\"\r\n                            error={ !this.state.fieldValidation.confirmEmail.valid }\r\n                            value={this.state.confirmEmail}\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={100}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.confirmEmail.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div> \r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"confirm-password\"\r\n                        name=\"confirmPassword\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.confirmPassword}\r\n                        error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={130}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>{\" \"}\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w200\" disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"password\") {\r\n        return (\r\n          <div>\r\n            <h2>Forgot Password?</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        value={this.state.email}\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w200\" disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default LoginPage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { selectPage } from \"../../redux/actions/index\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-12\">\r\n        Profile Page\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst UserEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default UserEditPage;\r\n","import React, { Component } from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\r\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\r\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n// import { Fab } from \"@material-ui/core\";\r\n\r\n/* \r\n  This component will be used by the WorldDetails component.  It will\r\n  have a link at the top for creating new Things, and will list all\r\n  Things in the selected World, allowing navigation to their Details.  \r\n  The List will have pagination and filtering controls to make it \r\n  easier to manage.\r\n*/\r\nconst mapStateToProps = state => {\r\n  return { \r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorld: state.app.selectedWorld,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n  };\r\n}\r\nclass Index extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      expandedPanel: false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleChange_old = panel => (event, isExpanded) => {\r\n    this.setState({expandedPanel: isExpanded ? panel : false});\r\n  };\r\n  handleChange = panel => {\r\n    this.setState({expandedPanel: this.state.expandedPanel === panel ? false : panel });\r\n  };\r\n\r\n  renderListForType(type) {\r\n    // TODO: Add a PluralName field to types so I can use it here.  It may end up being useful other places too.\r\n    const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              href={`/thing/create/type_id_${type._id}`}>\r\n              <Add/><ListItemText primary={`Create New ${type.Name}`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            things.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    href={`/thing/details/${thing._id}`}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMajorTypelessThings() {\r\n    const majorLess = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              href={`/thing/create`}>\r\n              <Add/><ListItemText primary={`Create New Thing`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            majorLess.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    href={`/thing/details/${thing._id}`}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render_old() {\r\n    const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n\r\n    return (\r\n      <div>\r\n        <ExpansionPanel expanded={this.state.expandedPanel === \"TYPES\"} onChange={this.handleChange(\"TYPES\")}>\r\n          <ExpansionPanelSummary\r\n            expandIcon={<ExpandMoreIcon />}\r\n          >\r\n            Types ({this.props.types.length})\r\n          </ExpansionPanelSummary>\r\n          <ExpansionPanelDetails>\r\n            <List style={{ width: \"240px\" }}>\r\n              <ListItem>\r\n                <Button \r\n                  fullWidth variant=\"contained\" color=\"primary\" \r\n                  href={`/type/create`}>\r\n                  <Add/><ListItemText primary={`Create New Type`} />\r\n                </Button>\r\n              </ListItem>\r\n              {\r\n                this.props.types.map((type, i) => {\r\n                  return (\r\n                    <ListItem key={i}>\r\n                      <Button \r\n                        fullWidth variant=\"contained\" color=\"primary\" \r\n                        href={`/type/details/${type._id}`}>\r\n                        <ListItemText primary={type.Name} className=\"marginLeft\" />\r\n                      </Button>\r\n                    </ListItem>\r\n                  );\r\n                })\r\n              }\r\n            </List>\r\n          </ExpansionPanelDetails>\r\n        </ExpansionPanel>\r\n        { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n          const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n          return (\r\n          <ExpansionPanel key={i} expanded={this.state.expandedPanel === type._id} onChange={this.handleChange(type._id)}>\r\n            <ExpansionPanelSummary\r\n              expandIcon={<ExpandMoreIcon />}\r\n            >\r\n              {type.Name}s ({things.length})\r\n            </ExpansionPanelSummary>\r\n            <ExpansionPanelDetails>\r\n                <List style={{ width: \"240px\" }}>\r\n                  <ListItem>\r\n                    <Button \r\n                      fullWidth variant=\"contained\" color=\"primary\" \r\n                      href={`/thing/create/type_id_${type._id}`}>\r\n                      <Add/><ListItemText primary={`Create New ${type.Name}`} />\r\n                    </Button>\r\n                  </ListItem>\r\n                  {\r\n                    things.map((thing, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button \r\n                            fullWidth variant=\"contained\" color=\"primary\" \r\n                            href={`/thing/details/${thing._id}`}>\r\n                            <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })\r\n                  }\r\n                </List>\r\n            </ExpansionPanelDetails>\r\n          </ExpansionPanel>\r\n          );\r\n        })}\r\n        <ExpansionPanel expanded={this.state.expandedPanel === \"OTHER\"} onChange={this.handleChange(\"OTHER\")}>\r\n          <ExpansionPanelSummary\r\n            expandIcon={<ExpandMoreIcon />}\r\n          >\r\n            Other Things ({majorless.length})\r\n          </ExpansionPanelSummary>\r\n          <ExpansionPanelDetails>\r\n            <List style={{ width: \"240px\" }}>\r\n              <ListItem>\r\n                <Button \r\n                  fullWidth variant=\"contained\" color=\"primary\" \r\n                  href={`/thing/create`}>\r\n                  <Add/><ListItemText primary={`Create New Thing`} />\r\n                </Button>\r\n              </ListItem>\r\n              {\r\n                majorless.map((thing, i) => {\r\n                  return (\r\n                    <ListItem key={i}>\r\n                      <Button \r\n                        fullWidth variant=\"contained\" color=\"primary\" \r\n                        href={`/thing/details/${thing._id}`}>\r\n                        <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                      </Button>\r\n                    </ListItem>\r\n                  );\r\n                })\r\n              }\r\n            </List>\r\n          </ExpansionPanelDetails>\r\n        </ExpansionPanel>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n    const buttons = this.props.selectedWorld !== null && this.props.user !== null && this.props.selectedWorld.Owner === this.props.user._id;\r\n\r\n    return (\r\n      <div>\r\n        <List>\r\n          <ListItem>\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                {this.state.expandedPanel === \"TYPES\" ? \r\n                    <Tooltip title={`Collapse Types`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                          <KeyboardArrowDownIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  :\r\n                    <Tooltip title={`Expand Types`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                        <KeyboardArrowRightIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                }\r\n                <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Types (${this.props.types.length})`}</span>\r\n                { buttons ?\r\n                  <Tooltip title={`Create New Type`}>\r\n                    <Button \r\n                      href={`/type/create`}>\r\n                      <Add/>\r\n                    </Button>\r\n                  </Tooltip> \r\n                : \"\" }\r\n              </Grid>\r\n              {this.state.expandedPanel === \"TYPES\" ? \r\n                <Grid item>\r\n                  <List style={{ maxWidth: \"300px\" }}>\r\n                    {\r\n                      this.props.types.map((type, i) => {\r\n                        return (\r\n                          <ListItem key={i}>\r\n                            <Tooltip title={`Details for ${type.Name}`}>\r\n                              <Button \r\n                                fullWidth variant=\"contained\" color=\"primary\" \r\n                                href={`/type/details/${type._id}`}>\r\n                                <ListItemText primary={type.Name} className=\"marginLeft\" />\r\n                              </Button>\r\n                            </Tooltip>\r\n                            { buttons ?\r\n                              <Grid container spacing={0} direction=\"row\">\r\n                                <Grid item xs={6}>\r\n                                  <Tooltip title={`Create New ${type.Name}`}>\r\n                                    <Button \r\n                                      href={`/thing/create/type_id_${type._id}`}>\r\n                                      <Add/>\r\n                                    </Button>\r\n                                  </Tooltip>\r\n                                </Grid>\r\n                                <Grid item xs={6}>\r\n                                  <Tooltip title={`Edit ${type.Name}`}>\r\n                                    <Button \r\n                                      href={`/type/edit/${type._id}`}>\r\n                                      <Edit/>\r\n                                    </Button>\r\n                                  </Tooltip>\r\n                                </Grid>\r\n                              </Grid>\r\n                            : \"\" }\r\n                          </ListItem>\r\n                        );\r\n                      })\r\n                    }\r\n                  </List>\r\n                </Grid>\r\n              : \"\" }\r\n            </Grid>\r\n          </ListItem>\r\n          { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n            const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n            return (\r\n              <ListItem key={i}>\r\n                <Grid container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    {this.state.expandedPanel === type._id ? \r\n                      <Tooltip title={`Collapse ${type.Name}s`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(type._id)}}>\r\n                          <KeyboardArrowDownIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                      :\r\n                      <Tooltip title={`Expand ${type.Name}s`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(type._id)}}>\r\n                          <KeyboardArrowRightIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                    }\r\n                    <Tooltip title={`Details for ${type.Name}`}>\r\n                      <Button \r\n                        href={`/type/details/${type._id}`}>\r\n                        <ListItemText>{type.Name}s ({things.length})</ListItemText>\r\n                      </Button>\r\n                    </Tooltip>\r\n                    { buttons ?\r\n                      <span>\r\n                        <Tooltip title={`Create New ${type.Name}`}>\r\n                          <Button \r\n                            href={`/thing/create/type_id_${type._id}`}>\r\n                            <Add/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                        <Tooltip title={`Edit ${type.Name}`}>\r\n                          <Button \r\n                            href={`/type/edit/${type._id}`}>\r\n                            <Edit/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                      </span>\r\n                    : \"\" }\r\n                  </Grid>\r\n                  {this.state.expandedPanel === type._id ? \r\n                    <Grid item>\r\n                      <List style={{ maxWidth: \"300px\" }}>\r\n                        {\r\n                          things.map((thing, j) => {\r\n                            return (\r\n                              <ListItem key={j}>\r\n                                <Tooltip title={`Details for ${thing.Name}`}>\r\n                                  <Button \r\n                                    fullWidth variant=\"contained\" color=\"primary\" \r\n                                    href={`/thing/details/${thing._id}`}>\r\n                                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                  </Button>\r\n                                </Tooltip>\r\n                                { buttons ?\r\n                                <Tooltip title={`Edit ${thing.Name}`}>\r\n                                  <Button \r\n                                    href={`/thing/edit/${thing._id}`}>\r\n                                    <Edit/>\r\n                                  </Button>\r\n                                </Tooltip>\r\n                                : \"\" }\r\n                              </ListItem>\r\n                            );\r\n                          })\r\n                        }\r\n                      </List>\r\n                    </Grid>\r\n                  : \"\" }\r\n                </Grid>\r\n              </ListItem>\r\n            );\r\n          })}\r\n          <ListItem>\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                {this.state.expandedPanel === \"OTHER\" ? \r\n                  <Tooltip title={`Collapse Other Things`}>\r\n                    <Button \r\n                      onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                      <KeyboardArrowDownIcon/>\r\n                    </Button>\r\n                  </Tooltip>\r\n                  :\r\n                  <Tooltip title={`Expand Other Things`}>\r\n                    <Button \r\n                      onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                      <KeyboardArrowRightIcon/>\r\n                    </Button>\r\n                  </Tooltip>\r\n                }\r\n                <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Other Things (${majorless.length})`}</span>\r\n                { buttons ?\r\n                <Tooltip title={`Create New Thing`}>\r\n                  <Button \r\n                    href={`/thing/create`}>\r\n                    <Add/>\r\n                  </Button>\r\n                </Tooltip>\r\n                : \"\" }\r\n              </Grid>\r\n              {this.state.expandedPanel === \"OTHER\" ? \r\n                <Grid item>\r\n                  <List style={{ maxWidth: \"300px\" }}>\r\n                    {\r\n                      majorless.map((thing, i) => {\r\n                        return (\r\n                          <ListItem key={i}>\r\n                            <Tooltip title={`Details for ${thing.Name}`}>\r\n                              <Button \r\n                                fullWidth variant=\"contained\" color=\"primary\" \r\n                                href={`/thing/details/${thing._id}`}>\r\n                                <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                              </Button>\r\n                            </Tooltip>\r\n                            { buttons ?\r\n                            <Tooltip title={`Edit ${thing.Name}`}>\r\n                              <Button \r\n                                href={`/thing/edit/${thing._id}`}>\r\n                                <Edit/>\r\n                              </Button>\r\n                            </Tooltip>\r\n                            : \"\" }\r\n                          </ListItem>\r\n                        );\r\n                      })\r\n                    }\r\n                  </List>\r\n                </Grid>\r\n              : \"\" }\r\n            </Grid>\r\n          </ListItem>\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst ThingIndex = connect(mapStateToProps, mapDispatchToProps)(Index);\r\nexport default ThingIndex;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { selectWorld, setTypes, setThings, setWorlds, setPublicWorlds } from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\nimport Index from \"./Index\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Delete from \"@material-ui/icons/Delete\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { Fab } from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      world: null,\r\n      modalOpen: false,\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n  componentDidMount() {\r\n    const { id } = this.props.match.params;\r\n    this.props.selectWorld(id);\r\n    setTimeout(() => {\r\n      this.api.selectWorld(id).then(res => {\r\n        console.log(res);\r\n        this.getTypes();\r\n      });\r\n    }, 500);\r\n  }\r\n\r\n  getTypes() {\r\n    this.api.getTypesForWorld(this.props.selectedWorldID).then(res => {\r\n      // console.log(res);\r\n      if (res !== undefined && res.message === undefined) {\r\n        // Add Supers to each type\r\n        const types = res.types;\r\n        types.forEach(t=> {\r\n          t.Supers = [];\r\n          t.SuperIDs.forEach(sID=> {\r\n            t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n          });\r\n        });\r\n        this.props.setTypes(types);\r\n        this.getThings();\r\n      }\r\n    });\r\n  }\r\n  getThings() {\r\n    this.api.getThingsForWorld(this.props.selectedWorldID).then(res => {\r\n      console.log(res);\r\n      if (res !== undefined && res.message === undefined) {\r\n        const things = res.things;\r\n        things.forEach(t=> {\r\n          t.Types = [];\r\n          t.TypeIDs.forEach(tID=> {\r\n            t.Types = t.Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n          });\r\n        });\r\n        this.props.setThings(things);\r\n      }\r\n    });\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteWorld(this.props.selectedWorldID).then(res=>{\r\n      let worlds = this.props.worlds.filter(t=>t._id!==this.props.selectedWorldID);\r\n      this.props.setWorlds(worlds);\r\n      worlds = this.props.publicWorlds.filter(t=>t._id!==this.props.selectedWorldID);\r\n      this.props.setPublicWorlds(worlds);\r\n      this.api.selectWorld(null);\r\n      this.props.selectWorld(null);\r\n      this.setState({modalOpen: false, redirectTo: `/`});\r\n    });\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && !this.props.selectedWorld.Public && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          {this.props.selectedWorld === null ? (\r\n            \"\"\r\n          ) : (\r\n            <Grid item container spacing={0} direction=\"row\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item xs={9}>\r\n                <h2>{this.props.selectedWorld.Name}</h2>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                { this.props.user !== null && this.props.user !== null && this.props.selectedWorld.Owner === this.props.user._id ?\r\n                <List>\r\n                  <ListItem>\r\n                    <Tooltip title={`Edit ${this.props.selectedWorld.Name}`}>\r\n                      <Fab size=\"small\" color=\"primary\"\r\n                        href={`/world/edit/${this.props.selectedWorld._id}`}\r\n                      >\r\n                      <Edit />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <Tooltip title={`Delete ${this.props.selectedWorld.Name}`}>\r\n                      <Fab size=\"small\" color=\"primary\"\r\n                        onClick={e => {this.setState({modalOpen: true})}}\r\n                      >\r\n                        <Delete />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                  </ListItem>\r\n                </List>\r\n                : \"\" }\r\n              </Grid>\r\n            </Grid>\r\n          )}\r\n          <Grid item>\r\n            <Index />\r\n          </Grid>\r\n          {/* <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item xs={6}>\r\n              <TypeIndex />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <ThingIndex />\r\n            </Grid>\r\n          </Grid> */}\r\n          <Modal\r\n              aria-labelledby=\"delete-thing-modal\"\r\n              aria-describedby=\"delete-thing-modal-description\"\r\n              open={this.state.modalOpen}\r\n              onClose={e => {this.setState({modalOpen: false})}}\r\n            >\r\n              <div style={this.getModalStyle()} className=\"paper\">\r\n                <Grid container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    Are you sure you want to delete {this.props.selectedWorld !== null ? this.props.selectedWorld.Name : \"\"}?\r\n                  </Grid>\r\n                  <Grid item>\r\n                    (All external references to it will be left alone and may not work correctly)\r\n                  </Grid>\r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={this.delete}\r\n                      >\r\n                        Yes\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        onClick={e => {this.setState({modalOpen: false})}}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\nconst WorldDetailsPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldDetailsPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectPage,\r\n  selectWorld,\r\n  addWorld,\r\n  updateWorld\r\n} from \"../../redux/actions/index\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    addWorld: world => dispatch(addWorld(world)),\r\n    updateWorld: world => dispatch(updateWorld(world))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Public: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        const { id } = this.props.match.params;\r\n        let world = this.props.worlds.filter(w => w._id === id);\r\n        if (world.length > 0) {\r\n          world = world[0];\r\n          this.setState({\r\n            Name: world.Name,\r\n            Public: world.Public,\r\n            _id: id\r\n          });\r\n          this.api.selectWorld(id);\r\n          this.props.selectWorld(id);\r\n        }\r\n      } else {\r\n        this.api.selectWorld(null);\r\n        this.props.selectWorld(null);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in World Names\";\r\n        else if (value.length < 4) {\r\n          valid = false;\r\n          message = \"World Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.worlds.filter(\r\n              w => w.Name === value && w._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This World Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const world = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name,\r\n      Public: this.state.Public,\r\n      Owner: this.props.user._id\r\n    };\r\n\r\n    if (world._id === null) {\r\n      this.api\r\n        .createWorld(world)\r\n        .then(res => {\r\n          if (res.message  !== undefined) {\r\n            this.setState({ message: res.message });\r\n          }\r\n          else {\r\n            world._id = res.worldID;\r\n            this.props.addWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${res.worldID}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateWorld(world)\r\n        .then(res => {\r\n          if (res.message !== `World ${world.Name} updated!`) {\r\n            this.setState({ message: res.message });\r\n          }\r\n          else {\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item>\r\n            <h2>\r\n              {this.state._id === null ? \"Create New World\" : \"Edit World\"}\r\n            </h2>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.Public}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"Public\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Public\"\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                style={{ marginLeft: \"4px\" }}\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  this.setState({\r\n                    redirectTo: `/`\r\n                  });\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst WorldEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldEditPage;","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectPage,\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  setTypes\r\n} from \"../../redux/actions/index\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Delete from \"@material-ui/icons/Delete\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport { Fab, Modal, Grid, Button, Tooltip, List, ListItem, ListItemText } from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  const type = state.app.selectedType;\r\n  const subTypes =\r\n    type === null\r\n      ? []\r\n      : state.app.types.filter(t => t.SuperIDs.includes(type._id));\r\n  const things =\r\n    type === null\r\n      ? []\r\n      : state.app.things.filter(t => t.TypeIDs.includes(type._id));\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: type,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    subTypes: subTypes,\r\n    instances: things,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    setTypes: types => dispatch(setTypes(types))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Supers: [],\r\n      Major: false,\r\n      Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) { // When I move to storing more in session, this is the kind of place where I'll check.\r\n        this.api.getType(this.props.selectedWorldID, id).then(res => {\r\n          if (res.message === undefined) {\r\n            const supers = this.props.types.filter(type =>\r\n              res.SuperIDs.includes(type._id)\r\n            );\r\n            this.setState({\r\n              Name: res.Name,\r\n              Description: res.Description,\r\n              _id: id,\r\n              Supers: supers,\r\n              Major: res.Major\r\n            });\r\n            this.props.updateSelectedType(res);\r\n          }\r\n          else {\r\n            console.log(res.message);\r\n          }\r\n        });\r\n      } else {\r\n        this.props.updateSelectedType({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Supers: [],\r\n          AttributesArr: [],\r\n          Major: false\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteType(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      const types = this.props.types.filter(t=>t._id!==this.state._id);\r\n      this.props.setTypes(types);\r\n      this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  render() { \r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && !this.props.selectedWorld.Public && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const references = this.props.types.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.props.selectedWorld === null ? `Author's Notebook` : `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item xs={6}>\r\n              <h2>{this.state.Name}</h2>\r\n            </Grid>\r\n            <Grid item sm={3} xs={6}>\r\n              <h3>{this.state.Major ? \"Major Type\" : \"\"}</h3>\r\n            </Grid>\r\n            <Grid item sm={3} xs={12}>\r\n              { this.props.user !== null && this.props.selectedWorld !== null && this.props.selectedWorld.Owner === this.props.user._id ?\r\n              <List>\r\n                <ListItem>\r\n                  <Tooltip title={`Create New ${this.state.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      href={`/thing/create/type_id_${this.state._id}`}\r\n                    >\r\n                      <Add />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <Tooltip title={`Edit ${this.state.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      href={`/type/edit/${this.state._id}`}\r\n                    >\r\n                      <Edit />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <Tooltip title={`Delete ${this.state.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {this.setState({modalOpen: true})}}\r\n                    >\r\n                      <Delete />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </ListItem>\r\n              </List>\r\n              : \"\" }\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n              <Grid item>{this.state.Description}</Grid>\r\n              <Grid item>\r\n                Attributes\r\n                <List>\r\n                  {this.props.selectedType === null ||\r\n                  this.props.selectedType === undefined\r\n                    ? \"\"\r\n                    : this.props.selectedType.AttributesArr.map(\r\n                        (attribute, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <ListItemText>\r\n                                {attribute.Name}:&nbsp;\r\n                                {attribute.Type === \"Options\" ? (\r\n                                  <span>\r\n                                    Options:\r\n                                    {attribute.Options.map((option, j) => {\r\n                                      return (\r\n                                        <span key={j}>\r\n                                          {j === 0 ? \" \" : \", \"}\r\n                                          {option}\r\n                                        </span>\r\n                                      );\r\n                                    })}\r\n                                  </span>\r\n                                ) : attribute.Type === \"Type\" ? (\r\n                                  <Button\r\n                                    variant=\"contained\"\r\n                                    color=\"primary\"\r\n                                    href={`/type/details/${attribute.Type2}`}\r\n                                  >\r\n                                    <ListItemText primary={this.props.types.filter(t=>t._id === attribute.Type2)[0].Name}/>\r\n                                  </Button>\r\n                                ) : attribute.Type === \"List\" ? (\r\n                                  <span>\r\n                                    List:&nbsp;\r\n                                    {attribute.ListType === \"Options\" ? (\r\n                                      <span>\r\n                                        Options:\r\n                                        {attribute.Options.map((option, j) => {\r\n                                          return (\r\n                                            <span key={j}>\r\n                                              {j === 0 ? \" \" : \", \"}\r\n                                              {option}\r\n                                            </span>\r\n                                          );\r\n                                        })}\r\n                                      </span>\r\n                                    ) : attribute.ListType === \"Type\" ? (\r\n                                      <Button\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                        href={`/type/details/${attribute.Type2}`}\r\n                                      >\r\n                                        <ListItemText primary={this.props.types.filter(t=>t._id === attribute.Type2)[0].Name}/>\r\n                                      </Button>\r\n                                    ) : (\r\n                                      attribute.ListType\r\n                                    )}\r\n                                  </span>\r\n                                ) : (\r\n                                  attribute.Type\r\n                                )}\r\n                              </ListItemText>\r\n                            </ListItem>\r\n                          );\r\n                        }\r\n                      )}\r\n                </List>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n              {this.state.Supers.length === 0 ? (\r\n                \"\"\r\n              ) : (\r\n                <Grid item>\r\n                  <List>\r\n                    <ListItem>\r\n                      <ListItemText primary={\"Super Types\"} />\r\n                    </ListItem>\r\n                    {this.state.Supers.map((superType, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button fullWidth\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            href={`/type/details/${superType._id}`}\r\n                          >\r\n                            <ListItemText primary={superType.Name} />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })}\r\n                  </List>\r\n                </Grid>\r\n              )}\r\n              {this.props.subTypes.length === 0 ? (\r\n                \"\"\r\n              ) : (\r\n                <Grid item>\r\n                  <List>\r\n                    <ListItem>\r\n                      <ListItemText primary={\"Sub Types\"} />\r\n                    </ListItem>\r\n                    {this.props.subTypes.map((sub, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button fullWidth\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            href={`/type/details/${sub._id}`}\r\n                          >\r\n                            <ListItemText primary={sub.Name} />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })}\r\n                  </List>\r\n                </Grid>\r\n              )}\r\n              {references.length === 0 ? (\r\n                \"\"\r\n              ) : (\r\n                <Grid item>\r\n                  <List>\r\n                    <ListItem>\r\n                      <ListItemText primary={\"Referenced in:\"} />\r\n                    </ListItem>\r\n                    {references.map((type, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button fullWidth\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            href={`/type/details/${type._id}`}\r\n                          >\r\n                            <ListItemText primary={type.Name} />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })}\r\n                  </List>\r\n                </Grid>\r\n              )}\r\n              {this.props.instances.length === 0 ? (\r\n                \"\"\r\n              ) : (\r\n                <Grid item>\r\n                  <List>\r\n                    <ListItem>\r\n                      <ListItemText primary={\"Instances\"} />\r\n                    </ListItem>\r\n                    {this.props.instances.map((thing, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button fullWidth\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            href={`/thing/details/${thing._id}`}\r\n                          >\r\n                            <ListItemText primary={thing.Name} />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })}\r\n                  </List>\r\n                </Grid>\r\n              )}\r\n            </Grid>\r\n          </Grid>\r\n          <Modal\r\n            aria-labelledby=\"delete-type-modal\"\r\n            aria-describedby=\"delete-type-modal-description\"\r\n            open={this.state.modalOpen}\r\n            onClose={e => {this.setState({modalOpen: false})}}\r\n          >\r\n            <div style={this.getModalStyle()} className=\"paper\">\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  Are you sure you want to delete {this.state.Name}?\r\n                </Grid>\r\n                <Grid item>\r\n                  (All references to it will be left alone and may not work correctly)\r\n                </Grid>\r\n                <Grid item container spacing={1} direction=\"row\">\r\n                  <Grid item xs={6}>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      onClick={this.delete}\r\n                    >\r\n                      Yes\r\n                    </Button>\r\n                  </Grid>\r\n                  <Grid item xs={6}>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      onClick={e => {this.setState({modalOpen: false})}}\r\n                    >\r\n                      Cancel\r\n                    </Button>\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </div>\r\n          </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport DeleteForever from \"@material-ui/icons/DeleteForever\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ChipInput from \"material-ui-chip-input\";\r\n\r\nconst handleTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"Type\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleType2Change = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"Type2\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond(newType) {\r\n      attr[\"Type2\"] = newType._id;\r\n      props.onChange(attr);\r\n    }\r\n    props.onNewType(respond);\r\n  }\r\n  else \r\n    props.onChange(attr);\r\n};\r\n\r\nconst handleListTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"ListType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleOptionsChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.Options = e;\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [name, changeName] = useState(props.attribute.Name);\r\n\r\n  const attributeTypes = [\r\n    \"Text\",\r\n    \"Number\",\r\n    \"True/False\",\r\n    \"Options\", \r\n    \"Type\", \r\n    \"List\"\r\n  ];\r\n  const type =\r\n    props.attribute.Type === \"\" ? attributeTypes[0] : props.attribute.Type;\r\n\r\n  const listTypes = [\r\n    \"Text\",\r\n    \"Options\", \r\n    \"Type\"\r\n  ];\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"AttrName\">Name</InputLabel>\r\n          <OutlinedInput\r\n            disabled={props.attribute.FromSupers.length > 0}\r\n            id=\"AttrName\"\r\n            name=\"AttrName\"\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={name}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                Name: name,\r\n                Type: props.attribute.Type,\r\n                Options: props.attribute.Options,\r\n                ListType: props.attribute.ListType,\r\n                FromSupers: props.attribute.FromSupers,\r\n                Type2: props.attribute.Type2,\r\n                AttributeTypes: props.attribute.AttributeTypes\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n            Attribute Type\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"attribute-type-label\"\r\n            id=\"attribute-type\"\r\n            disabled={props.attribute.FromSupers.length > 0} \r\n            value={props.attribute.Type}\r\n            onChange={e => {handleTypeChange(e, props)}}\r\n            fullWidth\r\n            labelWidth={100}\r\n          >\r\n            {attributeTypes.map((type, i) => {\r\n              return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        {type === \"Options\" ? (\r\n          <ChipInput\r\n            variant=\"outlined\"\r\n            disabled={props.attribute.FromSupers.length > 0}\r\n            defaultValue={props.attribute.Options}\r\n            onChange={chips => handleOptionsChange(chips, props)}\r\n          />\r\n        ) : type === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type2\" id=\"type2-label\">\r\n              Defined Type\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type2-label\"\r\n              id=\"type2\"\r\n              disabled={props.attribute.FromSupers.length > 0} \r\n              value={props.attribute.Type2}\r\n              onChange={e => {handleType2Change(e, props)}}\r\n              fullWidth\r\n              labelWidth={100}\r\n            >\r\n              <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n              {props.types.map((type, i) => {\r\n                return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : type === \"List\" ? (\r\n          <Grid container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                  List Type\r\n                </InputLabel>\r\n                <Select\r\n                  labelId=\"list-type-label\"\r\n                  id=\"list-type\"\r\n                  disabled={props.attribute.FromSupers.length > 0} \r\n                  value={props.attribute.ListType}\r\n                  onChange={e => {handleListTypeChange(e, props)}}\r\n                  fullWidth\r\n                  labelWidth={70}\r\n                >\r\n                  {listTypes.map((type, i) => {\r\n                    return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                  })}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            { props.attribute.ListType === \"Type\" ? \r\n              (\r\n                <Grid item>\r\n                  <FormControl variant=\"outlined\" fullWidth>\r\n                    <InputLabel htmlFor=\"type2\" id=\"type2-label\">\r\n                      Defined Type\r\n                    </InputLabel>\r\n                    <Select\r\n                      labelId=\"type2-label\"\r\n                      id=\"type2\"\r\n                      disabled={props.attribute.FromSupers.length > 0} \r\n                      value={props.attribute.Type2}\r\n                      onChange={e => {handleType2Change(e, props)}}\r\n                      fullWidth\r\n                      labelWidth={100}\r\n                    >\r\n                      <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                      {props.types.map((type, i) => {\r\n                        return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                      })}\r\n                    </Select>\r\n                  </FormControl>\r\n                </Grid>\r\n              ) : props.attribute.ListType === \"Options\" ?\r\n              (\r\n                <Grid item>\r\n                  <ChipInput\r\n                    variant=\"outlined\"\r\n                    disabled={props.attribute.FromSupers.length > 0}\r\n                    defaultValue={props.attribute.Options}\r\n                    onChange={chips => handleOptionsChange(chips, props)}\r\n                  />\r\n                </Grid>\r\n              ) : \"\"\r\n            }\r\n          </Grid>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <Button\r\n          variant=\"contained\" color=\"primary\"\r\n          className=\"w200\" fullWidth\r\n          disabled={props.attribute.FromSupers.length > 0}\r\n          onClick={_ => props.onDelete(props.attribute)}\r\n          type=\"submit\"\r\n        >\r\n          <DeleteForever />\r\n        </Button>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport styled from \"styled-components\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport {\r\n  updateSelectedType,\r\n  updateAttributesArr,\r\n  addType\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport API from \"../../api\";\r\n\r\nconst Label = styled(\"label\")`\r\n  padding: 0 0 4px;\r\n  line-height: 1.5;\r\n  display: block;\r\n`;\r\n\r\n// It will let you add and remove attributes.\r\n// Each needs to have a unique name as part of validation.\r\n// Each also needs to have a valid type.\r\n// The type can be string, integer, double, enum, any Type\r\n// already defined for this world, or a list of any of the\r\n// other types.\r\n// In future versions I will add support for additional types:\r\n// Color, DateTime, Schedule.\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedType: state.app.selectedType,\r\n    attributesArr: state.app.attributesArr,\r\n    types: state.app.types,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    updateAttributesArr: arr => dispatch(updateAttributesArr(arr)),\r\n    addType: type => dispatch(addType(type)),\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      Name: \"\",\r\n      Type: \"Text\",\r\n      Options: [],\r\n      Type2: \"\",\r\n      ListType: \"\",\r\n      FromSupers: [],\r\n      AttributeTypes: [\"Text\", \"Number\", \"True/False\", \"Options\", \"Type\", \"List\"]\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      Name: value.Name,\r\n      Type: value.Type,\r\n      Options: value.Options,\r\n      Type2: value.Type2,\r\n      ListType: value.ListType,\r\n      FromSupers: value.FromSupers,\r\n      AttributeTypes: [\"Text\", \"Number\", \"True/False\", \"Options\", \"Type\", \"List\"]\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributesArr = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributesArr.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributesArr;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  };\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  addNewType = (respond) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({modalOpen: true, modalSubmit: respond});\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewType = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const type = {\r\n      _id: null,\r\n      Name: this.state.Name,\r\n      Description: \"\",\r\n      SuperIDs: [],\r\n      AttributesArr: [],\r\n      worldID: this.props.selectedWorldID,\r\n      Major: false\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createType(type)\r\n      .then(res => {\r\n        if (res.typeID !== undefined) {\r\n          type._id = res.typeID;\r\n          // Adds to props \r\n          this.props.addType(type);\r\n          // Calls respond back to Attribute to set the type\r\n          this.state.modalSubmit(type);\r\n          this.setState({\r\n            waiting: false, \r\n            modalOpen: false\r\n          });\r\n        }\r\n        else if (res.message !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.message \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item>\r\n          <Label>Attributes</Label>\r\n        </Grid>\r\n        <Grid item>\r\n          <List>\r\n            <ListItem>\r\n              <Button variant=\"contained\" color=\"primary\" onClick={this.newAttribute}>\r\n                <Add />\r\n                <ListItemText primary={\"Create New\"} />\r\n              </Button>\r\n            </ListItem>\r\n            {this.props.selectedType === null ||\r\n            this.props.selectedType === undefined\r\n              ? \"\"\r\n              : this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                  return (\r\n                    <ListItem key={i}>\r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        onChange={this.changeAttribute}\r\n                        onDelete={this.deleteAttribute}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        onNewType={this.addNewType}\r\n                      />\r\n                    </ListItem>\r\n                  );\r\n                })}\r\n          </List>\r\n        </Grid>\r\n        <Modal\r\n          aria-labelledby=\"new-type-modal\"\r\n          aria-describedby=\"new-type-modal-description\"\r\n          open={this.state.modalOpen}\r\n          onClose={e => {this.setState({modalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new Type a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewType}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({modalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectPage,\r\n  updateSelectedType,\r\n  addType,\r\n  updateType\r\n} from \"../../redux/actions/index\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: state.app.selectedType,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Supers: [],\r\n      Attributes: [],\r\n      Major: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        this.api.getType(this.props.selectedWorldID, id).then(res => {\r\n          if (res.message === undefined) {\r\n            const supers = this.props.types.filter(type =>\r\n              res.SuperIDs.includes(type._id)\r\n            );\r\n            this.setState({\r\n              Name: res.Name,\r\n              Description: res.Description,\r\n              _id: id,\r\n              Supers: supers,\r\n              Major: res.Major\r\n            });\r\n            this.props.updateSelectedType(res);\r\n          }\r\n          else {\r\n            this.setState({ message: res.message });\r\n          }\r\n        });\r\n      } else {\r\n        this.props.updateSelectedType({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Supers: [],\r\n          AttributesArr: [],\r\n          Major: false\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          if (value.filter(attr2 => attr2.Name === value[i].Name).length > 1) {\r\n            valid = false;\r\n            message = \"Attribute Names must be unique\";\r\n            break;\r\n          }\r\n          else if ((value[i].Type === \"Type\" || (value[i].Type === \"List\" && value[i].ListType === \"Type\")) && (value[i].Type2 === undefined || value[i].Type2 === null || value[i].Type2 === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].Type === \"Options\" || (value[i].Type === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrArrValid = this.validateField(\"AttributesArr\");\r\n    const formValid = nameValid.valid && attrArrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.AttributesArr = attrArrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const superIDs = this.state.Supers.map(s => {\r\n      return s._id;\r\n    });\r\n    const type = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name,\r\n      Description: this.state.Description,\r\n      SuperIDs: superIDs,\r\n      AttributesArr: this.props.selectedType.AttributesArr,\r\n      worldID: this.props.selectedWorld._id,\r\n      Major: this.state.Major,\r\n      ReferenceIDs: []\r\n    };\r\n    this.props.selectedType.AttributesArr.filter(a=>a.Type === \"Type\" || (a.Type === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n      if (!type.ReferenceIDs.includes(a.Type2)) {\r\n        type.ReferenceIDs.push(a.Type2);\r\n      }\r\n    });\r\n\r\n    if (type._id === null) {\r\n      this.api\r\n        .createType(type)\r\n        .then(res => {\r\n          if (res.typeID !== undefined) {\r\n            type._id = res.typeID;\r\n            this.props.addType(type);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n          else if (res.message !== undefined) {\r\n            this.setState({\r\n              waiting: false, \r\n              message: res.message \r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateType(type)\r\n        .then(res => {\r\n          if (res.message === `Type ${type.Name} updated!`) {\r\n            this.props.updateType(type);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n          else {\r\n            this.setState({\r\n              waiting: false, \r\n              message: res.message \r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  supersChange = (e, value) => {\r\n    let supers = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      supers.push(t);\r\n      supers = supers.concat(t.Supers);\r\n    }\r\n    this.setState({ Supers: supers });\r\n  };\r\n\r\n  addSuper = (selectedList, selectedItem) => {\r\n    selectedItem.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) selectedList.push(s);\r\n    });\r\n    const type = this.props.selectedType;\r\n    let attributes = [...type.AttributesArr];\r\n    for (let i = 0; i < selectedItem.AttributesArr.length; i++) {\r\n      const attribute = selectedItem.AttributesArr[i];\r\n      attribute.FromSupers.push(selectedItem._id);\r\n      const matches = attributes.filter(a => a.Name === attribute.Name);\r\n      if (matches.length === 0) {\r\n        // It's a new attribute.\r\n        attribute.index = attributes.length;\r\n        attributes.push(attribute);\r\n      } else {\r\n        // It's an existing attribute,\r\n        // so we just need to add the appropriate ids to FromSupers.\r\n        // TODO: I also need to make sure the type and details match.\r\n        const superIDs = [...matches[0].FromSupers];\r\n        for (let i = 0; i < attribute.FromSupers.length; i++) {\r\n          const superID = attribute.FromSupers[i];\r\n          if (!superIDs.includes(superID)) {\r\n            superIDs.push(superID);\r\n          }\r\n        }\r\n        matches[0].FromSupers = superIDs;\r\n      }\r\n    }\r\n    this.setState({ Supers: selectedList });\r\n    type.AttributesArr = attributes;\r\n    this.props.updateSelectedType(type);\r\n  }\r\n  \r\n  removeSuper = (selectedList, removedItem) => {\r\n    let supers = [];\r\n    let removeUs = [removedItem._id];\r\n    for (let i = 0; i < this.state.Supers.length; i++) {\r\n      const checkMe = this.props.types.filter(\r\n        t => t._id === this.state.Supers[i]._id\r\n      )[0];\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else supers.push(checkMe);\r\n    }\r\n    const type = this.props.selectedType;\r\n    let attributes = [...type.AttributesArr];\r\n    for (let i = 0; i < attributes.length; i++) {\r\n      const attribute = attributes[i];\r\n      let j = 0;\r\n      while (j < attribute.FromSupers.length) {\r\n        const checkMe = attribute.FromSupers[j];\r\n        if (removeUs.includes(checkMe)) {\r\n          attribute.FromSupers.splice(j, 1);\r\n        } else {\r\n          j++;\r\n        }\r\n      }\r\n    }\r\n    this.setState({ Supers: supers });\r\n    type.AttributesArr = attributes;\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const types =\r\n        this.props.types === undefined || this.state._id === null\r\n          ? this.props.types\r\n          : this.props.types.filter(type => type._id !== this.state._id);\r\n      \r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.props.selectedWorld === null ? `Author's Notebook` : `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item>\r\n            <h2>{this.state._id === null ? \"Create New Type\" : \"Edit Type\"}</h2>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"description\">Description</InputLabel>\r\n              <OutlinedInput\r\n                id=\"description\"\r\n                name=\"Description\"\r\n                type=\"text\"\r\n                value={this.state.Description}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={82}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.Major}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"Major\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Major Type\"\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <Multiselect\r\n              placeholder=\"Super Types\"\r\n              options={types}\r\n              selectedValues={this.state.Supers}\r\n              onSelect={this.addSuper}\r\n              onRemove={this.removeSuper}\r\n              displayValue=\"Name\"\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <AttributesControl />\r\n          </Grid>\r\n          <Grid item>\r\n            {/* <FormHelperText>\r\n              {this.state.fieldValidation.AttributesArr.message}\r\n            </FormHelperText> */}\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\" color=\"primary\"\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                style={{marginLeft: \"4px\"}}\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  if (this.props.selectedType._id === null) {\r\n                    this.setState({\r\n                      redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                    });\r\n                  }\r\n                  else {\r\n                    this.setState({\r\n                      redirectTo: `/type/details/${this.props.selectedType._id}`\r\n                    });\r\n                  }\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          {/* <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid> */}\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectPage,\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Delete from \"@material-ui/icons/Delete\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport API from \"../../api\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport { Fab, Tooltip } from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\n\r\nconst mapStateToProps = state => {\r\n  const thing = state.app.selectedThing;\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: thing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        this.api.getThing(this.props.selectedWorldID, id).then(res => {\r\n          console.log(res);\r\n          if (res.message === undefined) {\r\n            let Types = [];\r\n            res.TypeIDs.forEach(tID=> {\r\n              Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n            });\r\n            this.setState({\r\n              Name: res.Name,\r\n              Description: res.Description,\r\n              _id: id,\r\n              Types: Types\r\n            });\r\n            this.props.updateSelectedThing(res);\r\n          }\r\n          else {\r\n            console.log(res.message);\r\n          }\r\n        });\r\n      } else {\r\n        this.props.updateSelectedThing({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Types: [],\r\n          AttributesArr: []\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteThing(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      const things = this.props.things.filter(t=>t._id!==this.state._id);\r\n      this.props.setThings(things);\r\n      this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && !this.props.selectedWorld.Public && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      console.log(this.props.things);\r\n      const references = this.props.things.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.props.selectedWorld === null ? `Author's Notebook` : `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item xs={9}>\r\n              <h2>{this.state.Name}</h2>\r\n            </Grid>\r\n            <Grid item xs={3}>\r\n              { this.props.user !== null && this.props.selectedWorld !== null &&  this.props.selectedWorld.Owner === this.props.user._id ?\r\n              <List>\r\n                <ListItem>\r\n                  <Tooltip title={`Edit ${this.state.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      href={`/thing/edit/${this.state._id}`}\r\n                    >\r\n                      <Edit />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <Tooltip title={`Delete ${this.state.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {this.setState({modalOpen: true})}}\r\n                    >\r\n                      <Delete />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </ListItem>\r\n              </List>\r\n              : \"\" }\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n              <Grid item>{this.state.Description}</Grid>\r\n              <Grid item>\r\n                Attributes\r\n                <List>\r\n                  {this.props.selectedThing === null ||\r\n                  this.props.selectedThing === undefined\r\n                    ? \"\"\r\n                    : this.props.selectedThing.AttributesArr.map(\r\n                        (attribute, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <ListItemText>\r\n                                {attribute.Name}:&nbsp;\r\n                                {attribute.Type === \"Type\" && attribute.Value !== \"\" ?\r\n                                <Button\r\n                                  variant=\"contained\"\r\n                                  color=\"primary\"\r\n                                  href={`/thing/details/${attribute.Value}`}\r\n                                >\r\n                                  <ListItemText primary={this.props.things.filter(t=>t._id === attribute.Value)[0].Name}/>\r\n                                </Button>\r\n                                : attribute.Type === \"List\" ?\r\n                                  attribute.ListValues.map(\r\n                                    (listValue, i) => {\r\n                                      return (\r\n                                      <span key={i}>\r\n                                        {\r\n                                          attribute.ListType === \"Type\" ?\r\n                                          <span>\r\n                                            <Button\r\n                                              variant=\"contained\"\r\n                                              color=\"primary\"\r\n                                              href={`/thing/details/${listValue}`}\r\n                                            >\r\n                                              <ListItemText primary={this.props.things.filter(t=>t._id === listValue)[0].Name}/>\r\n                                            </Button> \r\n                                            &nbsp;\r\n                                          </span>\r\n                                          :\r\n                                          i > 0 ? `, ${listValue}` : `${listValue}`\r\n                                        }\r\n                                      </span>\r\n                                      );\r\n                                    })\r\n                                : attribute.Value}\r\n                              </ListItemText>\r\n                            </ListItem>\r\n                          );\r\n                        }\r\n                      )}\r\n                </List>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n              {this.state.Types.length === 0 ? (\r\n                \"\"\r\n              ) : (\r\n                <Grid item>\r\n                  <List>\r\n                    <ListItem>\r\n                      <ListItemText primary={\"Types\"} />\r\n                    </ListItem>\r\n                    {this.state.Types.map((type, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button fullWidth\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            href={`/type/details/${type._id}`}\r\n                          >\r\n                            <ListItemText primary={type.Name} />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })}\r\n                  </List>\r\n                </Grid>\r\n              )}\r\n              {references.length === 0 ? (\r\n                \"\"\r\n              ) : (\r\n                <Grid item>\r\n                  <List>\r\n                    <ListItem>\r\n                      <ListItemText primary={\"Referenced in:\"} />\r\n                    </ListItem>\r\n                    {references.map((thing, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button fullWidth\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            href={`/thing/details/${thing._id}`}\r\n                          >\r\n                            <ListItemText primary={thing.Name} />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })}\r\n                  </List>\r\n                </Grid>\r\n              )}\r\n            </Grid>\r\n          </Grid>\r\n          <Modal\r\n            aria-labelledby=\"delete-thing-modal\"\r\n            aria-describedby=\"delete-thing-modal-description\"\r\n            open={this.state.modalOpen}\r\n            onClose={e => {this.setState({modalOpen: false})}}\r\n          >\r\n            <div style={this.getModalStyle()} className=\"paper\">\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  Are you sure you want to delete {this.state.Name}?\r\n                </Grid>\r\n                <Grid item>\r\n                  (All references to it will be left alone and may not work correctly)\r\n                </Grid>\r\n                <Grid item container spacing={1} direction=\"row\">\r\n                  <Grid item xs={6}>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      onClick={this.delete}\r\n                    >\r\n                      Yes\r\n                    </Button>\r\n                  </Grid>\r\n                  <Grid item xs={6}>\r\n                    <Button\r\n                      fullWidth\r\n                      variant=\"contained\"\r\n                      onClick={e => {this.setState({modalOpen: false})}}\r\n                    >\r\n                      Cancel\r\n                    </Button>\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </div>\r\n          </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = e;\r\n  props.onChange(attr);\r\n};\r\nconst handleType2Change = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"Type2\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond2(newThing) {\r\n      // attr[\"Type2\"] = newType._id;\r\n      // props.onChange(attr);\r\n      respond(newThing._id);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.Type2)[0]\r\n    );\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues.push(selectedItem.Name);\r\n  props.onChange(attr);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o.Name);\r\n  });\r\n  props.onChange(attr);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    function respond2(newThing) {\r\n      const attr = props.attribute;\r\n      attr.ListValues.push(newThing._id);\r\n      props.onChange(attr);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.Type2)[0]\r\n    );\r\n  } else {\r\n    const attr = props.attribute;\r\n    attr.ListValues.push(selectedItem._id);\r\n    props.onChange(attr);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o._id);\r\n  });\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [value, changeValue] = useState(props.attribute.Value);\r\n  const type = props.attribute.Type === \"\" ? \"Text\" : props.attribute.Type;\r\n\r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (type === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.attribute.ListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (type === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const type2 = props.types.filter(t => t._id === props.attribute.Type2)[0];\r\n    listOptions.push({ Name: `+ Create New ${type2.Name}`, _id: \"new\" });\r\n    props.things\r\n      .filter(t => t.TypeIDs.includes(props.attribute.Type2))\r\n      .forEach(t => {\r\n        listOptions.push({ Name: t.Name, _id: t._id });\r\n      });\r\n    listOptions\r\n      .filter(t => props.attribute.ListValues.includes(t._id))\r\n      .forEach(t => {\r\n        listOptionValues.push(t);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Grid item>\r\n      {type === \"Text\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"Name\">{props.attribute.Name}</InputLabel>\r\n          <OutlinedInput\r\n            id=\"Name\"\r\n            name=\"Name\"\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={value}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeValue(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                Name: props.attribute.Name,\r\n                Type: props.attribute.Type,\r\n                Options: props.attribute.Options,\r\n                Type2: props.attribute.Type2,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={props.attribute.Name.length * 9}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      ) : type === \"Number\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"Name\">{props.attribute.Name}</InputLabel>\r\n          <OutlinedInput\r\n            id=\"Name\"\r\n            name=\"Name\"\r\n            type=\"number\"\r\n            error={props.error}\r\n            value={value}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeValue(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                Name: props.attribute.Name,\r\n                Type: props.attribute.Type,\r\n                Options: props.attribute.Options,\r\n                Type2: props.attribute.Type2,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={props.attribute.Name.length * 9}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      ) : type === \"True/False\" ? (\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox checked={props.attribute.Value===\"True\"} onChange={e => {\r\n              const attr = props.attribute;\r\n              attr.Value = e.target.checked ? \"True\" : \"False\";\r\n              props.onChange(attr);\r\n            }}\r\n            color=\"primary\" />\r\n          }\r\n          label={props.attribute.Name}\r\n        />\r\n      ) : type === \"Options\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n            {props.attribute.Name}\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"options-select-label\"\r\n            id=\"options-select\"\r\n            value={value}\r\n            onChange={e => {\r\n              changeValue(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                Name: props.attribute.Name,\r\n                Type: props.attribute.Type,\r\n                Options: props.attribute.Options,\r\n                Type2: props.attribute.Type2,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            fullWidth\r\n            labelWidth={props.attribute.Name.length * 9}\r\n          >\r\n            {props.attribute.Options.map((option, i) => {\r\n              return (\r\n                <MenuItem key={i} value={option}>\r\n                  {option}\r\n                </MenuItem>\r\n              );\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      ) : type === \"Type\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n            {props.attribute.Name}\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"type-select-label\"\r\n            id=\"type-select\"\r\n            value={value}\r\n            onChange={e => {\r\n              handleType2Change(e, props, changeValue);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                Name: props.attribute.Name,\r\n                Type: props.attribute.Type,\r\n                Options: props.attribute.Options,\r\n                Type2: props.attribute.Type2,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            fullWidth\r\n            labelWidth={props.attribute.Name.length * 9}\r\n          >\r\n            <MenuItem value=\"new\">\r\n              + Create New{\" \"}\r\n              {props.types.filter(t => t._id === props.attribute.Type2)[0].Name}\r\n            </MenuItem>\r\n            {props.things\r\n              .filter(t => t.TypeIDs.includes(props.attribute.Type2))\r\n              .map((thing, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={thing._id}>\r\n                    {thing.Name}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n          </Select>\r\n        </FormControl>\r\n      ) : type === \"List\" ? (\r\n        <span>\r\n          {props.attribute.ListType === \"Text\" ? (\r\n            <ChipInput\r\n              placeholder={props.attribute.Name}\r\n              variant=\"outlined\"\r\n              defaultValue={props.attribute.ListValues}\r\n              onChange={chips => handleTextListChange(chips, props)}\r\n            />\r\n          ) : props.attribute.ListType === \"Options\" ? (\r\n            <Multiselect\r\n              placeholder={props.attribute.Name}\r\n              options={listOptions}\r\n              selectedValues={listOptionValues}\r\n              onSelect={(_, selectedItem) => {\r\n                addOption(selectedItem, props);\r\n              }}\r\n              onRemove={(selectedList, _) => {\r\n                removeOption(selectedList, props);\r\n              }}\r\n              displayValue=\"Name\"\r\n            />\r\n          ) : props.attribute.ListType === \"Type\" ? (\r\n            <Multiselect\r\n              placeholder={props.attribute.Name}\r\n              options={listOptions}\r\n              selectedValues={listOptionValues}\r\n              onSelect={(_, selectedItem) => {\r\n                addType(selectedItem, props);\r\n              }}\r\n              onRemove={(selectedList, _) => {\r\n                removeType(selectedList, props);\r\n              }}\r\n              displayValue=\"Name\"\r\n            />\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </span>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { updateSelectedThing, addThing } from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport API from \"../../api\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedThing: state.app.selectedThing,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.push({\r\n      index: thing.AttributesArr.length,\r\n      Name: \"\",\r\n      Type: \"Text\",\r\n      Options: [],\r\n      Type2: \"\",\r\n      ListType: \"\",\r\n      FromTypes: [],\r\n      Value: \"\",\r\n      ListValues: [],\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      Name: value.Name,\r\n      Type: value.Type,\r\n      Options: value.Options,\r\n      Type2: value.Type2,\r\n      ListType: value.ListType,\r\n      FromTypes: value.FromTypes,\r\n      Value: value.Value,\r\n      ListValues: value.ListValues,\r\n    };\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.splice(value.index);\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  optionsChange = (e, props) => {\r\n  }\r\n\r\n  addNewThing = (respond, type) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({modalOpen: true, modalSubmit: respond, newThingType: type});\r\n  }\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name,\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      AttributesArr: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            modalOpen: false\r\n          });\r\n        }\r\n        else if (res.message !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.message \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={1} direction=\"column\">\r\n        <Grid item>Attributes</Grid>\r\n        {this.props.selectedThing === null || this.props.selectedThing === undefined ? \"\"\r\n          : this.props.selectedThing.AttributesArr.map((attribute, i) => {\r\n            return (\r\n              <AttributeControl\r\n                key={i}\r\n                thingID={this.props.selectedThing._id}\r\n                attribute={attribute}\r\n                onChange={this.changeAttribute}\r\n                onDelete={this.deleteAttribute}\r\n                onBlur={this.blurAttribute}\r\n                things={this.props.things}\r\n                types={this.props.types}\r\n                onNewThing={this.addNewThing}\r\n              />\r\n            );\r\n          })\r\n        }\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.modalOpen}\r\n          onClose={e => {this.setState({modalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({modalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectPage,\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing\r\n} from \"../../redux/actions/index\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Thing.  It will allow the use of Types to make\r\n  it faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: state.app.selectedThing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectPage: page => dispatch(selectPage(page)),\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        if (id.includes(\"type_id_\")) {\r\n          // We're creating it from a type rather than from blank\r\n          const typeID = id.substring(8);\r\n          let type = this.props.types.filter(t=> t._id === typeID);\r\n          if (type.length > 0) {\r\n            type = type[0];\r\n            this.createThingFromType(type);\r\n          }\r\n          else {\r\n            this.setState({ message: \"Invalid Type\" });\r\n          }\r\n        }\r\n        else {\r\n          // We're editing an existing Thing\r\n          this.api.getThing(this.props.selectedWorldID, id).then(res => {\r\n            console.log(res);\r\n            const things = this.props.things.filter(\r\n              thing => res._id !== thing._id\r\n            );\r\n            let Types = [];\r\n            res.TypeIDs.forEach(tID=> {\r\n              Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n            });\r\n            let attributes = [...res.AttributesArr];\r\n            Types.forEach(type=> {\r\n              for (let i = 0; i < type.AttributesArr.length; i++) {\r\n                const attribute = {...type.AttributesArr[i]};\r\n                attribute.FromTypes = [...attribute.FromSupers];\r\n                delete attribute.FromSupers;\r\n                attribute.FromTypes.push(type._id);\r\n                const matches = attributes.filter(a => a.Name === attribute.Name);\r\n                if (matches.length === 0) {\r\n                  // It's a new attribute.\r\n                  // Thing Attributes have Values, so we need to add that field.\r\n                  // In the future I'll have List Types, in which case this will be more complicated.\r\n                  // Also I'll be adding default values.\r\n                  attribute.Value = \"\";\r\n                  attribute.ListValues = [];\r\n                  attributes.push(attribute);\r\n                } else {\r\n                  // It's an existing attribute,\r\n                  // so we just need to add the appropriate ids to FromTypes.\r\n                  const typeIDs = [...matches[0].FromTypes];\r\n                  for (let i = 0; i < attribute.FromTypes.length; i++) {\r\n                    const typeID = attribute.FromTypes[i];\r\n                    if (!typeIDs.includes(typeID)) {\r\n                      typeIDs.push(typeID);\r\n                    }\r\n                  }\r\n                  matches[0].FromTypes = typeIDs;\r\n                }\r\n              }\r\n            });\r\n            res.AttributesArr = attributes;\r\n            this.setState({\r\n              Name: res.Name,\r\n              Description: res.Description,\r\n              _id: id,\r\n              Things: things,\r\n              Types: Types\r\n            });\r\n            this.props.updateSelectedThing(res);\r\n          });\r\n        }\r\n      } else {\r\n        // We're creating a new thing from blank.\r\n        this.props.updateSelectedThing({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Types: [],\r\n          AttributesArr: []\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  createThingFromType = type => {\r\n    let types = [];\r\n    types.push(type);\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n          types.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      AttributesArr: []\r\n    };\r\n    let attributes = [];\r\n    for (let i = 0; i < type.AttributesArr.length; i++) {\r\n      const attribute = {...type.AttributesArr[i]};\r\n      attribute.FromTypes = [...attribute.FromSupers];\r\n      delete attribute.FromSupers;\r\n      attribute.FromTypes.push(type._id);\r\n      const matches = attributes.filter(a => a.Name === attribute.Name);\r\n      if (matches.length === 0) {\r\n        // It's a new attribute.\r\n        // Thing Attributes have Values, so we need to add that field.\r\n        // In the future I'll have List Types, in which case this will be more complicated.\r\n        // Also I'll be adding default values.\r\n        attribute.Value = \"\";\r\n        attribute.ListValues = [];\r\n        attributes.push(attribute);\r\n      } else {\r\n        // It's an existing attribute,\r\n        // so we just need to add the appropriate ids to FromTypes.\r\n        const typeIDs = [...matches[0].FromTypes];\r\n        for (let i = 0; i < attribute.FromTypes.length; i++) {\r\n          const typeID = attribute.FromTypes[i];\r\n          if (!typeIDs.includes(typeID)) {\r\n            typeIDs.push(typeID);\r\n          }\r\n        }\r\n        matches[0].FromTypes = typeIDs;\r\n      }\r\n    }\r\n    this.setState({ Types: types });\r\n    thing.AttributesArr = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedThing[fieldName];\r\n        for (let i = 0; i < value.length; i++) {\r\n          if (value.filter(attr2 => attr2.Name === value[i].Name).length > 1) {\r\n            valid = false;\r\n            break;\r\n          }\r\n        }\r\n        message = valid ? \"\" : \"Attribute Names must be unique\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrArrValid = this.validateField(\"AttributesArr\");\r\n    const formValid = nameValid.valid && attrArrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.AttributesArr = attrArrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const typeIDs = this.state.Types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name,\r\n      Description: this.state.Description,\r\n      TypeIDs: typeIDs,\r\n      AttributesArr: this.props.selectedThing.AttributesArr,\r\n      worldID: this.props.selectedWorld._id,\r\n      ReferenceIDs: []\r\n    };\r\n    this.props.selectedThing.AttributesArr.filter(a=>a.Type === \"Type\").forEach(a=>{\r\n      if (!thing.ReferenceIDs.includes(a.Value)) {\r\n        thing.ReferenceIDs.push(a.Type2);\r\n      }\r\n    });\r\n    this.props.selectedThing.AttributesArr.filter(a=>a.Type === \"List\" && a.ListType === \"Type\").forEach(a=>{\r\n      a.ListValues.forEach(v=> {\r\n        if (!thing.ReferenceIDs.includes(v)) {\r\n          thing.ReferenceIDs.push(v);\r\n        }\r\n      });\r\n    });\r\n\r\n    if (thing._id === null) {\r\n      this.api\r\n        .createThing(thing)\r\n        .then(res => {\r\n          if (res.message === undefined){\r\n            thing._id = res.thingID;\r\n            thing.Types = this.state.Types;\r\n            this.props.addThing(thing);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.message});\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateThing(thing)\r\n        .then(res => {\r\n          console.log(res);\r\n          if (res.message === undefined){\r\n            thing.Types = this.state.Types;\r\n            this.props.updateThing(thing);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.message});\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  typesChange = (e, value) => {\r\n    let types = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      types.push(t);\r\n      types = types.concat(t.Types);\r\n    }\r\n    this.setState({ Types: types });\r\n  };\r\n\r\n  addType = (selectedList, selectedItem) => {\r\n    selectedItem.Supers.forEach(s=>{\r\n      if (selectedList.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n        selectedList.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.AttributesArr];\r\n    for (let i = 0; i < selectedItem.AttributesArr.length; i++) {\r\n      const attribute = selectedItem.AttributesArr[i];\r\n      if (attribute.FromTypes === undefined)\r\n        attribute.FromTypes = [];\r\n      attribute.FromTypes.push(selectedItem._id);\r\n      const matches = attributes.filter(a => a.Name === attribute.Name);\r\n      if (matches.length === 0) {\r\n        // It's a new attribute.\r\n        // Thing Attributes have Values, so we need to add that field.\r\n        // In the future I'll have List Types, in which case this will be more complicated.\r\n        // Also I'll be adding default values.\r\n        attribute.Value = \"\";\r\n        attribute.ListValues = [];\r\n        attributes.push(attribute);\r\n      } else {\r\n        // It's an existing attribute,\r\n        // so we just need to add the appropriate ids to FromTypes.\r\n        const typeIDs = [...matches[0].FromTypes];\r\n        for (let i = 0; i < attribute.FromTypes.length; i++) {\r\n          const typeID = attribute.FromTypes[i];\r\n          if (!typeIDs.includes(typeID)) {\r\n            typeIDs.push(typeID);\r\n          }\r\n        }\r\n        matches[0].FromTypes = typeIDs;\r\n      }\r\n    }\r\n    this.setState({ Types: selectedList });\r\n    thing.AttributesArr = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n  \r\n  removeType = (selectedList, removedItem) => {\r\n    // TODO: Add a confirmation before doing this\r\n    // to let them know it will also remove sub-types.\r\n    let types = [];\r\n    let removeUs = [];\r\n    this.state.Types.forEach(checkMe => {\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else types.push(checkMe);\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.AttributesArr];\r\n    for (let i = 0; i < attributes.length; i++) {\r\n      const attribute = attributes[i];\r\n      if (attribute.FromTypes === undefined) {\r\n        // TODO: Remove this once all attributes have been changed to include the field\r\n        attribute.FromTypes = [];\r\n      }\r\n      let j = 0;\r\n      while (j < attribute.FromTypes.length) {\r\n        const checkMe = attribute.FromTypes[j];\r\n        if (removeUs.includes(checkMe)) {\r\n          attribute.FromTypes.splice(j, 1);\r\n        } else {\r\n          j++;\r\n        }\r\n      }\r\n    }\r\n    this.setState({ Types: types });\r\n    thing.AttributesArr = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n\r\n  renderHeader() {\r\n    let typeStr = \"Thing\";\r\n    this.state.Types.forEach(t=>{\r\n      if (t.Major) { \r\n        if (typeStr === \"Thing\") {\r\n          typeStr = t.Name;\r\n        }\r\n        else {\r\n          typeStr += \"/\" + t.Name;\r\n        }\r\n      }\r\n    });\r\n    return <h2>{this.state._id === null ? `Create New ${typeStr}` : `Edit ${typeStr}`}</h2>;\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.props.selectedWorld === null ? `Author's Notebook` : `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item>\r\n            {this.renderHeader()}\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"description\">Description</InputLabel>\r\n              <OutlinedInput\r\n                id=\"description\"\r\n                name=\"Description\"\r\n                type=\"text\"\r\n                value={this.state.Description}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={82}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <Multiselect\r\n              placeholder=\"Types\"\r\n              options={this.props.types}\r\n              selectedValues={this.state.Types}\r\n              onSelect={this.addType}\r\n              onRemove={this.removeType}\r\n              displayValue=\"Name\"\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <AttributesControl />\r\n            <FormHelperText>\r\n              {this.state.fieldValidation.AttributesArr.message}\r\n            </FormHelperText>\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\" color=\"primary\"\r\n                className=\"w200\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                style={{marginLeft: \"4px\"}}\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  if (this.props.selectedThing._id === null) {\r\n                    this.setState({\r\n                      redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                    });\r\n                  }\r\n                  else {\r\n                    this.setState({\r\n                      redirectTo: `/thing/details/${this.props.selectedThing._id}`\r\n                    });\r\n                  }\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { \r\n  Route, \r\n  Switch } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport HomePage from \"./Home\";\r\nimport ForumMenuPage from \"./Forum/ForumMenu\";\r\nimport LoginPage from \"./User/Login\";\r\nimport UserEditPage from \"./User/Edit\";\r\nimport WorldDetailsPage from \"./World/Details\";\r\nimport WorldEditPage from \"./World/Edit\";\r\n// import WorldDeletePage from \"./World/Delete\";\r\nimport TypeDetailsPage from \"./Type/Details\";\r\nimport TypeEditPage from \"./Type/Edit\";\r\n// import TypeDeletePage from \"./Type/Delete\";\r\nimport ThingDetailsPage from \"./Thing/Details\";\r\nimport ThingEditPage from \"./Thing/Edit\";\r\n// import ThingDeletePage from \"./Thing/Delete\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} className=\"h-100 margined\">\r\n        <Switch>\r\n          {/* <Route exact path=\"/Template\" component={TemplatePage} /> */}\r\n          <Route exact path=\"/\" component={HomePage} />\r\n          <Route exact path=\"/home\" component={HomePage} />\r\n          <Route exact path=\"/User/Login\" component={LoginPage} />\r\n          <Route exact path=\"/profile\" component={UserEditPage} />\r\n          \r\n          {/* <Route exact path=\"/test/:testtext\" component={Test} /> */}\r\n          <Route exact path=\"/forums\" component={ForumMenuPage} />\r\n          <Route exact path=\"/world/details/:id\" component={WorldDetailsPage} />\r\n          <Route exact path=\"/world/create\" component={WorldEditPage} />\r\n          <Route exact path=\"/world/edit/:id\" component={WorldEditPage} />\r\n          {/* <Route exact path=\"/world/delete/:id\" component={WorldDeletePage} /> */}\r\n          <Route exact path=\"/type/create\" component={TypeEditPage} />\r\n          <Route exact path=\"/type/details/:id\" component={TypeDetailsPage} />\r\n          <Route exact path=\"/type/edit/:id\" component={TypeEditPage} />\r\n          {/* <Route exact path=\"/type/delete/:id\" component={TypeDeletePage} /> */}\r\n          <Route exact path=\"/thing/create\" component={ThingEditPage} />\r\n          <Route exact path=\"/thing/create/:id\" component={ThingEditPage} />\r\n          <Route exact path=\"/thing/details/:id\" component={ThingDetailsPage} />\r\n          <Route exact path=\"/thing/edit/:id\" component={ThingEditPage} />\r\n          {/* <Route exact path=\"/thing/delete/:id\" component={ThingDeletePage} /> */}\r\n        </Switch>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst MainPage = connect()(Page);\r\nexport default MainPage;\r\n","// // App.js\n// //\n// import React, { Component } from 'react';\n// import './App.css';\n// class App extends Component {\n//   constructor(props) {\n//     super(props);\n//     this.state = {\n//       flower: {}\n//     }\n//     this.getFlower();\n//   }\n//   getFlower() {\n//     fetch('/flower')\n//       .then(response => response.json())\n//       .then(data => {\n//         this.setState({\n//           flower: data\n//         });\n//       });\n//   }\n//   render() {\n//     return (\n//       <div className=\"App\">\n//         <h1>{this.state.flower.name}</h1>\n//         <p>{this.state.flower.colour}</p>\n//       </div>\n//     );\n//   }\n// }\n// export default App;\n\nimport React, { Component } from \"react\";\nimport \"./assets/css/material-dashboard-react.css\";\nimport {\n  BrowserRouter as Router\n} from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport NavBar from \"./components/Navigation/Navbar\";\nimport Sidebar from \"./components/Navigation/Sidebar\";\nimport MainPage from \"./views/MainPage\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\n\nconst mapStateToProps = state => {\n  return {\n    menuOpen: state.app.menuOpen\n  };\n};\nclass AppLayout extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      version: \"0\",\n      width: 0,\n      marginLeft: 220\n    };\n  }\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    let w = window.innerWidth;\n    if (w >= 600) {\n      w -= 200;\n      this.setState({ width: w, marginLeft: 220, innerWidth: window.innerWidth });\n    }\n    else {\n      this.setState({ width: w, marginLeft: 0, innerWidth: window.innerWidth });\n    }\n  }\n\n  render() {\n    return (\n      <Router>\n        {this.props.menuOpen ? \n          <Box display={{ xs: 'none', sm: 'inline' }} className=\"Sidebar\">\n            <Sidebar className=\"\" logoText={\"Author's Notebook\"} />\n          </Box>\n        : \"\" }\n        <Grid container>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft : 0}px`, \n              width: `${this.props.menuOpen ? this.state.width : this.state.innerWidth}px` \n            }}>\n            <NavBar />\n          </Grid>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft + 10 : 10}px`, \n              width: `${this.props.menuOpen ? this.state.width - 20 : this.state.innerWidth - 20}px`,\n              marginRight: \"10px\",\n              marginTop: \"10px\" \n            }}>\n            <MainPage />\n          </Grid>\n        </Grid>\n      </Router>\n    );\n  }\n}\n\nconst App = connect(mapStateToProps)(AppLayout);\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\r\n  SELECT_PAGE,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOG_OUT,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  SELECT_WORLD,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  UPDATE_ATTRIBUTES_ARR,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  SET_FOLLOWING_WORLDS\r\n} from \"../constants/actionTypes\";\r\n\r\nconst initialState = {\r\n  selectedPage: \"Test\",\r\n  articles: [],\r\n  user: null,\r\n  loginError: \"\",\r\n  worlds: [],\r\n  publicWorlds: [],\r\n  followingWorlds: [],\r\n  selectedWorld: null,\r\n  selectedWorldID: null,\r\n  types: [],\r\n  things: [],\r\n  selectedType: null,\r\n  attributesArr: [],\r\n  selectedThing: null,\r\n  loadIt: true,\r\n  menuOpen: true\r\n};\r\nfunction rootReducer(state = initialState, action) {\r\n  if (action.type === LOAD_FROM_STORAGE) {\r\n    const user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n    const worlds = JSON.parse(sessionStorage.getItem(\"worlds\"));\r\n    const publicWorlds = JSON.parse(sessionStorage.getItem(\"publicWorlds\"));\r\n    const selectedWorld = JSON.parse(sessionStorage.getItem(\"selectedWorld\"));\r\n    const selectedWorldID = sessionStorage.getItem(\"selectedWorldID\");\r\n    const types = JSON.parse(sessionStorage.getItem(\"types\"));\r\n    const things = JSON.parse(sessionStorage.getItem(\"things\"));\r\n    const followingWorlds = JSON.parse(sessionStorage.getItem(\"followingWorlds\"));\r\n    \r\n    return Object.assign({}, state, {\r\n      user: user,\r\n      worlds: worlds === null ? [] : worlds,\r\n      publicWorlds: publicWorlds === null ? [] : publicWorlds,\r\n      selectedWorld,\r\n      selectedWorldID,\r\n      types: types === null ? [] : types,\r\n      things: things === null ? [] : things,\r\n      followingWorlds: followingWorlds === null ? [] : followingWorlds\r\n    });\r\n  } else if (action.type === SELECT_PAGE) {\r\n    return Object.assign({}, state, {\r\n      selectedPage: action.payload\r\n    });\r\n  } else if (action.type === ADD_ARTICLE) {\r\n    return Object.assign({}, state, {\r\n      articles: state.articles.concat(action.payload)\r\n    });\r\n  } else if (action.type === LOGIN) {\r\n    sessionStorage.setItem(\"user\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload.followingWorlds));\r\n    return Object.assign({}, state, {\r\n      user: action.payload, \r\n      followingWorlds: action.payload.followingWorlds\r\n    });\r\n  } else if (action.type === LOG_OUT) {\r\n    sessionStorage.removeItem(\"user\");\r\n    return Object.assign({}, state, {\r\n      user: null\r\n    });\r\n  } else if (action.type === SET_WORLDS) {\r\n    if (action.payload.message === undefined){\r\n      sessionStorage.setItem(\"worlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            selectedWorld: world\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          worlds: action.payload\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === SET_PUBLIC_WORLDS) {\r\n    if (action.payload.message === undefined){\r\n      sessionStorage.setItem(\"publicWorlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload,\r\n            selectedWorld: world\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          publicWorlds: action.payload\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === ADD_WORLD) {\r\n    if (action.payload.Public) {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      const publicWorlds = state.publicWorlds.concat(action.payload);\r\n      sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      return Object.assign({}, state, {\r\n        worlds: state.worlds.concat(action.payload)\r\n      });\r\n    }\r\n  } else if (action.type === UPDATE_WORLD) {\r\n    const worlds = [...state.worlds];\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = worlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Name = action.payload.Name;\r\n    const wasPublic = world.Public;\r\n    world.Public = action.payload.Public;\r\n    sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n    if (world.Public) {\r\n      if (wasPublic) {\r\n        // It was already public so we just need to update the name\r\n        const publicWorld = publicWorlds.filter(t => t._id === world._id)[0];\r\n        publicWorld.Name = world.Name;\r\n      }\r\n      else {\r\n        // It's been changed to public, so we need to add it\r\n        publicWorlds = publicWorlds.concat(world);\r\n      }\r\n      sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      if (wasPublic) {\r\n        // It used to be public, so we need to remove it\r\n        publicWorlds = publicWorlds.filter(t => t._id !== world._id);\r\n        sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n        return Object.assign({}, state, {\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      }\r\n      else {\r\n        // It's still not public, so we can leave it\r\n        return Object.assign({}, state, {\r\n          worlds\r\n        });\r\n      }\r\n    }\r\n  } else if (action.type === SELECT_WORLD) {\r\n    let world = state.worlds.filter(world => world._id === action.payload);\r\n    if (world.length === 0)\r\n      world = state.publicWorlds.filter(world => world._id === action.payload);\r\n    if (world.length > 0) {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world[0]));\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: world[0]\r\n      });\r\n    } else {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.removeItem(\"selectedWorld\");\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: null\r\n      });\r\n    }\r\n  } else if (action.type === SET_TYPES) {\r\n    sessionStorage.setItem(\"types\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      types: action.payload\r\n    });\r\n  } else if (action.type === ADD_TYPE) {\r\n    const types = state.types.concat(action.payload);\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  } else if (action.type === SET_THINGS) {\r\n    sessionStorage.setItem(\"things\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      things: action.payload\r\n    });\r\n  } else if (action.type === ADD_THING) {\r\n    const things = state.things.concat(action.payload);\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === UPDATE_SELECTED_TYPE) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedType = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedType: changedType\r\n    });\r\n  } else if (action.type === UPDATE_TYPE) {\r\n    const types = [...state.types];\r\n    const type = types.filter(t => t._id === action.payload._id)[0];\r\n    type.Name = action.payload.Name;\r\n    type.Description = action.payload.Description;\r\n    type.Supers = action.payload.Supers;\r\n    type.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  } else if (action.type === UPDATE_ATTRIBUTES_ARR) {\r\n    return Object.assign({}, state, {\r\n      attributesArr: action.payload\r\n    });\r\n  } else if (action.type === UPDATE_SELECTED_THING) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedThing = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedThing: changedThing\r\n    });\r\n  } else if (action.type === UPDATE_THING) {\r\n    const things = [...state.things];\r\n    const thing = things.filter(t => t._id === action.payload._id)[0];\r\n    thing.Name = action.payload.Name;\r\n    thing.Description = action.payload.Description;\r\n    thing.Types = action.payload.Types;\r\n    thing.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === TOGGLE_MENU) {\r\n    return Object.assign({}, state, {\r\n      menuOpen: !state.menuOpen\r\n    });\r\n  } else if (action.type === SET_FOLLOWING_WORLDS) {\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload));\r\n    console.log(action.payload);\r\n    return Object.assign({}, state, {\r\n      followingWorlds: action.payload\r\n    });\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default rootReducer;\r\n\r\nexport const login = (user, history) => {};\r\n\r\nexport const logout = history => {};\r\n","import { createStore, combineReducers } from \"redux\";\r\nimport { sessionService, sessionReducer } from \"redux-react-session\";\r\nimport rootReducer from \"../reducers/index\";\r\nconst reducers = {\r\n  app: rootReducer,\r\n  session: sessionReducer\r\n};\r\n\r\nconst reducer = combineReducers(reducers);\r\nconst store = createStore(reducer);\r\nconst validateSession = session => {\r\n  // check if your session is still valid\r\n  return true;\r\n};\r\nconst options = {\r\n  refreshFromLocalStorage: true,\r\n  refreshOnCheckAuth: true,\r\n  redirectPath: \"/home\",\r\n  driver: \"COOKIES\",\r\n  validateSession\r\n};\r\n\r\nsessionService\r\n  .initSessionService(store, options)\r\n  .then(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and a session was refreshed from your storage\"\r\n    )\r\n  )\r\n  .catch(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and there is no session in your storage\"\r\n    )\r\n  );\r\nexport default store;\r\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store/index\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}
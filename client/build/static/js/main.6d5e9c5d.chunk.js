(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{147:function(e,t,a){},167:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA9CAYAAAAeYmHpAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAmRSURBVGhD7dpHqC1ZFQbg916bszZiwCyCICqCrag4cKSIIuJE0B4IQjsQDAOH4sDUKGob0BbFnDHQ2tqKiqHNophzzjnn8FzfvvXXW7denXPvfTg794f/VtWuvdZea+20dp178vTp0yd2Daem607h2OldwbHTu4Jjp3cFO+n0kZKTkydPTnf78ILi3Yu/Kz5Qwf874Vm2exj9W2U8HIYNLy7+qPjj4i+Lfy/+p/jP4nuLA2s6zoUNVxSfs3d7sP4Jzy6yd2B+1ytuYsPbi38p/nfiv4oczvNfix8sDqzpOgobvl78U/EPxTcrgANkXl78TfH3xWcpmOt0gSUXuLKoVzkaJ1HFTu/VHVjTexg2fKn45+LfinS73+fEitwri0ajKaf+d4sDo85SKGx4RfELxd8WOU3Jr4qibkjraQKd/yi+r7iq+yA2mEJ0aUfb6PmjxU0ylxXZZ9TFvn8Xv13cQxdcUfDJ4jeLFD2t+JRixxeLoh9nQyNAzzyzuNrGJjZYLxjbSSfuG0kNnytylE2uZDiNgvWp4tkGNViUzKUXjqcJi3reURxHXUPPPysO9Da2ccJPivR2492npz9e7HhJ8ftFvdvXmNynt60LF681CO8vcvjS8VTo9Rb143Qi6j70PHplTX6NEz5W/HXRVOJojI8Dny0GhrrFNQFyTV30HNv+WLxsTk7avvaa4k2LevoiBc2YJZ5XjA4KVNRQoOyO42Z9j9+E+xQ5fl6xC7qnX4/Cp4tyBDYY9gLFsW5w7snSd/4wuBlkLxwJRuFx/mxxGAj2CvT1Z++vXfzEeDiE4629hxT1HBBMW3rsusUfFu9cNNLYfb3izYuvKlrIyApQZOFqxfN6I+8u2tdUNPbHu22cQLkHcsgoz2GGlRG0qmeNEyxm5jC9aUN7etqwZe+85jS51xbVERDtd9uumId34bZF3Q/XKj517/ZAmE9riPOifNXivYtHHeZ0dBsJX6V49aK5/tLiY3ugpusji9aDDi9w3rMhUfVCVN5QnCO/xgmSgMj0K12Jsl6xr7+juKpryQk/L/be8gL19lhkt8ga/uqRjQ6BmqP4+uL5RVGM4tsXN6L1mPm1ht6lRpDeuYeHI/S2ObiGbxUvag5uQlbuBOw7xdlpQ7tbotKt3KwZ2MokAxaqIFa40qFiKhvi1yladA6LTLclOH0Qrl/UZmyyTt3JTZw2RBMRYOgNi8skoDtshbxrsc85DcRhib5Ie47z1yxeUNza2+2dkUf/svKm0RXZtxW1FTl2vMuN0RGDf1o0B/PsqsG7FS+NEc0Y8/8GRfOUXJCoCqCkwT5qXgV06u2PjKeDkU6ABBRWp16z757F7PF8+V7xwrXpkFw3yhkuQjb8Dumecimm5MTioD4Ds3BIFJ5bBKNFWfSq5/AykMWnc4I83ylJfYXdtq8WN8kB/eS0e1YqnJ4FPaNSIEpomFvmLy9y+CZF28HNio8v6r0goaYn97aqHxTTa8olEiM9bb2zRJ+P0G3to2eJZxQtgBSTf2NxX1BOtYeHFfWQghTGolsXH1C8RVGDby2C3owxZNxHJk7C7Yo9PVTP1HFs3YauD2IbO2cI3BQ8+h5TNJ/Vk6CMTunBHQY3x2U4kg0FaiHjI6GxdxYfPZ5OnLhD8Yy2MzJgOHbdcnnTAtS5RlGquam3uy5KZkWF4XRzFhxzH16UWKXQznJh0doyI70UmENxOPBssfpK0aop2wkojUHdSMN7ON3AIB8F+jCnzyKz5rgeshhFP6RSzwKlnNmODOv4lLqeb7R3u4el004sry6as2nIEDEv7uJBz7Xey7awtLgb2uubFn0kccqU+UZx6XjWin26Cu6zT7+s+OAiOwI+dRkdI/Ga9c9ON8MMwQwRDvua+KhirxP0xgKV+nzueFLRiOm9zYbbFB0lu+OxLQ54Ed1PLIJ1yIInz5D0WDBTH8ggO9+iYGDRc2CJp1jhxq1lwteKaSRbClmJyfi0tCID3qcNV4G257+pGPh8a+7Sa/FUD5VdUmSn8jE9Gmyx9GWbjP5fFPewMOjLRY0QUFnSMtCNb/VtYR6iHN3PJ5wNcs7X2kl9Vw7I8mw58OSitUS91EXTQ2eo70Ay0HQ7iAhMfEDy5v34bj6G0DSknHfl4KlIaO9D2maMBH7CPC4L87TZgHsVBUY7QNYcli+PFb3Q8+6u28HFPm/R9YVndni6+trz+WIPKpLzkeHEqTaHHlS0+iVkMq2HumlRXGJ8bGhQMZFdlWtlDEtvKGSI+WkbtC3eeCqD7rT6ZCVJm2yTEGUnAvKCeEsP6ZFsRyopyxzb5jAwcA3pwW24X9ECFKcDPS4Rum9xuZiBQF/ArgOC6jwdeU5rZ9/816sKMyQ4bU8dSpacYO6oF4OQrN6Tx6/Khg0SIu0uh2MWI3PXO8+z4Ws6wwm2WfWRf/P8F4kXFUVX7UTGVcbUt5CB6dli84hikofAyxi9Fc04v49xDOI0sIk+jkP0Zv8+CM4LkbGwCe7c7nuKmVuhZxV9UekGgp9mrZ6ibx9ncIxFz+Nklshv4wQ2RFd6NPqUK0vPW+FXdYUNpgIZ9sznafDTTR9aUW67MEwdHwOHc4oMF/PRgpKjZcjwjVvWkg0fKMbB7jTb2MImnNeaTWywBXPYl96BvJcJ2fs0hOm5UK/ar52S9D4n8wvDh4uMjIHqMxBHZGFp1JINPi7EweikX7ucVz7y7jU92CCB8Yun7+ADvY4f5zgUJ9ciLRAZzv0TEucZEllkdBKIzxT3GbWJDUZPbKBbkNO+MjYcpMOnYdni6j8JWLC8dI2TSQqixTuN6+3XFcf36wkcTFDivPoSAYnG+Lh4GDSjnbPH6l+wkLEHs6K6v6QvsO7bs4XZdmeVv7+CRUBm5FtWDHcV7dBZdUZT4muLnkjaJwDofqyWkAgfhhP8akEvW5YUaKOhQ57/9KKkxolt6z8FdEgp4zRHs8xfXhxYETQHBYshGYZ45J9owwb/ZsEOhd1pQdWeQ4uV3KIZWwXDcXNgTT/u/TkDQ8J8pNBwdkAfOEtwD3501yhDOE12fLSDpcxROEHPCWJ3GvuI9N48/1BxxprO8MzNHi4u2hI47WPCQBdY1AeZDxnOz//isCZzFDY4YjoWZtq4ctQ9WoS3/vPNkvsf9uBX/Xlv7u+XbGDY+B8TWKt7rpzgnG0kcVivSinlCUbm84urspt40p9gmXL2d5twLjJHQdNv37cj2CafoCA4apv7nN4V2FN3DsdO7wqOnd4VHDu9Kzh2ejdw4sT/AKg3OUKQFc+/AAAAAElFTkSuQmCC"},186:function(e,t,a){e.exports=a(233)},191:function(e,t,a){},192:function(e,t,a){},233:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(21),s=a.n(i),l=(a(191),a(9)),o=a(11),c=a(13),u=a(12),d=a(14),p=(a(192),a(19)),m=a(10),h=a(275),f=a(276),b=a(238),y=a(266),g=a(265),v=a(240),E=a(166),w=a.n(E);function T(e){return{type:"SET_WORLDS",payload:e}}function D(e){return{type:"UPDATE_WORLD",payload:e}}function N(e){return{type:"SET_PUBLIC_WORLDS",payload:e}}function W(e){return{type:"SELECT_WORLD",payload:e}}function k(e){return{type:"SET_ATTRIBUTES",payload:e}}function I(e){return{type:"SET_TYPES",payload:e}}function A(e){return{type:"ADD_TYPE",payload:e}}function S(e){return{type:"SET_THINGS",payload:e}}function O(e){return{type:"ADD_THING",payload:e}}function C(e){return{type:"UPDATE_TYPE",payload:e}}function x(e){return{type:"UPDATE_SELECTED_TYPE",payload:e}}function _(e){return{type:"UPDATE_THING",payload:e}}function j(e){return{type:"UPDATE_SELECTED_THING",payload:e}}function V(e){return{type:"TOGGLE_MENU",payload:e}}function L(e){return{type:"SET_FOLLOWING_WORLDS",payload:e}}var P=a(267),F=a(297),M=a(23),B=a(4),R=a.n(B),U=a(15);function H(e){this.name="UnauthorizedError",this.message=e}H.prototype=new Error;var z=function(){var e;return{getInstance:function(){return e||(e=new J),e}}}(),J=function e(){var t=this;Object(l.a)(this,e),this.logErrorReason=function(e){return console.log("Response error reason:",e),Promise.reject(e)},this.checkStatus=function(e){if(e.status>=200&&e.status<300)return e;if(401===e.status){var t=new H(e.statusText);return t.response=e,Promise.reject(t)}var a=new Error(e.statusText);return a.response=e,Promise.reject(a)},this.getVersion=Object(U.a)(R.a.mark((function e(){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/version");case 3:return a=e.sent,e.abrupt("return",t.processResponse(a));case 7:return e.abrupt("return",{version:"0.0.1"});case 8:case"end":return e.stop()}}),e)}))),this.getAllUsers=Object(U.a)(R.a.mark((function e(){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/user/getAllUsers");case 3:return a=e.sent,e.abrupt("return",t.processResponse(a));case 7:return e.abrupt("return",[{_id:"-1",email:"fake@fakemail.com",username:"Liar Liar"}]);case 8:case"end":return e.stop()}}),e)}))),this.login=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/user/login",a);case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",{_id:"-1",email:"fake@fakemail.com",username:"Liar Liar"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.logout=function(){var e=Object(U.a)(R.a.mark((function e(a){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=3;break}return e.next=3,t.postData("/api/user/logout");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.register=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/user/register",a);case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",-1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.confirmEmail=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/user/confirmEmail",{code:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",{_id:"-1",email:"fake@fakemail.com",username:"Liar Liar"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.sendReset=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/user/sendReset",a);case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.checkResetPasswordCode=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/user/checkResetPasswordCode",{code:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.resetPassword=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/user/resetPassword",{code:a,newPassword:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return",{_id:"-1",email:"fake@fakemail.com",username:"Liar Liar"});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.emailTest=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/user/emailTest",a);case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateUser=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/user/update",a);case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",{_id:"-1",email:"fake@fakemail.com",username:"Liar Liar"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getWorldsForUser=Object(U.a)(R.a.mark((function e(){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getWorldsForUser");case 3:return a=e.sent,e.abrupt("return",t.processResponse(a));case 7:return e.abrupt("return",[{_id:-1,OwnerID:-1,Name:"Alice in Wonderland",Public:!0}]);case 8:case"end":return e.stop()}}),e)}))),this.getPublicWorlds=Object(U.a)(R.a.mark((function e(){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getPublicWorlds");case 3:return a=e.sent,e.abrupt("return",t.processResponse(a));case 7:return e.abrupt("return",[{_id:-1,OwnerID:-1,Name:"Alice in Wonderland",Public:!0}]);case 8:case"end":return e.stop()}}),e)}))),this.createWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/world/createWorld",{world:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",-1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.deleteData("/api/world/deleteWorld",{worldID:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/updateWorld",{world:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.generateCollabLink=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/generateCollabLink",{worldID:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.addNewCollaborator=function(){var e=Object(U.a)(R.a.mark((function e(a,n,r){var i;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/addNewCollaborator",{worldID:a,userID:n,email:r});case 3:return i=e.sent,e.abrupt("return",t.processResponse(i));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),this.emailCollaborator=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/emailCollaborator",{worldID:a,email:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.deleteCollab=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.deleteData("/api/world/deleteCollab",{worldID:a,collabID:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.updateCollaboratorPermission=function(){var e=Object(U.a)(R.a.mark((function e(a,n,r){var i;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/updateCollaboratorPermission",{worldID:a,collabID:n,editPermission:r});case 3:return i=e.sent,e.abrupt("return",t.processResponse(i));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),this.checkCollabID=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/world/checkCollabID",{worldID:a,collabID:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.requestToCollaborate=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/requestToCollaborate",{worldID:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.declineCollabInvite=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.deleteData("/api/world/declineCollabInvite",{worldID:a,collabID:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.acceptCollabInvite=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/acceptCollabInvite",{worldID:a,collabID:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.selectWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/world/selectWorld",{worldID:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAttributesForWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getAttributesForWorld/".concat(a));case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",[{_id:-1,worldID:-1,Name:"Character"}]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAttribute=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getAttribute/".concat(a,"/").concat(n));case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return",{_id:-1,worldID:-1,Name:"Character",Description:"",Attributes:{}});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.createAttribute=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/world/createAttribute",{attribute:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",-1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.upsertAttributes=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/upsertAttributes",{worldID:a,attributes:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.getTypesForWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getTypesForWorld/".concat(a));case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",[{_id:-1,worldID:-1,Name:"Character"}]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getType=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getType/".concat(a,"/").concat(n));case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return",{_id:-1,worldID:-1,Name:"Character",Description:"",Attributes:{}});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.createType=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/world/createType",{type:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",-1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteType=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.deleteData("/api/world/deleteType",{worldID:a,typeID:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.updateType=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/updateType",{type:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getThingsForWorld=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getThingsForWorld/".concat(a));case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",[{_id:-1,worldID:-1,Name:"Alice"}]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getThing=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.fetchData("/api/world/getThing/".concat(a,"/").concat(n));case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return",{_id:-1,worldID:-1,Types:[-1],Name:"Alice",Description:""});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.createThing=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.postData("/api/world/createThing",{thing:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return",-1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteThing=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.deleteData("/api/world/deleteThing",{worldID:a,thingID:n});case 3:return r=e.sent,e.abrupt("return",t.processResponse(r));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.updateThing=function(){var e=Object(U.a)(R.a.mark((function e(a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.real){e.next=7;break}return e.next=3,t.patchData("/api/world/updateThing",{thing:a});case 3:return n=e.sent,e.abrupt("return",t.processResponse(n));case 7:return e.abrupt("return","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.fetchData=function(){var e=Object(U.a)(R.a.mark((function e(a){var n,r=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.next=3,fetch("".concat(a),Object(M.a)({mode:"cors",credentials:"include"},n,{headers:Object(M.a)({Accept:"application/json"},n.headers)})).then(t.checkStatus).catch(t.logErrorReason);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.postData=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r,i=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{},e.next=3,fetch("".concat(a),Object(M.a)({mode:"cors",credentials:"include"},r,{headers:Object(M.a)({Accept:"application/json","Content-Type":"application/json"},r.headers),method:"POST",body:JSON.stringify(n)})).then(t.checkStatus).catch(t.logErrorReason);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.putData=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r,i=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{},e.next=3,fetch("".concat(a),Object(M.a)({mode:"cors",credentials:"include"},r,{headers:Object(M.a)({Accept:"application/json","Content-Type":"application/json"},r.headers),method:"PUT",body:JSON.stringify(n)})).then(t.checkStatus).catch(t.logErrorReason);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.patchData=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r,i=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{},e.next=3,fetch("".concat(a),Object(M.a)({mode:"cors",credentials:"include"},r,{headers:Object(M.a)({Accept:"application/json","Content-Type":"application/json"},r.headers),method:"PATCH",body:JSON.stringify(n)})).then(t.checkStatus).catch(t.logErrorReason);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.deleteData=function(){var e=Object(U.a)(R.a.mark((function e(a,n){var r,i=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{},e.next=3,fetch("".concat(a),Object(M.a)({mode:"cors",credentials:"include"},r,{headers:Object(M.a)({Accept:"application/json","Content-Type":"application/json"},r.headers),method:"DELETE",body:JSON.stringify(n)})).then(t.checkStatus).catch(t.logErrorReason);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.processResponse=function(){var e=Object(U.a)(R.a.mark((function e(t){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,200===t.status){e.next=7;break}throw Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.real=!0},Y=z,G=a(25),q=a(22),K=(a(147),a(148)),Z=a(159),Q=a(160),X=a(268),$=a(269),ee=a(298),te=a(270),ae=a(273),ne=a(274),re=a(115),ie=a.n(re),se=a(162),le=a.n(se),oe=a(163),ce=a.n(oe),ue=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={version:"0"},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Author's Notebook"),r.a.createElement("p",null,"This is something that I've been wanting to build for a while. It's purpose is to provide a place for keeping track of various aspects of books that an author is writing. It is able to keep track of details about characters, organizations, systems, and even storylines. I would like to make it so it's publicly available, and that any authors (aspiring and published) can use it to help them organize their stories. I want to make it automate a number of things, but the biggest part is to make it very dynamic and to allow for storage of all different kinds of notes. In order to make it publicly available however, it needs to at least be able to pay for itself. I'm not talking about the time I spent/spend working on it, but the costs of hosting the website, the db, and the url. Until I'm sure it's capable of doing those things, I can't let everyone have access to it."),r.a.createElement("p",null,"This is version 1 of instructions of how to use it. If I make it available for anyone, I'll update it with some video instructions."),r.a.createElement("p",null,"One thing you need to know is that this is a hobby project of mine. I'm working on it by myself for now. I've got a real job, and I've got a family, so this isn't my top priority, but that being said I do care about this probject, and I do plan to get to all the things that are on my to do list."),r.a.createElement("p",null,"If you want to do more than just look at the things others have put on (and which they're allowing you to see), then you'll have to register. Making it use Facebook and/or Google authentication is on my to do list. I know how to do that, but I just haven't gotten around to it. So, for now, just register and login. It currently doesn't send any emails, so if you forget your password or something, you'll have to reach out to me, and I can straighten it out. Again, that kind of thing is also on my to do list."),r.a.createElement("p",null,"Once you're logged in then you're able to start keeping track of things."),r.a.createElement("p",null,"The first thing you create is currently called a World. This is a holdover from when I was calling this my World Building App because I was aiming it for Fantasy/Sci-Fi authors (like me), but I realized that it could be used for anything really. If anyone has any suggestions for something to call this instead of World, I'm open to considering other options. Currently I'm considering changing it to 'Project', and I may do that before showing it to anyone other than family and close friends. Anyway, a World is basically the root of everything. Different Worlds aren't connected to each other. Each World has a Name, and you can choose whether or not to make it Public. If it's not Public then only the Owner (whoever created it) is able to see it. If it is Public then anyone can see it, but only the Owner can edit it. (Planned Future Features: When you create a new world you can use a template which will include generic Types common to that type of World, such as Character, Location, etc. I'm also planning to add the ability for Owners to add Collaborators to their World. Collaborators would be able to see the World, and the Owner would be able to control their other permissions as well (create/edit type, delete type, create/edit thing, and delete thing.). Only the Owner will have the ability to Edit or Delete the World itself, but they will be able to make someone else the Owner.)"),r.a.createElement("p",null,"Within a World you are able to define Types. Basically a Type is just that. It's a Type of Thing that you want to keep track of. In each Type you are able to define attributes which that Type of Thing share, such as Characters having Age, Race, Gender, Height, Weight, Skin Color, Eye Color, etc. Types can also be hierarchical through inheritance. For example, in Harry Potter I would have a 'Character' Type with all the attributes I listed above, but then I could have a 'Witch or Wizard' Type which has 'Character' as a Super Type. This means that 'Witch or Wizard' already has all those same Attributes as 'Character', but you can add more Attributes like Wand, Known Spells, etc. The way to set the Super Types for a type is with a control called a Multi Select. It's basically a textbox, but as you type it gives you suggestions. You click a suggestion and it adds a chip showing it as selected. Clicking the x on the right of the chip unselects it. When selecting a Type to be a Super Type it adds all the Attributes of that Type to the Type you're creating or editing, but they are greyed out and disabled for editing. The reason they're grey and disabled is that they come from a Super Type, so their definition is there. If a Super Type is removed then the Attributes remain, but are no longer grey and disabled. They can then be edited. There are a few more things to note however. First is that when adding a Super Type which has Super Types, those Super Types will be added as well. An example of this could be the 'Animagus' Type in Harry Potter. 'Animagus' has the Super Type 'Witch or Wizard', which has the Super Type 'Character', so when defining 'Animagus' I could add 'Witch or Wizard' as a Super Type, and that will automatically add 'Character' as well. Removing a Super Type of other Super Types will remove all Sub Types of the Super Type removed. An example of that would be removing 'Character' from 'Animagus'. This would automatically remove 'Witch or Wizard' as well. It doesn't make sense to do that for 'Animagus', but it may be necessary for you if you want to rethink how you're organizing things. The last thing to note about removing Super Types is that so long as a single Super Type exists which has an Attribute with that name, it will be greyed out and disabled. Another note about Attributes is that their names have to be unique on the Type (or Thing). It's generally a good idea to make sure that any Attributes you define with the same name also have the same Attribute type as well, otherwise you may run into Attribute name collisions. One last thing about Types. I've added an option to Types called Major Type. If it's checked then the Type is considered a Major Type and will show up in places of the UI where a regular Type will not. This makes finding, creating, and editing Things of that Type easier. I would make 'Character' a Major Type, but 'Witch or Wizard' and 'Animagus' would be regular Types. (Planned Future Features: Template Types like I have above for Template Worlds, but they're individual Types. Also add Plural Name field which will be used in the UI for places where we put the plural name of something. Currently it just adds an 's' to the end of the Type name, and I want to continue to do that if the Plural Name is left empty, but if it's not empty then display the Plural Name instead.)"),r.a.createElement("p",null,"Types have Attributes (as mentioned above). Things (which I'll get into more below) also have Attributes. The same Attributes really. In the Harry Potter World the Attributes on the 'Character' Type would then be given to every character you create afterward, but now instead of naming the Attribute and saying what type of Attribute it is, you get to specify a value for the Attribute."),r.a.createElement("p",null,"An Attribute is anything you may wish to keep track of for anything. These do not include Name or Description, because all Types and Things always have Name and Description by default. Attributes are for anything else you want to keep track of. It could be a relationship like 'Friend', 'Family Member', 'Significant Other', 'Coworker', etc. It could be skills and abilities, or possessions, or jobs, or home address, or work or school schedule. Really anything you want to keep track of which is part of something can be an Attribute. Currently there are six types of Attributes that are supported: Text, Number, True/False, Options, Type, and List. Text is just that. A Text Attribute gives you a textbox where you can type anything you want to keep track of. Number gives you a number box, which is like a textbox but it only accepts numbers, and it has arrows on the right which can be used to increment or decrement the number. True/False gives you a checkbox. Options allows you to specify possible choices for the Attribute, and then they show up in a drop down list (A quick example of this could be 'Gender' having 'Male', 'Female', and others if you wanted. They can have as many options as you want, and it can be used for whatever Attribute you want.). Specifying the choices is done using a control called a Chip Input. This looks like a regular textbox, but whenever you hit enter the text in it is added as a chip. Chips show the text, but have an x on their right which can be used to remove them. It's basically like the Multiselect except without the suggestions. The Chips are the choices that will be in the drop down list which the user has when creating or editing a Thing with that Attribute."),r.a.createElement("p",null,"The last two Attribute types are a little more complicated."),r.a.createElement("p",null,"When adding Attributes to a Type, the 'Type' Attribute type allows you to then choose from the various Types you've defined for the World, and then when you're creating or editing a Thing (such as the 'Character' 'Harry Potter') you would get all the Things of that Type as choices in a drop down list. For example you could have a 'Best Friend' Attribute which has the Attribute type of 'Type' and uses the Defined Type of 'Character'. Then when editing Harry you would have a drop down list which shows all the 'Characters' you've added to the World as possible 'Best Friends'. You would of course then choose 'Ron Weasley' (Sorry, Hermione, but you're a close second.)."),r.a.createElement("p",null,"The Attribute Type 'List' is still more complicated than 'Type'. It allows you to decide which type of 'List' it's going to be. For now it only supports 'Text', 'Options', and 'Type'. (I'm not planning to add any others, but if it's requested I may consider it. A List of Text could be anything really, so other types shouldn't be necessary.) If an Attribute is defined as a List of Text then when creating or editing a Thing the Attribute gives a Chip Input, which works the same as it does for Options (described above). A List of Options allows you to define the choices when creating or editing the Type, the same as with a regular Options Attribute, and then when creating or editing a Thing of that Type it gives a Multiselect which works the same as when choosing Super Types (described above) with the Options defined previously on the Type as the suggestions. A List of 'Type' allows you to choose a Defined Type (like with the Attribute type 'Type'), but when creating or editing a Thing it gives you a Multiselect instead of a regular drop down list so you can select more than one. With all 'List' Attributes, the items in the list are displayed separated by commas when looking at the details page rather than creating or editing."),r.a.createElement("p",null,"One last note about Attributes of type 'Type' or 'List' of 'Type'. I've made it so that if you want to choose a Defined Type which you haven't defined yet you can choose '+ Create New Type' and it opens a quick little window (modal for those who care) which lets you define a Type using just the name you want it to have. You'll have to edit that Type later to give it any Super Types or Attributes it should have, but you can create it there so you can continue defining the Type you're already working on rather than having to leave and come back to it. The same thing can be done when creating or editing a Thing with an Attribute of type 'Type' or 'List' of 'Type', but for Things the Type has already been chosen. Now you will be creating a Thing of that Type. An example of this would be if you're editing the 'Character' 'Harry Potter', but when you get to 'Best Friend' you realize you haven't added the 'Ron Weasley' 'Character' yet. You would choose '+ Create New Character', and then in the quick little window you would type 'Ron Weasley'. He would get added as a blank character with just his Name, but he would then be selected as Harry's 'Best Friend', and you could finish defining Harry, and get to Ron later."),r.a.createElement("p",null,"And one more thing about Attributes in general.  I added the ability to set Default values for attributes on the Type.  Default Values will automatically be set on any Things of that Type.  I made it as user friendly as I could think to make it."),r.a.createElement("p",null,"(Planned Future Features: Other Attribute types, including: Image, Event, and External Link. If you have any suggestions of others, feel free to recommend them.  Also need to put in validation to detect Name and Default collisions.)"),r.a.createElement("p",null,"And that brings us to Things. If you've gotten to this point, then you probably already understand what Things are, but I'll outline it anyway. The generic term Thing is used to mean any actual thing you're keeping track of. This would be your Characters, your Places, your Items, Spells, whatever. When creating or editing a Thing you are able to choose Types for the Thing (works the same as Super Types for Types), and all the Attributes of those Types are added to the Thing, but now you're able to give values for them. Again remember to avoid Attribute Name collisions (If for some reason you've defined 2 unrelated Types with an Attribute that has the same name but different Attribute types then you won't be able to have a Thing of both Types.). If a Type is edited to remove an Attribute, Things which use that Type and existed already will still have that Attribute. It will just be an orphaned Attribute. Currently there's no way to remove Attributes from Things. If a Type is edited to add Attributes then Things which already existed will gain those Attributes as soon as they're edited again. If a Type is edited and an Attribute is changed... I'm not actually sure what would happen to Things that already exist which have that Type. I'll have to test that. That's really it for Things. They're the simple part. (Planned Future Features: I'm planning to add the ability to add/remove/edit orphaned Attributes for Things. When I do, I'll probably try to find a way to make it so with adding/editing orphaned Attributes you'll be able to add the Attribute to a selected Type already on the Thing.)"),r.a.createElement("p",null,"I probably should have put Attributes below Things, but oh well."),r.a.createElement("p",null,"Other Planned Future Features:"),r.a.createElement("div",null,r.a.createElement("p",null,"Forums: I'm going to have a General Site Forum, and each World will automatically get its own Forum."),r.a.createElement("p",null,"Direct Messages: I'll add a simple messaging system to allow people to communicate directly with one another."),r.a.createElement("p",null,"Auto-links: For both Forums and DMs I'll allow users to put links to pages through a simple system similar to hashtags in Social Media. I'm thinking I also want to add this capability to Descriptions on Types and Things."),r.a.createElement("p",null,"Following Public Worlds: Currently all Public Worlds are listed in the menu, but I should make it so only those that the user follows are shown there, and have a button to pull up the full list, and add a button for people who neither own or collaborate on a Public World to 'Follow' the World."),r.a.createElement("p",null,"Home Page content: I'm planning to have actual Home Page content. This will have a link to a video tutorial for new users (which I have yet to make, and will need occasional updating after it's made), as well as things like recent software changes. I also want to make it so it can automatically have links to recently added or edited Types or Things and recent Forum posts which may be of interest to the user.")))}}]),t}(n.Component),de=Object(m.b)()(ue);var pe=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"col-sm-12"},"Template Page")}}]),t}(n.Component),me=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage}}),(function(e){return{}}))(pe),he=[{path:"/",name:"Home",icon:le.a,component:de},{path:"/Forums",name:"Forums",icon:ce.a,component:me}];var fe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleFollow=function(e,t){var n=Object(q.a)(a.props.followingWorlds);if(t)n.push(e);else{var r=n.indexOf(e);n.splice(r,1)}if(null!==a.props.user){var i=Object(M.a)({},a.props.user);i.followingWorlds=n,a.props.setFollowingWorlds(n),a.api.updateUser(i)}else a.props.setFollowingWorlds(n)},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.state={browse:!1,Filter:""},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.api.getPublicWorlds().then((function(t){e.props.setPublicWorlds(t.worlds)})),null!==this.props.user&&this.api.getWorldsForUser().then((function(t){void 0!==t.worlds&&e.props.setWorlds(t.worlds)}))}},{key:"links",value:function(){var e=this;return r.a.createElement("div",null,he.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:t.path,onClick:function(t){e.props.toggleMenu()},style:{width:"".concat(e.props.width,"px")},className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},"string"===typeof t.icon?r.a.createElement(g.a,{className:"marginLeft"},t.icon):r.a.createElement(t.icon,{className:"marginLeft"}),"\xa0",r.a.createElement(y.a,{primary:t.name,className:"marginLeft"}))))})))}},{key:"publicWorlds",value:function(){var e=this,t=[],a=[];return void 0!==this.props.publicWorlds&&null!==this.props.publicWorlds&&void 0===this.props.publicWorlds.error&&this.props.publicWorlds.forEach((function(n){e.state.browse?(""===e.state.Filter||n.Name.toLowerCase().includes(e.state.Filter.toLowerCase()))&&(e.props.followingWorlds.includes(n._id)?t.push(n):a.push(n)):e.props.followingWorlds.includes(n._id)&&t.push(n)})),this.state.browse?r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"filter"},"Filter"),r.a.createElement(Q.a,{id:"filter",name:"Filter",type:"text",autoComplete:"Off",value:this.state.Filter,onChange:this.handleUserInput,labelWidth:43,fullWidth:!0}))),r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,t.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(t._id),onClick:function(t){e.props.toggleMenu()},style:{width:"".concat(e.props.width-80,"px")},className:"MySmallerButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),r.a.createElement($.a,{size:"small",color:"primary",onClick:function(a){e.toggleFollow(t._id,!1)}},r.a.createElement(te.a,null)))})),a.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(t._id),onClick:function(t){e.props.toggleMenu()},style:{width:"".concat(e.props.width-80,"px")},className:"MySmallerButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),r.a.createElement($.a,{size:"small",color:"primary",onClick:function(a){e.toggleFollow(t._id,!0)}},r.a.createElement(ie.a,null)))}))))):t.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(t._id),onClick:function(t){e.props.toggleMenu()},style:{width:"".concat(e.props.width,"px")},className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))))}))}},{key:"myWorlds",value:function(){var e=this;return null===this.props.user||void 0===this.props.user||void 0===this.props.worlds?"":this.props.worlds.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(t._id),onClick:function(t){e.props.toggleMenu()},style:{width:"".concat(e.props.width,"px")},className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))))}))}},{key:"render",value:function(){var e=this;return r.a.createElement(X.a,null,this.links(),r.a.createElement(b.a,null,r.a.createElement(y.a,{display:"none",primary:"Public Worlds"}),r.a.createElement(ee.a,{title:"Browse Public Worlds"},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({browse:!e.state.browse})}},r.a.createElement(ae.a,null)))),this.publicWorlds(),r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"My Worlds"})),r.a.createElement(b.a,{className:"curvedButton"},r.a.createElement(p.b,{to:"/world/create",onClick:function(t){e.props.toggleMenu()},style:{width:"".concat(this.props.width,"px")},className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(ne.a,null),r.a.createElement(y.a,{primary:"Create New"})))),this.myWorlds())}}]),t}(n.Component),be=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,worlds:e.app.worlds,publicWorlds:e.app.publicWorlds,user:e.app.user,followingWorlds:e.app.followingWorlds,width:e.app.width}}),(function(e){return{setWorlds:function(t){return e(T(t))},setPublicWorlds:function(t){return e(N(t))},setFollowingWorlds:function(t){return e(L(t))},toggleMenu:function(){return e(V({}))}}}))(fe);var ye=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).menuClick=function(){a.props.toggleMenu()},a.state={},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.loadFromStorage()}},{key:"render",value:function(){return r.a.createElement(h.a,{position:"static"},r.a.createElement(f.a,null,r.a.createElement(P.a,{container:!0,spacing:0},r.a.createElement(P.a,{item:!0,xs:!0},r.a.createElement(v.a,{style:{color:"white"},"aria-label":"Menu",onClick:this.menuClick},r.a.createElement(w.a,null))),r.a.createElement(P.a,{item:!0,xs:!0},r.a.createElement(b.a,{className:"curvedButton"},r.a.createElement(y.a,{primary:null===this.props.selectedWorld?"Welcome!":this.props.selectedWorld.Name}))),r.a.createElement(P.a,{item:!0,xs:!0},r.a.createElement(p.b,{className:"float-right blue whiteFont",to:"/User/Login",activeClassName:"active"},r.a.createElement(b.a,{className:"curvedButton float-right"},r.a.createElement(g.a,null,"person"),r.a.createElement(y.a,{primary:null===this.props.user||void 0===this.props.user.username?" Login/Register":" ".concat(this.props.user.username)})))))),this.props.mobileMenuOpen?r.a.createElement(F.a,{display:{xs:"inline",sm:"none"}},r.a.createElement(be,null)):"")}}]),t}(n.Component),ge=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,user:e.app.user,selectedWorld:e.app.selectedWorld,mobileMenuOpen:!e.app.menuOpen}}),(function(e){return{setWorlds:function(t){return e(T(t))},loadFromStorage:function(){return e({type:"LOAD_FROM_STORAGE",payload:{}})},toggleMenu:function(){return e(V({}))}}}))(ye),ve=a(167),Ee=a.n(ve),we=a(278);var Te=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleFollow=function(e,t){var n=Object(q.a)(a.props.followingWorlds);if(t)n.push(e);else{var r=n.indexOf(e);n.splice(r,1)}if(null!==a.props.user){var i=Object(M.a)({},a.props.user);i.followingWorlds=n,a.props.setFollowingWorlds(n),a.api.updateUser(i)}else a.props.setFollowingWorlds(n)},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.state={browse:!1,Filter:""},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.api.getPublicWorlds().then((function(t){e.props.setPublicWorlds(t.worlds)})),setTimeout((function(){null!==e.props.user&&e.api.getWorldsForUser().then((function(t){void 0!==t.worlds&&e.props.setWorlds(t.worlds)}))}),500)}},{key:"links",value:function(){return he.map((function(e,t){return r.a.createElement(b.a,{key:t,className:"curvedButton"},r.a.createElement(p.b,{to:e.path,className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},"string"===typeof e.icon?r.a.createElement(g.a,{className:"marginLeft"},e.icon):r.a.createElement(e.icon,{className:"marginLeft"}),"\xa0",r.a.createElement(y.a,{primary:e.name,className:"marginLeft"}))))}))}},{key:"brand",value:function(){return r.a.createElement(p.b,{to:"/",className:"BlackTextButton",activeClassName:"active"},r.a.createElement(b.a,null,r.a.createElement("img",{src:Ee.a,alt:"logo",className:"App-logo"}),r.a.createElement(y.a,{primary:this.props.logoText})))}},{key:"publicWorlds",value:function(){var e=this,t=[],a=[];return void 0!==this.props.publicWorlds&&null!==this.props.publicWorlds&&void 0===this.props.publicWorlds.error&&this.props.publicWorlds.forEach((function(n){e.state.browse?(""===e.state.Filter||n.Name.toLowerCase().includes(e.state.Filter.toLowerCase()))&&(e.props.followingWorlds.includes(n._id)?t.push(n):a.push(n)):e.props.followingWorlds.includes(n._id)&&t.push(n)})),this.state.browse?r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"filter"},"Filter"),r.a.createElement(Q.a,{id:"filter",name:"Filter",type:"text",autoComplete:"Off",value:this.state.Filter,onChange:this.handleUserInput,labelWidth:43,fullWidth:!0}))),r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,t.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(t._id),className:"MySmallerButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),r.a.createElement($.a,{size:"small",color:"primary",onClick:function(a){e.toggleFollow(t._id,!1)}},r.a.createElement(te.a,null)))})),a.map((function(t,a){return r.a.createElement(b.a,{key:a,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(t._id),className:"MySmallerButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),r.a.createElement($.a,{size:"small",color:"primary",onClick:function(a){e.toggleFollow(t._id,!0)}},r.a.createElement(ie.a,null)))}))))):t.map((function(e,t){return r.a.createElement(b.a,{key:t,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(e._id),className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:e.Name,className:"marginLeft"}))))}))}},{key:"myWorlds",value:function(){return null===this.props.user||void 0===this.props.user||void 0===this.props.worlds?"":this.props.worlds.map((function(e,t){return r.a.createElement(b.a,{key:t,className:"curvedButton"},r.a.createElement(p.b,{to:"/world/details/".concat(e._id),className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(y.a,{primary:e.Name,className:"marginLeft"}))))}))}},{key:"render",value:function(){var e=this;return r.a.createElement(X.a,null,this.brand(),r.a.createElement(we.a,{light:!0}),this.links(),r.a.createElement(b.a,null,r.a.createElement(y.a,{display:"none",primary:"Public Worlds"}),r.a.createElement(ee.a,{title:"Browse Public Worlds"},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({browse:!e.state.browse})}},r.a.createElement(ae.a,null)))),this.publicWorlds(),r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"My Worlds"})),r.a.createElement(b.a,{className:"curvedButton"},r.a.createElement(p.b,{to:"/world/create",className:"MyButton",activeClassName:"active"},r.a.createElement(b.a,{button:!0},r.a.createElement(ne.a,null),r.a.createElement(y.a,{primary:"Create New"})))),this.myWorlds())}}]),t}(n.Component),De=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,worlds:e.app.worlds,publicWorlds:e.app.publicWorlds,user:e.app.user,followingWorlds:e.app.followingWorlds}}),(function(e){return{setWorlds:function(t){return e(T(t))},setPublicWorlds:function(t){return e(N(t))},setFollowingWorlds:function(t){return e(L(t))}}}))(Te),Ne=a(60);var We=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return null===this.props.selectedPage||"/".concat(this.props.selectedPage)===window.location.pathname?r.a.createElement("div",{className:"col-sm-12"},"Forum Menu Page!"):r.a.createElement(Ne.a,{to:"/".concat(this.props.selectedPage)})}}]),t}(n.Component),ke=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage}}),(function(e){return{}}))(We),Ie=a(31),Ae=a(294),Se=a(282),Oe=a(279),Ce=a(69),xe=a.n(Ce),_e=a(70),je=a.n(_e),Ve=a(153),Le=a(280),Pe=a(281),Fe=a(137);var Me=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){a.state.email&&(a.validateField("email"),a.validateField("password"),a.setState({remember:!0}))},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.handleClickShowPassword=function(){a.setState({showPassword:!a.state.showPassword})},a.handleMouseDownPassword=function(e){e.preventDefault()},a.validateField=function(e){var t=!0,n="",r=a.state[e];switch(e){case"email":n=(t=null!==r.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i))?"":"Email is invalid";break;case"password":n=(t=r.length>=6)?"":"Password is too short";break;case"confirmEmail":n=(t=r===a.state.email)?"":"Confirm Email doesn't match Email";break;case"confirmPassword":n=(t=r===a.state.password)?"":"Confirm Password doesn't match Password";break;case"username":n=(t=r.length>=2)?"":"Username is too short",t&&0!==a.state.allUsers.filter((function(e){return e.username===r})).length&&(t=!1,n="This Username is taken")}return{valid:t,message:n}},a.validateForm=function(e){var t=a.validateField("email"),n={valid:!0,message:""},r={valid:!0,message:""},i={valid:!0,message:""},s={valid:!0,message:""};switch(a.state.formMode){case"Login":r=a.validateField("password");break;case"Register":n=a.validateField("confirmEmail"),r=a.validateField("password"),i=a.validateField("confirmPassword"),s=a.validateField("username")}var l=t.valid&&r.valid&&n.valid&&i.valid&&s.valid,o=a.state.fieldValidation;o.email=t,o.password=r,o.confirmEmail=n,o.confirmPassword=i,o.username=s,a.setState({formValid:l,fieldValidation:o},e)},a.onSubmit=function(){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0},this.submitThroughAPI)}))},a.submitThroughAPI=function(){var e={email:a.state.email,password:a.state.password,username:a.state.username,followingWorlds:a.props.followingWorlds};"login"===a.state.formMode?a.api.login(e).then((function(e){if(null===e.user){var t=a.state.fieldValidation;t.loginError={message:e.error,valid:!1,show:!0},a.setState({fieldValidation:t,waiting:!1})}else{if(a.state.remember){var n=new Fe.a;n.set("email",a.state.email),n.set("password",a.state.password)}a.props.userLogin(e.user),a.api.getWorldsForUser(e.user._id).then((function(e){console.log(e.worlds),a.props.setWorlds(e.worlds),a.props.onLogin(e.user)}))}})).catch((function(e){return console.log(e)})):"register"===a.state.formMode?a.api.register(e).then((function(e){console.log(e),void 0===e.error?a.setState({message:e.message,formMode:"login",fieldValidation:{email:{valid:!0,message:""},password:{valid:!0,message:""},confirmEmail:{valid:!0,message:""},confirmPassword:{valid:!0,message:""},username:{valid:!0,message:""}},waiting:!1}):a.setState({message:e.error,waiting:!1})})).catch((function(e){return console.log(e)})):"password"===a.state.formMode&&a.api.sendReset(e).then((function(e){a.setState({message:e.message,formMode:"login",fieldValidation:{email:{valid:!0,message:""},password:{valid:!0,message:""},confirmEmail:{valid:!0,message:""},confirmPassword:{valid:!0,message:""},username:{valid:!0,message:""}},waiting:!1})})).catch((function(e){return console.log(e)}))},a.loginClick=function(){a.setState({formMode:"login"})},a.registerClick=function(){a.setState({formMode:"register"})},a.passwordClick=function(){a.setState({formMode:"password"})};var n=new Fe.a,r=n.get("email"),i=n.get("password");return a.state={formMode:"login",email:void 0===r?"":r,password:void 0===i?"":i,confirmEmail:"",confirmPassword:"",fieldValidation:{email:{valid:!0,message:""},password:{valid:!0,message:""},confirmEmail:{valid:!0,message:""},confirmPassword:{valid:!0,message:""},username:{valid:!0,message:""}},formValid:!1,remember:!1,message:"",username:"",allUsers:null},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return null===this.state.allUsers?(this.api.getAllUsers().then((function(t){e.setState({allUsers:t})})),r.a.createElement("div",null)):"login"===this.state.formMode?r.a.createElement("div",null,r.a.createElement("h2",null,"Login"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"email"},"Email"),r.a.createElement(Q.a,{id:"email",name:"email",type:"email",error:!this.state.fieldValidation.email.valid,value:this.state.email,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:40,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.email.message)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"outlined-adornment-password"},"Password"),r.a.createElement(Q.a,{id:"outlined-adornment-password",name:"password",type:this.state.showPassword?"text":"password",value:this.state.password,error:!this.state.fieldValidation.password.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(v.a,{"aria-label":"toggle password visibility",onClick:this.handleClickShowPassword,onMouseDown:this.handleMouseDownPassword,edge:"end"},this.state.showPassword?r.a.createElement(xe.a,null):r.a.createElement(je.a,null))),labelWidth:70,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.password.message)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:this.state.remember,onChange:this.handleUserInput,name:"remember",color:"primary"}),label:"Remember Me"}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"float-left"},r.a.createElement(Pe.a,{onClick:this.registerClick},"Register")," ",r.a.createElement(Pe.a,{onClick:this.passwordClick},"Forgot Password")),r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{className:"w-200",variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.onSubmit,type:"submit"},this.state.waiting?"Please Wait":"Submit")))),this.state.message,Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))):"register"===this.state.formMode?r.a.createElement("div",null,r.a.createElement("h2",null,"Register"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"username"},"Username"),r.a.createElement(Q.a,{id:"username",name:"username",type:"text",value:this.state.username,error:!this.state.fieldValidation.username.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:80,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.username.message))))),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"email"},"Email"),r.a.createElement(Q.a,{id:"email",name:"email",type:"email",value:this.state.email,error:!this.state.fieldValidation.email.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:40,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.email.message)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"confirmEmail"},"Confirm Email"),r.a.createElement(Q.a,{id:"confirmEmail",name:"confirmEmail",type:"email",error:!this.state.fieldValidation.confirmEmail.valid,value:this.state.confirmEmail,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:100,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.confirmEmail.message)))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"outlined-adornment-password"},"Password"),r.a.createElement(Q.a,{id:"outlined-adornment-password",name:"password",type:this.state.showPassword?"text":"password",value:this.state.password,error:!this.state.fieldValidation.password.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(v.a,{"aria-label":"toggle password visibility",onClick:this.handleClickShowPassword,onMouseDown:this.handleMouseDownPassword,edge:"end"},this.state.showPassword?r.a.createElement(xe.a,null):r.a.createElement(je.a,null))),labelWidth:70,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.password.message)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"confirm-password"},"Confirm Password"),r.a.createElement(Q.a,{id:"confirm-password",name:"confirmPassword",type:this.state.showPassword?"text":"password",value:this.state.confirmPassword,error:!this.state.fieldValidation.confirmPassword.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(v.a,{"aria-label":"toggle password visibility",onClick:this.handleClickShowPassword,onMouseDown:this.handleMouseDownPassword,edge:"end"},this.state.showPassword?r.a.createElement(xe.a,null):r.a.createElement(je.a,null))),labelWidth:130,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.confirmPassword.message)))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"float-left"},r.a.createElement(Pe.a,{onClick:this.loginClick},"Login")," ",r.a.createElement(Pe.a,{onClick:this.passwordClick},"Forgot Password")," "),r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{className:"w-200",variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.onSubmit,type:"submit"},this.state.waiting?"Please Wait":"Submit")))),this.state.message,Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))):"password"===this.state.formMode?r.a.createElement("div",null,r.a.createElement("h2",null,"Forgot Password?"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"email"},"Email"),r.a.createElement(Q.a,{id:"email",name:"email",type:"email",value:this.state.email,error:!this.state.fieldValidation.email.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:40,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.email.message)))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"float-left"},r.a.createElement(Pe.a,{onClick:this.registerClick},"Register")," ",r.a.createElement(Pe.a,{onClick:this.loginClick},"Login")),r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{className:"w-200",variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.onSubmit,type:"submit"},this.state.waiting?"Please Wait":"Submit")))),this.state.message,Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))):void 0}}]),t}(n.Component),Be=Object(m.b)((function(e){return{user:e.app.user,loginError:e.app.loginError,followingWorlds:e.app.followingWorlds}}),(function(e){return{userLogin:function(t){return e({type:"LOGIN",payload:t})},setWorlds:function(t){return e(T(t))},setFollowingWorlds:function(t){return e(L(t))}}}))(Me),Re=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){},a.state={redirectTo:null},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return null!==this.state.redirectTo?r.a.createElement(Ne.a,{to:this.state.redirectTo}):r.a.createElement("div",null,r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,"Author's Notebook: Login")),r.a.createElement(Be,{onLogin:function(t){e.setState({redirectTo:"/"})}}))}}]),t}(n.Component),Ue=Object(m.b)()(Re);var He=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"col-sm-12"},"Profile Page")}}]),t}(n.Component),ze=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage}}),(function(e){return{}}))(He),Je=a(45),Ye=a.n(Je),Ge=a(71),qe=a.n(Ge),Ke=a(296),Ze=a(284),Qe=a(283),Xe=a(119),$e=a.n(Xe),et=a(120),tt=a.n(et),at=a(121),nt=a.n(at);var rt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange_old=function(e){return function(t,n){a.setState({expandedPanel:!!n&&e})}},a.handleChange=function(e){a.setState({expandedPanel:a.state.expandedPanel!==e&&e})},a.state={expandedPanel:!1,redirectTo:null},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"renderListForType",value:function(e){var t=this,a=this.props.things.filter((function(t){return t.TypeIDs.includes(e._id)}));return r.a.createElement("div",{className:"Things"},r.a.createElement(X.a,{style:{width:"240px"}},r.a.createElement(b.a,null,r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){t.setState({redirectTo:"/thing/create/type_id_".concat(e._id)})}},r.a.createElement(Ye.a,null),r.a.createElement(y.a,{primary:"Create New ".concat(e.Name)}))),a.map((function(e,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){t.setState({redirectTo:"/thing/details/".concat(e._id)})}},r.a.createElement(y.a,{primary:e.Name,className:"marginLeft"})))}))))}},{key:"renderMajorTypelessThings",value:function(){var e=this,t=this.props.things.filter((function(e){return 0===e.Types.filter((function(e){return e.Major})).length}));return r.a.createElement("div",{className:"Things"},r.a.createElement(X.a,{style:{width:"240px"}},r.a.createElement(b.a,null,r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(t){e.setState({redirectTo:"/thing/create"})}},r.a.createElement(Ye.a,null),r.a.createElement(y.a,{primary:"Create New Thing"}))),t.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"})))}))))}},{key:"render_old",value:function(){var e=this,t=this.props.things.filter((function(e){return 0===e.Types.filter((function(e){return e.Major})).length}));return r.a.createElement("div",null,r.a.createElement(Ke.a,{expanded:"TYPES"===this.state.expandedPanel,onChange:this.handleChange("TYPES")},r.a.createElement(Qe.a,{expandIcon:r.a.createElement($e.a,null)},"Types (",this.props.types.length,")"),r.a.createElement(Ze.a,null,r.a.createElement(X.a,{style:{width:"240px"}},r.a.createElement(b.a,null,r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(t){e.setState({redirectTo:"/type/create"})}},r.a.createElement(Ye.a,null),r.a.createElement(y.a,{primary:"Create New Type"}))),this.props.types.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"})))}))))),this.props.types.filter((function(e){return e.Major})).map((function(t,a){var n=e.props.things.filter((function(e){return e.TypeIDs.includes(t._id)}));return r.a.createElement(Ke.a,{key:a,expanded:e.state.expandedPanel===t._id,onChange:e.handleChange(t._id)},r.a.createElement(Qe.a,{expandIcon:r.a.createElement($e.a,null)},t.Name,"s (",n.length,")"),r.a.createElement(Ze.a,null,r.a.createElement(X.a,{style:{width:"240px"}},r.a.createElement(b.a,null,r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/create/type_id_".concat(t._id)})}},r.a.createElement(Ye.a,null),r.a.createElement(y.a,{primary:"Create New ".concat(t.Name)}))),n.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"})))})))))})),r.a.createElement(Ke.a,{expanded:"OTHER"===this.state.expandedPanel,onChange:this.handleChange("OTHER")},r.a.createElement(Qe.a,{expandIcon:r.a.createElement($e.a,null)},"Other Things (",t.length,")"),r.a.createElement(Ze.a,null,r.a.createElement(X.a,{style:{width:"240px"}},r.a.createElement(b.a,null,r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(t){e.setState({redirectTo:"/thing/create"})}},r.a.createElement(Ye.a,null),r.a.createElement(y.a,{primary:"Create New Thing"}))),t.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"})))}))))))}},{key:"render",value:function(){var e=this;if(null!==this.state.redirectTo)return r.a.createElement(Ne.a,{to:this.state.redirectTo});var t=this.props.things.filter((function(e){return 0===e.Types.filter((function(e){return e.Major})).length})),a=null!==this.props.selectedWorld&&null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0),n=null!==this.props.selectedWorld&&null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0);return r.a.createElement("div",null,r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"TYPES"===this.state.expandedPanel?r.a.createElement(ee.a,{title:"Collapse Types"},r.a.createElement(Se.a,{onClick:function(t){e.handleChange("TYPES")}},r.a.createElement(tt.a,null))):r.a.createElement(ee.a,{title:"Expand Types"},r.a.createElement(Se.a,{onClick:function(t){e.handleChange("TYPES")}},r.a.createElement(nt.a,null))),r.a.createElement("span",{className:"MuiTypography-root MuiListItemText-primary MuiTypography-body1"},"Types (".concat(this.props.types.length,")")),n?r.a.createElement(ee.a,{title:"Create New Type"},r.a.createElement(Se.a,{onClick:function(t){e.setState({redirectTo:"/type/create"})}},r.a.createElement(Ye.a,null))):""),"TYPES"===this.state.expandedPanel?r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,{style:{maxWidth:"300px"}},this.props.types.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(ee.a,{title:"Details for ".concat(t.Name)},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),n?r.a.createElement(P.a,{container:!0,spacing:0,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(ee.a,{title:"Create New ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/thing/create/type_id_".concat(t._id)})}},r.a.createElement(Ye.a,null)))),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(ee.a,{title:"Edit ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/type/edit/".concat(t._id)})}},r.a.createElement(qe.a,null))))):"")})))):"")),this.props.types.filter((function(e){return e.Major})).map((function(t,i){var s=e.props.things.filter((function(e){return e.TypeIDs.includes(t._id)}));return r.a.createElement(b.a,{key:i},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},e.state.expandedPanel===t._id?r.a.createElement(ee.a,{title:"Collapse ".concat(t.Name,"s")},r.a.createElement(Se.a,{onClick:function(a){e.handleChange(t._id)}},r.a.createElement(tt.a,null))):r.a.createElement(ee.a,{title:"Expand ".concat(t.Name,"s")},r.a.createElement(Se.a,{onClick:function(a){e.handleChange(t._id)}},r.a.createElement(nt.a,null))),r.a.createElement(ee.a,{title:"Details for ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,null,t.Name,"s (",s.length,")"))),n?r.a.createElement("span",null,r.a.createElement(ee.a,{title:"Create New ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/thing/create/type_id_".concat(t._id)})}},r.a.createElement(Ye.a,null))),r.a.createElement(ee.a,{title:"Edit ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/type/edit/".concat(t._id)})}},r.a.createElement(qe.a,null)))):""),e.state.expandedPanel===t._id?r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,{style:{maxWidth:"300px"}},s.map((function(t,n){return r.a.createElement(b.a,{key:n},r.a.createElement(ee.a,{title:"Details for ".concat(t.Name)},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),a?r.a.createElement(ee.a,{title:"Edit ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/thing/edit/".concat(t._id)})}},r.a.createElement(qe.a,null))):"")})))):""))})),r.a.createElement(b.a,null,r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"OTHER"===this.state.expandedPanel?r.a.createElement(ee.a,{title:"Collapse Other Things"},r.a.createElement(Se.a,{onClick:function(t){e.handleChange("OTHER")}},r.a.createElement(tt.a,null))):r.a.createElement(ee.a,{title:"Expand Other Things"},r.a.createElement(Se.a,{onClick:function(t){e.handleChange("OTHER")}},r.a.createElement(nt.a,null))),r.a.createElement("span",{className:"MuiTypography-root MuiListItemText-primary MuiTypography-body1"},"Other Things (".concat(t.length,")")),n?r.a.createElement(ee.a,{title:"Create New Thing"},r.a.createElement(Se.a,{onClick:function(t){e.setState({redirectTo:"/thing/create"})}},r.a.createElement(Ye.a,null))):""),"OTHER"===this.state.expandedPanel?r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,{style:{maxWidth:"300px"}},t.map((function(t,n){return r.a.createElement(b.a,{key:n},r.a.createElement(ee.a,{title:"Details for ".concat(t.Name)},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name,className:"marginLeft"}))),a?r.a.createElement(ee.a,{title:"Edit ".concat(t.Name)},r.a.createElement(Se.a,{onClick:function(a){e.setState({redirectTo:"/thing/edit/".concat(t._id)})}},r.a.createElement(qe.a,null))):"")})))):""))))}}]),t}(n.Component),it=Object(m.b)((function(e){return{things:e.app.things,types:e.app.types,selectedWorld:e.app.selectedWorld,user:e.app.user}}),(function(e){return{}}))(rt),st=a(168),lt=a.n(st),ot=a(295),ct=a(285);var ut=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).delete=function(e){a.api.deleteWorld(a.props.selectedWorldID).then((function(e){var t=a.props.worlds.filter((function(e){return e._id!==a.props.selectedWorldID}));a.props.setWorlds(t),t=a.props.publicWorlds.filter((function(e){return e._id!==a.props.selectedWorldID})),a.props.setPublicWorlds(t),a.api.selectWorld(null),a.props.selectWorld(null),a.setState({modalOpen:!1,redirectTo:"/"})}))},a.getModalStyle=function(){var e=Math.round(window.innerHeight/2)-50,t=Math.round(window.innerWidth/2)-200;return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(".concat(t,"px, ").concat(e,"px)")}},a.load=function(e){setTimeout((function(){a.props.selectWorld(e),a.api.selectWorld(e).then((function(e){a.getAttributes()}))}),500)},a.requestToCollaborate=function(){a.api.requestToCollaborate(a.props.selectedWorldID).then((function(e){var t=a.props.selectedWorld;t.Collaborators.push(e),a.props.updatePublicWorldForCollab(t)}))},a.respondToInvite=function(){var e=a.props.selectedWorld.Collaborators.filter((function(e){return e.userID===a.props.user._id&&"invite"===e.type}))[0];a.setState({redirectTo:"/world/collaborate/".concat(a.props.selectedWorldID,"/").concat(e.collabID)})},a.state={world:null,modalOpen:!1,redirectTo:null},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"getAttributes",value:function(){var e=this;this.api.getAttributesForWorld(this.props.selectedWorldID).then((function(t){void 0!==t&&void 0===t.error&&(e.props.setAttributes(t.attributes),e.getTypes())}))}},{key:"getTypes",value:function(){var e=this;this.api.getTypesForWorld(this.props.selectedWorldID).then((function(t){if(void 0!==t&&void 0===t.error){var a=t.types;a.forEach((function(t){t.Supers=[],t.SuperIDs.forEach((function(e){t.Supers=t.Supers.concat(a.filter((function(t){return t._id===e})))})),t.AttributesArr=[],t.Attributes.forEach((function(a){var n=e.props.attributesByID[a.attrID];t.AttributesArr.push({index:t.AttributesArr.length,Name:n.Name,AttributeType:n.AttributeType,Options:n.Options,DefinedType:n.DefinedType,ListType:n.ListType,attrID:a.attrID})}));var n={};void 0!==t.Defaults&&t.Defaults.forEach((function(e){n[e.attrID]=e})),t.DefaultsHash=n})),e.props.setTypes(a),e.getThings()}}))}},{key:"getThings",value:function(){var e=this;this.api.getThingsForWorld(this.props.selectedWorldID).then((function(t){if(void 0!==t&&void 0===t.error){var a=t.things;a.forEach((function(t){t.Types=[],t.TypeIDs.forEach((function(a){t.Types=t.Types.concat(e.props.types.filter((function(e){return e._id===a})))}))})),e.props.setThings(a)}}))}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;return null!==this.props.selectedWorldID&&this.props.selectedWorldID===t||this.load(t),null!==this.state.redirectTo?r.a.createElement(Ne.a,{to:this.state.redirectTo}):null===this.props.selectedWorld||this.props.selectedWorld.Public||null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||0!==this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type})).length)?r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:0,direction:"column"},null===this.props.selectedWorld?"":r.a.createElement(P.a,{item:!0,container:!0,spacing:0,direction:"row"},r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,"Author's Notebook: ".concat(this.props.selectedWorld.Name))),r.a.createElement(P.a,{item:!0,xs:9},r.a.createElement("h2",null,this.props.selectedWorld.Name)),r.a.createElement(P.a,{item:!0,xs:3},null!==this.props.user&&null!==this.props.user&&this.props.selectedWorld.Owner===this.props.user._id?r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Edit ".concat(this.props.selectedWorld.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/edit/".concat(e.props.selectedWorldID)})}},r.a.createElement(qe.a,null)))),r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Edit Collaborators"},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/collaborators/".concat(e.props.selectedWorldID)})}},r.a.createElement(ct.a,null)))),r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Delete ".concat(this.props.selectedWorld.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({modalOpen:!0})}},r.a.createElement(lt.a,null))))):r.a.createElement(X.a,null,0===this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id})).length?r.a.createElement(b.a,null,this.props.selectedWorld.AcceptingCollaborators&&r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:this.requestToCollaborate,type:"button"},"Request to Collaborate")):this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"request"===t.type})).length>0?r.a.createElement(b.a,null,"Waiting on Collaboration Request"):this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"invite"===t.type})).length>0&&r.a.createElement(b.a,null,r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:this.respondToInvite,type:"button"},"You've been invited to Collaborate"))))),r.a.createElement(P.a,{item:!0},r.a.createElement(it,null)),r.a.createElement(ot.a,{"aria-labelledby":"delete-thing-modal","aria-describedby":"delete-thing-modal-description",open:this.state.modalOpen,onClose:function(t){e.setState({modalOpen:!1})}},r.a.createElement("div",{style:this.getModalStyle(),className:"paper"},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Are you sure you want to delete ",null!==this.props.selectedWorld?this.props.selectedWorld.Name:"","?"),r.a.createElement(P.a,{item:!0},"(All external references to it will be left alone and may not work correctly)"),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:this.delete},"Yes")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",onClick:function(t){e.setState({modalOpen:!1})}},"Cancel"))))))):r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),dt=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,worlds:e.app.worlds,publicWorlds:e.app.publicWorlds,types:e.app.types,things:e.app.things,user:e.app.user,attributesByID:e.app.attributesByID}}),(function(e){return{selectWorld:function(t){return e(W(t))},setTypes:function(t){return e(I(t))},setThings:function(t){return e(S(t))},setWorlds:function(t){return e(T(t))},setPublicWorlds:function(t){return e(N(t))},updatePublicWorldForCollab:function(t){return e({type:"UPDATE_PUBLIC_WORLD_COLLAB",payload:t})},setAttributes:function(t){return e(k(t))}}}))(ut),pt=a(286);var mt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;void 0!==r[t]&&r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.a11yProps=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},a.validateField=function(e){var t=a.state[e],n=!0,r="";switch(e){case"Name":(n=null!==t.match(/^[a-zA-Z0-9 ]*$/i))?t.length<4?(n=!1,r="World Name is too short"):(n=0===a.props.worlds.filter((function(e){return e.Name===t&&e._id!==a.state._id})).length)||(r="This World Name is already in use"):r="Only Letters, Numbers, and Spaces allowed in World Names";break;case"inviteEmail":r=(n=null!==t.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i))?"":"Email is invalid"}return{valid:n,message:r}},a.validateForm=function(e){var t=a.validateField("Name"),n=t.valid,r=a.state.fieldValidation;r.Name=t,a.setState({formValid:n,fieldValidation:r},e)},a.onSubmit=function(){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0},this.submitThroughAPI)}))},a.submitThroughAPI=function(){var e={_id:a.state._id,Name:a.state.Name,Public:a.state.Public,AcceptingCollaborators:a.state.AcceptingCollaborators,Owner:a.props.user._id};null===e._id?a.api.createWorld(e).then((function(t){void 0!==t.error?a.setState({message:t.error}):(e._id=t.worldID,a.props.addWorld(e),a.setState({waiting:!1,redirectTo:"/world/details/".concat(t.worldID)}))})).catch((function(e){return console.log(e)})):a.api.updateWorld(e).then((function(t){void 0!==t.error?a.setState({message:t.error}):(a.props.updateWorld(e),a.setState({waiting:!1,redirectTo:"/world/details/".concat(a.props.selectedWorld._id)}))})).catch((function(e){return console.log(e)}))},a.state={_id:null,Name:"",Public:!1,AcceptingCollaborators:!1,fieldValidation:{Name:{valid:!0,message:""}},formValid:!1,message:"",redirectTo:null},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){if(void 0!==e.props.match.params.id){var t=e.props.match.params.id,a=e.props.worlds.filter((function(e){return e._id===t}));a.length>0&&(a=a[0],e.setState({Name:a.Name,Public:a.Public,AcceptingCollaborators:void 0!==a.AcceptingCollaborators&&null!==a.AcceptingCollaborators&&a.AcceptingCollaborators,_id:t}),e.api.selectWorld(t),e.props.selectWorld(t))}else e.api.selectWorld(null),e.props.selectWorld(null)}),500)}},{key:"render",value:function(){var e=this;return null!==this.state.redirectTo?r.a.createElement(Ne.a,{to:this.state.redirectTo}):null===this.props.selectedWorld||null!==this.props.user&&this.props.selectedWorld.Owner===this.props.user._id?r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:1,direction:"column"},r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,null===this.state._id?"Author's Notebook: Create New World":"Author's Notebook: Edit ".concat(this.props.selectedWorld.Name))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:1},null!==this.props.selectedWorld&&r.a.createElement(ee.a,{title:"Back to ".concat(this.props.selectedWorld.Name," Details")},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)})}},r.a.createElement(pt.a,null)))),r.a.createElement(P.a,{item:!0,xs:11},r.a.createElement("h2",null,null===this.state._id?"Create New World":"Edit World"))),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"name"},"Name"),r.a.createElement(Q.a,{id:"name",name:"Name",type:"text",autoComplete:"Off",error:!this.state.fieldValidation.Name.valid,value:this.state.Name,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.Name.message))),r.a.createElement(P.a,{item:!0},r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:this.state.Public,onChange:this.handleUserInput,name:"Public",color:"primary"}),label:"Public"}),this.state.Public?r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:this.state.AcceptingCollaborators,onChange:this.handleUserInput,name:"AcceptingCollaborators",color:"primary"}),label:"Accepting Collaborator Requests"}):""),r.a.createElement(P.a,{item:!0},r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{variant:"contained",color:"primary",className:"w-200",disabled:this.state.waiting,onClick:this.onSubmit,type:"submit"},this.state.waiting?"Please Wait":"Submit"),r.a.createElement(Se.a,{variant:"contained",style:{marginLeft:"4px"},disabled:this.state.waiting,onClick:function(t){e.setState({redirectTo:null===e.state._id?"/":"/world/details/".concat(e.state._id)})},type:"button"},"Cancel"))),r.a.createElement(P.a,{item:!0},this.state.message),r.a.createElement(P.a,{item:!0},Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""})))):r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),ht=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,worlds:e.app.worlds,user:e.app.user}}),(function(e){return{selectWorld:function(t){return e(W(t))},addWorld:function(t){return e({type:"ADD_WORLD",payload:t})},updateWorld:function(t){return e(D(t))}}}))(mt);var ft=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){},a.accept=function(){null===a.props.user?a.setState({waiting:!1,accepted:!0}):a.setState({waiting:!0},a.submitAccept)},a.submitAccept=function(){a.api.acceptCollabInvite(a.state.worldID,a.state.collabID).then((function(e){a.setState({waiting:!1,accepted:!0},a.getWorlds)}))},a.getWorlds=function(){a.api.getWorldsForUser().then((function(e){void 0!==e.worlds&&a.props.setWorlds(e.worlds)}))},a.onLoginAccept=function(e){a.setState({waiting:!0},a.submitAccept)},a.decline=function(){a.setState({waiting:!0},a.submitDecline)},a.submitDecline=function(){a.api.declineCollabInvite(a.state.worldID,a.state.collabID).then((function(e){a.setState({waiting:!1,accepted:!1})}))},a.state={worldID:null,collabID:null,codeValid:!1,accepted:null,message:"Please wait.  Validating code.",world:null},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;if(null===this.state.collabID){var t=this.props.match.params,a=t.worldID,n=t.collabID;return setTimeout((function(){e.api.checkCollabID(a,n).then((function(t){void 0!==t.error?e.setState({collabID:n,worldID:a,codeValid:!1,message:t.error}):e.setState({collabID:n,worldID:a,world:t.world,codeValid:!0,message:""})}))}),500),r.a.createElement("div",null,r.a.createElement("h2",null,this.state.message))}return this.state.codeValid?null===this.state.accepted?r.a.createElement(P.a,{container:!0,spacing:1},r.a.createElement(P.a,{item:!0,xs:12},r.a.createElement("h2",null,"You've been invited to collaborate on ",this.state.world.Name)),r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:1},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{className:"w-200",variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.accept,type:"button"},"Accept")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{className:"w-200",variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.decline,type:"button"},"Decline")))):this.state.accepted?null===this.props.user?r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement("h2",null,"Please log in (or register and then log in if you're new) so we can add you as a collaborator on ",this.state.world.Name,".")),r.a.createElement(P.a,{item:!0},r.a.createElement(Be,{onLogin:this.onLoginAccept}))):r.a.createElement(P.a,{container:!0,spacing:1},r.a.createElement(P.a,{item:!0,xs:12},r.a.createElement("h2",null,"Congratulations! You can now collaborate on ",this.state.world.Name))):r.a.createElement(P.a,{container:!0,spacing:1},r.a.createElement(P.a,{item:!0,xs:12},"Okay.  Well, we hope you enjoy working on other worlds.")):r.a.createElement("div",null,r.a.createElement("h2",null,this.state.message))}}]),t}(n.Component),bt=Object(m.b)((function(e){return{user:e.app.user}}),(function(e){return{setWorlds:function(t){return e(T(t))}}}))(ft),yt=a(287),gt=a(293),vt=a(288),Et=a(292),wt=a(289),Tt=a(290);function Dt(e){var t=e.children,a=e.value,n=e.index;return r.a.createElement("div",null,a===n&&r.a.createElement(F.a,{p:3},t))}var Nt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;void 0!==r[t]&&r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.a11yProps=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},a.validateField=function(e){var t=a.state[e],n=!0,r="";switch(e){case"inviteEmail":r=(n=null!==t.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i))?"":"Email is invalid"}return{valid:n,message:r}},a.addNewCollaborator=function(){a.setState({waiting:!0},(function(){var e=this;this.api.addNewCollaborator(this.props.selectedWorldID,this.state.selectedUser._id,this.state.selectedUser.email).then((function(t){if(void 0===t.error){var a=Object(q.a)(e.state.Collaborators);a.push(t);var n=e.props.selectedWorld;n.Collaborators=a,e.props.updateWorld(n),e.setState({Collaborators:a,inviteMessage:"Invite Sent",selectedUser:"",waiting:!1})}else e.setState({message:t.error,waiting:!1})}))}))},a.emailCollaborator=function(){if(a.validateField("inviteEmail")){a.setState({waiting:!0},(function(){var e=this;this.api.emailCollaborator(this.props.selectedWorldID,this.state.inviteEmail).then((function(t){if(void 0===t.error){var a=Object(q.a)(e.state.Collaborators);a.push(t);var n=e.props.selectedWorld;n.Collaborators=a,e.props.updateWorld(n),e.setState({Collaborators:a,inviteMessage:"Email Sent",inviteEmail:"",waiting:!1})}else e.setState({message:t.error,waiting:!1})}))}))}},a.updateCollaboratorPermission=function(e,t){e.editPermission=t,a.setState({waiting:!0},(function(){var a=this;this.api.updateCollaboratorPermission(this.props.selectedWorldID,e.collabID,t).then((function(n){if(void 0===n.error){var r=Object(q.a)(a.state.Collaborators);r.filter((function(t){return t.collabID===e.collabID}))[0].editPermission=t;var i=a.props.selectedWorld;i.Collaborators=r,a.props.updateWorld(i),a.setState({Collaborators:r,waiting:!1})}else a.setState({message:n.error,waiting:!1})}))}))},a.generateCollabLink=function(){a.setState({waiting:!0},(function(){var e=this;this.api.generateCollabLink(this.props.selectedWorldID).then((function(t){if(void 0===t.error){var a=Object(q.a)(e.state.Collaborators);a.push(t);var n=e.props.selectedWorld;n.Collaborators=a,e.props.updateWorld(n),e.setState({collabLink:t.collabLink,collabLinkCopied:!1,Collaborators:a,waiting:!1})}else e.setState({message:t.error,waiting:!1})}))}))},a.deleteCollab=function(e){a.setState({waiting:!0},(function(){var t=this;this.api.deleteCollab(this.props.selectedWorldID,e.collabID).then((function(a){if(void 0===a.error){var n=t.state.Collaborators.filter((function(t){return t.collabID!==e.collabID})),r=t.props.selectedWorld;r.Collaborators=n,t.props.updateWorld(r),t.setState({collabLink:a.collabLink,collabLinkCopied:!1,Collaborators:n,waiting:!1})}else t.setState({message:a.error,waiting:!1})}))}))},a.copyCollabLink=function(){a.generatedLink.children[0].select(),document.execCommand("copy"),a.setState({collabLinkCopied:!0})},a.state={_id:null,Collaborators:[],allUsers:null,fieldValidation:{inviteEmail:{valid:!0,message:""}},message:"",redirectTo:null,newCollaborators:!1,newCollabTab:0,collabTab:0,collabLink:null,collabLinkCopied:!1,selectedUser:"",inviteEmail:"",inviteMessage:"",waiting:!1},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){if(void 0!==e.props.match.params.id){var t=e.props.match.params.id,a=e.props.worlds.filter((function(e){return e._id===t}));a.length>0&&(a=a[0],e.setState({Name:a.Name,Public:a.Public,AcceptingCollaborators:void 0!==a.AcceptingCollaborators&&null!==a.AcceptingCollaborators&&a.AcceptingCollaborators,Collaborators:void 0===a.Collaborators?[]:a.Collaborators,_id:t}),e.api.selectWorld(t),e.props.selectWorld(t))}else e.api.selectWorld(null),e.props.selectWorld(null)}),500)}},{key:"render",value:function(){var e=this;if(null===this.state.allUsers)return this.api.getAllUsers().then((function(t){e.setState({allUsers:t})})),r.a.createElement("div",null);if(null!==this.state.redirectTo)return r.a.createElement(Ne.a,{to:this.state.redirectTo});if(null===this.props.selectedWorld||null!==this.props.user&&this.props.selectedWorld.Owner===this.props.user._id){var t=this.state.Collaborators.filter((function(e){return"collab"===e.type})),a=this.state.Collaborators.filter((function(e){return"invite"===e.type})),n=this.state.Collaborators.filter((function(e){return"request"===e.type})),i=this.state.allUsers.filter((function(t){return t._id!==e.props.selectedWorld.Owner&&0===e.state.Collaborators.filter((function(e){return e.userID===t._id})).length})).map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e},e.username)}));return r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:1,direction:"column"},r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,null===this.state._id?"Author's Notebook: Create New World":"Author's Notebook: Edit ".concat(this.props.selectedWorld.Name," Collaborators"))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:1},r.a.createElement(ee.a,{title:"Back to ".concat(this.props.selectedWorld.Name," Details")},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)})}},r.a.createElement(pt.a,null)))),r.a.createElement(P.a,{item:!0,xs:11},r.a.createElement("h2",null,"Edit Collaborators"))),r.a.createElement(P.a,{item:!0},r.a.createElement(b.a,{style:{maxWidth:"200px"}},r.a.createElement(y.a,{primary:"Collaborators"}),this.state.newCollaborators?r.a.createElement(ee.a,{title:"Manage Existing Collaborators"},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({newCollaborators:!1})}},r.a.createElement(pt.a,null))):r.a.createElement(ee.a,{title:"Add New Collaborators"},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({newCollaborators:!0})}},r.a.createElement(ne.a,null))))),this.state.newCollaborators?r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(h.a,{position:"static"},r.a.createElement(gt.a,{value:this.state.newCollabTab,onChange:function(t,a){e.setState({newCollabTab:a,inviteMessage:""})},"aria-label":"Add Collaborator Method"},r.a.createElement(vt.a,Object.assign({label:"Find Existing User"},this.a11yProps(0))),r.a.createElement(vt.a,Object.assign({label:"Invite via Email"},this.a11yProps(1))),r.a.createElement(vt.a,Object.assign({label:"Get an Invite Link"},this.a11yProps(2))))),r.a.createElement(Dt,{value:this.state.newCollabTab,index:0},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"user-select",id:"user-select-label"},"Select a User"),r.a.createElement(Et.a,{labelId:"user-select-label",id:"user-select",value:this.state.selectedUser,onChange:function(t){e.setState({selectedUser:t.target.value,inviteMessage:""})},labelWidth:90},i))),r.a.createElement(P.a,{item:!0},r.a.createElement(Se.a,{variant:"contained",color:"primary",disabled:""===this.state.selectedUser||this.state.waiting,onClick:this.addNewCollaborator},"Send Invite"),this.state.inviteMessage))),r.a.createElement(Dt,{value:this.state.newCollabTab,index:1},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"inviteEmail"},"Collaborator Email"),r.a.createElement(Q.a,{id:"inviteEmail",name:"inviteEmail",type:"email",autoComplete:"Off",error:!this.state.fieldValidation.inviteEmail.valid,value:this.state.inviteEmail,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:140,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.inviteEmail.message))),r.a.createElement(P.a,{item:!0},r.a.createElement(Se.a,{variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.emailCollaborator},"Send Invite"),this.state.inviteMessage))),r.a.createElement(Dt,{value:this.state.newCollabTab,index:2},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Generate a single use link to send someone yourself"),r.a.createElement(P.a,{item:!0},r.a.createElement(Se.a,{variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.generateCollabLink},"Generate Link")),null!==this.state.collabLink&&r.a.createElement(P.a,{item:!0},r.a.createElement(Q.a,{id:"generatedLink",name:"generatedLink",ref:function(t){return e.generatedLink=t},type:"text",multiline:!0,value:this.state.collabLink,endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(v.a,{"aria-label":"copy to clipboard",onClick:this.copyCollabLink,edge:"end"},r.a.createElement(wt.a,null))),labelWidth:70,fullWidth:!0}),this.state.collabLinkCopied&&r.a.createElement("span",{style:{fontColor:"red"}},"Link Copied to Clipboard")))))):r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(h.a,{position:"static"},r.a.createElement(gt.a,{value:this.state.collabTab,onChange:function(t,a){e.setState({collabTab:a})},"aria-label":"Collaborators"},r.a.createElement(vt.a,Object.assign({label:"Collaborators (".concat(t.length,")")},this.a11yProps(0))),r.a.createElement(vt.a,Object.assign({label:"Invites (".concat(a.length,")")},this.a11yProps(1))),r.a.createElement(vt.a,Object.assign({label:"Requests (".concat(n.length,")")},this.a11yProps(2))))),r.a.createElement(Dt,{value:this.state.collabTab,index:0},r.a.createElement(P.a,{container:!0,spacing:3,direction:"column"},t.map((function(t,a){return r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direcion:"row",key:a},r.a.createElement(P.a,{item:!0,xs:12,sm:3},e.state.allUsers.filter((function(e){return e._id===t.userID}))[0].username),r.a.createElement(P.a,{item:!0,xs:12,sm:6},r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:t.editPermission,disabled:e.state.waiting,onChange:function(a){e.updateCollaboratorPermission(t,a.target.checked)},color:"primary"}),label:"Full Permissions"})),r.a.createElement(P.a,{item:!0,xs:12,sm:3},r.a.createElement(ee.a,{title:"Remove Collaborator"},r.a.createElement($.a,{size:"small",color:"primary",disabled:e.state.waiting,onClick:function(a){e.deleteCollab(t)}},r.a.createElement(Tt.a,null)))))})))),r.a.createElement(Dt,{value:this.state.collabTab,index:1},r.a.createElement(P.a,{container:!0,spacing:3,direction:"column"},a.map((function(t,a){var n=e.state.allUsers.filter((function(e){return e._id===t.userID}));return n=0===n.length?null:n[0],r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row",key:a},r.a.createElement(P.a,{item:!0,xs:12,sm:9,container:!0,spacing:1,direction:"column"},null!==n&&r.a.createElement(P.a,{item:!0},"Username: ",n.username),""!==t.email&&r.a.createElement(P.a,{item:!0},"Email: ",t.email),r.a.createElement(P.a,{item:!0},"Invite Link: ",t.collabLink)),r.a.createElement(P.a,{item:!0,xs:12,sm:3},r.a.createElement(ee.a,{title:"Delete Invite"},r.a.createElement($.a,{size:"small",color:"primary",disabled:e.state.waiting,onClick:function(a){e.deleteCollab(t)}},r.a.createElement(Tt.a,null)))))})))),r.a.createElement(Dt,{value:this.state.collabTab,index:2},r.a.createElement(P.a,{container:!0,spacing:3,direction:"column"},n.map((function(t,a){return r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direcion:"row",key:a},r.a.createElement(P.a,{item:!0,xs:12,sm:9},e.state.allUsers.filter((function(e){return e._id===t.userID}))[0].username),r.a.createElement(P.a,{item:!0,xs:12,sm:3},r.a.createElement(ee.a,{title:"Delete Request"},r.a.createElement($.a,{size:"small",color:"primary",disabled:e.state.waiting,onClick:function(a){e.deleteCollab(t)}},r.a.createElement(Tt.a,null)))))})))))),r.a.createElement(P.a,{item:!0},this.state.message),r.a.createElement(P.a,{item:!0},Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))))}return r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),Wt=Object(m.b)((function(e){return{selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,worlds:e.app.worlds,user:e.app.user}}),(function(e){return{updateWorld:function(t){return e(D(t))},selectWorld:function(t){return e(W(t))}}}))(Nt),kt=a(291);var It=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getModalStyle=function(){var e=Math.round(window.innerHeight/2)-50,t=Math.round(window.innerWidth/2)-200;return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(".concat(t,"px, ").concat(e,"px)")}},a.delete=function(e){a.api.deleteType(a.props.selectedWorldID,a.state._id).then((function(e){var t=a.props.types.filter((function(e){return e._id!==a.state._id}));a.props.setTypes(t),a.setState({redirectTo:"/world/details/".concat(a.props.selectedWorldID)})}))},a.load=function(e){setTimeout((function(){a.setState({_id:e,redirectTo:null},a.finishLoading)}),500)},a.finishLoading=function(){var e=a.state._id;void 0!==e?a.api.getType(a.props.selectedWorldID,e).then((function(t){if(void 0===t.error){t.Supers=[],t.SuperIDs.forEach((function(e){t.Supers=t.Supers.concat(a.props.types.filter((function(t){return t._id===e})))})),t.AttributesArr=[],t.Attributes.forEach((function(e){var n=a.props.attributesByID[e.attrID];t.AttributesArr.push({index:t.AttributesArr.length,Name:n.Name,AttributeType:n.AttributeType,Options:n.Options,DefinedType:n.DefinedType,ListType:n.ListType,attrID:e.attrID})}));var n={};void 0!==t.Defaults&&t.Defaults.forEach((function(e){n[e.attrID]=e})),t.DefaultsHash=n,a.setState({Name:t.Name,Description:t.Description,_id:e,Supers:t.Supers,Major:t.Major}),a.props.updateSelectedType(t)}else console.log(t.error)})):a.props.updateSelectedType({_id:null,Name:"",Description:"",Supers:[],AttributesArr:[],Attributes:[],Major:!1})},a.state={_id:null,Name:"",Description:"",Supers:[],Major:!1,Attributes:[],fieldValidation:{Name:{valid:!0,message:""},AttributesArr:{valid:!0,message:""}},formValid:!1,message:"",redirectTo:null,modalOpen:!1},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;if(this.state._id!==t&&this.load(t),null!==this.state.redirectTo)return r.a.createElement(Ne.a,{to:this.state.redirectTo});if(null===this.props.selectedWorld||this.props.selectedWorld.Public||null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||0!==this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type})).length)){if(void 0===this.props.selectedType||null===this.props.selectedType)return r.a.createElement("span",null,"Loading");var a=this.props.types.filter((function(t){return void 0!==t.ReferenceIDs&&t.ReferenceIDs.includes(e.state._id)})),n=[];return console.log(this.props.selectedType),this.props.selectedType.Supers.forEach((function(e){e.AttributesArr.forEach((function(e){0===n.filter((function(t){return t._id===e._id})).length&&n.push(e)}))})),r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:0,direction:"column"},null===this.props.selectedWorld?"":r.a.createElement("div",null,r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,"Author's Notebook: ".concat(this.props.selectedWorld.Name))),r.a.createElement(P.a,{item:!0,container:!0,spacing:0,direction:"row"},r.a.createElement(P.a,{item:!0,xs:1},r.a.createElement(ee.a,{title:"Back to ".concat(this.props.selectedWorld.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)})}},r.a.createElement(pt.a,null)))),r.a.createElement(P.a,{item:!0,xs:5},r.a.createElement("h2",null,this.state.Name)),r.a.createElement(P.a,{item:!0,sm:3,xs:6},r.a.createElement("h3",null,this.state.Major?"Major Type":"")),r.a.createElement(P.a,{item:!0,sm:3,xs:12},r.a.createElement(X.a,null,null!==this.props.user&&null!==this.props.selectedWorld&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0)&&r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Create New ".concat(this.state.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/thing/create/type_id_".concat(e.state._id)})}},r.a.createElement(ne.a,null)))),null!==this.props.user&&null!==this.props.selectedWorld&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0)&&r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Edit ".concat(this.state.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/type/edit/".concat(e.state._id)})}},r.a.createElement(kt.a,null)))),null!==this.props.user&&null!==this.props.selectedWorld&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0)&&r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Delete ".concat(this.state.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({modalOpen:!0})}},r.a.createElement(Tt.a,null))))))),r.a.createElement(P.a,{item:!0,container:!0,spacing:0,direction:"row"},r.a.createElement(P.a,{item:!0,sm:9,xs:12,container:!0,spacing:0,direction:"column"},r.a.createElement(P.a,{item:!0},this.state.Description),r.a.createElement(P.a,{item:!0},"Attributes",r.a.createElement(X.a,null,null!==this.props.selectedType&&void 0!==this.props.selectedType&&n.map((function(t,a){var n=e.props.types.filter((function(e){return e._id===t.DefinedType}));n=0===n.length?{Name:""}:n[0];var i=e.props.selectedType.DefaultsHash[t._id];return r.a.createElement(b.a,{key:a},r.a.createElement(y.a,null,t.Name,":\xa0","Options"===t.AttributeType?r.a.createElement("span",null,"Options:",t.Options.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue&&" (Default: ".concat(i.DefaultValue,")")):"Type"===t.AttributeType?r.a.createElement("span",null,r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t.DefinedType)})}},r.a.createElement(y.a,{primary:n.Name})),void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue&&" (Default: ".concat(e.props.things.filter((function(e){return e._id===i.DefaultValue}))[0].Name,")")):"List"===t.AttributeType?r.a.createElement("span",null,"List:\xa0","Options"===t.ListType?r.a.createElement("span",null,"Options:",t.Options.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),void 0!==i&&void 0!==i.DefaultListValues&&i.DefaultListValues.length>0&&r.a.createElement("span",null,"\xa0(Defaults:",i.DefaultListValues.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),")")):"Type"===t.ListType?r.a.createElement("span",null,r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t.DefinedType)})}},r.a.createElement(y.a,{primary:n.Name})),void 0!==i&&void 0!==i.DefaultListValues&&i.DefaultListValues.length>0&&r.a.createElement("span",null,"\xa0(Defaults:",t.DefaultListValues.map((function(t,a){return r.a.createElement("span",{key:a},0===a?" ":", ",r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t)})}},r.a.createElement(y.a,{primary:e.props.things.filter((function(e){return e._id===t}))[0].Name})))})),")")):r.a.createElement("span",null,t.ListType,void 0!==i&&void 0!==i.DefaultListValues&&i.DefaultListValues.length>0&&r.a.createElement("span",null,"\xa0(Defaults:",i.DefaultListValues.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),")"))):"True/False"===t.AttributeType?r.a.createElement("span",null,t.AttributeType,void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue?" (Default: ".concat(i.DefaultValue,")"):" (Default: False)"):r.a.createElement("span",null,t.AttributeType,void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue&&" (Default: ".concat(i.DefaultValue,")"))))})),null!==this.props.selectedType&&void 0!==this.props.selectedType&&this.props.selectedType.AttributesArr.map((function(t,a){var n=e.props.types.filter((function(e){return e._id===t.DefinedType}));n=0===n.length?{Name:""}:n[0];var i=e.props.selectedType.DefaultsHash[t._id];return r.a.createElement(b.a,{key:a},r.a.createElement(y.a,null,t.Name,":\xa0","Options"===t.AttributeType?r.a.createElement("span",null,"Options:",t.Options.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue&&" (Default: ".concat(i.DefaultValue,")")):"Type"===t.AttributeType?r.a.createElement("span",null,r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t.DefinedType)})}},r.a.createElement(y.a,{primary:n.Name})),void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue&&" (Default: ".concat(e.props.things.filter((function(e){return e._id===i.DefaultValue}))[0].Name,")")):"List"===t.AttributeType?r.a.createElement("span",null,"List:\xa0","Options"===t.ListType?r.a.createElement("span",null,"Options:",t.Options.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),void 0!==i&&void 0!==i.DefaultListValues&&i.DefaultListValues.length>0&&r.a.createElement("span",null,"\xa0(Defaults:",i.DefaultListValues.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),")")):"Type"===t.ListType?r.a.createElement("span",null,r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t.DefinedType)})}},r.a.createElement(y.a,{primary:n.Name})),void 0!==i&&void 0!==i.DefaultListValues&&i.DefaultListValues.length>0&&r.a.createElement("span",null,"\xa0(Defaults:",t.DefaultListValues.map((function(t,a){return r.a.createElement("span",{key:a},0===a?" ":", ",r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t)})}},r.a.createElement(y.a,{primary:e.props.things.filter((function(e){return e._id===t}))[0].Name})))})),")")):r.a.createElement("span",null,t.ListType,void 0!==i&&void 0!==i.DefaultListValues&&i.DefaultListValues.length>0&&r.a.createElement("span",null,"\xa0(Defaults:",i.DefaultListValues.map((function(e,t){return r.a.createElement("span",{key:t},0===t?" ":", ",e)})),")"))):"True/False"===t.AttributeType?r.a.createElement("span",null,t.AttributeType,void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue?" (Default: ".concat(i.DefaultValue,")"):" (Default: False)"):r.a.createElement("span",null,t.AttributeType,void 0!==i&&void 0!==i.DefaultValue&&""!==i.DefaultValue&&" (Default: ".concat(i.DefaultValue,")"))))}))))),r.a.createElement(P.a,{item:!0,sm:3,xs:12,container:!0,spacing:0,direction:"column"},0===this.state.Supers.length&&r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"Super Types"})),this.state.Supers.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name})))})))),0===this.props.subTypes.length&&r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"Sub Types"})),this.props.subTypes.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name})))})))),0!==a.length&&r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"Referenced in:"})),a.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name})))})))),0===this.props.instances.length&&r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"Instances"})),this.props.instances.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name})))})))))),r.a.createElement(ot.a,{"aria-labelledby":"delete-type-modal","aria-describedby":"delete-type-modal-description",open:this.state.modalOpen,onClose:function(t){e.setState({modalOpen:!1})}},r.a.createElement("div",{style:this.getModalStyle(),className:"paper"},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Are you sure you want to delete ",this.state.Name,"?"),r.a.createElement(P.a,{item:!0},"(All references to it will be left alone and may not work correctly)"),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:this.delete},"Yes")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",onClick:function(t){e.setState({modalOpen:!1})}},"Cancel"))))))))}return r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),At=Object(m.b)((function(e){var t=e.app.selectedType,a=null===t?[]:e.app.types.filter((function(e){return e.SuperIDs.includes(t._id)})),n=null===t?[]:e.app.things.filter((function(e){return e.TypeIDs.includes(t._id)}));return{selectedPage:e.app.selectedPage,selectedType:t,selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,types:e.app.types,subTypes:a,instances:n,user:e.app.user,things:e.app.things,attributesByID:e.app.attributesByID,attributesByName:e.app.attributesByName}}),(function(e){return{updateSelectedType:function(t){return e(x(t))},addType:function(t){return e(A(t))},updateType:function(t){return e(C(t))},setTypes:function(t){return e(I(t))},setAttributes:function(t){return e(k(t))}}}))(It),St=a(49),Ot=a(169),Ct=a(172),xt=a(170),_t=a.n(xt),jt=a(81),Vt=a(171),Lt=a.n(Vt),Pt=a(65),Ft=a.n(Pt),Mt=function(e,t){var a=t.attribute;if(a.DefinedType=e.target.value,"new"===e.target.value){t.onNewType((function(e){a.DefinedType=e._id,t.onChange(a)}))}else t.onChange(a)},Bt=function(e,t){var a=t.attribute;a.Options=e,t.onChange(a)};function Rt(e){var t=Object(n.useState)(e.attribute.Name),a=Object(jt.a)(t,2),i=a[0],s=a[1],l=["Text","Number","True/False","Options","Type","List"],o=["Text","Options","Type"],c=void 0===e.attribute.AttributeType||null===e.attribute.AttributeType||""===e.attribute.AttributeType?l[0]:e.attribute.AttributeType,u=void 0===e.attribute.ListType||""===e.attribute.ListType?o[0]:e.attribute.ListType,d=void 0===e.attribute.DefinedType||""===e.attribute.DefinedType?"":e.attribute.DefinedType;return r.a.createElement(P.a,{container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,sm:3,xs:12},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"AttrName_".concat(e.attribute.attrID,"_").concat(e.attribute.index)},"Name"),r.a.createElement(Q.a,{disabled:e.disabled,id:"AttrName_".concat(e.attribute.attrID,"_").concat(e.attribute.index),name:"AttrName_".concat(e.attribute.attrID,"_").concat(e.attribute.index),type:"text",error:e.error,value:i,autoComplete:"off",onChange:function(e){s(e.target.value)},onBlur:function(t){var a=e.attribute;a.Name=i,e.onChange(a)},labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,e.message))),r.a.createElement(P.a,{item:!0,sm:3,xs:12},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"attribute-type",id:"attribute-type-label"},"Attribute Type"),r.a.createElement(Et.a,{labelId:"attribute-type-label",id:"attribute-type",disabled:e.disabled,value:c,onChange:function(t){!function(e,t){var a=t.attribute;a.AttributeType=e.target.value,t.onChange(a)}(t,e)},fullWidth:!0,labelWidth:100},l.map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e},e)}))))),r.a.createElement(P.a,{item:!0,sm:3,xs:12},"Options"===c?r.a.createElement(Ft.a,{variant:"outlined",disabled:e.disabled,defaultValue:e.attribute.Options,onChange:function(t){return Bt(t,e)}}):"Type"===c?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"definedType",id:"definedType-label"},"Defined Type"),r.a.createElement(Et.a,{labelId:"definedType-label",id:"definedType",disabled:e.disabled,value:d,onChange:function(t){Mt(t,e)},fullWidth:!0,labelWidth:100},r.a.createElement(yt.a,{value:"new"},"+ Create New Type"),e.types.map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e._id},e.Name)})))):"List"===c?r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"list-type",id:"list-type-label"},"List Type"),r.a.createElement(Et.a,{labelId:"list-type-label",id:"list-type",disabled:e.disabled,value:u,onChange:function(t){!function(e,t){var a=t.attribute;a.ListType=e.target.value,t.onChange(a)}(t,e)},fullWidth:!0,labelWidth:70},o.map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e},e)}))))),"Type"===e.attribute.ListType?r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"definedType",id:"definedType-label"},"Defined Type"),r.a.createElement(Et.a,{labelId:"definedType-label",id:"definedType",disabled:e.disabled,value:d,onChange:function(t){Mt(t,e)},fullWidth:!0,labelWidth:100},r.a.createElement(yt.a,{value:"new"},"+ Create New Type"),e.types.map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e._id},e.Name)}))))):"Options"===e.attribute.ListType?r.a.createElement(P.a,{item:!0},r.a.createElement(Ft.a,{variant:"outlined",disabled:e.disabled,defaultValue:e.attribute.Options,onChange:function(t){return Bt(t,e)}})):""):""),r.a.createElement(P.a,{item:!0,sm:3,xs:12},r.a.createElement(Se.a,{variant:"contained",color:"primary",className:"w200",fullWidth:!0,disabled:e.disabled,onClick:function(t){return e.onDelete(e.attribute)},type:"submit"},r.a.createElement(Lt.a,null))))}function Ut(e){var t=Object(n.useState)(e.def.DefaultValue),a=Object(jt.a)(t,2),i=a[0],s=a[1],l=""===e.attribute.AttributeType?"Text":e.attribute.AttributeType,o=[],c=[];if("List"===l&&"Options"===e.attribute.ListType)e.attribute.Options.forEach((function(e){o.push({Name:e})})),e.def.DefaultListValues.forEach((function(e){c.push({Name:e})}));else if("List"===l&&"Type"===e.attribute.ListType){var u=e.types.filter((function(t){return t._id===e.attribute.DefinedType}))[0];o.push({Name:"+ Create New ".concat(u.Name),_id:"new"}),e.things.filter((function(t){return t.TypeIDs.includes(e.attribute.DefinedType)})).forEach((function(e){o.push({Name:e.Name,_id:e._id})})),o.filter((function(t){return e.def.DefaultListValues.includes(t._id)})).forEach((function(e){c.push(e)}))}return r.a.createElement(P.a,{container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:12},"Text"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"textField"},e.attribute.Name," Default Value"),r.a.createElement(Q.a,{id:"textField",name:"textField",type:"text",error:e.error,value:i,autoComplete:"off",onChange:function(e){s(e.target.value)},onBlur:function(t){var a=e.def;a.DefaultValue=i,e.onChange(a)},labelWidth:9*e.attribute.Name.length+100,fullWidth:!0}),r.a.createElement(Ve.a,null,e.message)):"Number"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"numField"},e.attribute.Name," Default Value"),r.a.createElement(Q.a,{id:"numField",name:"numField",type:"number",error:e.error,value:i,autoComplete:"off",onChange:function(e){s(e.target.value)},onBlur:function(t){var a=e.def;a.DefaultValue=i,e.onChange(a)},labelWidth:9*e.attribute.Name.length+100,fullWidth:!0}),r.a.createElement(Ve.a,null,e.message)):"True/False"===l?r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:"True"===e.def.DefaultValue,onChange:function(t){var a=e.def;a.DefaultValue=t.target.checked?"True":"False",e.onChange(a)},color:"primary"}),label:"".concat(e.attribute.Name," Default True")}):"Options"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"options-select",id:"options-select-label"},e.attribute.Name," Default Value"),r.a.createElement(Et.a,{labelId:"options-select-label",id:"options-select",value:i,onChange:function(e){s(e.target.value)},onBlur:function(t){var a=e.def;a.DefaultValue=i,e.onChange(a)},fullWidth:!0,labelWidth:9*e.attribute.Name.length+100},e.attribute.Options.map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e},e)})))):"Type"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"type-select",id:"type-select-label"},e.attribute.Name," Default Value"),r.a.createElement(Et.a,{labelId:"type-select-label",id:"type-select",value:i,onChange:function(t){!function(e,t,a){if("new"===e.target.value){t.onNewThing((function(e){a(e._id)}),t.types.filter((function(e){return e._id===t.attribute.DefinedType}))[0])}else a(e.target.value)}(t,e,s)},onBlur:function(t){var a=e.def;a.DefaultValue=i,e.onChange(a)},fullWidth:!0,labelWidth:9*e.attribute.Name.length+100},r.a.createElement(yt.a,{value:"new"},"+ Create New"," ",e.types.filter((function(t){return t._id===e.attribute.DefinedType}))[0].Name),e.things.filter((function(t){return t.TypeIDs.includes(e.attribute.DefinedType)})).map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e._id},e.Name)})))):"List"===l?r.a.createElement("span",null,"Text"===e.attribute.ListType?r.a.createElement(Ft.a,{placeholder:"".concat(e.attribute.Name," Default Values"),variant:"outlined",defaultValue:e.def.DefaultListValues,onChange:function(t){return function(e,t){var a=t.def;a.DefaultListValues=e,t.onChange(a)}(t,e)}}):"Options"===e.attribute.ListType?r.a.createElement(St.Multiselect,{placeholder:"".concat(e.attribute.Name," Default Values"),options:o,selectedValues:c,onSelect:function(t,a){!function(e,t){var a=t.def;a.DefaultListValues.push(e.Name),t.onChange(a)}(a,e)},onRemove:function(t,a){!function(e,t){var a=t.def;a.DefaultListValues=[],e.forEach((function(e){a.DefaultListValues.push(e.Name)})),t.onChange(a)}(t,e)},displayValue:"Name"}):"Type"===e.attribute.ListType?r.a.createElement(St.Multiselect,{placeholder:"".concat(e.attribute.Name," Default Values"),options:o,selectedValues:c,onSelect:function(t,a){!function(e,t){if("new"===e._id){t.onNewThing((function(e){var a=t.def;a.DefaultListValues.push(e._id),t.onChange(a)}),t.types.filter((function(e){return e._id===t.attribute.DefinedType}))[0])}else{var a=t.def;a.DefaultListValues.push(e._id),t.onChange(a)}}(a,e)},onRemove:function(t,a){!function(e,t){var a=t.def;a.DefaultListValues=[],e.forEach((function(e){a.DefaultListValues.push(e._id)})),t.onChange(a)}(t,e)},displayValue:"Name"}):""):""))}function Ht(){var e=Object(Ot.a)(["\n  padding: 0 0 4px;\n  line-height: 1.5;\n  display: block;\n"]);return Ht=function(){return e},e}var zt=Object(Ct.a)("label")(Ht());var Jt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).newAttribute=function(){var e=a.props.selectedType;e.AttributesArr.push({index:e.AttributesArr.length,attrID:"null_".concat(_t()()),Name:"",AttributeType:"Text",Options:[],DefinedType:"",ListType:""}),a.props.updateSelectedType(e)},a.changeAttribute=function(e){var t=a.props.selectedType;t.AttributesArr[e.index]={index:e.index,attrID:e.attrID,Name:e.Name,AttributeType:e.AttributeType,Options:e.Options,DefinedType:e.DefinedType,ListType:e.ListType},a.props.updateSelectedType(t)},a.changeDefault=function(e){var t=a.props.selectedType;t.DefaultsHash[e.attrID]={attrID:e.attrID,DefaultValue:e.DefaultValue,DefaultListValues:e.DefaultListValues,FromTypeID:e.FromTypeID},a.props.updateSelectedType(t)},a.blurAttribute=function(e){},a.deleteAttributeOld=function(e){var t=a.props.selectedType,n=[];t.AttributesArr.forEach((function(t){t.index!==e.index&&(t.index>e.index&&t.index--,n.push(t))})),t.AttributesArr=[],a.props.updateSelectedType(t),setTimeout((function(){t.AttributesArr=n,a.props.updateSelectedType(t)}),500)},a.deleteAttribute=function(e){var t=a.props.selectedType,n=[];t.AttributesArr.forEach((function(t){t.index!==e.index&&(t.index>e.index&&t.index--,n.push(t))})),t.AttributesArr=[];var r=Object(M.a)({},t.DefaultsHash);void 0!==r[e.attrID]&&delete r[e.attrID],t.DefaultsHash={},a.props.updateSelectedType(t),setTimeout((function(){t.AttributesArr=n,t.DefaultsHash=r,a.props.updateSelectedType(t)}),500)},a.getModalStyle=function(){var e=Math.round(window.innerHeight/2)-50,t=Math.round(window.innerWidth/2)-200;return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(".concat(t,"px, ").concat(e,"px)")}},a.addNewType=function(e){a.setState({typeModalOpen:!0,modalSubmit:e})},a.addNewThing=function(e,t){a.setState({thingModalOpen:!0,modalSubmit:e,newThingType:t})},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;void 0!==r[t]&&r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.validateField=function(e){var t=null,n=!0,r="";switch(e){case"Name":(n=null!==(t=a.state[e]).match(/^[a-zA-Z0-9 ]*$/i))?t.length<2?(n=!1,a.state.thingModalOpen&&(r=a.state.newThingType.Name+" Name is too short"),r="Type Name is too short"):(n=0===a.props.types.filter((function(e){return e.Name===t&&e._id!==a.state._id})).length)||(r="This Type Name is already in use"):r="Only Letters, Numbers, and Spaces allowed in Type Names"}return{valid:n,message:r}},a.validateForm=function(e){var t=a.validateField("Name"),n=t.valid,r=a.state.fieldValidation;r.Name=t,a.setState({formValid:n,fieldValidation:r},e)},a.saveNewType=function(){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0},this.submitThroughAPI)}))},a.submitThroughAPI=function(){var e={_id:null,Name:a.state.Name,Description:"",SuperIDs:[],AttributesArr:[],Attributes:[],worldID:a.props.selectedWorldID,Major:!1};a.api.createType(e).then((function(t){void 0!==t.typeID?(e._id=t.typeID,a.props.addType(e),a.state.modalSubmit(e),a.setState({waiting:!1,typeModalOpen:!1})):void 0!==t.error&&a.setState({waiting:!1,message:t.error})})).catch((function(e){return console.log(e)}))},a.saveNewThing=function(){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0},this.submitThingThroughAPI)}))},a.submitThingThroughAPI=function(){var e=a.props.types.filter((function(e){return e._id===a.state.newThingType._id||a.state.newThingType.SuperIDs.includes(e._id)})),t=e.map((function(e){return e._id})),n={_id:null,Name:a.state.Name,Description:"",TypeIDs:t,Attributes:[],worldID:a.props.selectedWorldID};a.api.createThing(n).then((function(t){void 0!==t.thingID?(n._id=t.thingID,n.Types=e,a.props.addThing(n),a.state.modalSubmit(n),a.setState({waiting:!1,thingModalOpen:!1})):void 0!==t.error&&a.setState({waiting:!1,message:t.error})})).catch((function(e){return console.log(e)}))},a.state={typeModalOpen:!1,thingModalOpen:!1,Name:"",fieldValidation:{Name:{valid:!0,message:""}},formValid:!1,message:"",waiting:!1,defaultsMode:!1,newThingType:null},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=[];return console.log(this.props.selectedType),this.props.selectedType.SuperIDs.forEach((function(a){var n=e.props.types.filter((function(e){return e._id===a}));n.length>0&&(n=n[0]).AttributesArr.forEach((function(e){0===t.filter((function(t){return t.attrID===e.attrID})).length&&t.push(e)}))})),r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:0,direction:"column"},r.a.createElement(P.a,{item:!0},r.a.createElement(zt,null,"Attributes")),r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(P.a,{container:!0,spacing:0,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{disabled:this.state.defaultsMode,variant:"contained",color:"primary",onClick:this.newAttribute},r.a.createElement(Ye.a,null),r.a.createElement(y.a,{primary:"Create New"}))),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(t){e.setState({defaultsMode:!e.state.defaultsMode})}},r.a.createElement(y.a,{primary:this.state.defaultsMode?"Set Attribute Types":"Set Defaults"}))))),null!==this.props.selectedType&&void 0!==this.props.selectedType&&t.map((function(t,a){var n=e.props.selectedType.DefaultsHash[t.attrID];return void 0===n&&(n={attrID:t.attrID,DefaultValue:"",DefaultListValues:[]}),r.a.createElement(b.a,{key:a},e.state.defaultsMode?r.a.createElement(Ut,{typeID:e.props.selectedType._id,attribute:t,def:n,onChange:e.changeDefault,types:e.props.types,things:e.props.things,onNewThing:e.addNewThing}):r.a.createElement(Rt,{typeID:e.props.selectedType._id,disabled:!0,attribute:t,types:e.props.types,things:e.props.things,onNewType:e.addNewType}))})),null!==this.props.selectedType&&void 0!==this.props.selectedType&&this.props.selectedType.AttributesArr.map((function(t,a){var n=e.props.selectedType.DefaultsHash[t.attrID];return void 0===n&&(n={attrID:t.attrID,DefaultValue:"",DefaultListValues:[]}),r.a.createElement(b.a,{key:a},e.state.defaultsMode?r.a.createElement(Ut,{typeID:e.props.selectedType._id,attribute:t,def:n,onChange:e.changeDefault,onBlur:e.blurAttribute,types:e.props.types,things:e.props.things,onNewThing:e.addNewThing}):r.a.createElement(Rt,{typeID:e.props.selectedType._id,attribute:t,onChange:e.changeAttribute,onDelete:e.deleteAttribute,onBlur:e.blurAttribute,types:e.props.types,things:e.props.things,onNewType:e.addNewType}))})))),r.a.createElement(ot.a,{"aria-labelledby":"new-type-modal","aria-describedby":"new-type-modal-description",open:this.state.typeModalOpen,onClose:function(t){e.setState({typeModalOpen:!1})}},r.a.createElement("div",{style:this.getModalStyle(),className:"paper"},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Just give the new Type a name."),r.a.createElement(P.a,{item:!0},"(You can do the rest later.)"),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"name"},"Name"),r.a.createElement(Q.a,{id:"name",name:"Name",type:"text",autoComplete:"Off",error:!this.state.fieldValidation.Name.valid,value:this.state.Name,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.Name.message))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.saveNewType},this.state.waiting?"Please Wait":"Submit")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",onClick:function(t){e.setState({typeModalOpen:!1})}},"Cancel")))))),r.a.createElement(ot.a,{"aria-labelledby":"new-thing-modal","aria-describedby":"new-thing-modal-description",open:this.state.thingModalOpen,onClose:function(t){e.setState({thingModalOpen:!1})}},r.a.createElement("div",{style:this.getModalStyle(),className:"paper"},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Just give the new ",null===this.state.newThingType?"":this.state.newThingType.Name," a name."),r.a.createElement(P.a,{item:!0},"(You can do the rest later.)"),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"name"},"Name"),r.a.createElement(Q.a,{id:"name",name:"Name",type:"text",autoComplete:"Off",error:!this.state.fieldValidation.Name.valid,value:this.state.Name,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.Name.message))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.saveNewThing},this.state.waiting?"Please Wait":"Submit")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",onClick:function(t){e.setState({thingModalOpen:!1})}},"Cancel")))))))}}]),t}(n.Component),Yt=Object(m.b)((function(e){return{selectedType:e.app.selectedType,types:e.app.types,things:e.app.things,selectedWorldID:e.app.selectedWorldID}}),(function(e){return{updateSelectedType:function(t){return e(x(t))},addType:function(t){return e(A(t))},addThing:function(t){return e(O(t))}}}))(Jt);var Gt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).resetForm=function(){setTimeout((function(){void 0!==a.props.match.params.id?a.setState({resetting:!1,redirectTo:"/type/create"}):a.setState({resetting:!1})}),500)},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;void 0!==r[t]&&r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.validateField=function(e){var t=null,n=!0,r="";switch(e){case"Name":t=a.state[e],(n=null!==t.match(/^[a-zA-Z0-9 ]*$/i))?t.length<2?(n=!1,r="Type Name is too short"):(n=0===a.props.types.filter((function(e){return e.Name===t&&e._id!==a.state._id})).length)||(r="This Type Name is already in use"):r="Only Letters, Numbers, and Spaces allowed in Type Names";break;case"Attributes":n=!0,t=a.props.selectedType[e],r="";for(var i=function(e){return t.filter((function(a){return a.Name===t[e].Name})).length>1?(n=!1,r="Attribute Names must be unique","break"):"Type"!==t[e].AttributeType&&("List"!==t[e].AttributeType||"Type"!==t[e].ListType)||void 0!==t[e].DefinedType&&null!==t[e].DefinedType&&""!==t[e].DefinedType?"Options"!==t[e].AttributeType&&("List"!==t[e].AttributeType||"Options"!==t[e].ListType)||void 0!==t[e].Options&&null!==t[e].Options&&0!==t[e].Options.length?void 0:(n=!1,r="At least one Option must be set for ".concat(t[e].Name,"."),"break"):(n=!1,r="A Defined Type must be selected for ".concat(t[e].Name,"."),"break")},s=0;s<t.length;s++){if("break"===i(s))break}}return{valid:n,message:r}},a.validateForm=function(e){var t=a.validateField("Name"),n=a.validateField("AttributesArr"),r=t.valid&&n.valid,i=a.state.fieldValidation;i.Name=t,i.AttributesArr=n,a.setState({formValid:r,fieldValidation:i},e)},a.onSubmit=function(e){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0,addMore:e},this.submitThroughAPI)}))},a.submitThroughAPI=function(){var e=a.state.Supers.map((function(e){return e._id})),t=a.props.selectedType.AttributesArr.map((function(e){return{_id:e.attrID,Name:e.Name,AttributeType:e.AttributeType,Options:e.Options,DefinedType:e.DefinedType,ListType:e.ListType}}));a.api.upsertAttributes(a.props.selectedWorldID,t).then((function(t){var n=[];a.props.selectedType.AttributesArr.forEach((function(e){var a=e.attrID.includes("null")?t.attributes[e.Name]:e.attrID;n.push({attrID:a,index:e.index})})),a.api.getAttributesForWorld(a.props.selectedWorldID).then((function(t){void 0!==t&&void 0===t.error&&a.props.setAttributes(t.attributes);var r={_id:a.state._id,Name:a.state.Name,Description:a.state.Description,SuperIDs:e,Attributes:n,Defaults:[],worldID:a.props.selectedWorld._id,Major:a.state.Major,ReferenceIDs:[],DefaultReferenceIDs:[]};a.props.selectedType.AttributesArr.filter((function(e){return"Type"===e.AttributeType||"List"===e.AttributeType&&"Type"===e.ListType})).forEach((function(e){r.ReferenceIDs.includes(e.DefinedType)||r.ReferenceIDs.push(e.DefinedType)})),a.props.selectedType.Supers.forEach((function(e){e.AttributesArr.filter((function(e){return"Type"===e.AttributeType||"List"===e.AttributeType&&"Type"===e.ListType})).forEach((function(e){r.ReferenceIDs.includes(e.DefinedType)||r.ReferenceIDs.push(e.DefinedType)}))})),Object.keys(a.props.selectedType.DefaultsHash).forEach((function(e){var t=a.props.selectedType.DefaultsHash[e];r.Defaults.push({_id:e,FromTypeID:t.FromTypeID,DefaultValue:t.DefaultValue,DefaultListValues:t.DefaultListValues})})),null===r._id?a.api.createType(r).then((function(e){void 0!==e.typeID?(r._id=e.typeID,r.Supers=[],r.SuperIDs.forEach((function(e){r.Supers=r.Supers.concat(a.props.types.filter((function(t){return t._id===e})))})),a.props.addType(r),a.state.addMore?(a.props.updateSelectedType({_id:null,Name:"",Description:"",Supers:[],AttributesArr:[],Attributes:[],Major:!1}),a.setState({_id:null,Name:"",Description:"",Supers:[],Attributes:[],Major:!1,fieldValidation:{Name:{valid:!0,message:""},AttributesArr:{valid:!0,message:""},Attributes:{valid:!0,message:""}},formValid:!1,message:"",redirectTo:null,waiting:!1,addMore:!1,resetting:!0},a.resetForm)):a.setState({waiting:!1,redirectTo:"/world/details/".concat(a.props.selectedWorld._id)})):void 0!==e.error&&a.setState({waiting:!1,message:e.error})})).catch((function(e){return console.log(e)})):a.api.updateType(r).then((function(e){if(void 0===e.error){r.Supers=[],r.SuperIDs.forEach((function(e){r.Supers=r.Supers.concat(a.props.types.filter((function(t){return t._id===e})))})),r.AttributesArr=[],r.Attributes.forEach((function(e){var t=a.props.attributesByID[e.attrID];r.AttributesArr.push({index:r.AttributesArr.length,Name:t.Name,AttributeType:t.AttributeType,Options:t.Options,DefinedType:t.DefinedType,ListType:t.ListType,attrID:e.attrID})}));var t={};void 0!==r.Defaults&&r.Defaults.forEach((function(e){t[e.attrID]=e})),r.DefaultsHash=t,a.props.updateType(r),a.state.addMore?(a.props.updateSelectedType({_id:null,Name:"",Description:"",Supers:[],AttributesArr:[],Attributes:[],Major:!1}),a.setState({Name:"",Description:"",Supers:[],Attributes:[],Major:!1,fieldValidation:{Name:{valid:!0,message:""},AttributesArr:{valid:!0,message:""},Attributes:{valid:!0,message:""}},formValid:!1,message:"",waiting:!1,addMore:!1,resetting:!0,redirectTo:"/type/create"})):a.setState({waiting:!1,redirectTo:"/world/details/".concat(a.props.selectedWorld._id)})}else a.setState({waiting:!1,message:e.error})})).catch((function(e){return console.log(e)}))}))}))},a.supersChange=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];n.push(i),n=n.concat(i.Supers)}a.setState({Supers:n})},a.addSuperOld=function(e,t){t.Supers.forEach((function(t){0===e.filter((function(e){return e._id===t._id})).length&&e.push(t)}));for(var n=a.props.selectedType,r=Object(q.a)(n.AttributesArr),i=function(e){var a=t.AttributesArr[e];a.FromSupers.push(t._id);var n=r.filter((function(e){return e.Name===a.Name}));if(0===n.length)a.index=r.length,r.push(a);else{for(var i=Object(q.a)(n[0].FromSupers),s=0;s<a.FromSupers.length;s++){var l=a.FromSupers[s];i.includes(l)||i.push(l)}n[0].FromSupers=i}},s=0;s<t.AttributesArr.length;s++)i(s);a.setState({Supers:e}),n.AttributesArr=r,a.props.updateSelectedType(n)},a.addSuper=function(e,t){var n=a.props.selectedType;n.SuperIDs.push(t._id),t.Supers.forEach((function(t){0===e.filter((function(e){return e._id===t._id})).length&&(e.push(t),n.SuperIDs.push(t._id))})),n.Supers=e,a.props.updateSelectedType(n),a.setState({Supers:e})},a.removeSuper=function(e,t){for(var n=[],r=[],i=[t._id],s=a.props.selectedType,l=function(e){var s=a.props.types.filter((function(t){return t._id===a.state.Supers[e]._id}))[0];s._id===t._id||s.SuperIDs.includes(t._id)?i.push(s._id):(n.push(s),r.push(s._id))},o=0;o<a.state.Supers.length;o++)l(o);s.Supers=n,s.SuperIDs=r,a.props.updateSelectedType(s),a.setState({Supers:n})},a.load=function(e){setTimeout((function(){a.setState({_id:e,redirectTo:null,loaded:!1},a.finishLoading)}),500)},a.finishLoading=function(){var e=a.state._id;null!==e?a.api.getType(a.props.selectedWorldID,e).then((function(t){if(void 0===t.error){var n=a.props.types.filter((function(e){return t.SuperIDs.includes(e._id)}));t.Supers=n,t.AttributesArr=[],t.Attributes.forEach((function(e){var n=a.props.attributesByID[e.attrID];t.AttributesArr.push({index:t.AttributesArr.length,Name:n.Name,AttributeType:n.AttributeType,Options:n.Options,DefinedType:n.DefinedType,ListType:n.ListType,attrID:e.attrID})}));var r={};void 0!==t.Defaults&&t.Defaults.forEach((function(e){r[e.attrID]=e})),t.DefaultsHash=r,a.props.updateSelectedType(t),a.setState({Name:t.Name,Description:t.Description,_id:e,Supers:n,Major:t.Major,loaded:!0})}else a.setState({message:t.error,loaded:!0})})):(a.props.updateSelectedType({_id:null,Name:"",Description:"",Supers:[],SuperIDs:[],AttributesArr:[],Attributes:[],Major:!1,DefaultsHash:{}}),a.setState({loaded:!0}))},a.state={_id:void 0,Name:"",Description:"",Supers:[],Attributes:[],Major:!1,fieldValidation:{Name:{valid:!0,message:""},AttributesArr:{valid:!0,message:""},Attributes:{valid:!0,message:""}},formValid:!1,message:"",redirectTo:null,waiting:!1,addMore:!1,resetting:!1},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;if(void 0===t&&(t=null),this.state._id!==t&&this.load(t),null!==this.state.redirectTo)return r.a.createElement(Ne.a,{to:this.state.redirectTo});if(null===this.props.selectedWorld||this.props.selectedWorld.Public||null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||0!==this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length)){var a=void 0===this.props.types||null===this.state._id?this.props.types:this.props.types.filter((function(t){return t._id!==e.state._id}));return r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:1,direction:"column"},null===this.props.selectedWorld?"":r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"column"},r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,"Author's Notebook: ".concat(this.props.selectedWorld.Name))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:1},r.a.createElement(ee.a,{title:"Back to ".concat(this.props.selectedWorld.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)})}},r.a.createElement(pt.a,null)))),r.a.createElement(P.a,{item:!0,xs:11},r.a.createElement("h2",null,null===this.state._id?"Create New Type":"Edit Type"))),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"name"},"Name"),r.a.createElement(Q.a,{id:"name",name:"Name",type:"text",autoComplete:"Off",error:!this.state.fieldValidation.Name.valid,value:this.state.Name,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.Name.message))),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"description"},"Description"),r.a.createElement(Q.a,{id:"description",name:"Description",type:"text",multiline:!0,value:this.state.Description,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:82,fullWidth:!0}))),r.a.createElement(P.a,{item:!0},r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:this.state.Major,onChange:this.handleUserInput,name:"Major",color:"primary"}),label:"Major Type"})),r.a.createElement(P.a,{item:!0},this.state.resetting?"":r.a.createElement(St.Multiselect,{placeholder:"Super Types",options:a,selectedValues:this.state.Supers,onSelect:this.addSuper,onRemove:this.removeSuper,displayValue:"Name"})),r.a.createElement(P.a,{item:!0},this.state.loaded&&r.a.createElement(Yt,null)),r.a.createElement(P.a,{item:!0},Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))),r.a.createElement(P.a,{item:!0},r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{variant:"contained",color:"primary",disabled:this.state.waiting,onClick:function(t){e.onSubmit(!0)},type:"submit"},this.state.waiting?"Please Wait":"Submit and Create Another"),r.a.createElement(Se.a,{variant:"contained",color:"primary",style:{marginLeft:"4px"},className:"w-200",disabled:this.state.waiting,onClick:function(t){e.onSubmit(!1)},type:"submit"},this.state.waiting?"Please Wait":"Submit"),r.a.createElement(Se.a,{variant:"contained",style:{marginLeft:"4px"},disabled:this.state.waiting,onClick:function(t){null===e.props.selectedType._id?e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)}):e.setState({redirectTo:"/type/details/".concat(e.props.selectedType._id)})},type:"button"},"Cancel"))),r.a.createElement(P.a,{item:!0},this.state.message)))}return r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),qt=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,selectedType:e.app.selectedType,selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,types:e.app.types,user:e.app.user,attributesByID:e.app.attributesByID,attributesByName:e.app.attributesByName}}),(function(e){return{updateSelectedType:function(t){return e(x(t))},addType:function(t){return e(A(t))},updateType:function(t){return e(C(t))},addAttributes:function(t){return e({type:"ADD_ATTRIBUTES",payload:t})}}}))(Gt);var Kt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getModalStyle=function(){var e=Math.round(window.innerHeight/2)-50,t=Math.round(window.innerWidth/2)-200;return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(".concat(t,"px, ").concat(e,"px)")}},a.delete=function(e){a.api.deleteThing(a.props.selectedWorldID,a.state._id).then((function(e){var t=a.props.things.filter((function(e){return e._id!==a.state._id}));a.props.setThings(t),a.setState({redirectTo:"/world/details/".concat(a.props.selectedWorldID)})}))},a.load=function(e){setTimeout((function(){a.setState({_id:e,redirectTo:null},a.finishLoading)}),500)},a.finishLoading=function(){var e=a.state._id;void 0!==e?a.api.getThing(a.props.selectedWorldID,e).then((function(t){if(void 0===t.error){var n=[];t.TypeIDs.forEach((function(e){n=n.concat(a.props.types.filter((function(t){return t._id===e})))})),t.AttributesArr=[],t.Attributes.forEach((function(e){var n=a.props.attributesByID[e.attrID];t.AttributesArr.push({index:t.AttributesArr.length,Name:n.Name,AttributeType:n.AttributeType,Options:n.Options,DefinedType:n.DefinedType,ListType:n.ListType,attrID:e.attrID,Value:e.Value})})),a.setState({Name:t.Name,Description:t.Description,_id:e,Types:n}),a.props.updateSelectedThing(t)}else console.log(t.error)})):a.props.updateSelectedThing({_id:null,Name:"",Description:"",Types:[],AttributesArr:[]})},a.state={_id:null,Name:"",Description:"",Types:[],AttributesArr:[],fieldValidation:{Name:{valid:!0,message:""},AttributesArr:{valid:!0,message:""}},formValid:!1,message:"",redirectTo:null,modalOpen:!1},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;if(this.state._id!==t&&this.load(t),null!==this.state.redirectTo)return r.a.createElement(Ne.a,{to:this.state.redirectTo});if(null===this.props.selectedWorld||this.props.selectedWorld.Public||null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||0!==this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type})).length)){var a=this.props.things.filter((function(t){return void 0!==t.ReferenceIDs&&t.ReferenceIDs.includes(e.state._id)}));return r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:0,direction:"column"},null===this.props.selectedWorld?"":r.a.createElement("div",null,r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,"Author's Notebook: ".concat(this.props.selectedWorld.Name))),r.a.createElement(P.a,{item:!0,container:!0,spacing:0,direction:"row"},r.a.createElement(P.a,{item:!0,xs:1},r.a.createElement(ee.a,{title:"Back to ".concat(this.props.selectedWorld.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)})}},r.a.createElement(pt.a,null)))),r.a.createElement(P.a,{item:!0,xs:8},r.a.createElement("h2",null,this.state.Name)),r.a.createElement(P.a,{item:!0,xs:3},r.a.createElement(X.a,null,null!==this.props.user&&null!==this.props.selectedWorld&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0)&&r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Edit ".concat(this.state.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/thing/edit/".concat(e.state._id)})}},r.a.createElement(kt.a,null)))),null!==this.props.user&&null!==this.props.selectedWorld&&(this.props.selectedWorld.Owner===this.props.user._id||this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length>0)&&r.a.createElement(b.a,null,r.a.createElement(ee.a,{title:"Delete ".concat(this.state.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({modalOpen:!0})}},r.a.createElement(Tt.a,null))))))),r.a.createElement(P.a,{item:!0,container:!0,spacing:0,direction:"row"},r.a.createElement(P.a,{item:!0,sm:9,xs:12,container:!0,spacing:0,direction:"column"},r.a.createElement(P.a,{item:!0},this.state.Description),r.a.createElement(P.a,{item:!0},"Attributes",r.a.createElement(X.a,null,null===this.props.selectedThing||void 0===this.props.selectedThing?"":this.props.selectedThing.AttributesArr.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(y.a,null,t.Name,":\xa0","Type"===t.AttributeType&&""!==t.Value?r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t.Value)})}},r.a.createElement(y.a,{primary:e.props.things.filter((function(e){return e._id===t.Value}))[0].Name})):"List"===t.AttributeType?t.ListValues.map((function(a,n){return r.a.createElement("span",{key:n},"Type"===t.ListType?r.a.createElement("span",null,r.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:function(t){e.setState({redirectTo:"/thing/details/".concat(a)})}},r.a.createElement(y.a,{primary:e.props.things.filter((function(e){return e._id===a}))[0].Name})),"\xa0"):n>0?", ".concat(a):"".concat(a))})):t.Value))}))))),r.a.createElement(P.a,{item:!0,sm:3,xs:12,container:!0,spacing:0,direction:"column"},0===this.state.Types.length?"":r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"Types"})),this.state.Types.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/type/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name})))})))),0===a.length?"":r.a.createElement(P.a,{item:!0},r.a.createElement(X.a,null,r.a.createElement(b.a,null,r.a.createElement(y.a,{primary:"Referenced in:"})),a.map((function(t,a){return r.a.createElement(b.a,{key:a},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(a){e.setState({redirectTo:"/thing/details/".concat(t._id)})}},r.a.createElement(y.a,{primary:t.Name})))})))))),r.a.createElement(ot.a,{"aria-labelledby":"delete-thing-modal","aria-describedby":"delete-thing-modal-description",open:this.state.modalOpen,onClose:function(t){e.setState({modalOpen:!1})}},r.a.createElement("div",{style:this.getModalStyle(),className:"paper"},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Are you sure you want to delete ",this.state.Name,"?"),r.a.createElement(P.a,{item:!0},"(All references to it will be left alone and may not work correctly)"),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:this.delete},"Yes")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",onClick:function(t){e.setState({modalOpen:!1})}},"Cancel"))))))))}return r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),Zt=Object(m.b)((function(e){var t=e.app.selectedThing;return{selectedPage:e.app.selectedPage,selectedThing:t,selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,types:e.app.types,things:e.app.things,user:e.app.user,attributesByID:e.app.attributesByID}}),(function(e){return{updateSelectedThing:function(t){return e(j(t))},addThing:function(t){return e(O(t))},updateThing:function(t){return e(_(t))},setThings:function(t){return e(S(t))}}}))(Kt);function Qt(e){var t=Object(n.useState)(e.attribute.Value),a=Object(jt.a)(t,2),i=a[0],s=a[1],l=""===e.attribute.AttributeType?"Text":e.attribute.AttributeType,o=[],c=[];if("List"===l&&"Options"===e.attribute.ListType)e.attribute.Options.forEach((function(e){o.push({Name:e})})),e.attribute.ListValues.forEach((function(e){c.push({Name:e})}));else if("List"===l&&"Type"===e.attribute.ListType){var u=e.types.filter((function(t){return t._id===e.attribute.DefinedType}))[0];o.push({Name:"+ Create New ".concat(u.Name),_id:"new"}),e.things.filter((function(t){return t.TypeIDs.includes(e.attribute.DefinedType)})).forEach((function(e){o.push({Name:e.Name,_id:e._id})})),o.filter((function(t){return e.attribute.ListValues.includes(t._id)})).forEach((function(e){c.push(e)}))}return r.a.createElement(P.a,{item:!0},"Text"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"textField"},e.attribute.Name),r.a.createElement(Q.a,{id:"textField",name:"textField",type:"text",error:e.error,value:i,autoComplete:"off",onChange:function(e){s(e.target.value)},onBlur:function(t){var a={index:e.attribute.index,attrID:e.attribute.attrID,Name:e.attribute.Name,AttributeType:e.attribute.AttributeType,Options:e.attribute.Options,DefinedType:e.attribute.DefinedType,ListType:e.attribute.ListType,FromTypes:e.attribute.FromTypes,Value:i,ListValues:e.attribute.ListValues};e.onChange(a)},labelWidth:9*e.attribute.Name.length,fullWidth:!0}),r.a.createElement(Ve.a,null,e.message)):"Number"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"numField"},e.attribute.Name),r.a.createElement(Q.a,{id:"numField",name:"numField",type:"number",error:e.error,value:i,autoComplete:"off",onChange:function(e){s(e.target.value)},onBlur:function(t){var a={index:e.attribute.index,attrID:e.attribute.attrID,Name:e.attribute.Name,AttributeType:e.attribute.AttributeType,Options:e.attribute.Options,DefinedType:e.attribute.DefinedType,ListType:e.attribute.ListType,FromTypes:e.attribute.FromTypes,Value:i,ListValues:e.attribute.ListValues};e.onChange(a)},labelWidth:9*e.attribute.Name.length,fullWidth:!0}),r.a.createElement(Ve.a,null,e.message)):"True/False"===l?r.a.createElement(Le.a,{control:r.a.createElement(Ae.a,{checked:"True"===e.attribute.Value,onChange:function(t){var a=e.attribute;a.Value=t.target.checked?"True":"False",e.onChange(a)},color:"primary"}),label:e.attribute.Name}):"Options"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"options-select",id:"options-select-label"},e.attribute.Name),r.a.createElement(Et.a,{labelId:"options-select-label",id:"options-select",value:i,onChange:function(e){s(e.target.value)},onBlur:function(t){var a={index:e.attribute.index,attrID:e.attribute.attrID,Name:e.attribute.Name,AttributeType:e.attribute.AttributeType,Options:e.attribute.Options,DefinedType:e.attribute.DefinedType,ListType:e.attribute.ListType,FromTypes:e.attribute.FromTypes,Value:i,ListValues:e.attribute.ListValues};e.onChange(a)},fullWidth:!0,labelWidth:9*e.attribute.Name.length},e.attribute.Options.map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e},e)})))):"Type"===l?r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"type-select",id:"type-select-label"},e.attribute.Name),r.a.createElement(Et.a,{labelId:"type-select-label",id:"type-select",value:i,onChange:function(t){!function(e,t,a){if("new"===e.target.value){t.onNewThing((function(e){a(e._id)}),t.types.filter((function(e){return e._id===t.attribute.DefinedType}))[0])}else a(e.target.value)}(t,e,s)},onBlur:function(t){var a={index:e.attribute.index,attrID:e.attribute.attrID,Name:e.attribute.Name,AttributeType:e.attribute.AttributeType,Options:e.attribute.Options,DefinedType:e.attribute.DefinedType,ListType:e.attribute.ListType,FromTypes:e.attribute.FromTypes,Value:i,ListValues:e.attribute.ListValues};e.onChange(a)},fullWidth:!0,labelWidth:9*e.attribute.Name.length},r.a.createElement(yt.a,{value:"new"},"+ Create New"," ",e.types.filter((function(t){return t._id===e.attribute.DefinedType}))[0].Name),e.things.filter((function(t){return t.TypeIDs.includes(e.attribute.DefinedType)})).map((function(e,t){return r.a.createElement(yt.a,{key:t,value:e._id},e.Name)})))):"List"===l?r.a.createElement("span",null,"Text"===e.attribute.ListType?r.a.createElement(Ft.a,{placeholder:e.attribute.Name,variant:"outlined",defaultValue:e.attribute.ListValues,onChange:function(t){return function(e,t){var a=t.attribute;a.ListValues=e,t.onChange(a)}(t,e)}}):"Options"===e.attribute.ListType?r.a.createElement(St.Multiselect,{placeholder:e.attribute.Name,options:o,selectedValues:c,onSelect:function(t,a){!function(e,t){var a=t.attribute;a.ListValues.push(e.Name),t.onChange(a)}(a,e)},onRemove:function(t,a){!function(e,t){var a=t.attribute;a.ListValues=[],e.forEach((function(e){a.ListValues.push(e.Name)})),t.onChange(a)}(t,e)},displayValue:"Name"}):"Type"===e.attribute.ListType?r.a.createElement(St.Multiselect,{placeholder:e.attribute.Name,options:o,selectedValues:c,onSelect:function(t,a){!function(e,t){if("new"===e._id){t.onNewThing((function(e){var a=t.attribute;a.ListValues.push(e._id),t.onChange(a)}),t.types.filter((function(e){return e._id===t.attribute.DefinedType}))[0])}else{var a=t.attribute;a.ListValues.push(e._id),t.onChange(a)}}(a,e)},onRemove:function(t,a){!function(e,t){var a=t.attribute;a.ListValues=[],e.forEach((function(e){a.ListValues.push(e._id)})),t.onChange(a)}(t,e)},displayValue:"Name"}):""):"")}var Xt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).newAttribute=function(){var e=a.props.selectedThing;e.AttributesArr.push({index:e.AttributesArr.length,_id:null,Name:"",AttributeType:"Text",Options:[],DefinedType:"",ListType:"Text",FromTypes:[],Value:"",ListValues:[]}),a.props.updateSelectedThing(e)},a.changeAttribute=function(e){var t=a.props.selectedThing;t.AttributesArr[e.index]={index:e.index,attrID:e.attrID,Name:e.Name,AttributeType:e.AttributeType,Options:e.Options,DefinedType:e.DefinedType,ListType:e.ListType,FromTypes:e.FromTypes,Value:e.Value,ListValues:e.ListValues},a.props.updateSelectedThing(t)},a.blurAttribute=function(e){},a.deleteAttribute=function(e){var t=a.props.selectedThing;t.AttributesArr.splice(e.index),a.props.updateSelectedThing(t)},a.optionsChange=function(e,t){},a.addNewThing=function(e,t){a.setState({modalOpen:!0,modalSubmit:e,newThingType:t})},a.getModalStyle=function(){var e=Math.round(window.innerHeight/2)-50,t=Math.round(window.innerWidth/2)-200;return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(".concat(t,"px, ").concat(e,"px)")}},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;void 0!==r[t]&&r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.validateField=function(e){var t=null,n=!0,r="";switch(e){case"Name":(n=null!==(t=a.state[e]).match(/^[a-zA-Z0-9 ]*$/i))?t.length<2?(n=!1,r="Thing Name is too short"):(n=0===a.props.things.filter((function(e){return e.Name===t&&e._id!==a.state._id})).length)||(r="This Thing Name is already in use"):r="Only Letters, Numbers, and Spaces allowed in Thing Names"}return{valid:n,message:r}},a.validateForm=function(e){var t=a.validateField("Name"),n=t.valid,r=a.state.fieldValidation;r.Name=t,a.setState({formValid:n,fieldValidation:r},e)},a.saveNewThing=function(){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0},this.submitThroughAPI)}))},a.submitThroughAPI=function(){var e=a.props.types.filter((function(e){return e._id===a.state.newThingType._id||a.state.newThingType.SuperIDs.includes(e._id)})),t=e.map((function(e){return e._id})),n={_id:a.state._id,Name:a.state.Name,Description:"",TypeIDs:t,AttributesArr:[],worldID:a.props.selectedWorldID};a.api.createThing(n).then((function(t){void 0!==t.thingID?(n._id=t.thingID,n.Types=e,a.props.addThing(n),a.state.modalSubmit(n),a.setState({waiting:!1,modalOpen:!1})):void 0!==t.message&&a.setState({waiting:!1,message:t.message})})).catch((function(e){return console.log(e)}))},a.state={modalOpen:!1,Name:"",fieldValidation:{Name:{valid:!0,message:""}},formValid:!1,message:"",waiting:!1,newThingType:null},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Attributes"),null===this.props.selectedThing||void 0===this.props.selectedThing?"":this.props.selectedThing.AttributesArr.map((function(t,a){return r.a.createElement(Qt,{key:a,thingID:e.props.selectedThing._id,attribute:t,onChange:e.changeAttribute,onDelete:e.deleteAttribute,onBlur:e.blurAttribute,things:e.props.things,types:e.props.types,onNewThing:e.addNewThing})})),r.a.createElement(ot.a,{"aria-labelledby":"new-thing-modal","aria-describedby":"new-thing-modal-description",open:this.state.modalOpen,onClose:function(t){e.setState({modalOpen:!1})}},r.a.createElement("div",{style:this.getModalStyle(),className:"paper"},r.a.createElement(P.a,{container:!0,spacing:1,direction:"column"},r.a.createElement(P.a,{item:!0},"Just give the new ",null===this.state.newThingType?"":this.state.newThingType.Name," a name."),r.a.createElement(P.a,{item:!0},"(You can do the rest later.)"),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"name"},"Name"),r.a.createElement(Q.a,{id:"name",name:"Name",type:"text",autoComplete:"Off",error:!this.state.fieldValidation.Name.valid,value:this.state.Name,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.Name.message))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",color:"primary",disabled:this.state.waiting,onClick:this.saveNewThing},this.state.waiting?"Please Wait":"Submit")),r.a.createElement(P.a,{item:!0,xs:6},r.a.createElement(Se.a,{fullWidth:!0,variant:"contained",onClick:function(t){e.setState({modalOpen:!1})}},"Cancel")))))))}}]),t}(n.Component),$t=Object(m.b)((function(e){return{selectedThing:e.app.selectedThing,things:e.app.things,types:e.app.types,selectedWorldID:e.app.selectedWorldID}}),(function(e){return{updateSelectedThing:function(t){return e(j(t))},addThing:function(t){return e(O(t))}}}))(Xt);var ea=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).createThingFromTypeOld=function(e){var t=[];t.push(e),e.Supers.forEach((function(e){if(0===t.filter((function(t){return t._id===e._id})).length){var n=a.props.types.filter((function(t){return t._id===e._id}));n.length>0&&t.push(n[0])}}));for(var n={_id:null,Name:"",Description:"",Types:[],AttributesArr:[]},r=[],i=[],s=function(t){var a=Object(M.a)({},e.AttributesArr[t]);a.FromTypes=Object(q.a)(a.FromSupers),delete a.FromSupers,a.FromTypes.push(e._id);var n=r.filter((function(e){return e._id===a._id})),s=r.filter((function(e){return e.Name===a.Name}));if(0===n.length&&0===s.length)void 0===a.DefaultValue?(a.Value="",a.ListValues=[]):(a.Value=a.DefaultValue,a.ListValues=a.DefaultListValues),a.index=r.length,r.push(a);else if(0===n.length)(s[0].AttributeType!==a.AttributeType||"List"===a.AttributeType&&a.ListType!==s[0].ListType||"Type"===a.AttributeType&&a.DefinedType!==s[0].DefinedType||"List"===a.AttributeType&&"Type"===a.ListType&&a.DefinedType!==s[0].DefinedType)&&i.push("Attribute ".concat(a.Name," has a Name Collision.  Please resolve it."));else if(0===s.length)i.push("Attribute ".concat(a.Name," has been changed on its Type to ")),a.Name=n[0].Name;else{for(var l=Object(q.a)(n[0].FromTypes),o=0;o<a.FromTypes.length;o++){var c=a.FromTypes[o];l.includes(c)||l.push(c)}n[0].FromTypes=l}},l=0;l<e.AttributesArr.length;l++)s(l);n.AttributesArr=r,a.props.updateSelectedThing(n),a.setState({_id:null,Types:t,loaded:!0,errors:i})},a.createThingFromType=function(e){var t=[];t.push(e),e.Supers.forEach((function(e){if(0===t.filter((function(t){return t._id===e._id})).length){var n=a.props.types.filter((function(t){return t._id===e._id}));n.length>0&&t.push(n[0])}}));var n={_id:null,Name:"",Description:"",Types:[],Attributes:[]},r=[];t.forEach((function(e){for(var t=function(t){var a=Object(M.a)({},e.Attributes[t]);console.log(a),0===n.Attributes.filter((function(e){return e.attrID===a.attrID})).length&&(a.FromTypeID=e._id,a.index=e.Attributes.length+r.length,r.push(a))},a=0;a<e.Attributes.length;a++)t(a)})),t.forEach((function(e){r.forEach((function(t){void 0===e.DefaultsHash[t.attrID]||void 0===e.DefaultsHash[t.attrID].DefaultValue?(t.Value="",t.ListValues=[]):(t.Value=e.DefaultsHash[t.attrID].DefaultValue,t.ListValues=e.DefaultsHash[t.attrID].DefaultListValues)}))}));var i=[].concat(Object(q.a)(n.Attributes),r);n.AttributesArr=i,a.props.updateSelectedThing(n),a.setState({_id:null,Types:t,loaded:!0})},a.resetForm=function(){setTimeout((function(){var e=a.props.match.params.id;void 0===e||e.includes("type_id_")?a.setState({resetting:!1},a.finishResettingForm):a.setState({resetting:!1,redirectTo:"/thing/create"})}),500)},a.finishResettingForm=function(){var e=a.props.match.params.id;if(void 0!==e&&e.includes("type_id_")){var t=e.substring(8),n=a.props.types.filter((function(e){return e._id===t}));n.length>0?(n=n[0],a.createThingFromType(n)):a.setState({message:"Invalid Type"})}},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;void 0!==r[t]&&r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.validateField=function(e){var t=null,n=!0,r="";switch(e){case"Name":t=a.state[e],(n=null!==t.match(/^[a-zA-Z0-9 ]*$/i))?t.length<2?(n=!1,r="Thing Name is too short"):(n=0===a.props.things.filter((function(e){return e.Name===t&&e._id!==a.state._id})).length)||(r="This Thing Name is already in use"):r="Only Letters, Numbers, and Spaces allowed in Thing Names";break;case"AttributesArr":n=!0,(t=a.props.selectedThing[e]).forEach((function(e){n&&t.filter((function(t){return t.Name===e.Name})).length>1&&(n=!1)})),r=n?"":"Attribute Names must be unique"}return{valid:n,message:r}},a.validateForm=function(e){var t=a.validateField("Name"),n=a.validateField("AttributesArr"),r=t.valid&&n.valid,i=a.state.fieldValidation;i.Name=t,i.Attributes=n,a.setState({formValid:r,fieldValidation:i},e)},a.onSubmit=function(e){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0,addMore:e},this.submitThroughAPI)}))},a.submitThroughAPI=function(){var e=a.state.Types.map((function(e){return e._id})),t={_id:a.state._id,Name:a.state.Name,Description:a.state.Description,TypeIDs:e,Attributes:[],worldID:a.props.selectedWorld._id,ReferenceIDs:[]};a.props.selectedThing.AttributesArr.forEach((function(e){t.Attributes.push({attrID:e.attrID,index:e.index,Value:e.Value,ListValues:e.ListValues}),"Type"===e.AttributeType&&(t.ReferenceIDs.includes(e.Value)||t.ReferenceIDs.push(e.Value)),"List"===e.AttributeType&&"Type"===e.ListType&&e.ListValues.forEach((function(e){t.ReferenceIDs.includes(e)||t.ReferenceIDs.push(e)}))})),console.log(t),null===t._id?a.api.createThing(t).then((function(e){void 0===e.error?(t._id=e.thingID,t.Types=a.state.Types,a.props.addThing(t),a.state.addMore?(a.props.updateSelectedThing({_id:null,Name:"",Description:"",Types:[],Attributes:[]}),a.setState({_id:null,Name:"",Description:"",Types:[],Attributes:[],fieldValidation:{Name:{valid:!0,message:""},Attributes:{valid:!0,message:""}},formValid:!1,message:"",waiting:!1,resetting:!0},a.resetForm)):a.setState({waiting:!1,redirectTo:"/world/details/".concat(a.props.selectedWorld._id)})):a.setState({message:e.error})})).catch((function(e){return console.log(e)})):a.api.updateThing(t).then((function(e){void 0===e.error?(t.Types=a.state.Types,a.props.updateThing(t),a.state.addMore?(a.props.updateSelectedThing({_id:null,Name:"",Description:"",Types:[],Attributes:[]}),a.setState({Name:"",Description:"",Types:[],Attributes:[],fieldValidation:{Name:{valid:!0,message:""},Attributes:{valid:!0,message:""}},formValid:!1,message:"",waiting:!1,addMore:!1,resetting:!0},a.resetForm)):a.setState({waiting:!1,redirectTo:"/world/details/".concat(a.props.selectedWorld._id)})):a.setState({message:e.error})})).catch((function(e){return console.log(e)}))},a.typesChange=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];n.push(i),n=n.concat(i.Types)}a.setState({Types:n})},a.addTypeOld=function(e,t){t.Supers.forEach((function(t){if(0===e.filter((function(e){return e._id===t._id})).length){var n=a.props.types.filter((function(e){return e._id===t._id}));n.length>0&&e.push(n[0])}}));for(var n=a.props.selectedThing,r=Object(q.a)(n.AttributesArr),i=function(e){var a=t.AttributesArr[e];void 0===a.FromTypes&&(a.FromTypes=[]),a.FromTypes.push(t._id);var n=r.filter((function(e){return e.Name===a.Name}));if(0===n.length)void 0===a.DefaultValue?(a.Value="",a.ListValues=[]):(a.Value=a.DefaultValue,a.ListValues=a.DefaultListValues),r.push(a);else{for(var i=Object(q.a)(n[0].FromTypes),s=0;s<a.FromTypes.length;s++){var l=a.FromTypes[s];i.includes(l)||i.push(l)}"List"===n[0].AttributeType||void 0!==n[0].Value&&""!==n[0].Value||void 0===a.DefaultValue||""===a.DefaultValue?"List"===n[0].AttributeType&&void 0!==a.DefaultListValues&&a.DefaultListValues.forEach((function(e){n[0].ListValues.includes(e)||n[0].ListValues.push(e)})):n[0].Value=a.DefaultValue,n[0].FromTypes=i}},s=0;s<t.AttributesArr.length;s++)i(s);a.setState({Types:e}),n.AttributesArr=r,n.AttributesArr=[],a.props.updateSelectedThing(n),setTimeout((function(){n.AttributesArr=r,a.props.updateSelectedThing(n)}),500)},a.addType=function(e,t){var n=a.props.selectedThing,r=[];t.Supers.forEach((function(t){if(0===e.filter((function(e){return e._id===t._id})).length){var n=a.props.types.filter((function(e){return e._id===t._id}));n.length>0&&0===e.filter((function(e){return e._id===n[0]._id})).length&&(e.push(n[0]),r.push(n[0]))}0===a.state.Types.filter((function(e){return e._id===t._id})).length&&r.push(t)}));var i=[];r.forEach((function(e){for(var t=function(t){var a=Object(M.a)({},e.Attributes[t]);console.log(a),0===n.Attributes.filter((function(e){return e.attrID===a.attrID})).length&&(a.FromTypeID=e._id,a.index=e.Attributes.length+i.length,i.push(a))},a=0;a<e.Attributes.length;a++)t(a)})),r.forEach((function(e){i.forEach((function(t){void 0===e.DefaultsHash||void 0===e.DefaultsHash[t.attrID]||void 0===e.DefaultsHash[t.attrID].DefaultValue?(t.Value="",t.ListValues=[]):(t.Value=e.DefaultsHash[t.attrID].DefaultValue,t.ListValues=e.DefaultsHash[t.attrID].DefaultListValues)}))}));var s=[].concat(Object(q.a)(n.Attributes),i);a.setState({Types:e}),n.Attributes=s,n.Attributes=[],a.props.updateSelectedThing(n),setTimeout((function(){n.Attributes=s,a.props.updateSelectedThing(n)}),500)},a.removeTypeOld=function(e,t){var n=[],r=[];a.state.Types.forEach((function(e){e._id===t._id||e.SuperIDs.includes(t._id)?r.push(e._id):n.push(e)}));for(var i=a.props.selectedThing,s=Object(q.a)(i.AttributesArr),l=0;l<s.length;l++){var o=s[l];void 0===o.FromTypes&&(o.FromTypes=[]);for(var c=0;c<o.FromTypes.length;){var u=o.FromTypes[c];r.includes(u)?o.FromTypes.splice(c,1):c++}}a.setState({Types:n}),i.AttributesArr=s,a.props.updateSelectedThing(i)},a.removeType=function(e,t){var n=[],r=[];a.state.Types.forEach((function(e){e._id===t._id||e.SuperIDs.includes(t._id)?r.push(e._id):n.push(e)}));for(var i=a.props.selectedThing,s=Object(q.a)(i.Attributes),l=0;l<s.length;l++){var o=s[l];r.includes(o.FromTypeID)&&(o.FromTypeID=null)}a.setState({Types:n}),i.Attributes=s,a.props.updateSelectedThing(i)},a.load=function(e){setTimeout((function(){a.setState({_id:e,redirectTo:null,loaded:!1},a.finishLoading)}),500)},a.finishLoading=function(){if(null!==a.state._id)a.api.getThing(a.props.selectedWorldID,a.state._id).then((function(e){var t=a.props.things.filter((function(t){return e._id!==t._id})),n=[];e.TypeIDs.forEach((function(e){n=n.concat(a.props.types.filter((function(t){return t._id===e})))}));var r=[];n.forEach((function(t){for(var a=function(a){var n=Object(M.a)({},t.Attributes[a]);console.log(n),0===e.Attributes.filter((function(e){return e.attrID===n.attrID})).length&&(n.FromTypeID=t._id,n.index=e.Attributes.length+r.length,r.push(n))},n=0;n<t.Attributes.length;n++)a(n)})),n.forEach((function(e){r.forEach((function(t){void 0===e.DefaultsHash[t.attrID]||void 0===e.DefaultsHash[t.attrID].DefaultValue?(t.Value="",t.ListValues=[]):(t.Value=e.DefaultsHash[t.attrID].DefaultValue,t.ListValues=e.DefaultsHash[t.attrID].DefaultListValues)}))}));var i=[].concat(Object(q.a)(e.Attributes),r);e.Attributes=i,e.AttributesArr=[],e.Attributes.forEach((function(t){var n=a.props.attributesByID[t.attrID];e.AttributesArr.push({index:e.AttributesArr.length,Name:n.Name,AttributeType:n.AttributeType,Options:n.Options,DefinedType:n.DefinedType,ListType:n.ListType,attrID:t.attrID,Value:t.Value})})),a.props.updateSelectedThing(e),a.setState({Name:e.Name,Description:e.Description,Things:t,Types:n,loaded:!0})}));else{var e=a.props.match.params.id;if(void 0!==e&&e.includes("type_id_")){var t=e.substring(8),n=a.props.types.filter((function(e){return e._id===t}));n.length>0?(n=n[0],a.createThingFromType(n)):a.setState({message:"Invalid Type",loaded:!0})}else a.props.updateSelectedThing({_id:null,Name:"",Description:"",Types:[],Attributes:[]}),a.setState({loaded:!0})}},a.state={_id:void 0,Name:"",Description:"",Types:[],Attributes:[],fieldValidation:{Name:{valid:!0,message:""},Attributes:{valid:!0,message:""}},formValid:!1,message:"",redirectTo:null,waiting:!1,addMore:!1,resetting:!1,loaded:!0,errors:[]},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"renderHeader",value:function(){var e="Thing";return this.state.Types.forEach((function(t){t.Major&&("Thing"===e?e=t.Name:e+="/"+t.Name)})),r.a.createElement("h2",null,null===this.state._id?"Create New ".concat(e):"Edit ".concat(e))}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;return(void 0===t||t.includes("type_id_"))&&(t=null),this.state._id!==t&&this.load(t),null!==this.state.redirectTo?r.a.createElement(Ne.a,{to:this.state.redirectTo}):null===this.props.selectedWorld||this.props.selectedWorld.Public||null!==this.props.user&&(this.props.selectedWorld.Owner===this.props.user._id||0!==this.props.selectedWorld.Collaborators.filter((function(t){return t.userID===e.props.user._id&&"collab"===t.type&&t.editPermission})).length)?r.a.createElement(P.a,{item:!0,xs:12,container:!0,spacing:1,direction:"column"},null===this.props.selectedWorld?"":r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"column"},r.a.createElement(Ie.Helmet,null,r.a.createElement("title",null,"Author's Notebook: ".concat(this.props.selectedWorld.Name))),r.a.createElement(P.a,{item:!0,container:!0,spacing:1,direction:"row"},r.a.createElement(P.a,{item:!0,xs:1},r.a.createElement(ee.a,{title:"Back to ".concat(this.props.selectedWorld.Name)},r.a.createElement($.a,{size:"small",color:"primary",onClick:function(t){e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)})}},r.a.createElement(pt.a,null)))),r.a.createElement(P.a,{item:!0,xs:11},this.renderHeader())),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"name"},"Name"),r.a.createElement(Q.a,{id:"name",name:"Name",type:"text",autoComplete:"Off",error:!this.state.fieldValidation.Name.valid,value:this.state.Name,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:43,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.Name.message))),r.a.createElement(P.a,{item:!0},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"description"},"Description"),r.a.createElement(Q.a,{id:"description",name:"Description",type:"text",multiline:!0,value:this.state.Description,onChange:this.handleUserInput,onBlur:this.inputBlur,labelWidth:82,fullWidth:!0}))),r.a.createElement(P.a,{item:!0},this.state.resetting?"":r.a.createElement(St.Multiselect,{placeholder:"Types",options:this.props.types,selectedValues:this.state.Types,onSelect:this.addType,onRemove:this.removeType,displayValue:"Name"})),r.a.createElement(P.a,{item:!0},!this.state.resetting&&this.state.loaded&&r.a.createElement($t,null),r.a.createElement(Ve.a,null,this.state.fieldValidation.Attributes.message)),r.a.createElement(P.a,{item:!0},r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{variant:"contained",color:"primary",disabled:this.state.waiting,onClick:function(t){e.onSubmit(!0)},type:"submit"},this.state.waiting?"Please Wait":"Submit and Create Another"),r.a.createElement(Se.a,{variant:"contained",color:"primary",style:{marginLeft:"4px"},className:"w200",disabled:this.state.waiting,onClick:function(t){e.onSubmit(!1)},type:"submit"},this.state.waiting?"Please Wait":"Submit"),r.a.createElement(Se.a,{variant:"contained",style:{marginLeft:"4px"},disabled:this.state.waiting,onClick:function(t){null===e.props.selectedThing._id?e.setState({redirectTo:"/world/details/".concat(e.props.selectedWorldID)}):e.setState({redirectTo:"/thing/details/".concat(e.props.selectedThing._id)})},type:"button"},"Cancel"))),r.a.createElement(P.a,{item:!0},this.state.message),r.a.createElement(P.a,{item:!0},this.state.errors.map((function(e,t){return r.a.createElement("div",{key:t},e)}))),r.a.createElement(P.a,{item:!0},Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))))):r.a.createElement(Ne.a,{to:"/"})}}]),t}(n.Component),ta=Object(m.b)((function(e){return{selectedPage:e.app.selectedPage,selectedThing:e.app.selectedThing,selectedWorld:e.app.selectedWorld,selectedWorldID:e.app.selectedWorldID,things:e.app.things,types:e.app.types,user:e.app.user,attributesByID:e.app.attributesByID}}),(function(e){return{updateSelectedThing:function(t){return e(j(t))},addThing:function(t){return e(O(t))},updateThing:function(t){return e(_(t))}}}))(ea),aa=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){},a.handleUserInput=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;a.setState(Object(G.a)({},t,n))},a.inputBlur=function(e){var t=e.target.name,n=a.validateField(t),r=a.state.fieldValidation;r[t].valid!==n.valid&&(r[t].valid=n.valid,r[t].message=n.message,a.setState({fieldValidation:r}))},a.handleClickShowPassword=function(){a.setState({showPassword:!a.state.showPassword})},a.handleMouseDownPassword=function(e){e.preventDefault()},a.validateField=function(e){var t=!0,n="",r=a.state[e];switch(e){case"email":n=(t=null!==r.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i))?"":"Email is invalid";break;case"password":n=(t=r.length>=6)?"":"Password is too short";break;case"confirmEmail":n=(t=r===a.state.email)?"":"Confirm Email doesn't match Email";break;case"confirmPassword":n=(t=r===a.state.password)?"":"Confirm Password doesn't match Password";break;case"username":n=(t=r.length>=2)?"":"Username is too short"}return{valid:t,message:n}},a.validateForm=function(e){var t=a.validateField("password"),n=a.validateField("confirmPassword"),r=t.valid&&n.valid,i=a.state.fieldValidation;i.password=t,i.confirmPassword=n,a.setState({formValid:r,fieldValidation:i},e)},a.onSubmit=function(){a.validateForm((function(){this.state.formValid&&this.setState({waiting:!0},this.submitThroughAPI)}))},a.submitThroughAPI=function(){a.api.resetPassword(a.state.resetPasswordCode,a.state.password).then((function(e){a.setState({message:e.message,waiting:!1})})).catch((function(e){return console.log(e)}))},a.state={resetPasswordCode:null,codeValid:!1,password:"",confirmPassword:"",fieldValidation:{password:{valid:!0,message:""},confirmPassword:{valid:!0,message:""}},formValid:!1,message:"Please wait.  Validating code."},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;if(null===this.state.resetPasswordCode){var t=this.props.match.params.id;return setTimeout((function(){e.api.checkResetPasswordCode(t).then((function(a){void 0!==a.error?e.setState({resetPasswordCode:t,codeValid:!1,message:a.error}):e.setState({resetPasswordCode:t,codeValid:!0,message:""})}))}),500),r.a.createElement("div",null,r.a.createElement("h2",null,"Reset Password"),this.state.message)}return this.state.codeValid?r.a.createElement("div",null,r.a.createElement("h2",null,"Reset Password"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"outlined-adornment-password"},"Password"),r.a.createElement(Q.a,{id:"outlined-adornment-password",name:"password",type:this.state.showPassword?"text":"password",value:this.state.password,error:!this.state.fieldValidation.password.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(v.a,{"aria-label":"toggle password visibility",onClick:this.handleClickShowPassword,onMouseDown:this.handleMouseDownPassword,edge:"end"},this.state.showPassword?r.a.createElement(xe.a,null):r.a.createElement(je.a,null))),labelWidth:70,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.password.message)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 margined"},r.a.createElement(K.a,{variant:"outlined",fullWidth:!0},r.a.createElement(Z.a,{htmlFor:"confirm-password"},"Confirm Password"),r.a.createElement(Q.a,{id:"confirm-password",name:"confirmPassword",type:this.state.showPassword?"text":"password",value:this.state.confirmPassword,error:!this.state.fieldValidation.confirmPassword.valid,onChange:this.handleUserInput,onBlur:this.inputBlur,endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(v.a,{"aria-label":"toggle password visibility",onClick:this.handleClickShowPassword,onMouseDown:this.handleMouseDownPassword,edge:"end"},this.state.showPassword?r.a.createElement(xe.a,null):r.a.createElement(je.a,null))),labelWidth:130,fullWidth:!0}),r.a.createElement(Ve.a,null,this.state.fieldValidation.confirmPassword.message)))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"float-right"},r.a.createElement(Se.a,{className:"w200",disabled:this.state.waiting,onClick:this.onSubmit,type:"submit"},this.state.waiting?"Please Wait":"Submit")))),this.state.message,Object.keys(this.state.fieldValidation).map((function(t,a){return void 0!==e.state.fieldValidation[t]&&e.state.fieldValidation[t].message.length>0?r.a.createElement("p",{className:"redFont",key:a},e.state.fieldValidation[t].message):""}))):r.a.createElement("div",null,r.a.createElement("h2",null,"Reset Password"),this.state.message)}}]),t}(n.Component),na=Object(m.b)()(aa),ra=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){},a.state={confirmEmailCode:null,codeValid:!1,message:"Please wait.  Validating code."},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;if(null===this.state.confirmEmailCode){var t=this.props.match.params.id;setTimeout((function(){e.api.confirmEmail(t).then((function(a){void 0!==a.error?e.setState({confirmEmailCode:t,codeValid:!1,message:a.error}):e.setState({confirmEmailCode:t,codeValid:!0,message:a.message})}))}),500)}return r.a.createElement("div",null,r.a.createElement("h2",null,"Confirming Email"),this.state.message)}}]),t}(n.Component),ia=Object(m.b)()(ra),sa=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={version:"0"},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement(P.a,{item:!0,xs:12,className:"h-100 margined"},r.a.createElement(Ne.d,null,r.a.createElement(Ne.b,{exact:!0,path:"/",component:de}),r.a.createElement(Ne.b,{exact:!0,path:"/home",component:de}),r.a.createElement(Ne.b,{exact:!0,path:"/User/Login",component:Ue}),r.a.createElement(Ne.b,{exact:!0,path:"/User/resetPassword/:id",component:na}),r.a.createElement(Ne.b,{exact:!0,path:"/User/confirmEmail/:id",component:ia}),r.a.createElement(Ne.b,{exact:!0,path:"/profile",component:ze}),r.a.createElement(Ne.b,{exact:!0,path:"/forums",component:ke}),r.a.createElement(Ne.b,{exact:!0,path:"/world/details/:id",component:dt}),r.a.createElement(Ne.b,{exact:!0,path:"/world/create",component:ht}),r.a.createElement(Ne.b,{exact:!0,path:"/world/edit/:id",component:ht}),r.a.createElement(Ne.b,{exact:!0,path:"/world/collaborators/:id",component:Wt}),r.a.createElement(Ne.b,{exact:!0,path:"/world/collaborate/:worldID/:collabID",component:bt}),r.a.createElement(Ne.b,{exact:!0,path:"/type/create",component:qt}),r.a.createElement(Ne.b,{exact:!0,path:"/type/details/:id",component:At}),r.a.createElement(Ne.b,{exact:!0,path:"/type/edit/:id",component:qt}),r.a.createElement(Ne.b,{exact:!0,path:"/thing/create",component:ta}),r.a.createElement(Ne.b,{exact:!0,path:"/thing/create/:id",component:ta}),r.a.createElement(Ne.b,{exact:!0,path:"/thing/details/:id",component:Zt}),r.a.createElement(Ne.b,{exact:!0,path:"/thing/edit/:id",component:ta})))}}]),t}(n.Component),la=Object(m.b)()(sa);var oa=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={version:"0",width:0,marginLeft:220},a.api=Y.getInstance(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions.bind(this))}},{key:"updateDimensions",value:function(){var e=window.innerWidth;e>=600?(e-=200,this.props.setWidth(e),this.setState({width:e,marginLeft:220,innerWidth:window.innerWidth})):(this.props.setWidth(e),this.setState({width:e,marginLeft:0,innerWidth:window.innerWidth}))}},{key:"render",value:function(){return null===this.props.api&&this.props.setAPI(this.api),r.a.createElement(p.a,null,this.props.menuOpen?r.a.createElement(F.a,{display:{xs:"none",sm:"inline"},className:"Sidebar"},r.a.createElement(De,{className:"",logoText:"Author's Notebook"})):"",r.a.createElement(P.a,{container:!0},r.a.createElement(P.a,{item:!0,xs:12,style:{marginLeft:"".concat(this.props.menuOpen?this.state.marginLeft:0,"px"),width:"".concat(this.props.menuOpen?this.state.width:this.state.innerWidth,"px")}},r.a.createElement(ge,null)),r.a.createElement(P.a,{item:!0,xs:12,style:{marginLeft:"".concat(this.props.menuOpen?this.state.marginLeft+10:10,"px"),width:"".concat(this.props.menuOpen?this.state.width-20:this.state.innerWidth-20,"px"),marginRight:"10px",marginTop:"10px"}},r.a.createElement(la,null))))}}]),t}(n.Component),ca=Object(m.b)((function(e){return{menuOpen:e.app.menuOpen,api:e.app.api}}),(function(e){return{setWidth:function(t){return e({type:"SET_WIDTH",payload:t})},setAPI:function(t){return e({type:"SET_API",payload:t})}}}))(oa);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ua=a(92),da=a(136),pa={api:null,articles:[],user:null,loginError:"",worlds:[],publicWorlds:[],followingWorlds:[],selectedWorld:null,selectedWorldID:null,types:[],things:[],selectedType:null,attributesByID:{},attributesByName:{},selectedThing:null,loadIt:!0,menuOpen:!0,width:0};var ma={app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pa,t=arguments.length>1?arguments[1]:void 0;if("LOAD_FROM_STORAGE"===t.type){var a=JSON.parse(sessionStorage.getItem("user")),n=JSON.parse(sessionStorage.getItem("worlds")),r=JSON.parse(sessionStorage.getItem("publicWorlds")),i=JSON.parse(sessionStorage.getItem("selectedWorld")),s=sessionStorage.getItem("selectedWorldID"),l=JSON.parse(sessionStorage.getItem("types")),o=JSON.parse(sessionStorage.getItem("things")),c=JSON.parse(sessionStorage.getItem("followingWorlds")),u=JSON.parse(sessionStorage.getItem("attributesByID")),d=JSON.parse(sessionStorage.getItem("attributesByName"));return Object.assign({},e,{user:a,worlds:null===n?[]:n,publicWorlds:null===r?[]:r,selectedWorld:i,selectedWorldID:s,types:null===l?[]:l,things:null===o?[]:o,followingWorlds:null===c?[]:c,attributesByID:null===u?{}:u,attributesByName:null===d?{}:d})}if("SET_API"===t.type)return Object.assign({},e,{api:t.payload});if("ADD_ARTICLE"===t.type)return Object.assign({},e,{articles:e.articles.concat(t.payload)});if("LOGIN"===t.type)return sessionStorage.setItem("user",JSON.stringify(t.payload)),sessionStorage.setItem("followingWorlds",JSON.stringify(t.payload.followingWorlds)),Object.assign({},e,{user:t.payload,followingWorlds:t.payload.followingWorlds});if("LOG_OUT"===t.type)return sessionStorage.removeItem("user"),Object.assign({},e,{user:null});if("SET_WORLDS"===t.type){if(void 0===t.payload.error){if(sessionStorage.setItem("worlds",JSON.stringify(t.payload)),null!==e.selectedWorldID&&null===e.selectedWorld){var p=t.payload.filter((function(t){return t._id===e.selectedWorldID}));if(p.length>0){var m=p[0];return sessionStorage.setItem("selectedWorld",JSON.stringify(m)),Object.assign({},e,{worlds:t.payload,selectedWorld:m})}return Object.assign({},e,{worlds:t.payload})}return Object.assign({},e,{worlds:t.payload})}return Object.assign({},e,{})}if("SET_PUBLIC_WORLDS"===t.type){if(void 0===t.payload.error){if(sessionStorage.setItem("publicWorlds",JSON.stringify(t.payload)),null!==e.selectedWorldID&&null===e.selectedWorld){var h=t.payload.filter((function(t){return t._id===e.selectedWorldID}));if(h.length>0){var f=h[0];return sessionStorage.setItem("selectedWorld",JSON.stringify(f)),Object.assign({},e,{publicWorlds:t.payload,selectedWorld:f})}return Object.assign({},e,{publicWorlds:t.payload})}return Object.assign({},e,{publicWorlds:t.payload})}return Object.assign({},e,{})}if("ADD_WORLD"===t.type){if(t.payload.Public){var b=e.worlds.concat(t.payload),y=e.publicWorlds.concat(t.payload);return sessionStorage.setItem("worlds",JSON.stringify(b)),sessionStorage.setItem("publicWorlds",JSON.stringify(y)),Object.assign({},e,{worlds:b,publicWorlds:y})}var g=e.worlds.concat(t.payload);return sessionStorage.setItem("worlds",JSON.stringify(g)),Object.assign({},e,{worlds:e.worlds.concat(t.payload)})}if("UPDATE_WORLD"===t.type){var v=Object(q.a)(e.worlds),E=Object(q.a)(e.publicWorlds),w=v.filter((function(e){return e._id===t.payload._id}))[0];w.Name=t.payload.Name;var T=w.Public;if(w.Public=t.payload.Public,w.AcceptingCollaborators=t.payload.AcceptingCollaborators,w.Collaborators=t.payload.Collaborators,sessionStorage.setItem("worlds",JSON.stringify(v)),w.Public){if(T){var D=E.filter((function(e){return e._id===w._id}))[0];D.Name=w.Name}else E=E.concat(w);return sessionStorage.setItem("publicWorlds",JSON.stringify(E)),Object.assign({},e,{worlds:v,publicWorlds:E})}return T?(E=E.filter((function(e){return e._id!==w._id})),sessionStorage.setItem("publicWorlds",JSON.stringify(E)),Object.assign({},e,{worlds:v,publicWorlds:E})):Object.assign({},e,{worlds:v})}if("UPDATE_PUBLIC_WORLD_COLLAB"===t.type){var N=Object(q.a)(e.publicWorlds),W=N.filter((function(e){return e._id===t.payload._id}))[0];return W.Collaborators=t.payload.Collaborators,sessionStorage.setItem("publicWorlds",JSON.stringify(N)),Object.assign({},e,{publicWorlds:N})}if("SELECT_WORLD"===t.type){var k=e.worlds.filter((function(e){return e._id===t.payload}));return 0===k.length&&(k=e.publicWorlds.filter((function(e){return e._id===t.payload}))),k.length>0?(sessionStorage.setItem("selectedWorldID",t.payload),sessionStorage.setItem("selectedWorld",JSON.stringify(k[0])),Object.assign({},e,{selectedWorldID:t.payload,selectedWorld:k[0],attributesByID:{},attributesByName:{}})):(sessionStorage.setItem("selectedWorldID",t.payload),sessionStorage.removeItem("selectedWorld"),Object.assign({},e,{selectedWorldID:t.payload,selectedWorld:null,attributesByID:{},attributesByName:{}}))}if("SET_ATTRIBUTES"===t.type){var I={},A={};return t.payload.forEach((function(e){I[e._id]=e,A[e.Name]=e})),sessionStorage.setItem("attributesByID",JSON.stringify(I)),sessionStorage.setItem("attributesByName",JSON.stringify(A)),Object.assign({},e,{attributesByID:I,attributesByName:A})}if("ADD_ATTRIBUTES"===t.type){var S=e.attributesByID,O=e.attributesByName;return t.payload.forEach((function(e){S[e._id]=e,O[e.Name]=e})),sessionStorage.setItem("attributesByID",JSON.stringify(S)),sessionStorage.setItem("attributesByName",JSON.stringify(O)),Object.assign({},e,{attributesByID:S,attributesByName:O})}if("SET_TYPES"===t.type)return sessionStorage.setItem("types",JSON.stringify(t.payload)),Object.assign({},e,{types:t.payload});if("ADD_TYPE"===t.type){var C=e.types.concat(t.payload);return sessionStorage.setItem("types",JSON.stringify(C)),Object.assign({},e,{types:C})}if("SET_THINGS"===t.type)return sessionStorage.setItem("things",JSON.stringify(t.payload)),Object.assign({},e,{things:t.payload});if("ADD_THING"===t.type){var x=e.things.concat(t.payload);return sessionStorage.setItem("things",JSON.stringify(x)),Object.assign({},e,{things:x})}if("UPDATE_SELECTED_TYPE"===t.type){var _=Object(M.a)({},t.payload,{changedAt:Date.now()});return Object.assign({},e,{selectedType:_})}if("UPDATE_TYPE"===t.type){var j=Object(q.a)(e.types),V=j.filter((function(e){return e._id===t.payload._id}))[0];return V.Name=t.payload.Name,V.Description=t.payload.Description,V.Supers=t.payload.Supers,V.AttributesArr=t.payload.AttributesArr,V.Attributes=t.payload.Attributes,sessionStorage.setItem("types",JSON.stringify(j)),Object.assign({},e,{types:j})}if("UPDATE_SELECTED_THING"===t.type){var L=Object(M.a)({},t.payload,{changedAt:Date.now()});return Object.assign({},e,{selectedThing:L})}if("UPDATE_THING"===t.type){var P=Object(q.a)(e.things),F=P.filter((function(e){return e._id===t.payload._id}))[0];return F.Name=t.payload.Name,F.Description=t.payload.Description,F.Types=t.payload.Types,F.Attributes=t.payload.Attributes,sessionStorage.setItem("things",JSON.stringify(P)),Object.assign({},e,{things:P})}return"TOGGLE_MENU"===t.type?Object.assign({},e,{menuOpen:!e.menuOpen}):"SET_WIDTH"===t.type?Object.assign({},e,{width:t.payload}):"SET_FOLLOWING_WORLDS"===t.type?(sessionStorage.setItem("followingWorlds",JSON.stringify(t.payload)),Object.assign({},e,{followingWorlds:t.payload})):e},session:da.sessionReducer},ha=Object(ua.b)(ma),fa=Object(ua.c)(ha),ba={refreshFromLocalStorage:!0,refreshOnCheckAuth:!0,redirectPath:"/home",driver:"COOKIES",validateSession:function(e){return!0}};da.sessionService.initSessionService(fa,ba).then((function(){return console.log("Redux React Session is ready and a session was refreshed from your storage")})).catch((function(){return console.log("Redux React Session is ready and there is no session in your storage")}));var ya=fa;s.a.render(r.a.createElement(m.a,{store:ya},r.a.createElement(ca,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[186,1,2]]]);
//# sourceMappingURL=main.6d5e9c5d.chunk.js.map
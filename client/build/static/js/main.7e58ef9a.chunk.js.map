{"version":3,"sources":["assets/img/ANB.png","redux/actions/index.js","redux/constants/actionTypes.js","smartAPI.js","components/Displays/MediaPlayer.js","components/Displays/MediaCard.js","views/Home.js","components/Inputs/ReactQuill.js","components/Inputs/AutocompleteTextField.js","components/Inputs/TextBox.js","components/Inputs/CommentControl.js","components/Inputs/CommentsControl.js","views/Discussion/GeneralDiscussion.js","components/Navigation/routes.js","components/Navigation/MobileMenu.js","components/Navigation/UserMenu.js","components/Navigation/Navbar.js","components/Navigation/Sidebar.js","views/User/Profile.js","views/World/Index.js","components/Displays/TypeSummary.js","components/Displays/ThingSummary.js","components/Modals/TemplateModal.js","components/Displays/WorldMap.js","components/WorldTemplateControls/ImportTemplatesControl.js","components/WorldTemplateControls/ImportingTemplatesControl.js","views/World/Details.js","views/World/Edit.js","views/User/LoginControl.js","views/World/Collaborate.js","views/World/EditCollaborators.js","views/Type/Details.js","views/Type/AttributeControl.js","views/Type/AttributeDefaultControl.js","views/Type/AttributesControl.js","components/Modals/NewTypeModal.js","components/Modals/NewThingModal.js","views/Type/Edit.js","components/Displays/ThingTable.js","views/Thing/Details.js","views/Thing/AttributeControl.js","views/Thing/AttributesControl.js","views/Thing/Edit.js","views/User/ResetPassword.js","views/User/ConfirmEmail.js","views/MainPage.js","App.js","serviceWorker.js","redux/reducers/index.js","redux/store/index.js","index.js","assets/img/under_construction.png","assets/img/under_construction_white.png"],"names":["module","exports","logout","payload","type","setWorlds","setTemplates","setAllUsers","addAndSelectWorld","updateWorld","setPublicWorlds","selectWorld","setAttributes","setTypes","addType","setThings","addThing","updateType","updateSelectedType","updateThing","updateSelectedThing","toggleMenu","toggleLogin","notFromLogin","setFollowingWorlds","UnauthorizedError","message","this","name","prototype","Error","API","instance","getInstance","APIClass","logErrorReason","reason","console","log","Promise","reject","checkStatus","response","status","unauthorizedError","statusText","error","getVersion","a","real","fetchData","processResponse","version","getAllUsers","getAllUsersFromAPI","data","getSessionData","res","_id","OwnerID","Name","Public","login","user","stayLoggedIn","sessionObj","body","expiresAt","localStorage","setItem","JSON","stringify","postData","email","username","removeItem","register","confirmEmail","code","patchData","sendReset","checkResetPasswordCode","resetPassword","newPassword","emailTest","updateUser","retry","relogin","createTemplate","template","getTemplates","getTemplatesFromAPI","worldID","getWorlds","refresh","getPublicWorlds","publicWorlds","getWorldsForUser","userWorlds","templates","allUsers","getWorldsForUserFromAPI","getPublicWorldsFromAPI","getWorld","getAttributesForWorld","attributes","getTypesForWorld","types","getThingsForWorld","things","attributesByID","attributesByName","forEach","attribute","TypeIDs","t","Supers","SuperIDs","sID","concat","filter","t2","AttributesArr","Attributes","attr","attrID","undefined","push","index","length","trim","AttributeType","Options","DefinedType","ListType","defHash","Defaults","def","DefaultsHash","Types","tID","getWorldByTypeID","typeID","getWorldIDByTypeID","getWorldByThingID","thingID","getWorldIDByThingID","createWorld","world","deleteWorld","deleteData","generateCollabLink","addNewCollaborator","userID","emailCollaborator","deleteCollab","collabID","updateCollaboratorPermission","editPermission","checkCollabID","requestToCollaborate","declineCollabInvite","acceptCollabInvite","acceptCollabRequest","getAttributesForWorldFromAPI","getAttribute","Description","createAttribute","upsertAttributes","getTypesForWorldFromAPI","getType","createType","deleteType","getThingsForWorldFromAPI","getThing","createThing","thing","deleteThing","getComments","objectType","objectID","addComment","comment","updateComment","path","options","fetch","mode","credentials","headers","Accept","then","catch","method","putData","sessionName","noExpiry","json","Date","setHours","getHours","sessionStr","getItem","parse","MediaPlayer","props","url","width","useStyles","makeStyles","root","MediaCard","classes","Card","className","CardActionArea","CardContent","Typography","gutterBottom","variant","component","title","color","description","Page","state","redirectTo","fromLogin","to","Component","HomePage","connect","app","dispatch","ReactQuill","dirtyProps","cleanProps","generation","editor","editingArea","value","refInput","selection","lastDeltaChangeSet","regenerationSnapshot","unprivilegedEditor","onEditorChange","eventName","rangeOrDelta","oldRangeOrDelta","source","onEditorChangeText","innerHTML","onEditorChangeSelection","isControlled","defaultValue","React","createRef","Children","count","children","child","only","nextProps","nextState","validateProps","prevContents","getEditorContents","nextContents","isEqualValue","setEditorContents","readOnly","setEditorReadOnly","some","prop","isEqual","instantiateEditor","destroyEditor","prevProps","prevState","shouldComponentRegenerate","delta","getContents","getSelection","setState","setContents","postpone","setEditorSelection","createEditor","getEditingArea","getEditorConfig","unhookEditor","bounds","formats","modules","placeholder","scrollingContainer","tabIndex","theme","element","config","Quill","setEditorTabIndex","hookEditor","makeUnprivilegedEditor","on","off","ops","nextValue","isDelta","sel","getEditorSelection","clipboard","convert","range","getLength","Math","max","min","setSelection","scroll","domNode","disable","enable","e","getHTML","bind","getText","getBounds","ReactDOM","findDOMNode","nodeType","preserveWhitespace","properties","key","ref","cloneElement","id","style","onKeyPress","onKeyDown","onKeyUp","onBlur","_","onBlur2","renderEditingArea","onChange","nextSelection","currentSelection","hasGainedFocus","hasLostFocus","onChangeSelection","onFocus","focus","blur","fn","resolve","displayName","defaultProps","toolbar","AutocompleteTextField","handleKeyDown","event","helperVisible","keyCode","preventDefault","resetHelper","handleSelection","setValue","handleChange","sanitizeConf","allowedTags","allowedAttributes","sanitize","html","sanitizeHtml","left","matchLength","matchStart","top","recentValue","caret","updateHelper","str","providedOptions","trigger","matchAny","regex","re","RegExp","triggerLength","triggerMatch","match","last","i","substring","triggerIdx","isTrigger","matchedSlug","slug","idx","Display","toLowerCase","indexOf","substr","spaceRemovers","spacer","old","target","end","old2","str2","enableSpaceRemovers","getMatch","newValue","slice","current","suggestionType","part1","part2","searched","part1Sub","openerEndIndex","updateCaretPosition","setTimeout","input","getEditor","clientHeight","minChars","onRequestOptions","requestOnlyIfNoOptions","maxOptions","offsetX","offsetY","optionNumber","helperOptions","map","val","highlightStart","onClick","onMouseEnter","position","renderAutocompleteList","disabled","Control","getValue","Value","fieldName","Grid","container","spacing","direction","item","InputLabel","htmlFor","autoComplete","FormControl","fullWidth","multiline","OutlinedInput","labelWidth","FormHelperText","TextBox","vote","theVote","changeWaiting","votes","updatedComment","rootComment","replies","r","cleanReply","api","object","comments","prepComment","changeComments","err","reply","newReply","voteSum","u","time","Object","values","reduce","total","CommentControl","useState","changeValue","replying","changeReplying","toLocaleDateString","toLocaleTimeString","dangerouslySetInnerHTML","__html","text","CardActions","disableSpacing","IconButton","aria-label","Owner","Collaborators","c","fontWeight","marginLeft","xs","marginTop","newComments","newWaiting","suggestions","shiftKey","endsWith","CommentsControl","waiting","loadComments","changeLoadComments","desc","Button","commentID","saveComment","commentsChange","GeneralDiscussionPage","userSuggestions","worldSuggestions","menuRoutes","icon","Home","Forum","Menu","toggleFollow","follow","followingWorlds","splice","handleUserInput","checked","browse","Filter","worlds","ListItem","activeClassName","button","Icon","ListItemText","primary","otherWorlds","w","includes","List","Fab","size","Star","links","display","Tooltip","Search","Add","myWorlds","MobileMenu","selectedPage","worldIDs","StyledMenu","withStyles","paper","border","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","UserMenu","anchorEl","setAnchorEl","aria-controls","aria-haspopup","cursor","currentTarget","keepMounted","open","Boolean","onClose","MenuItem","onLogout","Bar","loadFromStorage","AppBar","Toolbar","selectedWorld","mobileMenuOpen","Box","sm","NavBar","menuOpen","page","src","logo","alt","logoText","brand","Divider","light","Sidebar","inputBlur","validation","validateField","fieldValidation","valid","validateForm","respond","nameValid","emailValid","formValid","onSubmit","submitThroughAPI","errors","loginError","show","userLogin","onLogin","load","finishLoading","loaded","Helmet","ProfilePage","attrs","Index","panel","updateIndexExpandedPanel","indexExpandedPanel","majorless","Major","createButtons","NeedsWork","height","marginBottom","UnderConstruction","maxWidth","UnderConstructionWhite","Edit","PluralName","j","ThingIndex","TypeSummary","defaults","d","DefaultValue","DefaultListValues","superTypes","aKey","attributeType","dKey","defThing","ThingSummary","attributeValue","ListValues","selected","newSelected","typeIDs","superType","attrType","Default","thingIDs","defaultThing","removeType","subTypes","subType","references","ReferenceIDs","removeUs","removeMe","removeThing","thingAttr","attrThing","typesWithDefault","typeWithDefault","TemplateModal","changeName","changeMessage","nameMessage","changeNameMessage","changeSelected","changeValid","expandedPanel","changeExpanded","selectedType","changeSelectedType","selectedThing","changeSelectedThing","typeless","selectedTypeless","n","validate","Checkbox","overflowY","overflowX","selectedThings","templateName","onSave","saveTemplate","onCancel","WorldMap","dingus","Things","typeKey","thingKey","ImportTemplatesControl","selectedTemplate","changeSelectedTemplate","selectedTemplateIDs","changeSelectedTemplates","newSelectedTemplateIDs","takeNextStep","play","stepInProgress","reallyTakeNextStep","importingTypes","dumbImportType","importingAttributes","attributesStatus","importingThings","existingThing","thingMap","templateThing","dumbImportThing","importType","importThing","onComplete","typeMap","attributeMap","upsertUs","upsert","templateAttribute","selectedWorldID","existingAttribute","attrOptions","o","upserted","a2","existingType","templateType","dumbType","dumbThing","s","superID","theDefault","d2","v","TypeIDS","templateID","ImportingTemplatesControl","typeSuggestions","thingSuggestions","delete","res2","modalOpen","getModalStyle","round","window","innerHeight","innerWidth","transform","templateMode","importMode","loading","updatePublicWorldForCollab","respondToInvite","invite","updateTemplates","importSelectedTemplates","templatesToImport","importDumbTypesRecursive","typePos","newTypes","compareAndFixAttributes","nameChanges","attrMap","addAttributesToDumbTypesRecursive","newType","attributesAdded","realID","templateIDs","getTypes","updateAttributes","getThings","params","shift","People","Delete","AcceptingCollaborators","Modal","aria-labelledby","aria-describedby","WorldDetailsPage","a11yProps","cleanWYSIWYG","tempSelectedTemplateIDs","ArrowBack","FormControlLabel","control","label","keys","WorldEditPage","componentDidMount","remember","handleClickShowPassword","showPassword","handleMouseDownPassword","password","confirmEmailValid","passwordValid","confirmPasswordValid","usernameValid","formMode","confirmPassword","users","loginClick","registerClick","passwordClick","cookies","Cookies","emailCookie","get","passCookie","endAdornment","InputAdornment","onMouseDown","edge","Link","LoginControl","accept","accepted","submitAccept","refreshWorld","onLoginAccept","decline","submitDecline","codeValid","CollaboratePage","TabPanel","p","selectedUser","collabs","inviteMessage","inviteEmail","collaborator","permission","collabLink","collabLinkCopied","collab","acceptCollab","copyCollabLink","generatedLink","select","document","execCommand","actuallyFinishLoading","newCollaborators","newCollabTab","collabTab","invites","requests","userMenuItems","Tabs","Tab","Select","labelId","FileCopyOutlined","fontColor","direcion","Check","EditCollaboratorPage","redirectToNext","inheritedAttributes","definedType","option","sub","instances","TypeDetails","handleDefinedTypeChange","onNewType","handleOptionsChange","AttributeControl","attributeTypes","listTypes","selectedListType","selectedDefinedType","fromTypes","FromTypeIDs","handleTypeChange","chips","handleListTypeChange","onDelete","AttributeDefaultControl","selectedTypeValue","listOptions","listOptionValues","onNewThing","handleTextListChange","selectedValues","onSelect","selectedItem","addOption","onRemove","selectedList","removeOption","displayValue","addThingOfType","newAttribute","uuid","changeAttribute","changeDefault","blurAttribute","deleteAttribute","addNewType","addNewThing","defaultsMode","inheritedAttribute","AttributesControl","NewTypeModal","saveNewType","NewThingModal","newThingType","saveNewThing","resetForm","resetting","attrByName","attrArrValid","addMore","superIDs","typeAttributes","DefaultReferenceIDs","FromTypeID","supersChange","supers","addSuper","s2","duplicateAttributes","addSelectedAttribute","browseAttributesSelected","browseTypesSelected","addBrowsedType","removeSuper","removedItem","checkMe","renderAttributes","typeModalOpen","putTypeOnAttribute","thingModalOpen","putThingOnAttribute","browseAttributes","additionalAttributes","selectedAttributeTypes","selectedAttributeName","found","opacity","checkedIcon","TypeEditPage","addAttributes","rows","descendingComparator","b","orderBy","ThingTableHead","order","onRequestSort","columnMap","TableHead","TableRow","headCell","TableCell","align","numeric","padding","disablePadding","sortDirection","TableSortLabel","active","property","visuallyHidden","useToolbarStyles","paddingLeft","paddingRight","highlight","palette","secondary","main","backgroundColor","lighten","dark","flex","ThingTableToolbar","table","clip","margin","overflow","ThingTable","newRow","allThings","Type","setOrder","setOrderBy","setSelected","setPage","rowsPerPage","setRowsPerPage","Paper","TableContainer","Table","numSelected","onSelectAllClick","newSelecteds","rowCount","TableBody","array","comparator","stabilizedThis","el","sort","stableSort","getComparator","row","isItemSelected","hover","role","aria-checked","column","buttonClick","TablePagination","rowsPerPageOptions","onChangePage","newPage","onChangeRowsPerPage","parseInt","finishDelete","majorType","listValue","ThingDetails","FromTypes","blurBehavior","infoModal","infoAttribute","optionsChange","onInfo","modalSubmit","infoModalOpen","createThingFromType","newAttributes","existing","finishResettingForm","handleInfoAttrNameChange","inputBlur2","attr2","attrValid","validateAttrForm","infoAttributeName","typesChange","addType2","selectNewTypeForAttribute","newTypeForAttribute","saveInfoAttribute","submitAttributeThroughAPI","deleteInfoAttribute","theType","newFromTypeIDs","browseAttributesFilter","refDescription","typeStr","connectedTypes","otherTypes","fontSize","newThing","renderHeader","ThingEditPage","resetPasswordCode","ResetPasswordPage","confirmEmailCode","ConfirmEmailPage","loginOpen","exact","EditCollaboratorsPage","TypeDetailsPage","ThingDetailsPage","minHeight","MainPage","AppLayout","updateDimensions","addEventListener","removeEventListener","setWidth","setAPI","marginRight","App","location","hostname","initialState","articles","redirectToURL","loadIt","collabSuggestions","rootReducer","reducers","action","assign","worldArr","wasPublic","publicWorld","changedType","changedAt","now","changedThing","session","sessionReducer","reducer","combineReducers","store","createStore","refreshFromLocalStorage","refreshOnCheckAuth","redirectPath","driver","validateSession","sessionService","initSessionService","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7e58ef9a.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import {\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOGOUT,\r\n  REDIRECT_TO,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  SET_TEMPLATES,\r\n  SET_ALL_USERS,\r\n  ADD_WORLD,\r\n  ADD_AND_SELECT_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_ATTRIBUTES,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  TOGGLE_LOGIN,\r\n  NOT_FROM_LOGIN,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH,\r\n  UPDATE_INDEX_EXPANDED_PANEL\r\n} from \"../constants/actionTypes\";\r\n\r\nexport function updateIndexExpandedPanel(payload) {\r\n  return { type: UPDATE_INDEX_EXPANDED_PANEL, payload };\r\n}\r\nexport function setAPI(payload) {\r\n  return { type: SET_API, payload };\r\n}\r\nexport function addArticle(payload) {\r\n  return { type: ADD_ARTICLE, payload };\r\n}\r\nexport function userLogin(payload) {\r\n  return { type: LOGIN, payload };\r\n}\r\nexport function logout(payload) {\r\n  return { type: LOGOUT, payload };\r\n}\r\nexport function redirectTo(payload) {\r\n  return { type: REDIRECT_TO, payload };\r\n}\r\nexport function setWorlds(payload) {\r\n  return { type: SET_WORLDS, payload };\r\n}\r\nexport function setTemplates(payload) {\r\n  return { type: SET_TEMPLATES, payload };\r\n}\r\nexport function setAllUsers(payload) {\r\n  return { type: SET_ALL_USERS, payload };\r\n}\r\nexport function addWorld(payload) {\r\n  return { type: ADD_WORLD, payload };\r\n}\r\nexport function addAndSelectWorld(payload) {\r\n  return { type: ADD_AND_SELECT_WORLD, payload };\r\n}\r\nexport function updateWorld(payload) {\r\n  return { type: UPDATE_WORLD, payload };\r\n}\r\nexport function updatePublicWorldForCollab(payload) {\r\n  return { type: UPDATE_PUBLIC_WORLD_COLLAB, payload };\r\n}\r\nexport function setPublicWorlds(payload) {\r\n  return { type: SET_PUBLIC_WORLDS, payload };\r\n}\r\nexport function selectWorld(payload) {\r\n  return { type: SELECT_WORLD, payload };\r\n}\r\nexport function setAttributes(payload) {\r\n  return { type: SET_ATTRIBUTES, payload };\r\n}\r\nexport function addAttributes(payload) {\r\n  return { type: ADD_ATTRIBUTES, payload };\r\n}\r\nexport function updateAttributes(payload) {\r\n  return { type: UPDATE_ATTRIBUTES, payload };\r\n}\r\nexport function setTypes(payload) {\r\n  return { type: SET_TYPES, payload };\r\n}\r\nexport function addType(payload) {\r\n  return { type: ADD_TYPE, payload };\r\n}\r\nexport function setThings(payload) {\r\n  return { type: SET_THINGS, payload };\r\n}\r\nexport function addThing(payload) {\r\n  return { type: ADD_THING, payload };\r\n}\r\nexport function updateType(payload) {\r\n  return { type: UPDATE_TYPE, payload };\r\n}\r\nexport function updateSelectedType(payload) {\r\n  return { type: UPDATE_SELECTED_TYPE, payload };\r\n}\r\nexport function updateThing(payload) {\r\n  return { type: UPDATE_THING, payload };\r\n}\r\nexport function updateSelectedThing(payload) {\r\n  return { type: UPDATE_SELECTED_THING, payload };\r\n}\r\nexport function loadFromStorage(payload) {\r\n  return { type: LOAD_FROM_STORAGE, payload };\r\n}\r\nexport function toggleMenu(payload) {\r\n  return { type: TOGGLE_MENU, payload };\r\n}\r\nexport function toggleLogin(payload) {\r\n  return { type: TOGGLE_LOGIN, payload };\r\n}\r\nexport function notFromLogin(payload) {\r\n  return { type: NOT_FROM_LOGIN, payload };\r\n}\r\nexport function setFollowingWorlds(payload) {\r\n  return { type: SET_FOLLOWING_WORLDS, payload };\r\n}\r\nexport function setWidth(payload) {\r\n  return { type: SET_WIDTH, payload };\r\n}\r\n","\r\nexport const UPDATE_INDEX_EXPANDED_PANEL = \"UPDATE_INDEX_EXPANDED_PANEL\";\r\nexport const SET_API = \"SET_API\";\r\nexport const ADD_ARTICLE = \"ADD_ARTICLE\";\r\nexport const LOGIN = \"LOGIN\";\r\nexport const LOGOUT = \"LOGOUT\";\r\nexport const REDIRECT_TO = \"REDIRECT_TO\";\r\nexport const SET_WORLDS = \"SET_WORLDS\";\r\nexport const SET_PUBLIC_WORLDS = \"SET_PUBLIC_WORLDS\";\r\nexport const SET_TEMPLATES = \"SET_TEMPLATES\";\r\nexport const SET_ALL_USERS = \"SET_ALL_USERS\";\r\nexport const ADD_WORLD = \"ADD_WORLD\";\r\nexport const ADD_AND_SELECT_WORLD = \"ADD_AND_SELECT_WORLD\";\r\nexport const UPDATE_WORLD = \"UPDATE_WORLD\";\r\nexport const UPDATE_PUBLIC_WORLD_COLLAB = \"UPDATE_PUBLIC_WORLD_COLLAB\";\r\nexport const SELECT_WORLD = \"SELECT_WORLD\";\r\nexport const SET_TYPES = \"SET_TYPES\";\r\nexport const ADD_TYPE = \"ADD_TYPE\";\r\nexport const SET_THINGS = \"SET_THINGS\";\r\nexport const ADD_THING = \"ADD_THING\";\r\nexport const UPDATE_TYPE = \"UPDATE_TYPE\";\r\n// export const UPDATE_ATTRIBUTES_ARR = \"UPDATE_ATTRIBUTES_ARR\";\r\nexport const SET_ATTRIBUTES = \"SET_ATTRIBUTES\";\r\nexport const ADD_ATTRIBUTES = \"ADD_ATTRIBUTES\";\r\nexport const UPDATE_ATTRIBUTES = \"UPDATE_ATTRIBUTES\";\r\nexport const UPDATE_SELECTED_TYPE = \"UPDATE_SELECTED_TYPE\";\r\nexport const UPDATE_THING = \"UPDATE_THING\";\r\nexport const UPDATE_SELECTED_THING = \"UPDATE_SELECTED_THING\";\r\nexport const LOAD_FROM_STORAGE = \"LOAD_FROM_STORAGE\";\r\nexport const TOGGLE_MENU = \"TOGGLE_MENU\";\r\nexport const TOGGLE_LOGIN = \"TOGGLE_LOGIN\";\r\nexport const NOT_FROM_LOGIN = \"NOT_FROM_LOGIN\";\r\nexport const SET_FOLLOWING_WORLDS = \"SET_FOLLOWING_WORLDS\";\r\nexport const SET_WIDTH = \"SET_WIDTH\";\r\n","\r\n// This is our special type of Error that represents\r\n// when a request got a 401 Unauthorized response\r\nfunction UnauthorizedError(message) {\r\n  this.name = \"UnauthorizedError\";\r\n  this.message = message;\r\n}\r\nUnauthorizedError.prototype = new Error();\r\n\r\nvar API = (function() {\r\n  var instance;\r\n\r\n  function createInstance() {\r\n    var api = new APIClass();\r\n    return api;\r\n  }\r\n\r\n  return {\r\n    getInstance: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nclass APIClass {\r\n  constructor() {\r\n    this.real = true;\r\n  }\r\n\r\n  logErrorReason = reason => {\r\n    // log the error reason but keep the rejection\r\n    console.log(\"Response error reason:\", reason);\r\n    return Promise.reject(reason);\r\n  };\r\n\r\n  checkStatus = response => {\r\n    if (response.status >= 200 && response.status < 300) {\r\n      return response;\r\n    } else if (response.status === 401) {\r\n      var unauthorizedError = new UnauthorizedError(response.statusText);\r\n      unauthorizedError.response = response;\r\n      return Promise.reject(unauthorizedError);\r\n    } else {\r\n      var error = new Error(response.statusText);\r\n      error.response = response;\r\n      return Promise.reject(error);\r\n    }\r\n  };\r\n\r\n  getVersion = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/version\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return { version: \"0.0.1\" };\r\n    }\r\n  };\r\n\r\n  // User\r\n  getAllUsers = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getAllUsersFromAPI();\r\n    }\r\n    else {\r\n      const data = this.getSessionData(\"allUsers\");\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getAllUsersFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getAllUsersFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/user/getAllUsers\");\r\n      const res = this.processResponse(response, null, \"allUsers\");\r\n      return res;\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  login = async (user, stayLoggedIn) => {\r\n    if (this.real) {\r\n      if (stayLoggedIn) {\r\n        const sessionObj = {\r\n          body: user,\r\n          expiresAt: \"never\"\r\n        };\r\n        localStorage.setItem(\"loginUser\", JSON.stringify(sessionObj));\r\n      }\r\n      const response = await this.postData(\"/api/user/login\", user);\r\n      return this.processResponse(response, null, \"user\", stayLoggedIn);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  }\r\n\r\n  logout = async user => {\r\n    if (this.real) {\r\n      await this.postData(\"/api/user/logout\");\r\n      localStorage.removeItem(\"user\");\r\n    }\r\n  };\r\n\r\n  register = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/register\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  confirmEmail = async (code) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/confirmEmail\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  sendReset = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/sendReset\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkResetPasswordCode = async code => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/checkResetPasswordCode\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  resetPassword = async (code, newPassword) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/resetPassword\", {code, newPassword});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  emailTest = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/emailTest\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  updateUser = async user => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/update\", user);\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/user/update\", user);\r\n        return this.processResponse(response, null);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  // Templates\r\n  createTemplate = async (template) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createTemplate\", { template: template });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createTemplate\", { template: template });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }\r\n\r\n  getTemplates = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getTemplatesFromAPI();\r\n    }\r\n    else {\r\n      const data = this.getSessionData(\"templates\");\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getTemplatesFromAPI();\r\n      }\r\n    }\r\n  }\r\n  getTemplatesFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getTemplates/`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getTemplates/`\r\n        );\r\n        return this.processResponse(response, null, `templates`);\r\n      }\r\n      return this.processResponse(response, retry, `templates`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Alice\" }];\r\n    }\r\n  }\r\n\r\n  // World\r\n  getWorlds = async (refresh = false) => {\r\n    try {\r\n      const publicWorlds = await this.getPublicWorlds(refresh);\r\n      const userWorlds = await this.getWorldsForUser(refresh);\r\n      const templates = await this.getTemplates(refresh);\r\n      const allUsers = await this.getAllUsers(refresh);\r\n\r\n      return {\r\n        publicWorlds,\r\n        userWorlds,\r\n        templates,\r\n        allUsers\r\n      };\r\n    }\r\n    catch (error) {\r\n      console.log(error);\r\n      return { error };\r\n    }\r\n  };\r\n\r\n  getWorldsForUser = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getWorldsForUserFromAPI();\r\n    }\r\n    else {\r\n      const data = this.getSessionData(\"worlds\");\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getWorldsForUserFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getWorldsForUserFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n        return this.processResponse(response, null, \"worlds\");\r\n      }\r\n      const res = this.processResponse(response, retry, \"worlds\");\r\n      return res;\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getPublicWorlds = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getPublicWorldsFromAPI();\r\n    }\r\n    else {\r\n      const data = this.getSessionData(\"publicWorlds\");\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getPublicWorldsFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getPublicWorldsFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n        return this.processResponse(response, null, \"publicWorlds\");\r\n      }\r\n      return this.processResponse(response, retry, \"publicWorlds\");\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getWorld = async (worldID, refresh = false) => {\r\n    try {\r\n      let attributes = await this.getAttributesForWorld(worldID, refresh);\r\n      attributes = attributes.attributes;\r\n      let types = await this.getTypesForWorld(worldID, refresh);\r\n      types = types.types;\r\n      let things = await this.getThingsForWorld(worldID, refresh);\r\n      things = things.things;\r\n\r\n      // Now connect them all as is appropriate.\r\n      const attributesByID = {};\r\n      const attributesByName = {};\r\n      attributes.forEach(attribute => {\r\n        attribute.TypeIDs = [];\r\n        attributesByID[attribute._id] = attribute;\r\n        attributesByName[attribute.Name] = attribute;\r\n      });\r\n      types.forEach(t=> {\r\n        t.Supers = [];\r\n        t.SuperIDs.forEach(sID=> {\r\n          t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n        });\r\n        t.AttributesArr = [];\r\n        t.Attributes.forEach(a => {\r\n          const attr = attributesByID[a.attrID];\r\n          if (attr === undefined) {\r\n          }\r\n          else {\r\n            attr.TypeIDs.push(t._id);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name.trim(),\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          }\r\n        });\r\n        const defHash = {};\r\n        if (t.Defaults !== undefined) {\r\n          t.Defaults.forEach(def => {\r\n            defHash[def.attrID] = def;\r\n          });\r\n        }\r\n        t.DefaultsHash = defHash;\r\n      });\r\n      things.forEach(t=> {\r\n        t.Types = [];\r\n        t.TypeIDs.forEach(tID=> {\r\n          t.Types = t.Types.concat(types.filter(t2=>t2._id === tID));\r\n        });\r\n      });\r\n      return {\r\n        attributes,\r\n        attributesByID,\r\n        attributesByName,\r\n        types,\r\n        things\r\n      };\r\n    }\r\n    catch (error) {\r\n      console.log(error);\r\n      return { error };\r\n    }\r\n  };\r\n\r\n  getWorldByTypeID = async (typeID, refresh = false) => {\r\n    try {\r\n      let worldID = await this.getWorldIDByTypeID(typeID);\r\n      worldID = worldID.worldID;\r\n      console.log(worldID);\r\n      let attributes = await this.getAttributesForWorld(worldID, refresh);\r\n      attributes = attributes.attributes;\r\n      let types = await this.getTypesForWorld(worldID, refresh);\r\n      types = types.types;\r\n      let things = await this.getThingsForWorld(worldID, refresh);\r\n      things = things.things;\r\n\r\n      // Now connect them all as is appropriate.\r\n      const attributesByID = {};\r\n      const attributesByName = {};\r\n      attributes.forEach(attribute => {\r\n        attribute.TypeIDs = [];\r\n        attributesByID[attribute._id] = attribute;\r\n        attributesByName[attribute.Name] = attribute;\r\n      });\r\n      types.forEach(t=> {\r\n        t.Supers = [];\r\n        t.SuperIDs.forEach(sID=> {\r\n          t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n        });\r\n        t.AttributesArr = [];\r\n        t.Attributes.forEach(a => {\r\n          const attr = attributesByID[a.attrID];\r\n          if (attr === undefined) {\r\n          }\r\n          else {\r\n            attr.TypeIDs.push(t._id);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name.trim(),\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          }\r\n        });\r\n        const defHash = {};\r\n        if (t.Defaults !== undefined) {\r\n          t.Defaults.forEach(def => {\r\n            defHash[def.attrID] = def;\r\n          });\r\n        }\r\n        t.DefaultsHash = defHash;\r\n      });\r\n      things.forEach(t=> {\r\n        t.Types = [];\r\n        t.TypeIDs.forEach(tID=> {\r\n          t.Types = t.Types.concat(types.filter(t2=>t2._id === tID));\r\n        });\r\n      });\r\n      return {\r\n        worldID,\r\n        attributes,\r\n        attributesByID,\r\n        attributesByName,\r\n        types,\r\n        things\r\n      };\r\n    }\r\n    catch (error) {\r\n      console.log(error);\r\n      return { error };\r\n    }\r\n  };\r\n\r\n  getWorldIDByTypeID = async (typeID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getWorldIDByTypeID/${typeID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getWorldIDByTypeID/${typeID}`\r\n        );\r\n        return this.processResponse(response, null);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getWorldByThingID = async (thingID, refresh = false) => {\r\n    try {\r\n      let worldID = await this.getWorldIDByThingID(thingID);\r\n      worldID = worldID.worldID;\r\n      console.log(worldID);\r\n      let attributes = await this.getAttributesForWorld(worldID, refresh);\r\n      attributes = attributes.attributes;\r\n      let types = await this.getTypesForWorld(worldID, refresh);\r\n      types = types.types;\r\n      let things = await this.getThingsForWorld(worldID, refresh);\r\n      things = things.things;\r\n\r\n      // Now connect them all as is appropriate.\r\n      const attributesByID = {};\r\n      const attributesByName = {};\r\n      attributes.forEach(attribute => {\r\n        attribute.TypeIDs = [];\r\n        attributesByID[attribute._id] = attribute;\r\n        attributesByName[attribute.Name] = attribute;\r\n      });\r\n      types.forEach(t=> {\r\n        t.Supers = [];\r\n        t.SuperIDs.forEach(sID=> {\r\n          t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n        });\r\n        t.AttributesArr = [];\r\n        t.Attributes.forEach(a => {\r\n          const attr = attributesByID[a.attrID];\r\n          if (attr === undefined) {\r\n          }\r\n          else {\r\n            attr.TypeIDs.push(t._id);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name.trim(),\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          }\r\n        });\r\n        const defHash = {};\r\n        if (t.Defaults !== undefined) {\r\n          t.Defaults.forEach(def => {\r\n            defHash[def.attrID] = def;\r\n          });\r\n        }\r\n        t.DefaultsHash = defHash;\r\n      });\r\n      things.forEach(t=> {\r\n        t.Types = [];\r\n        t.TypeIDs.forEach(tID=> {\r\n          t.Types = t.Types.concat(types.filter(t2=>t2._id === tID));\r\n        });\r\n      });\r\n      return {\r\n        worldID,\r\n        attributes,\r\n        attributesByID,\r\n        attributesByName,\r\n        types,\r\n        things\r\n      };\r\n    }\r\n    catch (error) {\r\n      console.log(error);\r\n      return { error };\r\n    }\r\n  };\r\n\r\n  getWorldIDByThingID = async (thingID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getWorldIDByThingID/${thingID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getWorldIDByThingID/${thingID}`\r\n        );\r\n        return this.processResponse(response, null);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  createWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  generateCollabLink = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/generateCollabLink\", { worldID: worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/generateCollabLink\", { worldID: worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  addNewCollaborator = async (worldID, userID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/addNewCollaborator\", { worldID, userID, email });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/addNewCollaborator\", { worldID, userID, email });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  emailCollaborator = async (worldID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/emailCollaborator\", { worldID, email });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/emailCollaborator\", { worldID, email });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  deleteCollab = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteCollab\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteCollab\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateCollaboratorPermission = async (worldID, collabID, editPermission) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateCollaboratorPermission\", { worldID, collabID, editPermission });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateCollaboratorPermission\", { worldID, collabID, editPermission });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkCollabID = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/checkCollabID\", {worldID, collabID});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  requestToCollaborate = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/requestToCollaborate\", { worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/requestToCollaborate\", { worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  declineCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/declineCollabInvite\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/declineCollabInvite\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  acceptCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/acceptCollabInvite\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/acceptCollabInvite\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  acceptCollabRequest = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/acceptCollabRequest\", { worldID, collabID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/acceptCollabRequest\", { worldID, collabID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  selectWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Attribute\r\n  getAttributesForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getAttributesForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`attributes_${worldID}`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getAttributesForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getAttributesForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttributesForWorld/${worldID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getAttributesForWorld/${worldID}`\r\n        );\r\n        return this.processResponse(response, null, `attributes_${worldID}`);\r\n      }\r\n      return this.processResponse(response, retry, `attributes_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getAttribute = async (worldID, attrID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttribute/${worldID}/${attrID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getAttribute/${worldID}/${attrID}`\r\n        );\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createAttribute = async (attribute) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createAttribute\", { attribute: attribute });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createAttribute\", { attribute: attribute });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  // deleteAttribute = async (worldID, attrID) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.deleteData(\"/api/world/deleteAttribute\", { worldID: worldID, attrID: attrID });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  // updateAttribute = async (attribute) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.patchData(\"/api/world/updateAttribute\", { attribute: attribute });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  upsertAttributes = async (worldID, attributes) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/upsertAttributes\", { worldID, attributes: attributes });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/upsertAttributes\", { worldID, attributes: attributes });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  // Type\r\n  getTypesForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getTypesForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`types_${worldID}`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getTypesForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getTypesForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getTypesForWorld/${worldID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getTypesForWorld/${worldID}`\r\n        );\r\n        return this.processResponse(response, null, `types_${worldID}`);\r\n      }\r\n      return this.processResponse(response, retry, `types_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getType/${worldID}/${typeID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getType/${worldID}/${typeID}`\r\n        );\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createType\", { type: type });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createType\", { type: type });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Thing\r\n  getThingsForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getThingsForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`things_${worldID}`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getThingsForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getThingsForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getThingsForWorld/${worldID}`\r\n      );\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(\r\n          `/api/world/getThingsForWorld/${worldID}`\r\n        );\r\n        return this.processResponse(response, null, `things_${worldID}`);\r\n      }\r\n      return this.processResponse(response, retry, `things_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  getThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Types: [-1],\r\n        Name: \"Alice\",\r\n        Description: \"\"\r\n      };\r\n    }\r\n  };\r\n\r\n  createThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Comments\r\n  getComments = async (worldID, objectType, objectID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getComments/${worldID}/${objectType}/${objectID}`);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Types: [-1],\r\n        Name: \"Alice\",\r\n        Description: \"\"\r\n      };\r\n    }\r\n  }\r\n\r\n  addComment = async (comment) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/addComment\", { comment });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.postData(\"/api/world/addComment\", { comment });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }\r\n\r\n  updateComment = async (comment) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateComment\", { comment });\r\n      const retry = async () => {\r\n        await this.relogin();\r\n        const response = await this.patchData(\"/api/world/updateComment\", { comment });\r\n        return this.processResponse(response);\r\n      }\r\n      return this.processResponse(response, retry);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }\r\n\r\n  // Core API Calls\r\n  fetchData = async (path, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        ...options.headers\r\n      }\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  postData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  putData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  patchData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  deleteData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"DELETE\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  processResponse = async (response, retry = null, sessionName = null, noExpiry = false) => {\r\n    const body = await response.json();\r\n    if (response.status !== 200) { \r\n      throw Error(body.message);\r\n    }\r\n    else if (body.error !== undefined && retry !== null) {\r\n      return retry();\r\n    } \r\n    else {\r\n      if (sessionName !== null) {\r\n        let expiresAt = new Date();\r\n        if (noExpiry) \r\n          expiresAt = \"never\";\r\n        else \r\n          expiresAt.setHours(expiresAt.getHours() + 1);\r\n        const sessionObj = {\r\n          expiresAt,\r\n          body\r\n        };\r\n        localStorage.setItem(sessionName, JSON.stringify(sessionObj));\r\n      }\r\n      return body;\r\n    };\r\n  };\r\n\r\n  relogin = async () => {\r\n    try {\r\n      const user = this.getSessionData(\"loginUser\");\r\n      if (user !== null) {\r\n        const response = await this.postData(\"/api/user/login\", user);\r\n        this.processResponse(response, null, \"user\", true);\r\n      }\r\n    }\r\n    catch {}\r\n  }\r\n\r\n  getSessionData = (sessionName) => {\r\n    const sessionStr = localStorage.getItem(sessionName);\r\n    if (sessionStr !== null) {\r\n      const sessionObj = JSON.parse(sessionStr);\r\n      if (sessionObj.expiresAt !== undefined && \r\n        (sessionObj.expiresAt === \"never\" || sessionObj.expiresAt > new Date())) {\r\n        return sessionObj.body;\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n}\r\n\r\nexport default API;\r\n","import React from 'react';\r\nimport ReactPlayer from 'react-player'; // npm install react-player --save\r\n// import YouTube from 'react-youtube'; // npm install react-youtube\r\n\r\n// const _onReady = (event) => {\r\n//   // access to player in all event handlers via event.target\r\n//   event.target.pauseVideo();\r\n// }\r\n\r\nexport default function MediaPlayer(props) {\r\n  console.log(props);\r\n  return (\r\n    <ReactPlayer\r\n      // className='react-player fixed-bottom'\r\n      url= 'https://youtu.be/kksVfoN2bR8'\r\n      width='100%'\r\n      // height='100%'\r\n      // controls = {true}\r\n    />\r\n  );\r\n  // <ReactPlayer url='https://www.youtube.com/watch?v=ysz5S6PUM-U' />;\r\n}","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActionArea from '@material-ui/core/CardActionArea';\r\n// import CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\n// import CardMedia from '@material-ui/core/CardMedia'; // Don't forget about this one.  It looks like it could be useful.\r\n// import Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport MediaPlayer from './MediaPlayer';\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    // maxWidth: 345,\r\n  },\r\n});\r\n\r\nexport default function MediaCard(props) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n      <CardActionArea>\r\n        <CardContent>\r\n          <Typography gutterBottom variant=\"h5\" component=\"h2\">\r\n            {props.title}\r\n          </Typography>\r\n          <MediaPlayer url=\"urlGoesHere.mov\" />\r\n          <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n            {props.description}\r\n          </Typography>\r\n        </CardContent>\r\n      </CardActionArea>\r\n    </Card>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  notFromLogin\r\n} from \"../redux/actions/index\";\r\nimport MediaCard from \"../components/Displays/MediaCard\";\r\n// import ContentEditableBox from \"../components/Inputs/ContentEditableBox\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\",\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else {\r\n      return (\r\n        <div>\r\n          <h3>Author's Notebook</h3>\r\n\r\n          <MediaCard title=\"Getting Started\" description=\"This video explains the basics of how to use the website and its tools.  It covers the basic concepts, navigation, creating a project, importing templates, creating types, creating attributes, and creating things.\" />\r\n{/* \r\n          <p>\r\n            This is something that I've been wanting to build for a while. It's\r\n            purpose is to provide a place for keeping track of various aspects of\r\n            books that an author is writing. It is able to keep track of details\r\n            about characters, organizations, systems, and even storylines. I would\r\n            like to make it so it's publicly available, and that any authors\r\n            (aspiring and published) can use it to help them organize their\r\n            stories. I want to make it automate a number of things, but the\r\n            biggest part is to make it very dynamic and to allow for storage of\r\n            all different kinds of notes. In order to make it publicly available\r\n            however, it needs to at least be able to pay for itself. I'm not\r\n            talking about the time I spent/spend working on it, but the costs of\r\n            hosting the website, the db, and the url. Until I'm sure it's capable\r\n            of doing those things, I can't let everyone have access to it.\r\n          </p>\r\n          <p>\r\n            This is version 1 of instructions of how to use it. If I make it\r\n            available for anyone, I'll update it with some video instructions.\r\n          </p>\r\n          <p>\r\n            One thing you need to know is that this is a hobby project of mine.\r\n            I'm working on it by myself for now. I've got a real job, and I've got\r\n            a family, so this isn't my top priority, but that being said I do care\r\n            about this probject, and I do plan to get to all the things that are\r\n            on my to do list.\r\n          </p>\r\n          <p>\r\n            If you want to do more than just look at the things others have put on\r\n            (and which they're allowing you to see), then you'll have to register.\r\n            Making it use Facebook and/or Google authentication is on my to do\r\n            list. I know how to do that, but I just haven't gotten around to it.\r\n            So, for now, just register and login. It currently doesn't send any\r\n            emails, so if you forget your password or something, you'll have to\r\n            reach out to me, and I can straighten it out. Again, that kind of\r\n            thing is also on my to do list.\r\n          </p>\r\n          <p>\r\n            Once you're logged in then you're able to start keeping track of\r\n            things.\r\n          </p>\r\n          <p>\r\n            The first thing you create is currently called a World. This is a\r\n            holdover from when I was calling this my World Building App because I\r\n            was aiming it for Fantasy/Sci-Fi authors (like me), but I realized\r\n            that it could be used for anything really. If anyone has any\r\n            suggestions for something to call this instead of World, I'm open to\r\n            considering other options. Currently I'm considering changing it to\r\n            'Project', and I may do that before showing it to anyone other than\r\n            family and close friends. Anyway, a World is basically the root of\r\n            everything. Different Worlds aren't connected to each other. Each\r\n            World has a Name, and you can choose whether or not to make it Public.\r\n            If it's not Public then only the Owner (whoever created it) is able to\r\n            see it. If it is Public then anyone can see it, but only the Owner can\r\n            edit it. (Planned Future Features: When you create a new world you can\r\n            use a template which will include generic Types common to that type of\r\n            World, such as Character, Location, etc. I'm also planning to add the\r\n            ability for Owners to add Collaborators to their World. Collaborators\r\n            would be able to see the World, and the Owner would be able to control\r\n            their other permissions as well (create/edit type, delete type,\r\n            create/edit thing, and delete thing.). Only the Owner will have the\r\n            ability to Edit or Delete the World itself, but they will be able to\r\n            make someone else the Owner.)\r\n          </p>\r\n          <p>\r\n            Within a World you are able to define Types. Basically a Type is just\r\n            that. It's a Type of Thing that you want to keep track of. In each\r\n            Type you are able to define attributes which that Type of Thing share,\r\n            such as Characters having Age, Race, Gender, Height, Weight, Skin\r\n            Color, Eye Color, etc. Types can also be hierarchical through\r\n            inheritance. For example, in Harry Potter I would have a 'Character'\r\n            Type with all the attributes I listed above, but then I could have a\r\n            'Witch or Wizard' Type which has 'Character' as a Super Type. This\r\n            means that 'Witch or Wizard' already has all those same Attributes as\r\n            'Character', but you can add more Attributes like Wand, Known Spells,\r\n            etc. The way to set the Super Types for a type is with a control\r\n            called a Multi Select. It's basically a textbox, but as you type it\r\n            gives you suggestions. You click a suggestion and it adds a chip\r\n            showing it as selected. Clicking the x on the right of the chip\r\n            unselects it. When selecting a Type to be a Super Type it adds all the\r\n            Attributes of that Type to the Type you're creating or editing, but\r\n            they are greyed out and disabled for editing. The reason they're grey\r\n            and disabled is that they come from a Super Type, so their definition\r\n            is there. If a Super Type is removed then the Attributes remain, but\r\n            are no longer grey and disabled. They can then be edited. There are a\r\n            few more things to note however. First is that when adding a Super\r\n            Type which has Super Types, those Super Types will be added as well.\r\n            An example of this could be the 'Animagus' Type in Harry Potter.\r\n            'Animagus' has the Super Type 'Witch or Wizard', which has the Super\r\n            Type 'Character', so when defining 'Animagus' I could add 'Witch or\r\n            Wizard' as a Super Type, and that will automatically add 'Character'\r\n            as well. Removing a Super Type of other Super Types will remove all\r\n            Sub Types of the Super Type removed. An example of that would be\r\n            removing 'Character' from 'Animagus'. This would automatically remove\r\n            'Witch or Wizard' as well. It doesn't make sense to do that for\r\n            'Animagus', but it may be necessary for you if you want to rethink how\r\n            you're organizing things. The last thing to note about removing Super\r\n            Types is that so long as a single Super Type exists which has an\r\n            Attribute with that name, it will be greyed out and disabled. Another\r\n            note about Attributes is that their names have to be unique on the\r\n            Type (or Thing). It's generally a good idea to make sure that any\r\n            Attributes you define with the same name also have the same Attribute\r\n            type as well, otherwise you may run into Attribute name collisions.\r\n            One last thing about Types. I've added an option to Types called Major\r\n            Type. If it's checked then the Type is considered a Major Type and\r\n            will show up in places of the UI where a regular Type will not. This\r\n            makes finding, creating, and editing Things of that Type easier. I\r\n            would make 'Character' a Major Type, but 'Witch or Wizard' and\r\n            'Animagus' would be regular Types. (Planned Future Features: Template\r\n            Types like I have above for Template Worlds, but they're individual\r\n            Types. Also add Plural Name field which will be used in the UI for\r\n            places where we put the plural name of something. Currently it just\r\n            adds an 's' to the end of the Type name, and I want to continue to do\r\n            that if the Plural Name is left empty, but if it's not empty then\r\n            display the Plural Name instead.)\r\n          </p>\r\n          <p>\r\n            Types have Attributes (as mentioned above). Things (which I'll get\r\n            into more below) also have Attributes. The same Attributes really. In\r\n            the Harry Potter World the Attributes on the 'Character' Type would\r\n            then be given to every character you create afterward, but now instead\r\n            of naming the Attribute and saying what type of Attribute it is, you\r\n            get to specify a value for the Attribute.\r\n          </p>\r\n          <p>\r\n            An Attribute is anything you may wish to keep track of for anything.\r\n            These do not include Name or Description, because all Types and Things\r\n            always have Name and Description by default. Attributes are for\r\n            anything else you want to keep track of. It could be a relationship\r\n            like 'Friend', 'Family Member', 'Significant Other', 'Coworker', etc.\r\n            It could be skills and abilities, or possessions, or jobs, or home\r\n            address, or work or school schedule. Really anything you want to keep\r\n            track of which is part of something can be an Attribute. Currently\r\n            there are six types of Attributes that are supported: Text, Number,\r\n            True/False, Options, Type, and List. Text is just that. A Text\r\n            Attribute gives you a textbox where you can type anything you want to\r\n            keep track of. Number gives you a number box, which is like a textbox\r\n            but it only accepts numbers, and it has arrows on the right which can\r\n            be used to increment or decrement the number. True/False gives you a\r\n            checkbox. Options allows you to specify possible choices for the\r\n            Attribute, and then they show up in a drop down list (A quick example\r\n            of this could be 'Gender' having 'Male', 'Female', and others if you\r\n            wanted. They can have as many options as you want, and it can be used\r\n            for whatever Attribute you want.). Specifying the choices is done\r\n            using a control called a Chip Input. This looks like a regular\r\n            textbox, but whenever you hit enter the text in it is added as a chip.\r\n            Chips show the text, but have an x on their right which can be used to\r\n            remove them. It's basically like the Multiselect except without the\r\n            suggestions. The Chips are the choices that will be in the drop down\r\n            list which the user has when creating or editing a Thing with that\r\n            Attribute.\r\n          </p>\r\n          <p>The last two Attribute types are a little more complicated.</p>\r\n          <p>\r\n            When adding Attributes to a Type, the 'Type' Attribute type allows you\r\n            to then choose from the various Types you've defined for the World,\r\n            and then when you're creating or editing a Thing (such as the\r\n            'Character' 'Harry Potter') you would get all the Things of that Type\r\n            as choices in a drop down list. For example you could have a 'Best\r\n            Friend' Attribute which has the Attribute type of 'Type' and uses the\r\n            Defined Type of 'Character'. Then when editing Harry you would have a\r\n            drop down list which shows all the 'Characters' you've added to the\r\n            World as possible 'Best Friends'. You would of course then choose 'Ron\r\n            Weasley' (Sorry, Hermione, but you're a close second.).\r\n          </p>\r\n          <p>\r\n            The Attribute Type 'List' is still more complicated than 'Type'. It\r\n            allows you to decide which type of 'List' it's going to be. For now it\r\n            only supports 'Text', 'Options', and 'Type'. (I'm not planning to add\r\n            any others, but if it's requested I may consider it. A List of Text\r\n            could be anything really, so other types shouldn't be necessary.) If\r\n            an Attribute is defined as a List of Text then when creating or\r\n            editing a Thing the Attribute gives a Chip Input, which works the same\r\n            as it does for Options (described above). A List of Options allows you\r\n            to define the choices when creating or editing the Type, the same as\r\n            with a regular Options Attribute, and then when creating or editing a\r\n            Thing of that Type it gives a Multiselect which works the same as when\r\n            choosing Super Types (described above) with the Options defined\r\n            previously on the Type as the suggestions. A List of 'Type' allows you\r\n            to choose a Defined Type (like with the Attribute type 'Type'), but\r\n            when creating or editing a Thing it gives you a Multiselect instead of\r\n            a regular drop down list so you can select more than one. With all\r\n            'List' Attributes, the items in the list are displayed separated by\r\n            commas when looking at the details page rather than creating or\r\n            editing.\r\n          </p>\r\n          <p>\r\n            One last note about Attributes of type 'Type' or 'List' of 'Type'.\r\n            I've made it so that if you want to choose a Defined Type which you\r\n            haven't defined yet you can choose '+ Create New Type' and it opens a\r\n            quick little window (modal for those who care) which lets you define a\r\n            Type using just the name you want it to have. You'll have to edit that\r\n            Type later to give it any Super Types or Attributes it should have,\r\n            but you can create it there so you can continue defining the Type\r\n            you're already working on rather than having to leave and come back to\r\n            it. The same thing can be done when creating or editing a Thing with\r\n            an Attribute of type 'Type' or 'List' of 'Type', but for Things the\r\n            Type has already been chosen. Now you will be creating a Thing of that\r\n            Type. An example of this would be if you're editing the 'Character'\r\n            'Harry Potter', but when you get to 'Best Friend' you realize you\r\n            haven't added the 'Ron Weasley' 'Character' yet. You would choose '+\r\n            Create New Character', and then in the quick little window you would\r\n            type 'Ron Weasley'. He would get added as a blank character with just\r\n            his Name, but he would then be selected as Harry's 'Best Friend', and\r\n            you could finish defining Harry, and get to Ron later.\r\n          </p>\r\n          <p>\r\n            And one more thing about Attributes in general.  I added the ability to\r\n            set Default values for attributes on the Type.  Default Values will \r\n            automatically be set on any Things of that Type.  I made it as user \r\n            friendly as I could think to make it.\r\n          </p>\r\n          <p>\r\n            (Planned Future Features: Other Attribute types, including: Image,\r\n            Event, and External Link. If you have any suggestions of others, feel\r\n            free to recommend them.  Also need to put in validation to detect \r\n            Name and Default collisions.)\r\n          </p>\r\n          <p>\r\n            And that brings us to Things. If you've gotten to this point, then you\r\n            probably already understand what Things are, but I'll outline it\r\n            anyway. The generic term Thing is used to mean any actual thing you're\r\n            keeping track of. This would be your Characters, your Places, your\r\n            Items, Spells, whatever. When creating or editing a Thing you are able\r\n            to choose Types for the Thing (works the same as Super Types for\r\n            Types), and all the Attributes of those Types are added to the Thing,\r\n            but now you're able to give values for them. Again remember to avoid\r\n            Attribute Name collisions (If for some reason you've defined 2\r\n            unrelated Types with an Attribute that has the same name but different\r\n            Attribute types then you won't be able to have a Thing of both\r\n            Types.). If a Type is edited to remove an Attribute, Things which use\r\n            that Type and existed already will still have that Attribute. It will\r\n            just be an orphaned Attribute. Currently there's no way to remove\r\n            Attributes from Things. If a Type is edited to add Attributes then\r\n            Things which already existed will gain those Attributes as soon as\r\n            they're edited again. If a Type is edited and an Attribute is\r\n            changed... I'm not actually sure what would happen to Things that\r\n            already exist which have that Type. I'll have to test that. That's\r\n            really it for Things. They're the simple part. (Planned Future\r\n            Features: I'm planning to add the ability to add/remove/edit orphaned\r\n            Attributes for Things. When I do, I'll probably try to find a way to\r\n            make it so with adding/editing orphaned Attributes you'll be able to\r\n            add the Attribute to a selected Type already on the Thing.)\r\n          </p>\r\n          <p>I probably should have put Attributes below Things, but oh well.</p>\r\n          <p>Other Planned Future Features:</p>\r\n          <div>\r\n            <p>\r\n              Direct Messages: I'll add a simple messaging system to allow people\r\n              to communicate directly with one another.\r\n            </p>\r\n            <p>\r\n              Auto-links: For both comments and DMs I'll allow users to put links to\r\n              pages through a simple system similar to hashtags in Social Media.\r\n              I'm thinking I also want to add this capability to Descriptions on\r\n              Types and Things.\r\n            </p>\r\n            <p>\r\n              Following Public Worlds: Currently all Public Worlds are listed in\r\n              the menu, but I should make it so only those that the user follows\r\n              are shown there, and have a button to pull up the full list, and add\r\n              a button for people who neither own or collaborate on a Public World\r\n              to 'Follow' the World.\r\n            </p>\r\n            <p>\r\n              Home Page content: I'm planning to have actual Home Page content.\r\n              This will have a link to a video tutorial for new users (which I\r\n              have yet to make, and will need occasional updating after it's\r\n              made), as well as things like recent software changes. I also want\r\n              to make it so it can automatically have links to recently added or\r\n              edited Types or Things and recent comments which may be of\r\n              interest to the user.\r\n            </p>\r\n          </div> */}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst HomePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default HomePage;\r\n","/*\r\nReact-Quill\r\nhttps://github.com/zenoamaro/react-quill\r\n*/\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport isEqual from 'lodash/isEqual';\r\n\r\nimport Quill, {\r\n  // QuillOptionsStatic,\r\n  // DeltaStatic,\r\n  // RangeStatic,\r\n  // BoundsStatic,\r\n  // StringMap,\r\n  // Sources,\r\n} from 'quill';\r\n\r\n\r\nclass ReactQuill extends React.Component {\r\n\r\n  static displayName = 'React Quill'\r\n\r\n  /*\r\n  Export Quill to be able to call `register`\r\n  */\r\n  static Quill = Quill;\r\n\r\n  /*\r\n  Changing one of these props should cause a full re-render and a\r\n  re-instantiation of the Quill editor.\r\n  */\r\n  dirtyProps = [\r\n    'modules',\r\n    'formats',\r\n    'bounds',\r\n    'theme',\r\n    'children',\r\n  ]\r\n\r\n  /*\r\n  Changing one of these props should cause a regular update. These are mostly\r\n  props that act on the container, rather than the quillized editing area.\r\n  */\r\n  cleanProps = [\r\n    'id',\r\n    'className',\r\n    'style',\r\n    'placeholder',\r\n    'tabIndex',\r\n    'onChange',\r\n    'onChangeSelection',\r\n    'onFocus',\r\n    'onBlur',\r\n    'onKeyPress',\r\n    'onKeyDown',\r\n    'onKeyUp',\r\n    // 'ref'\r\n  ]\r\n\r\n  static defaultProps = {\r\n    theme: 'snow',\r\n    modules: {},\r\n    readOnly: false,\r\n  }\r\n\r\n  state = {\r\n    generation: 0,\r\n  }\r\n\r\n  /*\r\n  The Quill Editor instance.\r\n  */\r\n  editor = null\r\n\r\n  /*\r\n  Reference to the element holding the Quill editing area.\r\n  */\r\n  editingArea = null\r\n\r\n  /*\r\n  Tracks the internal value of the Quill editor\r\n  */\r\n  value = null\r\n\r\n  refInput = null\r\n\r\n  /*\r\n  Tracks the internal selection of the Quill editor\r\n  */\r\n  selection = null\r\n\r\n  /*\r\n  Used to compare whether deltas from `onChange` are being used as `value`.\r\n  */\r\n  lastDeltaChangeSet = null\r\n\r\n  /*\r\n  Stores the contents of the editor to be restored after regeneration.\r\n  */\r\n  regenerationSnapshot = {}\r\n\r\n  /*\r\n  A weaker, unprivileged proxy for the editor that does not allow accidentally\r\n  modifying editor state.\r\n  */\r\n  unprivilegedEditor = null\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const value = this.isControlled()? props.value : props.defaultValue;\r\n    // So at this point value includes the span.  Need to figure out where it's getting stripped out.\r\n    this.value = value ?? '';\r\n    this.refInput = React.createRef();\r\n  }\r\n\r\n  validateProps(props) {\r\n    if (React.Children.count(props.children) > 1) throw new Error(\r\n      'The Quill editing area can only be composed of a single React element.'\r\n    );\r\n\r\n    if (React.Children.count(props.children)) {\r\n      const child = React.Children.only(props.children);\r\n      if (child !== null && child.type === 'textarea') throw new Error(\r\n        'Quill does not support editing on a <textarea>. Use a <div> instead.'\r\n      );\r\n    }\r\n\r\n    if (\r\n      this.lastDeltaChangeSet &&\r\n      props.value === this.lastDeltaChangeSet\r\n    ) throw new Error(\r\n      'You are passing the `delta` object from the `onChange` event back ' +\r\n      'as `value`. You most probably want `editor.getContents()` instead. ' +\r\n      'See: https://github.com/zenoamaro/react-quill#using-deltas'\r\n    );\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    this.validateProps(nextProps);\r\n\r\n    // If the editor hasn't been instantiated yet, or the component has been\r\n    // regenerated, we already know we should update.\r\n    if (!this.editor || this.state.generation !== nextState.generation) {\r\n      return true;\r\n    }\r\n\r\n    // Handle value changes in-place\r\n    if ('value' in nextProps) {\r\n      const prevContents = this.getEditorContents();\r\n      const nextContents = nextProps.value ?? '';\r\n\r\n      // NOTE: Seeing that Quill is missing a way to prevent edits, we have to\r\n      //       settle for a hybrid between controlled and uncontrolled mode. We\r\n      //       can't prevent the change, but we'll still override content\r\n      //       whenever `value` differs from current state.\r\n      // NOTE: Comparing an HTML string and a Quill Delta will always trigger a\r\n      //       change, regardless of whether they represent the same document.\r\n      if (!this.isEqualValue(nextContents, prevContents)) {\r\n        this.setEditorContents(this.editor, nextContents);\r\n      }\r\n    }\r\n\r\n    // Handle read-only changes in-place\r\n    if (nextProps.readOnly !== this.props.readOnly) {\r\n      this.setEditorReadOnly(this.editor, !nextProps.readOnly);\r\n    }\r\n\r\n    // Clean and Dirty props require a render\r\n    return [...this.cleanProps, ...this.dirtyProps].some((prop) => {\r\n      return !isEqual(nextProps[prop], this.props[prop]);\r\n    });\r\n  }\r\n\r\n  shouldComponentRegenerate(nextProps) {\r\n    // Whenever a `dirtyProp` changes, the editor needs reinstantiation.\r\n    return this.dirtyProps.some((prop) => {\r\n      return !isEqual(nextProps[prop], this.props[prop]);\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.instantiateEditor();\r\n    this.setEditorContents(this.editor, this.getEditorContents());\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.destroyEditor();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    // If we're changing one of the `dirtyProps`, the entire Quill Editor needs\r\n    // to be re-instantiated. Regenerating the editor will cause the whole tree,\r\n    // including the container, to be cleaned up and re-rendered from scratch.\r\n    // Store the contents so they can be restored later.\r\n    if (this.editor && this.shouldComponentRegenerate(prevProps)) {\r\n      const delta = this.editor.getContents();\r\n      const selection = this.editor.getSelection();\r\n      this.regenerationSnapshot = {delta, selection};\r\n      this.setState({generation: this.state.generation + 1});\r\n      this.destroyEditor();\r\n    }\r\n\r\n    // The component has been regenerated, so it must be re-instantiated, and\r\n    // its content must be restored to the previous values from the snapshot.\r\n    if (this.state.generation !== prevState.generation) {\r\n      const {delta, selection} = this.regenerationSnapshot;\r\n      delete this.regenerationSnapshot;\r\n      this.instantiateEditor();\r\n      const editor = this.editor;\r\n      editor.setContents(delta);\r\n      postpone(() => this.setEditorSelection(editor, selection));\r\n    }\r\n  }\r\n\r\n  instantiateEditor() {\r\n    if (this.editor) return;\r\n    this.editor = this.createEditor(\r\n      this.getEditingArea(),\r\n      this.getEditorConfig()\r\n    );\r\n  }\r\n\r\n  destroyEditor() {\r\n    if (!this.editor) return;\r\n    this.unhookEditor(this.editor);\r\n    delete this.editor;\r\n  }\r\n\r\n  /*\r\n  We consider the component to be controlled if `value` is being sent in props.\r\n  */\r\n  isControlled() {\r\n    return 'value' in this.props;\r\n  }\r\n\r\n  getEditorConfig() {\r\n    return {\r\n      bounds: this.props.bounds,\r\n      formats: this.props.formats,\r\n      modules: this.props.modules,\r\n      placeholder: this.props.placeholder,\r\n      readOnly: this.props.readOnly,\r\n      scrollingContainer: this.props.scrollingContainer,\r\n      tabIndex: this.props.tabIndex,\r\n      theme: this.props.theme,\r\n    };\r\n  }\r\n\r\n  getEditor() {\r\n    if (!this.editor) throw new Error('Accessing non-instantiated editor');\r\n    return this.editor;\r\n  }\r\n\r\n  /**\r\n  Creates an editor on the given element. The editor will be passed the\r\n  configuration, have its events bound,\r\n  */\r\n  createEditor(element, config) {\r\n    const editor = new Quill(element, config);\r\n    if (config.tabIndex != null) {\r\n      this.setEditorTabIndex(editor, config.tabIndex);\r\n    }\r\n    this.hookEditor(editor);\r\n    return editor;\r\n  }\r\n\r\n  hookEditor(editor) {\r\n    // Expose the editor on change events via a weaker, unprivileged proxy\r\n    // object that does not allow accidentally modifying editor state.\r\n    this.unprivilegedEditor = this.makeUnprivilegedEditor(editor);\r\n    // Using `editor-change` allows picking up silent updates, like selection\r\n    // changes on typing.\r\n    editor.on('editor-change', this.onEditorChange);\r\n  }\r\n\r\n  unhookEditor(editor) {\r\n    editor.off('editor-change', this.onEditorChange);\r\n  }\r\n\r\n  getEditorContents() {\r\n    return this.value;\r\n  }\r\n\r\n  getEditorSelection() {\r\n    return this.selection;\r\n  }\r\n\r\n  /*\r\n  True if the value is a Delta instance or a Delta look-alike.\r\n  */\r\n  isDelta(value) {\r\n    return value && value.ops;\r\n  }\r\n\r\n  /*\r\n  Special comparison function that knows how to compare Deltas.\r\n  */\r\n  isEqualValue(value, nextValue) {\r\n    if (this.isDelta(value) && this.isDelta(nextValue)) {\r\n      return isEqual(value.ops, nextValue.ops);\r\n    } else {\r\n      return isEqual(value, nextValue);\r\n    }\r\n  }\r\n\r\n  /*\r\n  Replace the contents of the editor, but keep the previous selection hanging\r\n  around so that the cursor won't move.\r\n  */\r\n  setEditorContents(editor, value) {\r\n    this.value = value;\r\n    const sel = this.getEditorSelection();\r\n    if (typeof value === 'string') {\r\n      editor.setContents(editor.clipboard.convert(value));\r\n    } else {\r\n      editor.setContents(value);\r\n    }\r\n    postpone(() => this.setEditorSelection(editor, sel));\r\n  }\r\n\r\n  setEditorSelection(editor, range) {\r\n    this.selection = range;\r\n    if (range) {\r\n      // Validate bounds before applying.\r\n      const length = editor.getLength();\r\n      range.index = Math.max(0, Math.min(range.index, length-1));\r\n      range.length = Math.max(0, Math.min(range.length, (length-1) - range.index));\r\n      \r\n      editor.setSelection(range);\r\n    }\r\n  }\r\n\r\n  setEditorTabIndex(editor, tabIndex) {\r\n    if (editor?.scroll?.domNode) {\r\n      (editor.scroll.domNode).tabIndex = tabIndex;\r\n    }\r\n  }\r\n\r\n  setEditorReadOnly(editor, value) {\r\n    if (value) {\r\n      editor.disable();\r\n    } else {\r\n      editor.enable();\r\n    }\r\n  }\r\n\r\n  /*\r\n  Returns a weaker, unprivileged proxy object that only exposes read-only\r\n  accessors found on the editor instance, without any state-modifying methods.\r\n  */\r\n  makeUnprivilegedEditor(editor) {\r\n    const e = editor;\r\n    return {\r\n      getHTML:      () => e.root.innerHTML,\r\n      getLength:    e.getLength.bind(e),\r\n      getText:      e.getText.bind(e),\r\n      getContents:  e.getContents.bind(e),\r\n      getSelection: e.getSelection.bind(e),\r\n      getBounds:    e.getBounds.bind(e),\r\n      setSelection: e.setSelection.bind(e) // Trying to add the ability to select from outside\r\n    };\r\n  }\r\n\r\n  getEditingArea() {\r\n    if (!this.editingArea) {\r\n      throw new Error('Instantiating on missing editing area');\r\n    }\r\n    const element = ReactDOM.findDOMNode(this.editingArea);\r\n    if (!element) {\r\n      throw new Error('Cannot find element for editing area');\r\n    }\r\n    if (element.nodeType === 3) {\r\n      throw new Error('Editing area cannot be a text node');\r\n    }\r\n    return element;\r\n  }\r\n\r\n  /*\r\n  Renders an editor area, unless it has been provided one to clone.\r\n  */\r\n  renderEditingArea() {\r\n    const {children, preserveWhitespace} = this.props;\r\n    const {generation} = this.state;\r\n\r\n    const properties = {\r\n      key: generation,\r\n      ref: (instance) => {\r\n        this.editingArea = instance\r\n      },\r\n    };\r\n\r\n    if (React.Children.count(children)) {\r\n      return React.cloneElement(\r\n        React.Children.only(children),\r\n        properties\r\n      );\r\n    }\r\n\r\n    return preserveWhitespace ?\r\n      <pre {...properties}/> :\r\n      <div {...properties}/>;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        ref={this.refInput}\r\n        id={this.props.id}\r\n        style={this.props.style}\r\n        key={this.state.generation}\r\n        className={`quill ${this.props.className ?? ''}`}\r\n        onKeyPress={this.props.onKeyPress}\r\n        onKeyDown={this.props.onKeyDown}\r\n        onKeyUp={this.props.onKeyUp}\r\n        onBlur={_ => {\r\n          if (this.props.onBlur2 !== undefined)\r\n            this.props.onBlur2();\r\n        }}\r\n      >\r\n        {this.renderEditingArea()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onEditorChange = (\r\n    eventName,\r\n    rangeOrDelta,\r\n    oldRangeOrDelta,\r\n    source,\r\n  ) => {\r\n    if (eventName === 'text-change') {\r\n      this.onEditorChangeText(\r\n        this.editor.root.innerHTML,\r\n        rangeOrDelta,\r\n        source,\r\n        this.unprivilegedEditor\r\n      );\r\n    } else if (eventName === 'selection-change') {\r\n      this.onEditorChangeSelection(\r\n        rangeOrDelta,\r\n        source,\r\n        this.unprivilegedEditor\r\n      );\r\n    }\r\n  };\r\n\r\n  onEditorChangeText(\r\n    value,\r\n    delta,\r\n    source,\r\n    editor,\r\n  ) {\r\n    if (!this.editor) return;\r\n\r\n    // We keep storing the same type of value as what the user gives us,\r\n    // so that value comparisons will be more stable and predictable.\r\n    const nextContents = this.isDelta(this.value)\r\n      ? editor.getContents()\r\n      : editor.getHTML();\r\n\r\n    if (nextContents !== this.getEditorContents()) {\r\n      // Taint this `delta` object, so we can recognize whether the user\r\n      // is trying to send it back as `value`, preventing a likely loop.\r\n      this.lastDeltaChangeSet = delta;\r\n\r\n      this.value = nextContents;\r\n      this.props.onChange(value, delta, source, editor);\r\n    }\r\n  }\r\n\r\n  onEditorChangeSelection(\r\n    nextSelection,\r\n    source,\r\n    editor,\r\n  ) {\r\n    if (!this.editor) return;\r\n    const currentSelection = this.getEditorSelection();\r\n    const hasGainedFocus = !currentSelection && nextSelection;\r\n    const hasLostFocus = currentSelection && !nextSelection;\r\n\r\n    if (isEqual(nextSelection, currentSelection)) return;\r\n\r\n    this.selection = nextSelection;\r\n    if (this.props.onChangeSelection !== undefined)\r\n      this.props.onChangeSelection(nextSelection, source, editor);\r\n\r\n    if (hasGainedFocus) {\r\n      if (this.props.onFocus !== undefined)\r\n        this.props.onFocus(nextSelection, source, editor);\r\n    } else if (hasLostFocus) {\r\n      if (this.props.onBlur !== undefined)\r\n        this.props.onBlur(currentSelection, source, editor);\r\n    }\r\n  }\r\n\r\n  focus() {\r\n    if (!this.editor) return;\r\n    this.editor.focus();\r\n  }\r\n\r\n  blur() {\r\n    if (!this.editor) return;\r\n    this.selection = null;\r\n    this.editor.blur();\r\n  }\r\n}\r\n\r\n/*\r\nSmall helper to execute a function in the next micro-tick.\r\n*/\r\nfunction postpone(fn) {\r\n  Promise.resolve().then(fn);\r\n}\r\n\r\n// Compatibility Export to avoid `require(...).default` on CommonJS.\r\n// See: https://github.com/Microsoft/TypeScript/issues/2719\r\nexport default ReactQuill;\r\n","// import React, { createRef } from 'react';\r\n// import PropTypes from 'prop-types';\r\n// // import getCaretCoordinates from './textarea-caret';\r\n// // import getCaretCoordinates from 'textarea-caret';\r\n// import getInputSelection, { setCaretPosition } from 'get-input-selection';\r\nimport '../../assets/css/AutocompleteTextField.css';\r\n// import {\r\n//   Button\r\n//   // FormControl,\r\n//   // OutlinedInput,\r\n//   // InputLabel,\r\n//   // FormHelperText\r\n// } from \"@material-ui/core\";\r\n// import Quill, {\r\n//   // QuillOptionsStatic,\r\n//   // DeltaStatic,\r\n//   RangeStatic,\r\n//   // BoundsStatic,\r\n//   // StringMap,\r\n//   // Sources,\r\n// } from 'quill';\r\n// import ContentEditable from \"react-contenteditable\";\r\n// import ContentEditable from \"./ContentEditable\";\r\nimport sanitizeHtml from \"sanitize-html\";\r\n// import \"../../assets/css/editable-content.css\";\r\n\r\n\r\nimport React, { createRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\n// import ReactQuill from 'react-quill';\r\nimport ReactQuill from './ReactQuill';\r\n  \r\nconst modules = {\r\n  toolbar: [\r\n    [\r\n      // { 'header': [1, 2, false] }\r\n    ],\r\n    [\r\n      'bold', 'italic', 'underline','strike', 'blockquote'\r\n    ],\r\n    [\r\n      {'list': 'ordered'}, {'list': 'bullet'}, {'indent': '-1'}, {'indent': '+1'}\r\n    ],\r\n    [\r\n      'link', \r\n      'image'\r\n    ],\r\n    [\r\n      'clean'\r\n    ]\r\n  ],\r\n};\r\n\r\nconst formats = [\r\n  'header',\r\n  'bold', \r\n  'italic', 'underline', 'strike', 'blockquote',\r\n  'list', 'bullet', 'indent',\r\n  'link', \r\n  'image'\r\n];\r\n\r\nconst KEY_UP = 38;\r\nconst KEY_DOWN = 40;\r\nconst KEY_RETURN = 13;\r\nconst KEY_ENTER = 14;\r\nconst KEY_ESCAPE = 27;\r\nconst KEY_TAB = 9;\r\n\r\nconst propTypes = {\r\n  Component: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.func,\r\n  ]),\r\n  defaultValue: PropTypes.string,\r\n  disabled: PropTypes.bool,\r\n  maxOptions: PropTypes.number,\r\n  onBlur: PropTypes.func,\r\n  onChange: PropTypes.func,\r\n  onKeyDown: PropTypes.func,\r\n  onRequestOptions: PropTypes.func,\r\n  // options: PropTypes.arrayOf(PropTypes.Object),\r\n  regex: PropTypes.string,\r\n  matchAny: PropTypes.bool,\r\n  minChars: PropTypes.number,\r\n  requestOnlyIfNoOptions: PropTypes.bool,\r\n  spaceRemovers: PropTypes.arrayOf(PropTypes.string),\r\n  spacer: PropTypes.string,\r\n  trigger: PropTypes.string,\r\n  value: PropTypes.string,\r\n  offsetX: PropTypes.number,\r\n  offsetY: PropTypes.number,\r\n};\r\n\r\nconst defaultProps = {\r\n  Component: 'textarea',\r\n  defaultValue: '',\r\n  disabled: false,\r\n  maxOptions: 6,\r\n  onBlur: () => { },\r\n  onChange: () => { },\r\n  onKeyDown: () => { },\r\n  onRequestOptions: () => { },\r\n  options: [],\r\n  regex: '^[A-Za-z0-9\\\\-_]+$',\r\n  matchAny: false,\r\n  minChars: 0,\r\n  requestOnlyIfNoOptions: true,\r\n  spaceRemovers: [',', '.', '!', '?'],\r\n  spacer: ' ',\r\n  trigger: '@',\r\n  offsetX: 0,\r\n  offsetY: -10,\r\n  value: null,\r\n};\r\n\r\nclass AutocompleteTextField extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      helperVisible: false,\r\n      left: 0,\r\n      matchLength: 0,\r\n      matchStart: 0,\r\n      options: [],\r\n      selection: 0,\r\n      top: 0,\r\n      value: props.value\r\n    };\r\n\r\n    this.recentValue = props.defaultValue;\r\n    this.refInput = createRef();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { options } = this.props;\r\n    const { caret } = this.state;\r\n\r\n    if (options.length !== prevProps.options.length) {\r\n      this.updateHelper(this.recentValue, caret, options);\r\n    }\r\n  }\r\n\r\n  getMatch(str, caret, providedOptions) {\r\n    const { trigger, matchAny, regex } = this.props;\r\n    const re = new RegExp(regex);\r\n    const triggerLength = trigger.length;\r\n    const triggerMatch = trigger.match(re);\r\n\r\n    let last = str[caret - 1];\r\n    // The Quill control I'm using puts things inside of a <p>.  \r\n    // I need to back the caret up to be before it.\r\n    while (last === \">\") {\r\n      while (last !== \"<\") {\r\n        caret--;\r\n        last = str[caret - 1];\r\n      }\r\n      caret--;\r\n      last = str[caret - 1];\r\n    }\r\n    // string change event happens before keydown event with Quill control, \r\n    // which is preventing tabs from causing selection.\r\n    // This should fix it.\r\n    if (last === \"\t\") {\r\n      caret--;\r\n      last = str[caret - 1];\r\n    }\r\n    for (let i = caret - 1; i >= 0; --i) {\r\n      const substr = str.substring(i, caret);\r\n      const match = substr.match(re);\r\n      let matchStart = -1;\r\n\r\n      if (triggerLength > 0) {\r\n        const triggerIdx = triggerMatch ? i : i - triggerLength + 1;\r\n\r\n        if (triggerIdx < 0) { // out of input\r\n          return null;\r\n        }\r\n\r\n        if (this.isTrigger(str, triggerIdx)) {\r\n          matchStart = triggerIdx + triggerLength;\r\n        }\r\n\r\n        if (!match && matchStart < 0) {\r\n          return null;\r\n        }\r\n      } else {\r\n        if (match && i > 0) { // find first non-matching character or begin of input\r\n          continue;\r\n        }\r\n        matchStart = i === 0 && match ? 0 : i + 1;\r\n\r\n        if (caret - matchStart === 0) { // matched slug is empty\r\n          return null;\r\n        }\r\n      }\r\n\r\n      if (matchStart >= 0) {\r\n        const matchedSlug = str.substring(matchStart, caret);\r\n        const options = providedOptions.filter((slug) => {\r\n          // TODO: Change this to work with object\r\n          const idx = slug.Display.toLowerCase().indexOf(matchedSlug.toLowerCase());\r\n          return idx !== -1 && (matchAny || idx === 0);\r\n        });\r\n\r\n        const matchLength = matchedSlug.length;\r\n\r\n        return { matchStart, matchLength, options };\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  isTrigger(str, i) {\r\n    const { trigger } = this.props;\r\n\r\n    if (!trigger || !trigger.length) {\r\n      return true;\r\n    }\r\n\r\n    if (str.substr(i, trigger.length) === trigger) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  handleChange(e) {\r\n    const {\r\n      onChange,\r\n      options,\r\n      spaceRemovers,\r\n      spacer,\r\n      value,\r\n    } = this.props;\r\n    const old = this.recentValue;\r\n    let str = e.target === undefined || e.target.value === undefined ? this.state.value : e.target.value;\r\n\r\n    let end = -1;\r\n    if (old.length === 0) {\r\n      end = str.length - 1;\r\n    } else if (str.length === 0) {\r\n      end = 0;\r\n    } else {\r\n      let old2 = old.trim();\r\n      let str2 = str.trim();\r\n      if (old2.substring(old2.length - 6) === \"&nbsp;\") {\r\n        old2 = old2.substring(0, old2.length - 6);\r\n      }\r\n      if (str2.substring(str2.length - 6) === \"&nbsp;\") {\r\n        str2 = str2.substring(0, str2.length - 6);\r\n      }\r\n      if (old2 !== str2) {\r\n        // let inSpan = false;\r\n            \r\n        for (let i = 1; i <= Math.min(str2.length, old2.length); i++) {\r\n          if (str2.length < i || old2.length < i || str2[str2.length - i] !== old2[old2.length - i]) {\r\n            end = str2.length - i;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    const caret = end + 1;\r\n\r\n    if (!str.length) {\r\n      this.setState({ helperVisible: false });\r\n    }\r\n\r\n    this.recentValue = str;\r\n\r\n    this.setState({ caret, value: e });\r\n\r\n    if (!str.length || !caret) {\r\n      return onChange(e);\r\n    }\r\n\r\n    // '@wonderjenny ,|' -> '@wonderjenny, |'\r\n    if (this.enableSpaceRemovers && spaceRemovers.length && str.length > 2 && spacer.length) {\r\n      for (let i = 0; i < Math.max(old.length, str.length); ++i) {\r\n        if (old[i] !== str[i]) {\r\n          if (\r\n            i >= 2\r\n            && str[i - 1] === spacer\r\n            && spaceRemovers.indexOf(str[i - 2]) === -1\r\n            && spaceRemovers.indexOf(str[i]) !== -1\r\n            && this.getMatch(str.substring(0, i - 2), caret - 3, options) // TODO: Change this to work with objects\r\n          ) {\r\n            const newValue = (`${str.slice(0, i - 1)}${str.slice(i, i + 1)}${str.slice(i - 1, i)}${str.slice(i + 1)}`);\r\n\r\n            this.refInput.current.value = newValue;\r\n\r\n            if (!value) {\r\n              this.setState({ value: newValue });\r\n            }\r\n\r\n            return onChange(newValue);\r\n          }\r\n\r\n          break;\r\n        }\r\n      }\r\n\r\n      this.enableSpaceRemovers = false;\r\n    }\r\n\r\n    this.updateHelper(str, caret, options);\r\n\r\n    if (!value) {\r\n      this.setState({ value: e });\r\n    }\r\n    return onChange(e);\r\n  }\r\n\r\n  handleKeyDown = (event) => {\r\n    const { helperVisible, options, selection } = this.state;\r\n    const { onKeyDown } = this.props;\r\n\r\n    if (helperVisible) {\r\n      switch (event.keyCode) {\r\n        case KEY_ESCAPE:\r\n          event.preventDefault();\r\n          this.resetHelper();\r\n          break;\r\n        case KEY_UP:\r\n          event.preventDefault();\r\n          this.setState({ selection: ((options.length + selection) - 1) % options.length });\r\n          break;\r\n        case KEY_DOWN:\r\n          event.preventDefault();\r\n          this.setState({ selection: (selection + 1) % options.length });\r\n          break;\r\n        case KEY_ENTER:\r\n        case KEY_RETURN:\r\n        case KEY_TAB:\r\n          event.preventDefault();\r\n          this.handleSelection(selection);\r\n          break;\r\n        default:\r\n          onKeyDown(event);\r\n          break;\r\n      }\r\n    } else {\r\n      onKeyDown(event);\r\n    }\r\n  }\r\n\r\n  handleSelection(idx) {\r\n    const { matchStart, matchLength, options } = this.state;\r\n    // const { spacer } = this.props;\r\n\r\n    // const slug = `<span id='myid' style=\"color: blue\">${options[idx]}</span>`;\r\n    let slug = `<a href='/${options[idx].suggestionType}/details/${options[idx]._id}' rel=\"noopener noreferrer\" target=\"_blank\">${options[idx].Display}</a>`;\r\n    const value = this.recentValue;\r\n    const part1 = value.substring(0, matchStart - 1); // - 1 to remove the @\r\n    const part2 = value.substring(matchStart + matchLength);\r\n    \r\n    if (part2 === \"\") {\r\n      slug += \"&nbsp;\";\r\n    }\r\n    this.setState({ value: `${part1}${slug}${part2}` });\r\n    let caret = 0;\r\n    let searched = 0;\r\n    let part1Sub = part1;\r\n    while (searched < part1.length) {\r\n      // I'll need some way in the future to make it so <> can be used in these.\r\n      // Probably something like catching them and putting an escape character before them.\r\n      // Of course then it will also have to do escape characters for escape characters as well.\r\n      // Actually, it looks like I don't.  It's automatically converting < and > to &lt; and &gt;.\r\n\r\n      const index = part1Sub.indexOf(\"<\");\r\n      if (index > -1) {\r\n        if (index > 0) \r\n          caret += index;\r\n        searched += index; // everything before the tag;\r\n        part1Sub = part1Sub.substring(index);\r\n        let openerEndIndex = part1Sub.indexOf(\">\");\r\n        if (openerEndIndex === -1) {\r\n          // Probably an error because I haven't done the escape character thing yet.\r\n          throw Error(\"What the Pizza Sauce\");\r\n        } else {\r\n          searched += openerEndIndex + 1;\r\n          part1Sub = part1Sub.substring(openerEndIndex + 1);\r\n        }\r\n      } else if (part1Sub.length > 0) {\r\n        searched += part1Sub.length;\r\n        caret += part1Sub.length;\r\n        part1Sub = \"\";\r\n      }\r\n      if (part1Sub.length === 0 && searched < part1.length) {\r\n        throw Error(\"OMGOSH\");\r\n      }\r\n    }\r\n    caret += options[idx].Display.length;\r\n    this.updateCaretPosition(caret);\r\n  }\r\n\r\n  updateCaretPosition(index) {\r\n    setTimeout(() => {\r\n      let input = this.refInput.current;\r\n      \r\n      const editor = input.getEditor();\r\n      const unprivilegedEditor = input.makeUnprivilegedEditor(editor);\r\n      \r\n      const length = unprivilegedEditor.getLength();\r\n      // Caret at the end\r\n      // const range = {\r\n      //   index: length - 1,\r\n      //   length: 0\r\n      // };\r\n      const range = {\r\n        index: Math.max(0, Math.min(index, length-1)),\r\n        length: 0\r\n      };\r\n      unprivilegedEditor.setSelection(range);\r\n    }, 500);\r\n  }\r\n\r\n  setValue = (event) => {\r\n    this.setState({ value: event }, _ => { \r\n      this.handleChange(event);\r\n    });\r\n  }\r\n\r\n  updateHelper(str, caret, options) {\r\n    const slug = this.getMatch(str, caret, options);\r\n    if (slug) {\r\n      let input = this.refInput.current;\r\n      let element = input.refInput.current;\r\n      const top = element.clientHeight;\r\n      const left = 0;\r\n\r\n      const { minChars, onRequestOptions, requestOnlyIfNoOptions } = this.props;\r\n\r\n      if (\r\n        slug.matchLength >= minChars\r\n        && (\r\n          slug.options.length > 1\r\n          || (\r\n            slug.options.length === 1\r\n            && slug.options[0].Display.length !== slug.matchLength\r\n          )\r\n        )\r\n      ) {\r\n        this.setState({\r\n          helperVisible: true,\r\n          top,\r\n          left,\r\n          ...slug,\r\n        });\r\n      } else {\r\n        if (!requestOnlyIfNoOptions || !slug.options.length) {\r\n          onRequestOptions(str.substr(slug.matchStart, slug.matchLength));\r\n        }\r\n\r\n        this.resetHelper();\r\n      }\r\n    } else {\r\n      this.resetHelper();\r\n    }\r\n  }\r\n\r\n  resetHelper() {\r\n    this.setState({ helperVisible: false, selection: 0 });\r\n  }\r\n\r\n  renderAutocompleteList() {\r\n    const {\r\n      helperVisible,\r\n      left,\r\n      matchStart,\r\n      matchLength,\r\n      options,\r\n      selection,\r\n      top,\r\n      value,\r\n    } = this.state;\r\n\r\n    if (!helperVisible) {\r\n      return null;\r\n    }\r\n\r\n    const { maxOptions, offsetX, offsetY } = this.props;\r\n\r\n    if (options.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    if (selection >= options.length) {\r\n      this.setState({ selection: 0 });\r\n\r\n      return null;\r\n    }\r\n\r\n    const optionNumber = maxOptions === 0 ? options.length : maxOptions;\r\n\r\n    const helperOptions = options.slice(0, optionNumber).map((val, idx) => {\r\n      const highlightStart = val.Display.toLowerCase().indexOf(value.substr(matchStart, matchLength).toLowerCase());\r\n\r\n      return (\r\n        <li\r\n          className={idx === selection ? 'active' : null}\r\n          key={val.Display}\r\n          onClick={() => { this.handleSelection(idx); }}\r\n          onMouseEnter={() => { this.setState({ selection: idx }); }}\r\n        >\r\n          {val.Display.slice(0, highlightStart)}\r\n          <strong>{val.Display.substr(highlightStart, matchLength)}</strong>\r\n          {val.Display.slice(highlightStart + matchLength)}\r\n        </li>\r\n      );\r\n    });\r\n\r\n    return (\r\n      <ul className=\"react-autocomplete-input\" style={{ left: left + offsetX, top: top + offsetY }}>\r\n        {helperOptions}\r\n      </ul>\r\n    );\r\n  }\r\n\r\n  sanitizeConf = {\r\n    allowedTags: [\"b\", \"i\", \"em\", \"strong\", \"a\", \"p\", \"h1\"],\r\n    allowedAttributes: { a: [\"href\"] }\r\n  };\r\n\r\n  sanitize = (onBlur) => {\r\n    this.setState({ html: sanitizeHtml(this.state.html, this.sanitizeConf) }, onBlur);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div style={{position: \"relative\"}}>\r\n        <ReactQuill \r\n          theme=\"snow\"\r\n          modules={modules}\r\n          formats={formats} \r\n          value={this.state.value} \r\n          onChange={ e => {\r\n              this.setValue(e);\r\n            }\r\n          }\r\n          onBlur={_ => {\r\n            if (this.props.onBlur !== undefined) {\r\n              this.props.onBlur(this.state.value.trim());\r\n            }\r\n          }}\r\n          onBlur2={_ => {\r\n            if (this.props.onBlur !== undefined) {\r\n              this.props.onBlur(this.state.value.trim());\r\n            }\r\n          }}\r\n          onKeyDown={this.handleKeyDown}\r\n          ref={this.refInput}\r\n        />\r\n        {this.renderAutocompleteList()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nAutocompleteTextField.propTypes = propTypes;\r\nAutocompleteTextField.defaultProps = defaultProps;\r\n\r\nexport default AutocompleteTextField;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport {\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  Grid,\r\n  // Box\r\n} from \"@material-ui/core\";\r\n// import TextInput from 'react-autocomplete-input';\r\nimport AutocompleteTextField from \"./AutocompleteTextField\";\r\n// import AutocompleteTextField from 'react-autocomplete-input';\r\n// import 'react-autocomplete-input/dist/bundle.css';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    // selectedPage: state.app.selectedPage,\r\n    // selectedType: state.app.selectedType,\r\n    // selectedWorld: state.app.selectedWorld,\r\n    // selectedWorldID: state.app.selectedWorldID,\r\n    // types: state.app.types,\r\n    // things: state.app.things,\r\n    // user: state.app.user,\r\n    // attributesByID: state.app.attributesByID,\r\n    // attributesByName: state.app.attributesByName,\r\n    // fromLogin: state.app.fromLogin,\r\n    // typeSuggestions: state.app.typeSuggestions,\r\n    // thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    // addType: type => dispatch(addType(type)),\r\n    // updateType: type => dispatch(updateType(type)),\r\n    // addAttributes: attrs => dispatch(addAttributes(attrs)),\r\n    // setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    // setTypes: types => dispatch(setTypes(types)),\r\n    // setThings: things => dispatch(setThings(things)),\r\n    // notFromLogin: () => dispatch(notFromLogin({})),\r\n    // addThing: thing => dispatch(addThing(thing)),\r\n    // toggleLogin: () => dispatch(toggleLogin({})),\r\n    // logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      // value: \"<a href=\\\"type_5e75999efb4bae172d3fa0ef\\\" rel=\\\"noopener noreferrer\\\" target=\\\"_blank\\\">pizza</a> <span id='type_5e75999efb4bae172d3fa0ef' style=\\\"color: blue\\\">y/Component</span> <em>lasagna</em> \"\r\n      value: props.Value\r\n    };\r\n  }\r\n  // 0123456789112345678921234567893123456789412345678951234567896123456789712345678981234567899123456789\r\n  // pizza <span id='type_5e75999efb4bae172d3fa0ef' style=\"color: blue\">y/Component</span> lasagna \r\n\r\n  getValue = () => {\r\n    return this.state.value;\r\n  }\r\n  \r\n  render() {\r\n    // const [value, changeValue] = useState(props.Value === undefined || props.Value === null ? \"\" : props.Value);\r\n    const displayName = this.props.displayName === undefined ? this.props.fieldName : this.props.displayName;\r\n    \r\n    if (this.props.options !== undefined) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <InputLabel htmlFor={`text_field_${this.props.fieldName}`}>{displayName}</InputLabel>\r\n          </Grid>\r\n          <Grid item>\r\n            <AutocompleteTextField\r\n              id={`text_field_${this.props.fieldName}`}\r\n              name={`text_field_${this.props.fieldName}`}\r\n              type=\"text\"\r\n              autoComplete=\"Off\"\r\n              // multiline\r\n              // error={this.props.message !== undefined && this.props.message !== \"\"}\r\n              // multiline=\"multiline\"\r\n              error={this.props.message}\r\n              value={this.state.value}\r\n              onChange={e => {\r\n                this.setState({ value: e });\r\n                if (this.props.onChange !== undefined) {\r\n                  this.props.onChange(e);\r\n                }\r\n                // if (this.props.onBlur !== undefined) {\r\n                //   this.props.onBlur(e);\r\n                // }\r\n              }}\r\n              onKeyDown={e => {\r\n                if (this.props.onKeyPress !== undefined) {\r\n                  this.props.onKeyPress(e);\r\n                }\r\n              }}\r\n              onBlur={e => {\r\n                console.log(e);\r\n                if (this.props.onBlur !== undefined) {\r\n                  this.props.onBlur(this.state.value);\r\n                }\r\n              }}\r\n              // labelWidth={this.props.labelWidth}\r\n              // fullWidth\r\n              options={this.props.options}\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    } else {\r\n      return (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor={`text_field_${this.props.fieldName}`}>{displayName}</InputLabel>\r\n          { this.props.multiline !== undefined && this.props.multiline ?\r\n            <OutlinedInput\r\n              id={`text_field_${this.props.fieldName}`}\r\n              name={`text_field_${this.props.fieldName}`}\r\n              type=\"text\"\r\n              autoComplete=\"Off\"\r\n              multiline\r\n              error={this.props.message !== undefined && this.props.message !== \"\"}\r\n              value={this.state.value}\r\n              onChange={e => {\r\n                this.setState({ value: e.target.value });\r\n              }}\r\n              onBlur={e => {\r\n                this.props.onBlur(this.state.value.trim());\r\n              }}\r\n              labelWidth={this.props.labelWidth}\r\n              fullWidth\r\n            />\r\n          :\r\n            <OutlinedInput\r\n              id={`text_field_${this.props.fieldName}`}\r\n              name={`text_field_${this.props.fieldName}`}\r\n              type=\"text\"\r\n              autoComplete=\"Off\"\r\n              error={this.props.message !== undefined && this.props.message !== \"\"}\r\n              value={this.state.value}\r\n              onChange={e => {\r\n                this.setState({ value: e.target.value });\r\n              }}\r\n              onBlur={e => {\r\n                this.props.onBlur(this.state.value.trim());\r\n              }}\r\n              labelWidth={this.props.labelWidth}\r\n              fullWidth\r\n            />\r\n          }\r\n          <FormHelperText>\r\n            {this.props.message}\r\n          </FormHelperText>\r\n        </FormControl>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TextBox = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default TextBox;","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport {\r\n  // FormControl,\r\n  // OutlinedInput,\r\n  // InputLabel,\r\n  Grid,\r\n  // Button,\r\n  Typography,\r\n  Card, CardContent, CardActions,\r\n  IconButton, \r\n  // Tooltip\r\n} from \"@material-ui/core\";\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport ReplyIcon from '@material-ui/icons/Reply';\r\nimport TextBox from \"./TextBox\";\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    // maxWidth: 345,\r\n  },\r\n});\r\n\r\nconst vote = (comment, theVote, props) => {\r\n  if (props.user === null) {\r\n    return;\r\n  }\r\n  props.changeWaiting(true);\r\n  if (comment.votes[props.user._id] !== undefined && comment.votes[props.user._id] !== theVote) {\r\n    delete comment.votes[props.user._id];\r\n  } else {\r\n    comment.votes[props.user._id] = theVote;\r\n  }\r\n\r\n  const updatedComment = {...props.rootComment};\r\n  delete updatedComment.user;\r\n  // updatedComment.replies.forEach(r => {\r\n  //   cleanReply(r);\r\n  // });\r\n  updatedComment.replies = [];\r\n  props.rootComment.replies.forEach(r => {\r\n    updatedComment.replies.push(cleanReply(r));\r\n  });\r\n  // Calls API\r\n  props.api\r\n    .updateComment(updatedComment)\r\n    .then(res => {\r\n      if (res.error === undefined) {\r\n        props.api.getComments(props.world._id, props.objectType, props.object._id).then(res => {\r\n          res.comments.forEach(comment => {\r\n            prepComment(comment, props);\r\n          });\r\n          props.changeComments(res.comments);\r\n          props.changeWaiting(false);\r\n        });\r\n      } else {\r\n        console.log(res.error);\r\n      }\r\n      props.changeWaiting(false);\r\n    })\r\n    .catch(err => console.log(err));\r\n};\r\n\r\n/**\r\n * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p><p><br></p>\r\n * gets translated to \r\n * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p>\r\n */\r\nconst cleanWYSIWYG = (str) => {\r\n  if (str.endsWith(\"<p><br></p>\")) {\r\n    str = str.substring(0, str.length - 11);\r\n  }\r\n  return str;\r\n}\r\n\r\nconst reply = (text, props, changeReplying, changeValue) => {\r\n  if (props.user === null) {\r\n    return;\r\n  }\r\n  props.changeWaiting(true);\r\n\r\n  const rootComment = {...props.rootComment};\r\n  // Need to search for the right comment\r\n  // Actually in theory, adding it to props.comment should put it in the right place\r\n  const comment = props.comment;\r\n  // Then add the reply\r\n  comment.replies.push({\r\n    time: new Date(),\r\n    user: props.user,\r\n    userID: props.user._id,\r\n    text: cleanWYSIWYG(text),\r\n    votes: {},\r\n    voteSum: 0,\r\n    replies: []\r\n  });\r\n  changeValue(\"\");\r\n  changeReplying(false);\r\n  props.changeWaiting(true);\r\n\r\n  const updatedComment = {...rootComment};\r\n  delete updatedComment.user;\r\n  updatedComment.replies = [];\r\n  rootComment.replies.forEach(r => {\r\n    updatedComment.replies.push(cleanReply(r));\r\n  });\r\n  // updatedComment.replies.forEach(r => {\r\n  //   cleanReply(r);\r\n  // });\r\n  \r\n  // Calls API\r\n  props.api\r\n    .updateComment(updatedComment)\r\n    .then(res => {\r\n      if (res.error === undefined) {\r\n        props.api.getComments(props.world._id, props.objectType, props.object._id).then(res => {\r\n          res.comments.forEach(comment => {\r\n            prepComment(comment, props);\r\n          });\r\n          props.changeComments(res.comments);\r\n          props.changeWaiting(false);\r\n        });\r\n      } else {\r\n        console.log(res.error);\r\n      }\r\n      props.changeWaiting(false);\r\n    })\r\n    .catch(err => console.log(err));\r\n};\r\n\r\nconst cleanReply = (reply) => {\r\n  const newReply = {...reply};\r\n  delete newReply.user;\r\n  delete newReply.voteSum;\r\n  newReply.replies = [];\r\n  for (let i = 0; i < reply.replies.length; i++) {\r\n    newReply.replies.push(cleanReply(reply.replies[i]));\r\n  }\r\n  return newReply;\r\n}\r\n\r\nconst prepComment = (comment, props) => {\r\n  comment.user = props.allUsers.filter(u => u._id === comment.userID)[0];\r\n  if (comment.user === undefined || comment.user === null) {\r\n    comment.user = {\r\n      _id: comment.userID,\r\n      username: \"Unknown\"\r\n    }\r\n  }\r\n  comment.time = new Date(comment.time);\r\n  comment.voteSum = Object.values(comment.votes).reduce((total, vote) => total + vote, 0);\r\n  comment.replies.forEach(r => {\r\n    prepComment(r, props);\r\n  });\r\n}\r\n\r\nexport default function CommentControl(props) {\r\n  const classes = useStyles();\r\n\r\n  const [value, changeValue] = useState(\"\");\r\n  // const [waiting, changeWaiting] = useState(false);\r\n  const [replying, changeReplying] = useState(false);\r\n  \r\n  return (\r\n    <Grid container spacing={0} direction=\"column\">\r\n      <Grid item>\r\n        <Card className={classes.root}>\r\n          <CardContent>\r\n            <Typography variant=\"body2\" color=\"textSecondary\">\r\n              {props.comment.user.username}: {props.comment.time.toLocaleDateString()} {props.comment.time.toLocaleTimeString()}\r\n            </Typography>\r\n            <Typography component=\"p\">\r\n              <span  dangerouslySetInnerHTML={{__html: props.comment.text}} />\r\n              {/* {props.comment.text} */}\r\n            </Typography>\r\n          </CardContent>\r\n          <CardActions disableSpacing>\r\n            { props.user === null || props.comment.votes[props.user._id] !== 1 ?\r\n              <IconButton \r\n                aria-label=\"upvote comment\"\r\n                onClick={_ => {\r\n                  if (props.user !== null && (props.world.Owner === props.user._id || (props.world.Collaborators !== undefined && props.world.Collaborators.filter(c=> c.userID === props.user._id && c.type === \"collab\").length === 0))) {\r\n                    vote(props.comment, 1, props);\r\n                  }\r\n                }}>\r\n                <ArrowUpwardIcon />\r\n              </IconButton>\r\n            :\r\n              <IconButton \r\n                aria-label=\"upvote comment\"\r\n                color=\"primary\"\r\n                // style={{ color: \"green\" }}\r\n                onClick={_ => {\r\n                  // vote(comment, 1, props);\r\n                }}>\r\n                <ArrowUpwardIcon />\r\n              </IconButton>\r\n            }\r\n            <span style={{ fontWeight: \"bold\", color: props.user === null || props.comment.votes[props.user._id] === undefined ? \"black\" : props.comment.votes[props.user._id] === 1 ? \"blue\" : props.comment.votes[props.user._id] === -1 ? \"red\" : \"black\" }}>{props.comment.voteSum}</span>\r\n            { props.user === null || props.comment.votes[props.user._id] !== -1 ?\r\n              <IconButton \r\n                aria-label=\"downvote comment\"\r\n                onClick={_ => {\r\n                  if (props.user !== null && (props.world.Owner === props.user._id || (props.world.Collaborators !== undefined && props.world.Collaborators.filter(c=> c.userID === props.user._id && c.type === \"collab\").length === 0))) {\r\n                    vote(props.comment, -1, props);\r\n                  }\r\n                }}>\r\n                <ArrowDownwardIcon />\r\n              </IconButton>\r\n            :\r\n              <IconButton \r\n                aria-label=\"downvote comment\"\r\n                color=\"secondary\"\r\n                onClick={_ => {\r\n                  // vote(comment, -1, props);\r\n                }}>\r\n                <ArrowDownwardIcon />\r\n              </IconButton>\r\n            }\r\n            <IconButton style={{ marginLeft: \"auto\" }}\r\n              onClick={_ => {\r\n                if (props.user !== null && (props.world.Owner === props.user._id || (props.world.Collaborators !== undefined && props.world.Collaborators.filter(c=> c.userID === props.user._id && c.type === \"collab\").length === 0))) {\r\n                  // Open a reply box under the card\r\n                  changeReplying(!replying);\r\n                }\r\n              }}\r\n              aria-label=\"reply\">\r\n              <ReplyIcon />\r\n            </IconButton>\r\n          </CardActions>\r\n        </Card>\r\n      </Grid>\r\n\r\n      { props.comment.replies.length > 0 &&\r\n        <Grid item container spacing={0} direction=\"row\">\r\n          <Grid item xs={2}>&nbsp;</Grid>\r\n          <Grid item xs={10} container spacing={0} direction=\"column\">\r\n            {props.comment.replies.map((reply, key) => {\r\n              return (\r\n                <Grid item key={key} style={{ marginTop: \"4px\" }}>\r\n                  <CommentControl \r\n                    comment={reply} \r\n                    user={props.user} \r\n                    world={props.world}\r\n                    object={props.object}\r\n                    objectType={props.objectType}\r\n                    api={props.api}\r\n                    rootComment={props.rootComment}\r\n                    allUsers={props.allUsers} \r\n                    changeComments={newComments => {\r\n                      props.changeComments(newComments);\r\n                    }} \r\n                    changeWaiting={newWaiting => {\r\n                      props.changeWaiting(newWaiting);\r\n                    }}\r\n                    suggestions={props.suggestions}\r\n                  />\r\n                </Grid>\r\n              );\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      }\r\n      { replying &&\r\n        <Grid item>\r\n          {/* <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`text_field_reply`}>New Reply</InputLabel>\r\n            <OutlinedInput\r\n              id={`text_field_reply`}\r\n              name={`text_field_reply`}\r\n              type=\"text\"\r\n              autoComplete=\"Off\"\r\n              multiline\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onKeyPress={e => {\r\n                if (e.key === 'Enter' && !e.shiftKey) {\r\n                  reply(value,  \r\n                    props, changeReplying, \r\n                    changeValue);\r\n                }\r\n              }}\r\n              labelWidth={80}\r\n              fullWidth\r\n            />\r\n          </FormControl> */}\r\n          <TextBox \r\n            Value={value} \r\n            fieldName=\"New Reply\" \r\n            multiline={true}\r\n            onChange={e => {\r\n              changeValue(e);\r\n              // changeValue(e.target.value);\r\n            }}\r\n            // onBlur={reply => {\r\n            //   changeValue(reply);\r\n            // }}\r\n            onKeyPress={e => {\r\n              if (e.key === 'Enter' && !e.shiftKey) {\r\n                reply(value,  \r\n                  props, changeReplying, \r\n                  changeValue);\r\n              }\r\n            }}\r\n            options={props.suggestions}\r\n            labelWidth={110}\r\n          />\r\n        </Grid>\r\n      }\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  Grid,\r\n  Button\r\n} from \"@material-ui/core\";\r\nimport CommentControl from \"./CommentControl\";\r\nimport TextBox from \"./TextBox\";\r\n\r\n\r\n/**\r\n * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p><p><br></p>\r\n * gets translated to \r\n * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p>\r\n */\r\nconst cleanWYSIWYG = (str) => {\r\n  if (str.endsWith(\"<p><br></p>\")) {\r\n    str = str.substring(0, str.length - 11);\r\n  }\r\n  return str;\r\n}\r\n\r\nconst saveComment = (text, props, changeWaiting, comments, changeComments, changeValue) => {\r\n  changeWaiting(true);\r\n  const comment = {\r\n    _id: null,\r\n    time: new Date(),\r\n    userID: props.user._id,\r\n    worldID: props.world._id,\r\n    objectType: props.objectType,\r\n    objectID: props.object._id,\r\n    text: cleanWYSIWYG(text),\r\n    votes: {},\r\n    replies: []\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .addComment(comment)\r\n    .then(res => {\r\n      if (res.error === undefined) {\r\n        comment._id = res.commentID;\r\n        comment.user = props.user;\r\n        comment.voteSum = 0;\r\n        const newComments = [...comments];\r\n        newComments.push(comment);\r\n        changeComments(newComments);\r\n        changeValue(\"\");\r\n      } else {\r\n        console.log(res.error);\r\n      }\r\n      changeWaiting(false);\r\n    })\r\n    .catch(err => console.log(err));\r\n};\r\n\r\nconst prepComment = (comment, allUsers) => {\r\n  comment.user = allUsers.filter(u => u._id === comment.userID)[0];\r\n  if (comment.user === undefined || comment.user === null) {\r\n    comment.user = {\r\n      _id: comment.userID,\r\n      username: \"Unknown\"\r\n    }\r\n  }\r\n  comment.time = new Date(comment.time);\r\n  comment.voteSum = Object.values(comment.votes).reduce((total, vote) => total + vote, 0);\r\n  comment.replies.forEach(r => {\r\n    prepComment(r, allUsers);\r\n  });\r\n}\r\n\r\nexport default function CommentsControl(props) {\r\n  const [value, changeValue] = useState(\"\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n  const [comments, changeComments] = useState([]);\r\n  const [loadComments, changeLoadComments] = useState(true);\r\n  \r\n  if (loadComments && props.allUsers.length > 0) {\r\n    changeLoadComments(false);\r\n    setTimeout(() => {\r\n      props.api.getComments(props.world._id, props.objectType, props.object._id).then(res => {\r\n        res.comments.forEach(comment => {\r\n          prepComment(comment, props.allUsers);\r\n        });\r\n        changeComments(res.comments);\r\n      });\r\n    }, 500);\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      { props.objectType !== \"General\" &&\r\n        <Grid item>\r\n          <b>Comments:</b>\r\n        </Grid>\r\n      }\r\n      { comments.map((comment, key) => {\r\n        return (\r\n          <Grid item key={key} container spacing={1} direction=\"column\">\r\n            <CommentControl \r\n              comment={comment} \r\n              rootComment={comment}\r\n              user={props.user} \r\n              world={props.world}\r\n              object={props.object}\r\n              objectType={props.objectType}\r\n              allUsers={props.allUsers} \r\n              api={props.api} \r\n              changeComments={newComments => {\r\n                changeComments(newComments);\r\n              }} \r\n              changeWaiting={changeWaiting}\r\n              suggestions={props.suggestions}\r\n            />\r\n          </Grid>\r\n        );\r\n      })}\r\n      { props.objectType === \"General\" && comments.length === 0 ? \r\n        <Grid item>\r\n          No discussions yet\r\n        </Grid>\r\n      : comments.length === 0 &&\r\n        <Grid item>\r\n          No comments yet\r\n        </Grid>\r\n      }\r\n      { !waiting &&\r\n        <Grid item>\r\n          { (props.user !== null && (props.world.Owner === props.user._id || (props.world.Collaborators !== undefined && props.world.Collaborators.filter(c=> c.userID === props.user._id && c.type === \"collab\").length === 0))) ?\r\n            <TextBox \r\n              Value={value} \r\n              fieldName=\"New Comment\" \r\n              multiline={true}\r\n              onChange={comment => {\r\n                changeValue(comment);\r\n              }}\r\n              onBlur={comment => {\r\n                changeValue(comment);\r\n              }}\r\n              options={props.suggestions}\r\n              labelWidth={110}\r\n            />\r\n          : (props.user !== null && props.objectType === \"General\") ?\r\n            <TextBox \r\n              Value={value} \r\n              fieldName=\"New Discussion\" \r\n              multiline={true}\r\n              onBlur={desc => {\r\n                changeValue(desc);\r\n              }}\r\n              options={props.suggestions}\r\n              labelWidth={110}\r\n            />\r\n          : (props.user === null && props.objectType === \"General\") ?\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"fake_comments_label\">\r\n                You have to log in to start a discussion\r\n              </InputLabel>\r\n              <OutlinedInput\r\n                id=\"fake_comments_label\"\r\n                name=\"fake_comments_label\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                disabled={true}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          :\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"fake_comments_label\">\r\n                You have to log in to leave comments\r\n              </InputLabel>\r\n              <OutlinedInput\r\n                id=\"fake_comments_label\"\r\n                name=\"fake_comments_label\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                disabled={true}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          }\r\n        </Grid>\r\n      }\r\n      <Grid item>\r\n        <Button\r\n          fullWidth\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          disabled={waiting || value === \"\"}\r\n          onClick={_ => {\r\n            saveComment(value, props, changeWaiting, comments, changeComments, changeValue);\r\n          }}>\r\n          {waiting ? \"Please Wait\" : \"Submit\"}\r\n        </Button>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport {\r\n  // selectWorld, setTypes, setThings, setWorlds, \r\n  // setPublicWorlds, \r\n  // updatePublicWorldForCollab,\r\n  // setAttributes, \r\n  // setTemplates,\r\n  // updateAttributes,\r\n  // setAllUsers,\r\n  notFromLogin,\r\n  toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport { \r\n  Grid\r\n} from \"@material-ui/core\";\r\nimport CommentsControl \r\nfrom \"../../components/Inputs/CommentsControl\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    // selectedPage: state.app.selectedPage,\r\n    // selectedWorld: state.app.selectedWorld,\r\n    // selectedWorldID: state.app.selectedWorldID,\r\n    // worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    // types: state.app.types,\r\n    // things: state.app.things,\r\n    user: state.app.user,\r\n    // attributesByID: state.app.attributesByID,\r\n    // attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin,\r\n    templates: state.app.templates,\r\n    allUsers: state.app.allUsers,\r\n    userSuggestions: state.app.userSuggestions,\r\n    worldSuggestions: state.app.worldSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    // setTypes: types => dispatch(setTypes(types)),\r\n    // setThings: things => dispatch(setThings(things)),\r\n    // setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    // setTemplates: templates => dispatch(setTemplates(templates)),\r\n    // setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    // updatePublicWorldForCollab: world => dispatch(updatePublicWorldForCollab(world)),\r\n    // setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    // updateAttributes: attributes => dispatch(updateAttributes(attributes)),\r\n    // setAllUsers: allUsers => dispatch(setAllUsers(allUsers)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item>\r\n          <h3>General Discussion Board</h3>\r\n        </Grid>\r\n        <Grid item>\r\n          This is a place where anyone can discuss anything related to \r\n          writing in general, or to look for collaborators, or something\r\n          to collaborate on.\r\n        </Grid>\r\n        <Grid item>\r\n          I plan to add filtering capabilities in the future.\r\n        </Grid>\r\n        <Grid item>\r\n          <CommentsControl \r\n            user={this.props.user} \r\n            allUsers={this.props.allUsers}\r\n            object={{_id: \"General\"}}\r\n            objectType=\"General\"\r\n            world={{_id: \"General\"}}\r\n            api={this.api} \r\n            onChange={this.commentsChange}\r\n          /> \r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\nconst GeneralDiscussionPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default GeneralDiscussionPage;\r\n","\r\nimport Home from \"@material-ui/icons/Home\";\r\nimport Forum from \"@material-ui/icons/Forum\";\r\nimport HomePage from \"../../views/Home\";\r\nimport GeneralDiscussionPage from \"../../views/Discussion/GeneralDiscussion\";\r\n\r\n\r\nconst menuRoutes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home\",\r\n    icon: Home,\r\n    component: HomePage,\r\n  },\r\n  {\r\n    path: \"/discussion\",\r\n    name: \"Discussion\",\r\n    icon: Forum,\r\n    component: GeneralDiscussionPage,\r\n  }\r\n];\r\n\r\nexport default menuRoutes;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport StarBorderIcon from \"@material-ui/icons/StarBorder\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setTemplates,\r\n  setAllUsers,\r\n  setFollowingWorlds,\r\n  toggleMenu,\r\n  logout,\r\n  // toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds,\r\n    width: state.app.width\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setTemplates: templates => dispatch(setTemplates(templates)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    toggleMenu: () => dispatch(toggleMenu({})),\r\n    // toggleLogin: () => dispatch(toggleLogin({}))\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Menu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getWorlds(true).then(res => {\r\n      this.props.setPublicWorlds(res.publicWorlds.worlds);\r\n      this.props.setTemplates(res.templates.templates);\r\n      this.props.setAllUsers(res.allUsers);\r\n      \r\n      if (this.props.user !== null) {\r\n        if (res.userWorlds.worlds === undefined) {\r\n          this.props.logout();\r\n        } else {\r\n          this.props.setWorlds(res.userWorlds.worlds);\r\n        }\r\n      }\r\n    });\r\n    // this.api.getPublicWorlds().then(res => {\r\n    //   this.props.setPublicWorlds(res.worlds);\r\n    // });\r\n    // if (this.props.user !== null) {\r\n    //   this.api.getWorldsForUser().then(res => {\r\n    //     if (res.worlds !== undefined) {\r\n    //       this.props.setWorlds(res.worlds);\r\n    //     }\r\n    //     else {\r\n    //       // User's login is no longer valid.\r\n    //       this.props.logout();\r\n    //     }\r\n    //   });\r\n    // }\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      <div>\r\n        {menuRoutes.map((prop, key) => (\r\n          <ListItem key={key} className=\"curvedButton\">\r\n            <NavLink\r\n              to={prop.path}\r\n              onClick={_ => {\r\n                this.props.toggleMenu();\r\n              }}\r\n              style={{\r\n                width: `${this.props.width}px`\r\n              }}\r\n              className=\"MyButton\"\r\n              activeClassName=\"active\"\r\n            >\r\n              <ListItem button>\r\n                {typeof prop.icon === \"string\" ? (\r\n                  <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n                ) : (\r\n                  <prop.icon className=\"marginLeft\" />\r\n                )}\r\n                &nbsp;\r\n                <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n              </ListItem>\r\n            </NavLink>\r\n          </ListItem>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (\r\n      this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined\r\n    ) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (\r\n            this.state.Filter === \"\" ||\r\n            w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())\r\n          ) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            } else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {followingWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/project/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, false);\r\n                    }}\r\n                  >\r\n                    <Star />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n              {otherWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/project/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, true);\r\n                    }}\r\n                  >\r\n                    <StarBorderIcon />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return followingWorlds.map((w, key) => (\r\n      <ListItem key={key} className=\"curvedButton\">\r\n        <NavLink\r\n          to={`/project/details/${w._id}`}\r\n          onClick={_ => {\r\n            this.props.toggleMenu();\r\n          }}\r\n          style={{\r\n            width: `${this.props.width}px`\r\n          }}\r\n          className=\"MyButton\"\r\n          activeClassName=\"active\"\r\n        >\r\n          <ListItem button>\r\n            <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n          </ListItem>\r\n        </NavLink>\r\n      </ListItem>\r\n    ));\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => (\r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink\r\n                  to={`/project/details/${w._id}`}\r\n                  onClick={_ => {\r\n                    this.props.toggleMenu();\r\n                  }}\r\n                  style={{\r\n                    width: `${this.props.width}px`\r\n                  }}\r\n                  className=\"MyButton\"\r\n                  activeClassName=\"active\"\r\n                >\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            ));\r\n      return worldLinks;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Projects\"} />\r\n          <Tooltip title={`Browse Public Projects`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        { this.props.user !== null &&\r\n          <ListItem>\r\n            <ListItemText primary={\"My Projects\"} />\r\n          </ListItem>\r\n        }\r\n        { this.props.user !== null &&\r\n          <ListItem className=\"curvedButton\">\r\n            <NavLink \r\n            to={`/project/create`}\r\n            onClick={_ => {\r\n              this.props.toggleMenu();\r\n            }}\r\n            style={{\r\n              width: `${this.props.width}px`\r\n            }} \r\n            className=\"MyButton\" \r\n            activeClassName=\"active\">\r\n              <ListItem button>\r\n                <Add />\r\n                <ListItemText primary={\"Create New\"} />\r\n              </ListItem>\r\n            </NavLink>\r\n          </ListItem>\r\n        }\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst MobileMenu = connect(mapStateToProps, mapDispatchToProps)(Menu);\r\nexport default MobileMenu;\r\n","import React from 'react';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport {\r\n  Menu, MenuItem,\r\n  ListItem, ListItemText,\r\n  Icon, // ListItemIcon\r\n} from '@material-ui/core';\r\n// import {\r\n//   // InboxIcon,\r\n//   // DraftsIcon,\r\n//   // SendIcon\r\n// } from '@material-ui/icons';\r\n\r\nconst StyledMenu = withStyles({\r\n  paper: {\r\n    border: '1px solid #d3d4d5',\r\n  },\r\n})((props) => (\r\n  <Menu\r\n    elevation={0}\r\n    getContentAnchorEl={null}\r\n    anchorOrigin={{\r\n      vertical: 'bottom',\r\n      horizontal: 'center',\r\n    }}\r\n    transformOrigin={{\r\n      vertical: 'top',\r\n      horizontal: 'center',\r\n    }}\r\n    {...props}\r\n  />\r\n));\r\n\r\n// const StyledMenuItem = withStyles((theme) => ({\r\n//   root: {\r\n//     '&:focus': {\r\n//       backgroundColor: theme.palette.primary.main,\r\n//       '& .MuiListItemIcon-root, & .MuiListItemText-primary': {\r\n//         color: theme.palette.common.white,\r\n//       },\r\n//     },\r\n//   },\r\n// }))(MenuItem);\r\n\r\nexport default function UserMenu(props) {\r\n  const [anchorEl, setAnchorEl] = React.useState(null);\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  return (\r\n    <span className=\"float-right blue whiteFont\">\r\n      <ListItem \r\n        aria-controls=\"user-menu\" aria-haspopup=\"true\"\r\n        style={{cursor: \"pointer\"}} \r\n        onClick={handleClick} \r\n        className=\"curvedButton float-right\">\r\n        <Icon>person</Icon>\r\n        <ListItemText primary={` ${props.username}`}/>\r\n      </ListItem>\r\n      <StyledMenu\r\n        id=\"customized-menu\"\r\n        anchorEl={anchorEl}\r\n        keepMounted\r\n        open={Boolean(anchorEl)}\r\n        onClose={_ => {setAnchorEl(null)}}\r\n      >\r\n        <MenuItem onClick={_ => {\r\n          // if (props.onProfile !== undefined)\r\n          //   props.onProfile();\r\n          setAnchorEl(null);\r\n        }}>\r\n          <NavLink\r\n            to=\"/User/Profile\"\r\n            // onClick={_ => {\r\n            //   this.props.toggleMenu();\r\n            // }}\r\n            style={{\r\n              color:\"black\"\r\n            }}\r\n            // className=\"MyButton\"\r\n            // activeClassName=\"active\"\r\n          >\r\n            <ListItemText primary=\"Profile\" />\r\n          </NavLink>\r\n        </MenuItem>\r\n        <MenuItem\r\n          style={{\r\n            color:\"black\"\r\n          }} \r\n          onClick={_ => {\r\n            if (props.onLogout !== undefined)\r\n              props.onLogout();\r\n            setAnchorEl(null);\r\n          }}>\r\n          <ListItemText primary=\"Logout\" />\r\n        </MenuItem>\r\n      </StyledMenu>\r\n    </span>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport {\r\n  AppBar, Toolbar, ListItem, \r\n  ListItemText, Icon, IconButton, \r\n  // Button\r\n} from \"@material-ui/core\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\n// import { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  setWorlds,\r\n  loadFromStorage,\r\n  toggleMenu,\r\n  toggleLogin,\r\n  logout,\r\n  redirectTo\r\n} from \"../../redux/actions/index\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport API from \"../../smartAPI\";\r\nimport MobileMenu from \"./MobileMenu\";\r\nimport UserMenu from \"./UserMenu\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    user: state.app.user,\r\n    selectedWorld: state.app.selectedWorld,\r\n    mobileMenuOpen: !state.app.menuOpen // This defaults to closed instead of open\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    loadFromStorage: () => dispatch(loadFromStorage({})),\r\n    toggleMenu: () => dispatch(toggleMenu({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    redirectTo: page => dispatch(redirectTo(page))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.loadFromStorage();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Grid container spacing={0}>\r\n            <Grid item xs>\r\n              <IconButton\r\n                style={{ color: \"white\" }}\r\n                aria-label=\"Menu\"\r\n                onClick={_ => {\r\n                  this.props.toggleMenu();\r\n                }}\r\n              >\r\n                <MenuIcon />\r\n              </IconButton>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <ListItem className=\"curvedButton\">\r\n                <ListItemText\r\n                  primary={\r\n                    this.props.selectedWorld === null\r\n                      ? \"Welcome!\"\r\n                      : this.props.selectedWorld.Name\r\n                  }\r\n                />\r\n              </ListItem>\r\n            </Grid>\r\n            <Grid item xs>\r\n              { this.props.user === null || this.props.user.username === undefined ? \r\n                <span style={{cursor: \"pointer\"}} \r\n                  onClick={_ => {\r\n                    this.props.toggleLogin();\r\n                  }}\r\n                  className=\"float-right blue whiteFont\">\r\n                  <ListItem className=\"curvedButton float-right\">\r\n                    <Icon>person</Icon>\r\n                    <ListItemText primary=\" Login/Register\"/>\r\n                  </ListItem>\r\n                </span>\r\n              : \r\n                <UserMenu \r\n                  username={this.props.user.username}\r\n                  onLogout={_ => {\r\n                    this.api.logout().then(_ => {\r\n                      this.props.logout();\r\n                    });\r\n                  }}\r\n                />\r\n              }\r\n            </Grid>\r\n          </Grid>\r\n        </Toolbar>\r\n        {this.props.mobileMenuOpen &&\r\n          <Box display={{ xs: 'inline', sm: 'none' }}>\r\n            <MobileMenu />\r\n          </Box>\r\n        }\r\n      </AppBar>\r\n    );\r\n  }\r\n}\r\n\r\nconst NavBar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default NavBar;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\n// import logo from \"../../logo.svg\";\r\nimport logo from \"../../assets/img/ANB.png\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  Divider,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds,\r\n  setTemplates,\r\n  setAllUsers,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    setTemplates: templates => dispatch(setTemplates(templates)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getWorlds(true).then(res => {\r\n      this.props.setPublicWorlds(res.publicWorlds.worlds);\r\n      this.props.setTemplates(res.templates.templates);\r\n      this.props.setAllUsers(res.allUsers);\r\n      \r\n      if (this.props.user !== null) {\r\n        if (res.userWorlds.worlds === undefined) {\r\n          this.props.logout();\r\n        } else {\r\n          this.props.setWorlds(res.userWorlds.worlds);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      menuRoutes.map((prop, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={prop.path} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              {typeof prop.icon === \"string\" ? (\r\n                <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n              ) : (\r\n                <prop.icon className=\"marginLeft\" />\r\n              )}\r\n              &nbsp;\r\n              <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  brand() {\r\n    return (\r\n      <NavLink to={`/`} className=\"BlackTextButton\" activeClassName=\"active\">\r\n        <ListItem>\r\n          <img src={logo} alt=\"logo\" className=\"App-logo\" />\r\n          <ListItemText primary={this.props.logoText} />\r\n        </ListItem>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (this.state.Filter === \"\" || w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            }\r\n            else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {\r\n                followingWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/project/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, false);\r\n                      }}\r\n                    >\r\n                      <Star />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n              {\r\n                otherWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/project/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, true);\r\n                      }}\r\n                    >\r\n                      <StarBorderIcon />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return (\r\n      followingWorlds.map((w, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={`/project/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => \r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink to={`/project/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            );\r\n      return (worldLinks);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.brand()}\r\n        <Divider light />\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Projects\"} />\r\n          <Tooltip title={`Browse Public Projects`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        { this.props.user !== null &&\r\n          <ListItem>\r\n            <ListItemText primary={\"My Projects\"} />\r\n          </ListItem>\r\n        }\r\n        { this.props.user !== null &&\r\n          <ListItem className=\"curvedButton\">\r\n            <NavLink to={`/project/create`} className=\"MyButton\" activeClassName=\"active\">\r\n              <ListItem button>\r\n                <Add />\r\n                <ListItemText primary={\"Create New\"} />\r\n              </ListItem>\r\n            </NavLink>\r\n          </ListItem>\r\n        }\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst Sidebar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default Sidebar;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\n// import uuid from 'react-uuid';\r\n// import { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport { \r\n  Grid, \r\n  //Button, \r\n  // Checkbox, FormControl, FormControlLabel,\r\n  // InputLabel, Tooltip, Fab,\r\n  // Select, MenuItem \r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\n// import { Multiselect } from 'multiselect-react-dropdown';\r\nimport {\r\n  // updateSelectedType,\r\n  // addType,\r\n  // updateType,\r\n  // addAttributes,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  setAllUsers,\r\n  notFromLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n// import TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin,\r\n    allUsers: state.app.allUsers\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: \"\",\r\n      email: \"\",\r\n      fieldValidation: {\r\n        username: { valid: true, message: \"\" },\r\n        email: { valid: true, message: \"\" },\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      loaded: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"username\":\r\n        value = this.state.username;\r\n        // valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        // if (!valid)\r\n        //   message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        // else \r\n        if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Username is too short\";\r\n        } else if (this.props.allUsers.filter(u=>u.username === value && u._id !== this.props.user._id).length !== 0) {\r\n          valid = false;\r\n          message = \"This Username is taken\";\r\n        }\r\n        break;\r\n      case \"email\":\r\n        value = this.state.email;\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        if (valid && value !== this.props.user.email)\r\n          message = \"You will be sent a confirmation email at your new email upon submission.  Please use the link.\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  }\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"username\");\r\n    const emailValid = this.validateField(\"email\");\r\n    const formValid = nameValid.valid && emailValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  }\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      _id: this.props.user._id,\r\n      username: this.state.username.trim(),\r\n      email: this.state.email.trim()\r\n    };\r\n\r\n    this.api.updateUser(user).then(res => {\r\n      // Should do all the same stuff that is done on login.\r\n      if (res.user === null) {\r\n        let errors = this.state.fieldValidation;\r\n        errors.loginError = { message: res.error, valid: false, show: true };\r\n        this.setState({ fieldValidation: errors, waiting: false });\r\n      }\r\n      else {\r\n        this.props.userLogin(res.user);\r\n        this.api.getWorldsForUser(res.user._id).then(res => {\r\n          this.props.setWorlds(res.worlds);\r\n          this.props.onLogin(res.user);\r\n          // this.setState({ redirectTo: \"/\" });\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  load = () => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        redirectTo: null,\r\n        message: \"Loading...\"\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    \r\n    // if (this.props.allUsers.length === 0) {\r\n    //   this.api.getAllUsers().then(res => {\r\n    //     this.props.setAllUsers(res);\r\n    //     this.setState({\r\n    //       // allUsers: res2, \r\n    //       username: this.props.user.username, \r\n    //       email: this.props.user.email,\r\n    //       loaded: true,\r\n    //       message: \"\"\r\n    //     });\r\n    //   });\r\n    // } else {\r\n      this.setState({\r\n        // allUsers: res2, \r\n        username: this.props.user.username, \r\n        email: this.props.user.email,\r\n        loaded: true,\r\n        message: \"\"\r\n      });\r\n    // }\r\n  }\r\n\r\n  render() {\r\n    if (!this.state.loaded)\r\n      this.load();\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.user === null) {\r\n      return <span>Please log in to be able to access your profile.</span>;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ `Author's Notebook: User Profile` }</title>\r\n          </Helmet>\r\n          <Grid item>\r\n            <h2>User Profile</h2>\r\n          </Grid>\r\n          <Grid item>\r\n            Username: {this.props.user.username}\r\n            {/* { this.state.loaded && <span>{this.state.username}</span> \r\n              // <TextBox \r\n              //   Value={this.state.username} \r\n              //   fieldName=\"username\" \r\n              //   displayName=\"Username\" \r\n              //   message={this.state.fieldValidation.username.message}\r\n              //   onBlur={name => {\r\n              //     this.setState({ username: name }, this.validateForm);\r\n              //   }}\r\n              //   labelWidth={70}/>\r\n            } */}\r\n          </Grid>\r\n          <Grid item>\r\n            Email: {this.props.user.email}\r\n            {/* { this.state.loaded &&  \r\n              <TextBox \r\n                Value={this.state.email} \r\n                fieldName=\"email\" \r\n                displayName=\"Email\" \r\n                message={this.state.fieldValidation.email.message}\r\n                onBlur={email => {\r\n                  this.setState({ email }, this.validateForm);\r\n                }}\r\n                labelWidth={43}/>\r\n            } */}\r\n          </Grid>\r\n          <Grid item>I'll add more profile elements here as the website grows</Grid>\r\n          {/* <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\" color=\"primary\"\r\n                style={{marginLeft: \"4px\"}}\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={e => {this.onSubmit(false);}}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item style={{color:\"red\"}}>{this.state.message}</Grid> */}\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ProfilePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ProfilePage;\r\n","import React, { Component } from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport {\r\n  Add, Edit\r\n} from \"@material-ui/icons\";\r\nimport {\r\n  Grid, List, ListItem, Button, Tooltip, Fab\r\n} from \"@material-ui/core\";\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\r\n// import Tooltip from '@material-ui/core/Tooltip';\r\n// import { Fab } from \"@material-ui/core\";\r\nimport {\r\n  updateIndexExpandedPanel\r\n} from \"../../redux/actions/index\";\r\nimport UnderConstruction from \"../../assets/img/under_construction.png\";\r\nimport UnderConstructionWhite from \"../../assets/img/under_construction_white.png\";\r\n\r\n/* \r\n  This component will be used by the WorldDetails component.  It will\r\n  have a link at the top for creating new Things, and will list all\r\n  Things in the selected World, allowing navigation to their Details.  \r\n  The List will have pagination and filtering controls to make it \r\n  easier to manage.\r\n*/\r\nconst mapStateToProps = state => {\r\n  return { \r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorld: state.app.selectedWorld,\r\n    user: state.app.user,\r\n    indexExpandedPanel: state.app.indexExpandedPanel\r\n  };\r\n}\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateIndexExpandedPanel: panel => dispatch(updateIndexExpandedPanel(panel))\r\n  };\r\n}\r\nclass Index extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleChange = panel => {\r\n    this.props.updateIndexExpandedPanel(this.props.indexExpandedPanel === panel ? false : panel);\r\n  }\r\n\r\n  renderListForType(type) {\r\n    // TODO: Add a PluralName field to types so I can use it here.  It may end up being useful other places too.\r\n    const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n              <Add/>{`Create New ${type.Name}`}\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            things.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    {thing.Name}\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    }\r\n    else {\r\n      const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n      const createButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n\r\n      return (\r\n        <div>\r\n          <Grid item container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              {this.props.indexExpandedPanel === \"TYPES\" ? \r\n                <Tooltip title={`Collapse Types`}>\r\n                  <Button \r\n                    onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                      <KeyboardArrowDownIcon/>\r\n                  </Button>\r\n                </Tooltip>\r\n              :\r\n                <Tooltip title={`Expand Types`}>\r\n                    <Button \r\n                      onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                      <KeyboardArrowRightIcon/>\r\n                    </Button>\r\n                  </Tooltip>\r\n              }\r\n              <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>\r\n                { this.props.types.filter(t => t.NeedsWork !== undefined && t.NeedsWork).length > 0 ?\r\n                  <span>Types ({this.props.types.length}) ({this.props.types.filter(t => t.NeedsWork !== undefined && t.NeedsWork).length} <img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstruction} alt=\"Needs Work\" />)</span>\r\n                :\r\n                  <span>Types ({this.props.types.length})</span>\r\n                }\r\n              </span>\r\n              { createButtons &&\r\n                <Tooltip title={`Create New Type`}>\r\n                  <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                    onClick={ _ => {this.setState({redirectTo:`/type/create`})}}>\r\n                    <Add/>\r\n                  </Fab>\r\n                </Tooltip> \r\n              }\r\n            </Grid>\r\n            { this.props.indexExpandedPanel === \"TYPES\" &&\r\n              <Grid item>\r\n                <List style={{ maxWidth: \"380px\" }}>\r\n                  {\r\n                    this.props.types.map((type, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Grid container spacing={1} direction=\"row\">\r\n                            <Grid item xs={8}>\r\n                              <Tooltip title={`Details for ${type.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                                  { type.NeedsWork &&\r\n                                    <span><img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstructionWhite} alt=\"Needs Work\" />&nbsp;</span>\r\n                                  }\r\n                                  {type.Name}\r\n                                </Button>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                            { createButtons &&\r\n                              <Grid item xs={2}>\r\n                                <Tooltip title={`Create New ${type.Name}`}>\r\n                                  <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                                    onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                                    <Add/>\r\n                                  </Fab>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            }\r\n                            { createButtons &&\r\n                              <Grid item xs={2}>\r\n                                <Tooltip title={`Edit ${type.Name}`}>\r\n                                  <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                                    onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                                    <Edit/>\r\n                                  </Fab>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            }\r\n                          </Grid>\r\n                        </ListItem>\r\n                      );\r\n                    })\r\n                  }\r\n                </List>\r\n              </Grid>\r\n            }\r\n            { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n              const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n              return (\r\n                <Grid key={i} item container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    {this.props.indexExpandedPanel === type._id ? \r\n                      <Tooltip title={`Collapse ${type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName}`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(type._id)}}>\r\n                          <KeyboardArrowDownIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                      :\r\n                      <Tooltip title={`Expand ${type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName}`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(type._id)}}>\r\n                          <KeyboardArrowRightIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                    }\r\n                    <Tooltip title={`Details for ${type.Name}`}>\r\n                      <Button variant=\"contained\" color=\"primary\" style={{ width: \"220px\" }}\r\n                        onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                        { things.filter(t => t.NeedsWork !== undefined && t.NeedsWork).length > 0 ?\r\n                          <span>\r\n                            { type.NeedsWork &&\r\n                              <span><img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstructionWhite} alt=\"Needs Work\" />&nbsp;</span>\r\n                            }\r\n                            {type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName} \r\n                            ({things.length}) \r\n                            ({things.filter(t => t.NeedsWork !== undefined && t.NeedsWork).length} <img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstructionWhite} alt=\"Needs Work\" />)\r\n                          </span>\r\n                        :\r\n                          <span>\r\n                            { type.NeedsWork &&\r\n                              <span><img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstructionWhite} alt=\"Needs Work\" />&nbsp;</span>\r\n                            }\r\n                            {type.PluralName === undefined || type.PluralName === \"\" ? `${type.Name}s` : type.PluralName} \r\n                            ({things.length})\r\n                          </span>\r\n                        }\r\n                      </Button>\r\n                    </Tooltip>\r\n                    { createButtons &&\r\n                      <span>\r\n                        <Tooltip title={`Create New ${type.Name}`}>\r\n                          <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                            <Add/>\r\n                          </Fab>\r\n                        </Tooltip>\r\n                        <Tooltip title={`Edit ${type.Name}`}>\r\n                          <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </span>\r\n                    }\r\n                  </Grid>\r\n                  {this.props.indexExpandedPanel === type._id &&\r\n                    <Grid item>\r\n                      <List style={{ maxWidth: \"380px\" }}>\r\n                        {\r\n                          things.map((thing, j) => {\r\n                            return (\r\n                              <ListItem key={j}>\r\n                                <Grid container spacing={1} direction=\"row\">\r\n                                  <Grid item xs={10}>\r\n                                    <Tooltip title={`Details for ${thing.Name}`}>\r\n                                      <Button \r\n                                        fullWidth variant=\"contained\" color=\"primary\" \r\n                                        onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                        { thing.NeedsWork &&\r\n                                          <span><img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstructionWhite} alt=\"Needs Work\" />&nbsp;</span>\r\n                                        }\r\n                                        {thing.Name}\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                  { createButtons &&\r\n                                    <Grid item xs={2}>\r\n                                      <Tooltip title={`Edit ${thing.Name}`}>\r\n                                        <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                                          onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                          <Edit/>\r\n                                        </Fab>\r\n                                      </Tooltip>\r\n                                    </Grid>\r\n                                  }\r\n                                </Grid>\r\n                              </ListItem>\r\n                            );\r\n                          })\r\n                        }\r\n                      </List>\r\n                    </Grid>\r\n                  }\r\n                </Grid>\r\n              );\r\n            })}\r\n            <Grid item>\r\n              {this.props.indexExpandedPanel === \"OTHER\" ? \r\n                <Tooltip title={`Collapse Other Things`}>\r\n                  <Button \r\n                    onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                    <KeyboardArrowDownIcon/>\r\n                  </Button>\r\n                </Tooltip>\r\n              :\r\n                <Tooltip title={`Expand Other Things`}>\r\n                  <Button \r\n                    onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                    <KeyboardArrowRightIcon/>\r\n                  </Button>\r\n                </Tooltip>\r\n              }\r\n              <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>\r\n                { majorless.filter(t => t.NeedsWork !== undefined && t.NeedsWork).length > 0 ?\r\n                  <span>Other Things ({majorless.length}) ({majorless.filter(t => t.NeedsWork !== undefined && t.NeedsWork).length} <img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstruction} alt=\"Needs Work\" />)</span>\r\n                :\r\n                  <span>Other Things ({majorless.length})</span>\r\n                }\r\n              </span>\r\n              { createButtons &&\r\n                <Tooltip title={`Create New Thing`}>\r\n                  <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n                    <Add/>\r\n                  </Fab>\r\n                </Tooltip>\r\n              }\r\n            </Grid>\r\n            {this.props.indexExpandedPanel === \"OTHER\" &&\r\n              <Grid item>\r\n                <List style={{ maxWidth: \"380px\" }}>\r\n                  {\r\n                    majorless.map((thing, j) => {\r\n                      return (\r\n                        <ListItem key={j}>\r\n                          <Grid container spacing={1} direction=\"row\">\r\n                            <Grid item xs={10}>\r\n                              <Tooltip title={`Details for ${thing.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                  { thing.NeedsWork &&\r\n                                    <span><img style={{ height: \"20px\", marginBottom: \"-4px\" }} src={UnderConstructionWhite} alt=\"Needs Work\" />&nbsp;</span>\r\n                                  }\r\n                                  {thing.Name}\r\n                                </Button>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                            { createButtons &&\r\n                              <Grid item xs={2}>\r\n                                <Tooltip title={`Edit ${thing.Name}`}>\r\n                                  <Fab size=\"small\" color=\"primary\" style={{marginLeft: \"8px\"}}\r\n                                    onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                    <Edit/>\r\n                                  </Fab>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            }\r\n                          </Grid>\r\n                        </ListItem>\r\n                      );\r\n                    })\r\n                  }\r\n                </List>\r\n              </Grid>\r\n            }\r\n          </Grid>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingIndex = connect(mapStateToProps, mapDispatchToProps)(Index);\r\nexport default ThingIndex;\r\n","\r\n/* eslint-disable no-use-before-define */\r\nimport React from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  // Button,\r\n  // List, ListItem,\r\n  // Checkbox, Tooltip\r\n} from \"@material-ui/core\";\r\n\r\n/**\r\n * This control displays everything for the type which is passed to it.\r\n */\r\n\r\nexport default function TypeSummary(props) {\r\n  const type = props.type;\r\n  const types = props.types;\r\n  const things = props.things;\r\n  if (type.typeID === undefined) {\r\n    type.typeID = type._id;\r\n  }\r\n  types.forEach(t => {\r\n    if (t.typeID === undefined) {\r\n      t.typeID = t._id;\r\n    }\r\n  });\r\n  things.forEach(t => {\r\n    if (t.thingID === undefined) {\r\n      t.thingID = t._id;\r\n    }\r\n  });\r\n  console.log(type.Defaults);\r\n  let defaults = type.Defaults.filter(d => d.DefaultValue !== \"\" || d.DefaultListValues.length > 0);\r\n  let superTypes = types.filter(t => type.SuperIDs.includes(t.typeID));\r\n  return (\r\n    <Grid item container spacing={1} direction=\"column\">\r\n      <Grid item>\r\n        {type.Name}\r\n      </Grid>\r\n      { superTypes.length > 0 &&\r\n        <Grid item>\r\n          <div style={{ marginLeft: \"10px\" }}>\r\n            Super Types (\r\n              { superTypes.map((t, key) => {\r\n                return (\r\n                  <span key={key}>\r\n                    {key > 0 && <span>,&nbsp;</span>}\r\n                    {t.Name}\r\n                  </span>\r\n                );\r\n              })}\r\n            )\r\n          </div>\r\n        </Grid>\r\n      }\r\n      { type.Attributes.length > 0 &&\r\n        <Grid item>\r\n          <div style={{ marginLeft: \"10px\" }}>\r\n            Attributes (\r\n              { type.Attributes.map((a, aKey) => {\r\n                const attribute = props.attributesByID[a.attrID];\r\n                if (attribute !== undefined) {\r\n                  let attributeType = \"\"; \r\n                  if (attribute.AttributeType === \"Type\") {\r\n                    attributeType = `Type - ${types.filter(t => t.typeID === attribute.DefinedType)[0].Name}`;\r\n                  } else if (attribute.AttributeType === \"List\") {\r\n                    if (attribute.ListType === \"Type\") {\r\n                      attributeType = `List: Type - ${types.filter(t => t.typeID === attribute.DefinedType)[0].Name}`;\r\n                    } else {\r\n                      attributeType = `List: ${attribute.ListType}`;\r\n                    }\r\n                  } else {\r\n                    attributeType = attribute.AttributeType;\r\n                  }\r\n                  return (\r\n                    <span key={aKey}>\r\n                      {aKey > 0 && <span>,&nbsp;</span>}\r\n                      {attribute.Name}&nbsp;({attributeType})\r\n                    </span>\r\n                  );\r\n                } else {\r\n                  return (\r\n                    <span key={aKey}></span>\r\n                  );\r\n                }\r\n              })}\r\n            )\r\n          </div>\r\n        </Grid>\r\n      }\r\n      { defaults !== undefined && defaults.length > 0 &&\r\n        <Grid item>\r\n          <div style={{ marginLeft: \"10px\" }}>\r\n            Defaults (\r\n              { defaults.map((d, dKey) => {\r\n                const attribute = props.attributesByID[d.attrID];\r\n                if (attribute !== undefined) {\r\n                  let defaultValue = \"\"; \r\n                  if (attribute.AttributeType === \"Type\") {\r\n                    defaultValue = props.thing.filter(t => t.thingID === d.DefaultValue)[0].Name;\r\n                  } else if (attribute.AttributeType === \"List\") {\r\n                    for (let i = 0; i < d.DefaultListValues.length; i++) {\r\n                      if (attribute.ListType === \"Type\") {\r\n                        const defThing = things.filter(t => t.thingID === d.DefaultListValues[i])[0];\r\n                        if (defThing !== undefined) {\r\n                          if (i > 0) {\r\n                            defaultValue += \", \";\r\n                          }\r\n                          defaultValue += defThing.Name;\r\n                        }\r\n                      } else {\r\n                        if (i > 0) {\r\n                          defaultValue += \", \";\r\n                        }\r\n                        defaultValue += d.DefaultListValues[i];\r\n                      }\r\n                    }\r\n                  } else {\r\n                    defaultValue = d.DefaultValue;\r\n                  }\r\n                  return (\r\n                    <span key={dKey}>\r\n                      {dKey > 0 && <span>,&nbsp;</span>}\r\n                      {attribute.Name}&nbsp;({defaultValue})\r\n                    </span>\r\n                  );\r\n                } else {\r\n                  return (\r\n                    <span key={dKey}></span>\r\n                  );\r\n                }\r\n              })}\r\n            )\r\n          </div>\r\n        </Grid>\r\n      }\r\n    </Grid>\r\n  );\r\n}\r\n","\r\n/* eslint-disable no-use-before-define */\r\nimport React from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  // Button,\r\n  // List, ListItem,\r\n  // Checkbox, Tooltip\r\n} from \"@material-ui/core\";\r\n\r\n/**\r\n * This control displays everything for the thing which is passed to it.\r\n */\r\n\r\nexport default function ThingSummary(props) {\r\n  let types = props.types.filter(t => props.thing.TypeIDs.includes(t.typeID));\r\n  const thing = props.thing;\r\n  const things = props.things;\r\n  if (thing.typeID === undefined) {\r\n    thing.thingID = thing._id;\r\n  }\r\n  types.forEach(t => {\r\n    if (t.typeID === undefined) {\r\n      t.typeID = t._id;\r\n    }\r\n  });\r\n  things.forEach(t => {\r\n    if (t.thingID === undefined) {\r\n      t.thingID = t._id;\r\n    }\r\n  });\r\n\r\n  return (\r\n    <Grid item container spacing={1} direction=\"column\">\r\n      <Grid item>\r\n        {thing.Name}\r\n      </Grid>\r\n      { types.length > 0 &&\r\n        <Grid item>\r\n          Types (\r\n            { types.map((t, key) => {\r\n              return (\r\n                <span key={key}>\r\n                  {key > 0 && <span>,&nbsp;</span>}\r\n                  {t.Name}\r\n                </span>\r\n              );\r\n            })}\r\n          )\r\n        </Grid>\r\n      }\r\n      <Grid item>\r\n        Attributes (\r\n          { thing.Attributes.map((a, aKey) => {\r\n            const attribute = props.attributesByID[a.attrID];\r\n            let attributeValue = \"\"; \r\n            if (attribute.AttributeType === \"Type\") {\r\n              attributeValue = things.filter(t => t.thingID === a.Value)[0].Name;\r\n            } else if (attribute.AttributeType === \"List\") {\r\n              for (let i = 0; i < a.ListValues.length; i++) {\r\n                if (i > 0) {\r\n                  attributeValue += \", \";\r\n                }\r\n                if (attribute.ListType === \"Type\") {\r\n                  attributeValue += things.filter(t => t.thingID === a.ListValues[i])[0].Name;\r\n                } else {\r\n                  attributeValue += a.ListValues[i];\r\n                }\r\n              }\r\n            } else {\r\n              attributeValue = a.Value;\r\n            }\r\n            return (\r\n              <span key={aKey}>\r\n                {aKey > 0 && <span>,&nbsp;</span>}\r\n                {attribute.Name}&nbsp;({attributeValue})\r\n              </span>\r\n            );\r\n          })}\r\n        )\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  Button,\r\n  List, ListItem,\r\n  Checkbox,\r\n  Box\r\n} from \"@material-ui/core\";\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\r\nimport TextBox from \"../Inputs/TextBox\";\r\nimport TypeSummary from \"../Displays/TypeSummary\";\r\nimport ThingSummary from \"../Displays/ThingSummary\";\r\n\r\n\r\nconst validate = (value, props, changeMessage) => {\r\n  const valid = props.templates.filter((t) => t.Name === value).length === 0;\r\n  changeMessage(valid ? \"\" : \"This Template Name is already in use\");\r\n  return valid;\r\n};\r\n\r\nconst saveTemplate = (templateName, selected, props, changeMessage, changeWaiting) => {\r\n  changeWaiting(true);\r\n  const template = {\r\n    _id: null,\r\n    Name: templateName.trim(),\r\n    typeIDs: selected.typeIDs,\r\n    thingIDs: selected.thingIDs,\r\n    worldID: props.world._id\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .createTemplate(template)\r\n    .then(res => {\r\n      if (res.error === undefined) {\r\n        changeMessage(\"Success\");\r\n        setTimeout(() => {\r\n          changeWaiting(false);\r\n          props.onSave();\r\n        }, 500);\r\n      } else {\r\n        changeMessage(res.error);\r\n        changeWaiting(false);\r\n      }\r\n    })\r\n    .catch(err => console.log(err));\r\n};\r\n\r\n// const addTypeToList = (type, types, attributesByID, typeIDs) => {\r\n//   if (!typeIDs.includes(type._id)) {\r\n//     typeIDs.push(type._id);\r\n//     for (let i = 0; i < type.SuperIDs.length; i++) {\r\n//       let superType = types.filter(t => t._id === type.SuperIDs[i]);\r\n//       if (superType.length > 0){\r\n//         superType = superType[0];\r\n//         typeIDs = addTypeToList(superType, types, attributesByID, typeIDs);\r\n//       }\r\n//     }\r\n//     for (let i = 0; i < type.Attributes.length; i++) {\r\n//       let attr = attributesByID[type.Attributes[i].attrID];\r\n//       if (attr.AttributeType === \"Type\" || (attr.AttributeType === \"List\" && attr.ListType === \"Type\")) {\r\n//         let attrType = types.filter(t => t._id === attr.DefinedType);\r\n//         if (attrType.length > 0) {\r\n//           attrType = attrType[0];\r\n//           typeIDs = addTypeToList(attrType, types, attributesByID, typeIDs);\r\n//         }\r\n//       }\r\n//     }\r\n//   }\r\n//   return typeIDs;\r\n// };\r\n\r\n// const removeTypeFromList = (type, types, attributesByID, typeIDs) => {\r\n//   const index = typeIDs.indexOf(type._id);\r\n//   if (index > -1) {\r\n//     typeIDs.splice(index, 1);\r\n//     const subTypes = types.filter(t=>t.SuperIDs.includes(type._id));\r\n//     for (let i = 0; i < subTypes.length; i++) {\r\n//       let subType = subTypes[i];\r\n//       if (subType.length > 0){\r\n//         subType = subType[0];\r\n//         typeIDs = removeTypeFromList(subType, types, attributesByID, typeIDs);\r\n//       }\r\n//     }\r\n//     const references = types.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(type._id));\r\n//     for (let i = 0; i < references.length; i++) {\r\n//       let reference = references[i];\r\n//       typeIDs = removeTypeFromList(reference, types, attributesByID, typeIDs);\r\n//     }\r\n//   }\r\n//   return typeIDs;\r\n// };\r\n\r\n/**\r\n * finished\r\n */\r\nconst addType = (type, types, things, attributesByID, selected) => {\r\n  let newSelected = {...selected};\r\n  if (!newSelected.typeIDs.includes(type._id)) {\r\n    newSelected.typeIDs.push(type._id);\r\n    for (let i = 0; i < type.SuperIDs.length; i++) {\r\n      if (!newSelected.typeIDs.includes(type.SuperIDs[i])) {\r\n        let superType = types.filter(t => t._id === type.SuperIDs[i]);\r\n        if (superType.length > 0){\r\n          superType = superType[0];\r\n          newSelected = addType(superType, types, things, attributesByID, newSelected);\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < type.Attributes.length; i++) {\r\n      let attr = attributesByID[type.Attributes[i].attrID];\r\n      if (attr !== undefined) {\r\n        if (attr.AttributeType === \"Type\" || (attr.AttributeType === \"List\" && attr.ListType === \"Type\")) {\r\n          if (!newSelected.typeIDs.includes(attr.DefinedType)) {\r\n            let attrType = types.filter(t => t._id === attr.DefinedType);\r\n            if (attrType.length > 0) {\r\n              attrType = attrType[0];\r\n              newSelected = addType(attrType, types, things, attributesByID, newSelected);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (type.Defaults !== undefined && type.Default !== null) {\r\n      for (let i = 0; i < type.Defaults.length; i++) {\r\n        let attr = attributesByID[type.Defaults[i].attrID];\r\n        if (attr.AttributeType === \"Type\") {\r\n          if (!newSelected.thingIDs.includes(type.Defaults[i].DefaultValue)) {\r\n            let defaultThing = things.filter(t => t._id === type.Defaults[i].DefaultValue);\r\n            if (defaultThing.length > 0) {\r\n              defaultThing = defaultThing[0];\r\n              newSelected = addThing(defaultThing, types, things, attributesByID, newSelected);\r\n            }\r\n          }\r\n        } else if (attr.AttributeType === \"List\" && attr.ListType === \"Type\") {\r\n          for (let j = 0; j < type.Defaults[i].DefaultListValues.length; j++) {\r\n            if (!newSelected.thingIDs.includes(type.Defaults[i].DefaultListValues[j])) {\r\n              let defaultThing = things.filter(t => t._id === type.Defaults[i].DefaultListValues[j]);\r\n              if (defaultThing.length > 0) {\r\n                defaultThing = defaultThing[0];\r\n                newSelected = addThing(defaultThing, types, things, attributesByID, newSelected);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return newSelected;\r\n};\r\n\r\n/**\r\n * finished, dependant on removeThing\r\n */\r\nconst removeType = (type, types, things, attributesByID, selected) => {\r\n  let newSelected = {...selected};\r\n  const index = newSelected.typeIDs.indexOf(type._id);\r\n  if (index > -1) {\r\n    newSelected.typeIDs.splice(index, 1);\r\n    const subTypes = types.filter(t=>t.SuperIDs.includes(type._id));\r\n    for (let i = 0; i < subTypes.length; i++) {\r\n      let subType = subTypes[i];\r\n      if (subType.length > 0){\r\n        subType = subType[0];\r\n        newSelected = removeType(subType, types, things, attributesByID, newSelected);\r\n      }\r\n    }\r\n    const references = types.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(type._id));\r\n    for (let i = 0; i < references.length; i++) {\r\n      let reference = references[i];\r\n      newSelected = removeType(reference, types, things, attributesByID, newSelected);\r\n    }\r\n    const removeUs = things.filter(t => t.TypeIDs.includes(type._id));\r\n    for (let i = 0; i < removeUs.length; i++) {\r\n      let removeMe = removeUs[i];\r\n      newSelected = removeThing(removeMe, types, things, attributesByID, newSelected);\r\n    }\r\n  }\r\n  return newSelected;\r\n};\r\n\r\n/**\r\n * finished\r\n */\r\nconst addThing = (thing, types, things, attributesByID, selected) => {\r\n  let newSelected = {...selected};\r\n  if (!newSelected.thingIDs.includes(thing._id)) {\r\n    newSelected.thingIDs.push(thing._id);\r\n    for (let i = 0; i < thing.TypeIDs.length; i++) {\r\n      const typeID = thing.TypeIDs[i];\r\n      if (!newSelected.typeIDs.includes(typeID)) {\r\n        let type = types.filter(t => t._id === typeID);\r\n        if (type.length > 0) {\r\n          type = type[0];\r\n          newSelected = addType(type, types, things, attributesByID, newSelected);\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < thing.Attributes.length; i++) {\r\n      const attr = attributesByID[thing.Attributes[i].attrID];\r\n      if (attr.AttributeType === \"Type\" || (attr.AttributeType === \"List\" && attr.ListType === \"Type\")) {\r\n        if (!newSelected.typeIDs.includes(attr.DefinedType)) {\r\n          let attrType = types.filter(t => t._id === attr.DefinedType);\r\n          if (attrType.length > 0) {\r\n            attrType = attrType[0];\r\n            newSelected = addType(attrType, types, things, attributesByID, newSelected);\r\n          }\r\n        }\r\n      }\r\n      if (attr.AttributeType === \"Type\") {\r\n        const thingAttr = thing.Attributes[i];\r\n        if (!newSelected.thingIDs.includes(thingAttr.Value)) {\r\n          let attrThing = things.filter(t => t._id === thingAttr.Value);\r\n          if (attrThing.length > 0) {\r\n            attrThing = attrThing[0];\r\n            newSelected = addThing(attrThing, types, things, attributesByID, newSelected);\r\n          }\r\n        }\r\n      } else if (attr.AttributeType === \"List\" && attr.ListType === \"Type\") {\r\n        const thingAttr = thing.Attributes[i];\r\n        for (let j = 0; j < thingAttr.ListValues.length; j++) {\r\n          if (!newSelected.thingIDs.includes(thingAttr.ListValues[j])) {\r\n            let attrThing = things.filter(t => t._id === thingAttr.ListValues[j]);\r\n            if (attrThing.length > 0) {\r\n              attrThing = attrThing[0];\r\n              newSelected = addThing(attrThing, types, things, attributesByID, newSelected);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return newSelected;\r\n};\r\n\r\n/**\r\n * finished\r\n */\r\nconst removeThing = (thing, types, things, attributesByID, selected) => {\r\n  let newSelected = {...selected};\r\n  const index = newSelected.thingIDs.indexOf(thing._id);\r\n  if (index > -1) {\r\n    newSelected.thingIDs.splice(index, 1);\r\n    const typesWithDefault = types.filter(t=>t.Defaults.filter(d => d.DefaultValue === thing._id || d.DefaultListValues.includes(thing._id)).length > 0);\r\n    for (let i = 0; i < typesWithDefault.length; i++) {\r\n      let typeWithDefault = typesWithDefault[i];\r\n      newSelected = removeType(typeWithDefault, types, things, attributesByID, newSelected);\r\n    }\r\n    const references = things.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(thing._id));\r\n    for (let i = 0; i < references.length; i++) {\r\n      let reference = references[i];\r\n      newSelected = removeThing(reference, types, things, attributesByID, newSelected);\r\n    }\r\n  }\r\n  return newSelected;\r\n};\r\n\r\nexport default function TemplateModal(props) {\r\n  const valid = props.templates.filter((t) => t.Name === props.world.Name).length === 0;\r\n  const [name, changeName] = useState(props.world.Name);\r\n  const [message, changeMessage] = useState(\"\");\r\n  const [nameMessage, changeNameMessage] = useState(valid ? \"\" : \"This Template Name is already in use\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n  const [selected, changeSelected] = useState({ typeIDs: [], thingIDs: [] });\r\n  const [nameValid, changeValid] = useState(valid);\r\n  const [expandedPanel, changeExpanded] = useState(\"\");\r\n  const [selectedType, changeSelectedType] = useState({});\r\n  const [selectedThing, changeSelectedThing] = useState({});\r\n\r\n  const typeless = props.things.filter(thing => thing.Types.length === 0);\r\n  const selectedTypeless = typeless.filter(thing => selected.thingIDs.includes(thing._id));\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      <Grid item>\r\n        Create a template for use in other projects based on this one.\r\n        The template will be usable by any user.\r\n      </Grid>\r\n      <Grid item>\r\n        <TextBox \r\n          Value={name} \r\n          fieldName=\"Template Name\" \r\n          message={nameMessage}\r\n          onBlur={n => {\r\n            changeName(n);\r\n            changeValid(validate(n, props, changeNameMessage));\r\n          }}\r\n          labelWidth={110}/>\r\n      </Grid>\r\n      <Grid item style={{color: \"red\"}}>\r\n        {message}\r\n      </Grid>\r\n      <Grid item>\r\n        Choose which data you want to include in the template.  \r\n        Dependencies will automatically be checked/unchecked as appropriate.\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={4}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={_ => {\r\n              changeWaiting(true);\r\n              let newSelected = {...selected};\r\n              for (let i = 0; i < props.types.length; i++) {\r\n                newSelected = addType(props.types[i], props.types, props.things, props.attributesByID, newSelected);\r\n              }\r\n              changeSelected(newSelected);\r\n              changeWaiting(false);\r\n            }}\r\n          >\r\n            { waiting ? \r\n              <span>Please Wait</span> \r\n            : \r\n              <span><Checkbox disabled checked=\"checked\" color=\"default\" /> All Types</span>\r\n            }\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={_ => {\r\n              changeWaiting(true);\r\n              const typeIDs = [];\r\n              props.types.forEach(t => {\r\n                typeIDs.push(t._id);\r\n              });\r\n              const thingIDs = [];\r\n              props.things.forEach(t => {\r\n                thingIDs.push(t._id);\r\n              });\r\n              const newSelected = {\r\n                typeIDs,\r\n                thingIDs\r\n              };\r\n              changeSelected(newSelected);\r\n              changeWaiting(false);\r\n            }}\r\n          >\r\n            { waiting ? \r\n              <span>Please Wait</span> \r\n            : \r\n              <span><Checkbox disabled checked=\"checked\" color=\"default\" /> All</span>\r\n            }\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <Button\r\n            style={{ marginLeft: \"4px\"}}\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={_ => {\r\n              changeSelected({ typeIDs: [], thingIDs: [] });\r\n            }}\r\n          >\r\n            { waiting ? \r\n              <span>Please Wait</span> \r\n            : \r\n              <span><Checkbox color=\"default\" disabled /> All</span>\r\n            }\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Box style={{ height: \"300px\", overflowY: \"scroll\", overflowX: \"hidden\" }}>\r\n            <Grid container spacing={1} direction=\"column\">\r\n              { props.types.map((type, i) => {\r\n                const things = props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n                const selectedThings = things.filter(thing => selected.thingIDs.includes(thing._id));\r\n                return (\r\n                  <Grid key={i} item container spacing={0} direction=\"column\">\r\n                    <Grid item>\r\n                      {expandedPanel === type._id ? \r\n                        <Button \r\n                          onClick={_ => {changeExpanded(\"\")}}>\r\n                          <KeyboardArrowDownIcon/>\r\n                        </Button>\r\n                      :\r\n                        <Button \r\n                          onClick={_ => {changeExpanded(type._id)}}>\r\n                          <KeyboardArrowRightIcon/>\r\n                        </Button>\r\n                      }\r\n                      <Checkbox\r\n                        checked={selected.typeIDs.includes(type._id)}\r\n                        onChange={ e => {\r\n                          if (!waiting) {\r\n                            changeWaiting(true);\r\n                            let newSelected = {...selected};\r\n                            if (e.target.checked) {\r\n                              newSelected = addType(type, props.types, props.things, props.attributesByID, newSelected);\r\n                            } else {\r\n                              newSelected = removeType(type, props.types, props.things, props.attributesByID, newSelected);\r\n                            }\r\n                            changeSelected(newSelected);\r\n\r\n                            changeWaiting(false);\r\n                          }\r\n                        }}\r\n                        name={`include_type_${type._id}`}\r\n                        color=\"primary\"\r\n                      />\r\n                      <Button \r\n                        // fullWidth \r\n                        style={{ width: \"200px\" }}\r\n                        variant=\"contained\" \r\n                        color=\"primary\" \r\n                        onClick={ _ => {\r\n                          changeSelectedType(type);\r\n                          changeSelectedThing({});\r\n                        }}>\r\n                        {`${type.Name} (${selectedThings.length}/${things.length})`}\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={waiting}\r\n                        style={{ marginLeft: \"4px\" }}\r\n                        onClick={_ => {\r\n                          changeWaiting(true);\r\n                          let newSelected = {...selected};\r\n                          things.forEach(t => {\r\n                            newSelected = addThing(t, props.types, props.things, props.attributesByID, newSelected);\r\n                          });\r\n                          changeSelected(newSelected);\r\n                          changeWaiting(false);\r\n                        }}\r\n                      >\r\n                        { waiting ? \r\n                          <span>Please Wait</span> \r\n                        : \r\n                          <span><Checkbox disabled checked=\"checked\" color=\"default\" /> All</span>\r\n                        }\r\n                      </Button>\r\n                    </Grid>\r\n                    {expandedPanel === type._id &&\r\n                      <Grid item>\r\n                        <List style={{ marginLeft: \"50px\", maxWidth: \"380px\" }}>\r\n                          {\r\n                            things.map((thing, j) => {\r\n                              return (\r\n                                <ListItem key={j}>\r\n                                  <Checkbox\r\n                                    checked={selected.thingIDs.includes(thing._id)}\r\n                                    onChange={ e => {\r\n                                      if (!waiting) {\r\n                                        changeWaiting(true);\r\n                                        let newSelected = {...selected};\r\n                                        if (e.target.checked) {\r\n                                          newSelected = addThing(thing, props.types, props.things, props.attributesByID, newSelected);\r\n                                        } else {\r\n                                          newSelected = removeThing(thing, props.types, props.things, props.attributesByID, newSelected);\r\n                                        }\r\n                                        changeSelected(newSelected);\r\n\r\n                                        changeWaiting(false);\r\n                                      }\r\n                                    }}\r\n                                    name={`include_thing_${thing._id}`}\r\n                                    color=\"primary\"\r\n                                  />\r\n                                  <Button \r\n                                    style={{ width: \"200px\" }}\r\n                                    variant=\"contained\" \r\n                                    color=\"primary\" \r\n                                    onClick={ _ => {\r\n                                      changeSelectedType({});\r\n                                      changeSelectedThing(thing);\r\n                                      // changeSelectedTemplate(template);\r\n                                    }}>\r\n                                    {`${thing.Name}`}\r\n                                  </Button>\r\n                                </ListItem>\r\n                              );\r\n                            })\r\n                          }\r\n                        </List>\r\n                      </Grid>\r\n                    }\r\n                  </Grid>\r\n                );\r\n              })}\r\n              { typeless.length > 0 &&\r\n                <Grid item>\r\n                  {expandedPanel === \"OTHER\" ? \r\n                    <Button \r\n                      onClick={_ => {changeExpanded(\"\")}}>\r\n                      <KeyboardArrowDownIcon/>\r\n                    </Button>\r\n                  :\r\n                    <Button \r\n                      onClick={_ => {changeExpanded(\"OTHER\")}}>\r\n                      <KeyboardArrowRightIcon/>\r\n                    </Button>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>\r\n                    {`Other Things (${selectedTypeless.length}/${typeless.length})`}\r\n                  </span>\r\n                </Grid>\r\n              }\r\n              {expandedPanel === \"OTHER\" &&\r\n                <Grid item>\r\n                  <List style={{ maxWidth: \"380px\" }}>\r\n                    {\r\n                      typeless.map((thing, j) => {\r\n                        return (\r\n                          <ListItem key={j}>\r\n                            <Grid container spacing={1} direction=\"row\">\r\n                              <Grid item xs={10}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {\r\n                                    changeSelectedType({});\r\n                                    changeSelectedThing(thing);\r\n                                  }}>\r\n                                  {thing.Name}\r\n                                </Button>\r\n                              </Grid>\r\n                            </Grid>\r\n                          </ListItem>\r\n                        );\r\n                      })\r\n                    }\r\n                  </List>\r\n                </Grid>\r\n              }\r\n            </Grid>\r\n          </Box>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Box style={{ height: \"300px\", overflowY: \"scroll\", overflowX: \"hidden\" }}>\r\n            { selectedType._id !== undefined ? \r\n              <TypeSummary type={selectedType} types={props.types} things={props.things} attributesByID={props.attributesByID} />\r\n            : selectedThing._id !== undefined &&\r\n              <ThingSummary thing={selectedThing} types={props.types} things={props.things} attributesByID={props.attributesByID} />\r\n            }\r\n          </Box>\r\n        </Grid>\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting || !nameValid || selected.typeIDs.length === 0}\r\n            onClick={_ => {\r\n              changeWaiting(true);\r\n              saveTemplate(name, selected, props, changeMessage, changeWaiting);\r\n            }}\r\n          >\r\n            {waiting ? \"Please Wait\" : \"Submit\"}\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={(e) => {\r\n              if (props.onCancel !== undefined && props.onCancel !== null)\r\n                props.onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","\r\n/* eslint-disable no-use-before-define */\r\nimport React from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  // Button,\r\n  // List, ListItem,\r\n  // Checkbox, Tooltip\r\n} from \"@material-ui/core\";\r\nimport TypeSummary from \"./TypeSummary\";\r\nimport ThingSummary from \"./ThingSummary\";\r\n\r\n/**\r\n * This control displays everything for the world or template which\r\n * is passed to it.\r\n * \r\n * Types:\r\n * Type Name - Attributes: Attribute1 Name, Attribute2 Name, etc. - Defaults: etc.\r\n * \r\n * Things:\r\n * Thing Name - Types: Type1Name, etc.\r\n */\r\n\r\nexport default function WorldMap(props) {\r\n  const dingus = {...props.dingus};\r\n  const attributesByID = {};\r\n  if (props.Attributes !== undefined) {\r\n    dingus.Attributes = [...props.Attributes];\r\n  }\r\n  dingus.Attributes.forEach(a => {\r\n    if (a.attrID === undefined) {\r\n      a.attrID = a._id;\r\n    }\r\n    attributesByID[a.attrID] = a;\r\n  });\r\n  console.log(props);\r\n  console.log(attributesByID);\r\n  if (props.Types !== undefined) {\r\n    dingus.Types = [...props.Types];\r\n    dingus.Types.forEach(t => {\r\n      if (t.typeID === undefined) {\r\n        t.typeID = t._id;\r\n      }\r\n    });\r\n  }\r\n  if (dingus.Types === undefined) {\r\n    dingus.Types = [];\r\n  }\r\n  if (props.Things !== undefined) {\r\n    dingus.Things = [...props.Things];\r\n    dingus.Things.forEach(t => {\r\n      if (t.thingID === undefined) {\r\n        t.thingID = t._id;\r\n      }\r\n    });\r\n  } \r\n  if (dingus.Things === undefined) {\r\n    dingus.Things = [];\r\n  }\r\n  return (\r\n    <Grid item xs={9} container spacing={1} direction=\"column\">\r\n      <Grid item>\r\n        {dingus.Name}\r\n      </Grid>\r\n      <Grid item>\r\n        Types:\r\n      </Grid>\r\n      { dingus.Types.map((type, typeKey) => {\r\n        return (\r\n          <TypeSummary \r\n            key={typeKey} \r\n            type={type} \r\n            types={dingus.Types} \r\n            things={dingus.Things} \r\n            attributesByID={attributesByID} \r\n          />\r\n        );\r\n      })}\r\n      { dingus.Things !== undefined && dingus.Things.length > 0 &&\r\n        <Grid item container spacing={0} direction=\"column\">\r\n          <Grid item>\r\n            Things:\r\n          </Grid>\r\n          { dingus.Things.map((thing, thingKey) => {\r\n            return (\r\n              <ThingSummary \r\n                key={thingKey} \r\n                thing={thing} \r\n                types={dingus.Types} \r\n                things={dingus.Things} \r\n                attributesByID={attributesByID} \r\n              />\r\n              // <Grid item key={thingKey} container spacing={1} direction=\"row\">\r\n              //   <Grid item xs={12} sm={3}>\r\n              //     {thing.Name}\r\n              //   </Grid>\r\n              //   <Grid item xs={12} sm={9}>\r\n              //     Types (\r\n              //       { thing.TypeIDs.map((typeID, typeKey) => {\r\n              //         console.log(typeID);\r\n              //         return (\r\n              //           <span key={typeKey}>{typeKey > 0 && <span>,&nbsp;</span>}{dingus.Types.filter(t => t.typeID === typeID)[0].Name}</span>\r\n              //         );\r\n              //       })}\r\n              //     )\r\n              //   </Grid>\r\n              // </Grid>\r\n            );\r\n          })}\r\n        </Grid>\r\n      }\r\n    </Grid>\r\n  );\r\n}\r\n","\r\n /* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  Button,\r\n  List, ListItem,\r\n  Checkbox, Tooltip\r\n} from \"@material-ui/core\";\r\nimport WorldMap from \"../Displays/WorldMap\";\r\n\r\n/**\r\n * This control displays all the templates for display (map)\r\n * and selection.  When submitted, the selected templates are\r\n * passed back to the containing view, where they can be passed\r\n * to the ImportingTemplatesControl when appropriate.\r\n */\r\n\r\n\r\nexport default function ImportTemplatesControl(props) {\r\n  const [selectedTemplate, changeSelectedTemplate] = useState({});\r\n  const [selectedTemplateIDs, changeSelectedTemplates] = useState(props.selectedTemplateIDs === undefined ? [] : props.selectedTemplateIDs);\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      <Grid item>\r\n        Click a template to view its contents.\r\n        Select the templates you want to import into your project.\r\n        Any which have types or attributes with the same names \r\n        (either with each other or with what you already have in your project), \r\n        we will try to merge them if possible.  \r\n        If it's not, then we will append the names of them with \r\n        the names of the templates they came from, and you can \r\n        resolve it yourself afterward.\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={3}>\r\n          Templates:\r\n          <List>\r\n            { props.templates.map((template, key) => {\r\n              return (\r\n                <ListItem key={key}>\r\n                  <Checkbox\r\n                    checked={selectedTemplateIDs.includes(template._id)}\r\n                    onChange={ _ => {\r\n                      const newSelectedTemplateIDs = [...selectedTemplateIDs];\r\n                      newSelectedTemplateIDs.push(template._id);\r\n                      changeSelectedTemplates(newSelectedTemplateIDs);\r\n                    }}\r\n                    name={`include_template_${template._id}`}\r\n                    color=\"primary\"\r\n                  />\r\n                  <Tooltip title={`Details for ${template.Name}`}>\r\n                    <Button \r\n                      fullWidth variant=\"contained\" color=\"primary\" \r\n                      onClick={ _ => {\r\n                        changeSelectedTemplate(template);\r\n                      }}>\r\n                      {template.Name}\r\n                    </Button>\r\n                  </Tooltip>\r\n                </ListItem>\r\n              );\r\n            })}\r\n          </List>\r\n        </Grid>\r\n        { selectedTemplate._id !== undefined && \r\n          <WorldMap dingus={selectedTemplate} />\r\n        }\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={selectedTemplateIDs.length === 0}\r\n            onClick={_ => {\r\n              props.onSubmit(selectedTemplateIDs);\r\n            }}\r\n          >\r\n            OK\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={(e) => {\r\n              if (props.onCancel !== undefined && props.onCancel !== null)\r\n                props.onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","\r\nimport React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectWorld,\r\n  addAndSelectWorld,\r\n  updateWorld,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport { \r\n  IconButton, \r\n  List, ListItem,\r\n  // Checkbox, FormControl, FormControlLabel,\r\n  // OutlinedInput, InputLabel, FormHelperText, \r\n  Grid, \r\n  // Tooltip, Fab\r\n} from \"@material-ui/core\";\r\nimport PlayCircleOutlineIcon from '@material-ui/icons/PlayCircleOutline';\r\nimport PauseCircleOutlineIcon from '@material-ui/icons/PauseCircleOutline';\r\n// import { ArrowBack } from \"@material-ui/icons\";\r\n// import { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n// import TemplatesModal from \"../../components/Modals/TemplatesModal\";\r\n// import ImportTemplatesControl from \"../../components/WorldTemplateControls/ImportTemplatesControl\";\r\n// import TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/**\r\n * This control imports the templates passed to it into the \r\n * selected world.  It displays the name of the template it is\r\n * currently working on, along with the names of its attributes, \r\n * types, and things (if any) and the status of each (pending,\r\n * importing, imported, defaults pending (this one happens when\r\n * it is a type with defaults for attributes of Type or \r\n * List Type.  Then after it imports the things it comes back to\r\n * do their defaults.)).  It also has a pause/play control at \r\n * the top, and it checks the status of it before starting each\r\n * import.  If it's paused then it just waits.  If it gets \r\n * unpaused then it checks to see what it needs to do next and \r\n * picks back up.  Because of the possibility that it will get \r\n * paused and unpaused during a single import, it needs to \r\n * check for anything importing at the time that it gets \r\n * unpaused.\r\n * Once all statuses are imported then it moves on to the next \r\n * template.  Once all templates are imported then it triggers\r\n * the onCompleteEvent which goes back to the view and lets it \r\n * do whatever it's supposed to do next (either reload details\r\n * or forward to details).\r\n */\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin,\r\n    templates: state.app.templates,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    attributesByName: state.app.attributesByName,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    addAndSelectWorld: world => dispatch(addAndSelectWorld(world)),\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      templateID: null, \r\n      template: null, \r\n      importingTypes: [], \r\n      importingAttributes: [], \r\n      attributesStatus: \"Pending\",\r\n      importingThings: [], \r\n      play: true,\r\n      stepInProgress: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  takeNextStep = () => {\r\n    if (this.state.play && !this.state.stepInProgress) {\r\n      this.setState({ stepInProgress: true }, \r\n        this.reallyTakeNextStep\r\n      );\r\n    }\r\n  }\r\n\r\n  reallyTakeNextStep = () => {\r\n    // First do a dumb import of all the types that aren't being merged\r\n    const importingTypes = this.state.importingTypes;\r\n    let type = importingTypes.filter(t => t.status === \"Pending\");\r\n    if (type.length > 0) {\r\n      type = type[0];\r\n      type.status = \"Importing\";\r\n      this.setState(\r\n        { \r\n          importingTypes\r\n        }, this.dumbImportType\r\n      );\r\n    } else {\r\n      // Now upsert all of the attributes that aren't already ready\r\n      const importingAttributes = this.state.importingAttributes;\r\n      let attributes = importingAttributes.filter(a => a.status === \"Pending\");\r\n      if (attributes.length > 0) {\r\n        this.setState(\r\n          {\r\n            attributesStatus: \"Importing\"\r\n          },\r\n          this.upsertAttributes\r\n        );\r\n      } else {\r\n        // Now we do a dumb import on the things that aren't going to be merged\r\n        const importingThings = this.state.importingThings;\r\n        let thing = importingThings.filter(t => t.status === \"Pending\");\r\n        if (thing.length > 0) {\r\n          thing = thing[0];\r\n          let existingThing = this.props.things.filter(t => t.Name.trim().toLowerCase() === thing.Name.trim().toLowerCase());\r\n          if (existingThing.length > 0) {\r\n            existingThing = existingThing[0];\r\n\r\n            // It already exists, so add it to the mapping, etc then move on.\r\n            thing.thing = existingThing;\r\n            thing.status = \"More Pending\";\r\n            const thingMap = this.state.thingMap;\r\n            // const attrMap = this.state.attributeMap;\r\n            // const thingMap = this.state.thingMap;\r\n            thingMap[thing.templateThing.thingID] = existingThing;\r\n            this.setState(\r\n              { \r\n                importingThings, \r\n                thingMap,\r\n                stepInProgress: false \r\n              }, \r\n              this.takeNextStep\r\n            );\r\n          } else {\r\n            thing.status = \"Importing\";\r\n            this.setState(\r\n              { \r\n                importingThings\r\n              }, this.dumbImportThing\r\n            );\r\n          }\r\n        } else {\r\n          // Now we need to go back through the types and update them\r\n          type = importingTypes.filter(t => t.status === \"More Pending\");\r\n          if (type.length > 0) {\r\n            type = type[0];\r\n            type.status = \"Importing\";\r\n            this.setState(\r\n              { \r\n                importingTypes\r\n              }, this.importType\r\n            );\r\n          } else {\r\n            // Now we need to go back through the things and update them\r\n            thing = importingThings.filter(t => t.status === \"More Pending\");\r\n            if (thing.length > 0) {\r\n              thing = thing[0];\r\n              thing.status = \"Importing\";\r\n              this.setState(\r\n                { \r\n                  importingThings\r\n                }, this.importThing\r\n              );\r\n            } else {\r\n              // Yay!  We're done.\r\n              if (this.props.onComplete)\r\n                this.props.onComplete();\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  upsertAttributes = () => {\r\n    const importingAttributes = this.state.importingAttributes;\r\n    let attributes = importingAttributes.filter(a => a.status === \"Pending\");\r\n      \r\n    const typeMap = this.state.typeMap;\r\n    const attributeMap = this.state.attributeMap;\r\n    const templateName = this.state.template.Name;\r\n    const upsertUs = [];\r\n    attributes.forEach(a => {\r\n      let upsert = false;\r\n      const attribute = {...a.templateAttribute};\r\n      attribute.worldID = this.props.selectedWorldID;\r\n      delete attribute.attrID;\r\n      if (attribute.AttributeType === \"Type\" || (attribute.AttributeType === \"List\" && attribute.ListType === \"Type\")) {\r\n        // We need to fix DefinedType\r\n        attribute.DefinedType = typeMap[attribute.DefinedType]._id;\r\n      }\r\n      const existingAttribute = this.props.attributesByName[attribute.Name];\r\n      if (existingAttribute !== undefined) {\r\n        // We've got a matching name.  Check if the types match.\r\n        if (attribute.AttributeType !== existingAttribute.AttributeType || (attribute.AttributeType === \"List\" && attribute.ListType !== existingAttribute.ListType)) {\r\n          // They don't, so we need to change the name.\r\n          attribute.Name += ` From Template (${templateName})`;\r\n          upsert = true;\r\n        } else {\r\n          // It matches, so we can merge them.\r\n          attribute._id = existingAttribute._id;\r\n          if (attribute.AttributeType === \"Options\" || (attribute.AttributeType === \"List\" && attribute.ListType === \"Options\")) {\r\n            // It's Options, so we need to merge the Options.\r\n            const attrOptions = attribute.Options;\r\n            attribute.Options = existingAttribute.Options;\r\n            attrOptions.forEach(o => {\r\n              if (!attribute.Options.includes(o)){\r\n                attribute.Options.push(o);\r\n                upsert = true;\r\n              }\r\n            });\r\n          }\r\n          if (!upsert) {\r\n            a.status = \"Imported\";\r\n          }\r\n          a.attribute = attribute;\r\n          attributeMap[a.templateAttribute.attrID] = attribute;\r\n        }\r\n      } else {\r\n        upsert = true;\r\n      }\r\n      if (upsert) {\r\n        upsertUs.push(attribute);\r\n      }\r\n    });\r\n    if (upsertUs.length > 0) {\r\n      this.api.upsertAttributes(this.props.selectedWorldID, upsertUs).then(res => {\r\n        attributes.forEach(a => {\r\n          let id = res.attributes[a.templateAttribute.Name];\r\n          let upserted = upsertUs.filter(a2 => a2.Name === a.templateAttribute.Name);\r\n          if (id === undefined || id === null) {\r\n            id = res.attributes[`${a.templateAttribute.Name} From Template (${templateName})`];\r\n            upserted = upsertUs.filter(a2 => a2.Name === `${a.templateAttribute.Name} From Template (${templateName})`);\r\n          }\r\n          upserted = upserted[0];\r\n          upserted._id = id;\r\n          a.status = \"Imported\";\r\n          a.attribute = upserted;\r\n          attributeMap[a.templateAttribute.attrID] = upserted;\r\n        });\r\n\r\n        this.setState(\r\n          { \r\n            importingAttributes: attributes, \r\n            attributeMap,\r\n            stepInProgress: false,\r\n            attributesStatus: \"Imported\"\r\n          }, \r\n          this.takeNextStep\r\n        );\r\n      });\r\n    } else {\r\n      this.setState(\r\n        { \r\n          importingAttributes: attributes, \r\n          attributesStatus: \"Imported\",\r\n          attributeMap,\r\n          stepInProgress: false\r\n        }, \r\n        this.takeNextStep\r\n      );\r\n    }\r\n  }\r\n\r\n  dumbImportType = () => {\r\n    const importingTypes = this.state.importingTypes;\r\n    let type = importingTypes.filter(t => t.status === \"Importing\")[0];\r\n    let existingType = this.props.types.filter(t => t.Name.trim().toLowerCase() === type.templateType.Name.trim().toLowerCase());\r\n    if (existingType.length > 0) {\r\n      existingType = existingType[0];\r\n      this.api.updateType(existingType).then(res => {\r\n        if (res.error === undefined) {\r\n          type.type = existingType;\r\n          type.status = \"More Pending\";\r\n          const typeMap = this.state.typeMap;\r\n          typeMap[type.templateType.typeID] = existingType;\r\n          this.setState(\r\n            { \r\n              importingTypes, \r\n              typeMap,\r\n              stepInProgress: false \r\n            }, \r\n            this.takeNextStep\r\n          );\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    } else {\r\n      const dumbType = {\r\n        _id: null,\r\n        Name: type.templateType.Name,\r\n        Description: type.templateType.Description,\r\n        SuperIDs: [],\r\n        AttributesArr: [],\r\n        Attributes: [],\r\n        worldID: this.props.selectedWorldID,\r\n        Major: type.templateType.Major,\r\n      };\r\n      this.api.createType(dumbType).then(res => {\r\n        if (res.error === undefined) {\r\n          dumbType._id = res.typeID;\r\n          type.type = dumbType;\r\n          type.status = \"More Pending\";\r\n          const typeMap = this.state.typeMap;\r\n          typeMap[type.templateType.typeID] = dumbType;\r\n          this.setState(\r\n            { \r\n              importingTypes, \r\n              typeMap,\r\n              stepInProgress: false \r\n            }, \r\n            this.takeNextStep\r\n          );\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  dumbImportThing = () => {\r\n    const importingThings = this.state.importingThings;\r\n    let thing = importingThings.filter(t => t.status === \"Importing\")[0];\r\n    const dumbThing = {\r\n      _id: null,\r\n      Name: thing.templateThing.Name,\r\n      Description: thing.templateThing.Description,\r\n      worldID: this.props.selectedWorldID,\r\n      TypeIDs: [],\r\n      Attributes: [],\r\n      ReferenceIDs: []\r\n    };\r\n    this.api.createThing(dumbThing).then(res => {\r\n      if (res.error === undefined) {\r\n        dumbThing._id = res.thingID;\r\n        thing.thing = dumbThing;\r\n        thing.status = \"More Pending\";\r\n        const thingMap = this.state.thingMap;\r\n        thingMap[thing.templateThing.thingID] = dumbThing;\r\n        this.setState(\r\n          { \r\n            importingThings, \r\n            thingMap,\r\n            stepInProgress: false \r\n          }, \r\n          this.takeNextStep\r\n        );\r\n      } else {\r\n        console.log(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  importType = () => {\r\n    const typeMap = this.state.typeMap;\r\n    const attributeMap = this.state.attributeMap;\r\n    const thingMap = this.state.thingMap;\r\n    const importingTypes = this.state.importingTypes;\r\n    const templateType = importingTypes.filter(t => t.status === \"Importing\")[0];\r\n    let type = this.props.types.filter(t => t.Name === templateType.templateType.Name);\r\n    if (type.length > 0) {\r\n      type = type[0];\r\n      templateType.templateType.SuperIDs.forEach(s => {\r\n        const superID = typeMap[s]._id;\r\n        if (!type.SuperIDs.includes(superID))\r\n          type.SuperIDs.push(superID);\r\n      });\r\n      templateType.templateType.Attributes.forEach(a => {\r\n        const attribute = attributeMap[a.attrID];\r\n        if (type.Attributes.filter(a2 => a2.attrID === attribute._id).length === 0) {\r\n          type.Attributes.push({\r\n            attrID: attribute._id,\r\n            index: type.Attributes.length\r\n          });\r\n        }\r\n      });\r\n      templateType.templateType.Defaults.forEach(d => {\r\n        const attribute = attributeMap[d.attrID];\r\n        let theDefault = type.Defaults.filter(d2 => d2.attrID === attribute._id);\r\n        if (theDefault.length === 0) {\r\n          type.Defaults.push({\r\n            attrID: attribute._id,\r\n            DefaultValue: d.DefaultValue,\r\n            DefaultListValues: d.DefaultListValues\r\n          });\r\n        } else if (attribute.AttributeType === \"List\") {\r\n          theDefault = theDefault[0];\r\n          if (attribute.ListType === \"Type\") {\r\n            d.DefaultListValues.forEach(v => {\r\n              const id = thingMap[v]._id;\r\n              if (!theDefault.DefaultListValues.includes(id)) {\r\n                theDefault.DefaultListValues.push(id);\r\n              }\r\n            });\r\n          } else {\r\n            d.DefaultListValues.forEach(v => {\r\n              if (!theDefault.DefaultListValues.includes(v)) {\r\n                theDefault.DefaultListValues.push(v);\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n      this.api.updateType(type).then(res => {\r\n        if (res.error === undefined) {\r\n          templateType.status = \"Imported\";\r\n          this.setState(\r\n            { \r\n              importingTypes,\r\n              stepInProgress: false\r\n            }, \r\n            this.takeNextStep\r\n          );\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    } else {\r\n      type = templateType.type;\r\n      templateType.templateType.SuperIDs.forEach(s => {\r\n        type.SuperIDs.push(typeMap[s]._id);\r\n      });\r\n      templateType.templateType.Attributes.forEach(a => {\r\n        type.Attributes.push({\r\n          attrID: attributeMap[a.attrID]._id,\r\n          index: type.Attributes.length\r\n        });\r\n      });\r\n      if (type.Defaults === undefined || type.Defaults === null) {\r\n        type.Defaults = [];\r\n      }\r\n      templateType.templateType.Defaults.forEach(d => {\r\n        let attribute = attributeMap[d.attrID];\r\n        // let theDefault = type.Defaults.filter(d2 => d2.attrID === attribute._id);\r\n        // if (theDefault.length === 0) {\r\n          let DefaultValue = d.DefaultValue;\r\n          let DefaultListValues = d.DefaultListValues;\r\n          if (attribute.AttributeType === \"Type\") {\r\n            DefaultValue = thingMap[DefaultValue]._id;\r\n          } else if (attribute.AttributeType === \"List\" && attribute.ListType === \"Type\") {\r\n            DefaultListValues = [];\r\n            d.DefaultListValues.forEach(v => {\r\n              DefaultListValues.push(thingMap[v]._id);\r\n            });\r\n          }\r\n          type.Defaults.push({\r\n            attrID: attribute._id,\r\n            DefaultValue,\r\n            DefaultListValues\r\n          });\r\n        // } else if (attribute.AttributeType === \"List\") {\r\n        //   theDefault = theDefault[0];\r\n        //   console.log(theDefault);\r\n        //   console.log(thingMap);\r\n        //   if (attribute.ListType === \"Type\") {\r\n        //     d.DefaultListValues.forEach(v => {\r\n        //       console.log(v);\r\n        //       const id = thingMap[v]._id;\r\n        //       console.log(id);\r\n        //       if (!theDefault.DefaultListValues.includes(id)) {\r\n        //         theDefault.DefaultListValues.push(id);\r\n        //       }\r\n        //     });\r\n        //   } else {\r\n        //     d.DefaultListValues.forEach(v => {\r\n        //       if (!theDefault.DefaultListValues.includes(v)) {\r\n        //         theDefault.DefaultListValues.push(v);\r\n        //       }\r\n        //     });\r\n        //   }\r\n        // }\r\n      });\r\n      this.api.updateType(type).then(res => {\r\n        if (res.error === undefined) {\r\n          templateType.status = \"Imported\";\r\n          this.setState(\r\n            { \r\n              importingTypes,\r\n              stepInProgress: false\r\n            }, \r\n            this.takeNextStep\r\n          );\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  importThing = () => {\r\n    const typeMap = this.state.typeMap;\r\n    const attributeMap = this.state.attributeMap;\r\n    const thingMap = this.state.thingMap;\r\n    const importingThings = this.state.importingThings;\r\n    const templateThing = importingThings.filter(t => t.status === \"Importing\")[0];\r\n    let thing = this.props.things.filter(t => t.Name === templateThing.templateThing.Name);\r\n    if (thing.length > 0) {\r\n      thing = thing[0];\r\n      templateThing.templateThing.TypeIDs.forEach(t => {\r\n        const typeID = typeMap[t]._id;\r\n        if (!thing.TypeIDS.includes(typeID))\r\n          thing.TypeIDs.push(typeID);\r\n      });\r\n      templateThing.templateThing.Attributes.forEach(a => {\r\n        const attribute = attributeMap[a.attrID];\r\n        let Value = a.Value;\r\n        let ListValues = a.ListValues;\r\n        if (thing.Attributes.filter(a2 => a2.attrID === attribute._id).length > 0) {\r\n          if (attribute.AttributeType === \"List\") {\r\n            // if it exists and isn't a list type then we leave it alone\r\n            const attr = thing.Attributes.filter(a2 => a2.attrID === attribute._id)[0];\r\n            ListValues = attr.ListValues;\r\n            a.ListValues.forEach(v => {\r\n              if (attribute.ListType === \"Type\") {\r\n                const id = thingMap[v]._id;\r\n                if (!ListValues.includes(id)) {\r\n                  ListValues.push(id);\r\n                  thing.ReferenceIDs.push(id);\r\n                }\r\n              } else if (!ListValues.includes(v)) {\r\n                ListValues.push(v);\r\n              }\r\n            });\r\n          }\r\n        } else {\r\n          if (attribute.AttributeType === \"Type\") {\r\n            Value = thingMap[a.Value]._id;\r\n            thing.ReferenceIDs.push(Value);\r\n          } else if (attribute.AttributeType === \"List\" && attribute.ListType === \"Type\") {\r\n            ListValues = [];\r\n            a.ListValues.forEach(v => {\r\n              ListValues.push(thingMap[v]._id);\r\n              thing.ReferenceIDs.push(thingMap[v]._id);\r\n            });\r\n          }\r\n          thing.Attributes.push({\r\n            attrID: attribute._id,\r\n            index: thing.Attributes.length,\r\n            Value,\r\n            ListValues\r\n          });\r\n        }\r\n      });\r\n      this.api.updateThing(thing).then(res => {\r\n        if (res.error === undefined) {\r\n          templateThing.status = \"Imported\";\r\n          this.setState(\r\n            { \r\n              importingThings,\r\n              stepInProgress: false\r\n            }, \r\n            this.takeNextStep\r\n          );\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    } else {\r\n      thing = templateThing.thing;\r\n      templateThing.templateThing.TypeIDs.forEach(t => {\r\n        thing.TypeIDs.push(typeMap[t]._id);\r\n      });\r\n      templateThing.templateThing.Attributes.forEach(a => {\r\n        const attribute = attributeMap[a.attrID];\r\n        let Value = a.Value;\r\n        let ListValues = a.ListValues;\r\n        if (attribute.AttributeType === \"Type\") {\r\n          Value = thingMap[a.Value]._id;\r\n          thing.ReferenceIDs.push(Value);\r\n        } else if (a.AttributeType === \"List\" && a.ListType === \"Type\") {\r\n          ListValues = [];\r\n          a.ListValues.forEach(v => {\r\n            ListValues.push(thingMap[v]._id);\r\n            thing.ReferenceIDs.push(thingMap[v]._id);\r\n          });\r\n        }\r\n        thing.Attributes.push({\r\n          attrID: attribute.attrID,\r\n          index: a.index,\r\n          Value,\r\n          ListValues\r\n        });\r\n      });\r\n      this.api.updateThing(thing).then(res => {\r\n        if (res.error === undefined) {\r\n          templateThing.status = \"Imported\";\r\n          this.setState(\r\n            { \r\n              importingThings,\r\n              stepInProgress: false\r\n            }, \r\n            this.takeNextStep\r\n          );\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.props.templateID !== this.state.templateID) {\r\n      let template = this.props.templates.filter(t => t._id === this.props.templateID);\r\n      if (template.length > 0) {\r\n        template = template[0];\r\n        const importingTypes = [];\r\n        template.Types.forEach(t => {\r\n          importingTypes.push({\r\n            status: \"Pending\",\r\n            templateType: t,\r\n            type: null\r\n          });\r\n        });\r\n        const importingAttributes = [];\r\n        template.Attributes.forEach(a => {\r\n          importingAttributes.push({\r\n            status: \"Pending\",\r\n            templateAttribute: a,\r\n            attribute: null\r\n          });\r\n        });\r\n        const importingThings = [];\r\n        if (template.Things !== undefined && template.Things !== null) {\r\n          template.Things.forEach(t => {\r\n            importingThings.push({\r\n              status: \"Pending\",\r\n              templateThing: t,\r\n              thing: null\r\n            });\r\n          });\r\n        }\r\n        this.setState(\r\n          { \r\n            templateID: this.props.templateID, \r\n            template, \r\n            importingTypes, \r\n            importingAttributes, \r\n            attributesStatus: \"Pending\",\r\n            importingThings, \r\n            play: true,\r\n            typeMap: {},\r\n            attributeMap: {},\r\n            thingMap: {},\r\n            stepInProgress: false\r\n          }, \r\n          this.takeNextStep\r\n        );\r\n      }\r\n    }\r\n    return (\r\n      <Grid item container spacing={1} direction=\"column\">\r\n        <Grid item>\r\n          <List>\r\n            <ListItem>\r\n              { this.state.play ? \r\n                <IconButton \r\n                  aria-label=\"Pause Import\"\r\n                  onClick={_ => {\r\n                    this.setState({ play: false });\r\n                  }}>\r\n                  <PauseCircleOutlineIcon />\r\n                </IconButton>\r\n              : \r\n                <IconButton \r\n                  aria-label=\"Pause Import\"\r\n                  onClick={_ => {\r\n                    this.setState({ play: true }, this.takeNextStep);\r\n                  }}>\r\n                  <PlayCircleOutlineIcon />\r\n                </IconButton>\r\n              }\r\n            </ListItem>\r\n          </List>\r\n        </Grid>\r\n        <Grid item>\r\n          Importing {this.props.templates.filter(t => t._id === this.props.templateID )[0].Name}.  Please Wait.\r\n        </Grid>\r\n        <Grid item>\r\n          Types:\r\n        </Grid>\r\n        { this.state.importingTypes.map((type, key) => {\r\n          return (\r\n            <Grid item key={key} container spacing={0} direction=\"row\">\r\n              <Grid item xs={6}>\r\n                {type.templateType.Name}\r\n              </Grid>\r\n              <Grid item xs={6} style={{ color: (type.status === \"Importing\" ? \"blue\" : (type.status === \"Imported\" ? \"green\" : \"grey\")) }}>\r\n                {type.status}\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        })}\r\n        <Grid item container spacing={0} direction=\"row\">\r\n          <Grid item xs={6}>\r\n            Attributes: \r\n          </Grid>\r\n          <Grid item xs={6} style={{ color: (this.state.attributesStatus === \"Importing\" ? \"blue\" : (this.state.attributesStatus === \"Imported\" ? \"green\" : \"grey\")) }}>\r\n            {this.state.attributesStatus}\r\n          </Grid>\r\n        </Grid>\r\n        { this.state.importingThings.length > 0 && \r\n          <Grid item container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              Things:\r\n            </Grid>\r\n            { this.state.importingThings.map((thing, key) => {\r\n              return (\r\n                <Grid item key={key} container spacing={0} direction=\"row\">\r\n                  <Grid item xs={6}>\r\n                    {thing.templateThing.Name}\r\n                  </Grid>\r\n                  <Grid item xs={6} style={{ color: (thing.status === \"Importing\" ? \"blue\" : (thing.status === \"Imported\" ? \"green\" : \"grey\")) }}>\r\n                    {thing.status}\r\n                  </Grid>\r\n                </Grid>\r\n              );\r\n            })}\r\n          </Grid>\r\n        }\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst ImportingTemplatesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default ImportingTemplatesControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  selectWorld, setTypes, setThings, setWorlds, \r\n  setPublicWorlds, updatePublicWorldForCollab,\r\n  setAttributes, \r\n  setTemplates,\r\n  setAllUsers,\r\n  updateAttributes,\r\n  notFromLogin,\r\n  toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport Index from \"./Index\";\r\nimport { \r\n  Edit, Delete, People\r\n} from \"@material-ui/icons\";\r\nimport {\r\n  List, ListItem, \r\n  Grid, Button, \r\n  Modal, Tooltip,\r\n  Fab, Box\r\n} from '@material-ui/core';\r\nimport { Helmet } from 'react-helmet';\r\nimport TemplateModal from \"../../components/Modals/TemplateModal\";\r\n// import TemplatesModal from \"../../components/Modals/TemplatesModal\";\r\nimport ImportTemplatesControl from \"../../components/WorldTemplateControls/ImportTemplatesControl\";\r\nimport ImportingTemplatesControl from \"../../components/WorldTemplateControls/ImportingTemplatesControl\";\r\nimport CommentsControl from \"../../components/Inputs/CommentsControl\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin,\r\n    templates: state.app.templates,\r\n    allUsers: state.app.allUsers,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setTemplates: templates => dispatch(setTemplates(templates)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    updatePublicWorldForCollab: world => dispatch(updatePublicWorldForCollab(world)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    updateAttributes: attributes => dispatch(updateAttributes(attributes)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      world: null,\r\n      modalOpen: false,\r\n      redirectTo: null,\r\n      templateMode: false,\r\n      importMode: false,\r\n      selectedTemplateIDs: []\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n  componentDidMount() {\r\n  }\r\n\r\n  getAttributes() {\r\n    this.api.getAttributesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // We store the attributes in two hashes, by name and by id\r\n        this.props.setAttributes(res.attributes);\r\n        this.getTypes();\r\n      }\r\n    });\r\n  }\r\n\r\n  getTypes() {\r\n    this.api.getTypesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // Add Supers to each type\r\n        const types = res.types;\r\n        const updateAttributes = [];\r\n        types.forEach(t=> {\r\n          t.Supers = [];\r\n          t.SuperIDs.forEach(sID=> {\r\n            t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n          });\r\n          t.AttributesArr = [];\r\n          t.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            attr.TypeIDs.push(t._id);\r\n            updateAttributes.push(attr);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: a.TypeIDs\r\n            });\r\n          });\r\n          const defHash = {};\r\n          if (t.Defaults !== undefined) {\r\n            t.Defaults.forEach(def => {\r\n              defHash[def.attrID] = def;\r\n            });\r\n          }\r\n          t.DefaultsHash = defHash;\r\n        });\r\n        this.props.updateAttributes(updateAttributes);\r\n        this.props.setTypes(types);\r\n        this.getThings();\r\n      }\r\n    });\r\n  }\r\n\r\n  getThings() {\r\n    this.api.getThingsForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        const things = res.things;\r\n        things.forEach(t=> {\r\n          t.Types = [];\r\n          t.TypeIDs.forEach(tID=> {\r\n            t.Types = t.Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n          });\r\n        });\r\n        this.props.setThings(things);\r\n      }\r\n    });\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteWorld(this.props.selectedWorldID).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getWorlds(true).then(res2 => {\r\n          this.props.setPublicWorlds(res2.publicWorlds.worlds);\r\n          this.props.setWorlds(res2.userWorlds.worlds);\r\n          this.props.setTemplates(res2.templates.templates);\r\n          this.props.setAllUsers(res2.allUsers);\r\n\r\n          this.props.selectWorld(null);\r\n          this.setState({modalOpen: false, redirectTo: `/`});\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error });\r\n      }\r\n    });\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  load = (id) => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    if (this.state.templateMode || this.state.importMode) {\r\n      this.setState({ \r\n        loading: true, templateMode: false, importMode: false \r\n      }, _ => {\r\n        this.props.selectWorld(id);\r\n        this.api.getWorld(id).then(res => {\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n          this.setState({ loading: false });\r\n        });\r\n      });\r\n    } else {\r\n      this.setState({ loading: true }, _ => {\r\n        this.props.selectWorld(id);\r\n        this.api.getWorld(id).then(res => {\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n          this.setState({ loading: false });\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  requestToCollaborate = () => {\r\n    this.api.requestToCollaborate(this.props.selectedWorldID).then(res => {\r\n      const world = this.props.selectedWorld;\r\n      world.Collaborators.push(res);\r\n      this.props.updatePublicWorldForCollab(world);\r\n    });\r\n  }\r\n\r\n  respondToInvite = () => {\r\n    const invite = this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\")[0];\r\n    this.setState({ redirectTo: `/project/collaborate/${this.props.selectedWorldID}/${invite.collabID}` });\r\n  }\r\n\r\n  updateTemplates = () => {\r\n    this.api.getTemplates().then(res => {\r\n      this.props.setTemplates(res.templates);\r\n      this.setState({ templateMode: false });\r\n    });\r\n  }\r\n\r\n  importSelectedTemplates = () => {\r\n    const templatesToImport = [...this.state.selectedTemplateIDs];\r\n    if (templatesToImport.length > 0) {\r\n      const template = {...this.props.templates.filter(t => t._id === templatesToImport[0])[0]};\r\n      this.importDumbTypesRecursive(0, template.Types, [], {}, template.Attributes, template.Name);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * This checks to see if a type by that name exists.\r\n   * If so then it merges their descriptions and majorness,\r\n   * then it puts it in the map.\r\n   * If not then it inserts it with just name, description, \r\n   * and majorness, and puts it in the map.\r\n   * After all the dumb types are merged or inserted and mapped,\r\n   * and after all the attributes are merged, upserted, and mapped,\r\n   * then we go through all the types and merge in their attributes.\r\n   */\r\n  importDumbTypesRecursive = (typePos, types, newTypes, typeMap, attributes, templateName) => {\r\n    // function next() {\r\n      \r\n    // }\r\n    const type = {...types[typePos]};\r\n    const typeID = type.typeID;\r\n    // Check for an existing Type with the same name.\r\n    let existingType = this.props.types.filter(t => t.Name.trim().toLowerCase() === type.Name.trim().toLowerCase());\r\n    if (existingType.length > 0) {\r\n      existingType = existingType[0];\r\n      typeMap[typeID] = existingType._id;\r\n      newTypes.push(existingType);\r\n      if (existingType.Description === type.Description && (existingType.Major || !type.Major)) {\r\n        // Sans attributes, they match, so we can just move on.\r\n        // next();\r\n        typePos++;\r\n        if (types.length === typePos) {\r\n          // We're done with all the types.\r\n          // Now for the attributes.\r\n          this.compareAndFixAttributes(types, newTypes, typeMap, attributes, templateName);\r\n        } else {\r\n          this.importDumbTypesRecursive(typePos, types, newTypes, typeMap, attributes, templateName);\r\n        }\r\n      } else {\r\n        if (existingType.Description !== type.Description) {\r\n          existingType.Description += ` From Template (${templateName}) ${type.Description}`;\r\n        }\r\n        if (type.Major)\r\n          existingType.Major = true;\r\n        if (existingType.PluralName === undefined || existingType.PluralName === \"\")\r\n          existingType.PluralName = type.PluralName;\r\n        this.api.updateType(existingType).then(res => {\r\n          // next();\r\n          typePos++;\r\n          if (types.length === typePos) {\r\n            // We're done with all the types.\r\n            // Now for the attributes.\r\n            this.compareAndFixAttributes(types, newTypes, typeMap, attributes, templateName);\r\n          } else {\r\n            this.importDumbTypesRecursive(typePos, types, newTypes, typeMap, attributes, templateName);\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      // Remove the attributes\r\n      delete type.typeID;\r\n      type.Attributes = [];\r\n      type.worldID = this.props.selectedWorldID;\r\n      // insert it\r\n      this.api.createType(type).then(res => {\r\n        if (res.error === undefined) {\r\n          // map it\r\n          typeMap[typeID] = res.typeID;\r\n          type._id = res.typeID;\r\n          newTypes.push(type);\r\n          // next();\r\n          typePos++;\r\n          if (types.length === typePos) {\r\n            // We're done with all the types.\r\n            // Now for the attributes.\r\n            this.compareAndFixAttributes(types, newTypes, typeMap, attributes, templateName);\r\n          } else {\r\n            this.importDumbTypesRecursive(typePos, types, newTypes, typeMap, attributes, templateName);\r\n          }\r\n        } else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * This goes through all the Attributes, \r\n   * and looks for existing Attributes with the same name.  \r\n   * If it finds one it checks to see if they're compatible \r\n   * (same type, etc).  \r\n   * If they're compatible then it merges them.  \r\n   * If not then the new one gets the template name appended to its name.\r\n   * Then they're upserted, and then all attributes are pulled, \r\n   * and it puts together a mapping of the ids to be used in the types.\r\n   */\r\n  compareAndFixAttributes = (types, newTypes, typeMap, attributes, templateName) => {\r\n    const upsertUs = [];\r\n    const nameChanges = {\r\n      // oldName: newName\r\n    };\r\n    attributes.forEach(a => {\r\n      const attribute = {...a};\r\n      delete attribute.attrID;\r\n      if (attribute.AttributeType === \"Type\" || (attribute.AttributeType === \"List\" && attribute.ListType === \"Type\")) {\r\n        // We need to fix DefinedType\r\n        attribute.DefinedType = typeMap[attribute.DefinedType];\r\n      }\r\n      const existingAttribute = this.props.attributesByName[attribute.Name];\r\n      if (existingAttribute !== undefined) {\r\n        // We've got a matching name.  Check if the types match.\r\n        if (attribute.AttributeType !== existingAttribute.AttributeType || (attribute.AttributeType === \"List\" && attribute.ListType !== existingAttribute.ListType)) {\r\n          // They don't, so we need to change the name.\r\n          attribute.Name += ` From Template (${templateName})`;\r\n          nameChanges[existingAttribute.Name] = attribute.Name;\r\n        } else {\r\n          // It matches, so we can merge them.\r\n          attribute._id = existingAttribute._id;\r\n          if (attribute.AttributeType === \"Options\" || (attribute.AttributeType === \"List\" && attribute.ListType === \"Options\")) {\r\n            // It's Options, so we need to merge the Options.\r\n            const attrOptions = attribute.Options;\r\n            attribute.Options = existingAttribute.Options;\r\n            attrOptions.forEach(o => {\r\n              if (!attribute.Options.includes(o))\r\n                attribute.Options.push(o);\r\n            });\r\n          }\r\n        }\r\n      }\r\n      attribute.worldID = this.props.selectedWorldID;\r\n      upsertUs.push(attribute);\r\n    });\r\n    // We've compared them, now we upsert.\r\n    this.api.upsertAttributes(this.props.selectedWorldID, upsertUs).then(res => {\r\n      // Now we need to build the map\r\n      const attrMap = {\r\n        // templateID: realID\r\n      };\r\n      attributes.forEach(a => {\r\n        if (nameChanges[a.Name] !== undefined) {\r\n          // The name changed so use the new name.\r\n          attrMap[a.attrID] = res.attributes[nameChanges[a.Name]];\r\n        } else {\r\n          attrMap[a.attrID] = res.attributes[a.Name];\r\n        }\r\n      });\r\n      // The map is built, so now we're done here, and we need to update the types with their attributes\r\n      this.addAttributesToDumbTypesRecursive(0, types, newTypes, typeMap, attributes, attrMap, templateName);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Goes through each type and adds its attributes onto its \r\n   * corresponding type in newTypes, updates, then sends it back \r\n   * to the beginning of the process.\r\n   * \r\n   */\r\n  addAttributesToDumbTypesRecursive = (typePos, types, newTypes, typeMap, attributes, attrMap, templateName) => {\r\n    const type = types[typePos];\r\n    const newType = newTypes[typePos];\r\n    if (type.Name !== newType.Name) {\r\n      console.log(\"Names don't match\");\r\n      // If this happens then I did something wrong.  Should never happen\r\n    }\r\n    else {\r\n      // function next() {\r\n        \r\n      // }\r\n      let attributesAdded = false;\r\n      if (newType.Attributes.length === 0) {\r\n        // It's not a merged type, so just add the attributes.\r\n        let index = 0;\r\n        type.Attributes.forEach(attr => {\r\n          const realID = attrMap[attr.attrID];\r\n          newType.Attributes.push({\r\n            attrID: realID, index\r\n          });\r\n          index++;\r\n          attributesAdded = true;\r\n        });\r\n      } else {\r\n        // It's a merged type, so we need to check each attribute to see if it's already on it.\r\n        let index = newType.Attributes.length;\r\n        type.Attributes.forEach(attr => {\r\n          const realID = attrMap[attr.attrID];\r\n          if (newType.Attributes.filter(a => a.attrID === realID).length === 0) {\r\n            newType.Attributes.push({\r\n              attrID: realID, index\r\n            });\r\n            index++;\r\n            attributesAdded = true;\r\n          }\r\n        });\r\n      }\r\n      if (attributesAdded) {\r\n        // Update the type\r\n        this.api.updateType(newType).then(res => {\r\n          if (res.error === undefined) {\r\n            // Done.  Move on.\r\n            // next();\r\n            typePos++;\r\n            if (types.length === typePos) {\r\n              // We're done with all the types.\r\n              // Now we see if there's another selected template.\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res => {\r\n                this.props.setAttributes(res.attributes);\r\n                this.props.setTypes(res.types);\r\n                this.props.setThings(res.things);\r\n\r\n                let templateIDs = [...this.state.selectedTemplateIDs];\r\n                templateIDs.splice(0, 1);\r\n                this.setState({ selectedTemplateIDs: templateIDs });\r\n              });\r\n            } else {\r\n              this.addAttributesToDumbTypesRecursive(typePos, types, newTypes, typeMap, attributes, attrMap, templateName);\r\n            }\r\n          } else {\r\n            console.log(res.error);\r\n          }\r\n        });\r\n      } else {\r\n        // Nothing to update.  Move on.\r\n        // next();\r\n        typePos++;\r\n        if (types.length === typePos) {\r\n          // We're done with all the types.\r\n          // Now we see if there's another selected template.\r\n          this.api.getWorld(this.props.selectedWorldID, true).then(res => {\r\n            this.props.setAttributes(res.attributes);\r\n            this.props.setTypes(res.types);\r\n            this.props.setThings(res.things);\r\n\r\n            let templateIDs = [...this.state.selectedTemplateIDs];\r\n            templateIDs.splice(0, 1);\r\n            this.setState({ selectedTemplateIDs: templateIDs });\r\n          });\r\n        } else {\r\n          this.addAttributesToDumbTypesRecursive(typePos, types, newTypes, typeMap, attributes, attrMap, templateName);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if ((this.props.worlds.length > 0 || this.props.publicWorlds.length > 0) && (this.props.selectedWorldID === null || this.props.selectedWorldID !== id)) {\r\n      this.load(id);\r\n      return (<span>Loading</span>);\r\n    } else if (this.state.loading) {\r\n      return (<span>Loading</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.state.templateMode) {\r\n      return (\r\n        <TemplateModal \r\n          world={this.props.selectedWorld} \r\n          types={this.props.types}\r\n          things={this.props.things}\r\n          attributesByID={this.props.attributesByID}\r\n          templates={this.props.templates} \r\n          onSave={_ => {\r\n            this.updateTemplates();\r\n          }}\r\n          onCancel={_ => {\r\n            this.setState({ templateMode: false });\r\n          }}\r\n          api={this.api} />\r\n      );\r\n    } else if (this.state.importMode) {\r\n      return (\r\n        <ImportTemplatesControl \r\n          templates={this.props.templates} \r\n          onSubmit={selectedTemplateIDs => {\r\n            setTimeout(() => {\r\n              this.setState(\r\n                { \r\n                  selectedTemplateIDs, \r\n                  importMode: false \r\n                }\r\n              );\r\n            }, 500);\r\n          }}\r\n          onCancel={_ => {\r\n            this.setState({ importMode: false });\r\n          }} \r\n        />\r\n      );\r\n    } else if (this.state.selectedTemplateIDs.length > 0) {\r\n      return (\r\n        <ImportingTemplatesControl \r\n          templateID={this.state.selectedTemplateIDs[0]} \r\n          onComplete={_ => {\r\n            this.api.getWorld(id, true).then(res => {\r\n              this.props.setAttributes(res.attributes);\r\n              this.props.setTypes(res.types);\r\n              this.props.setThings(res.things);\r\n\r\n              setTimeout(() => {\r\n                const selectedTemplateIDs = [...this.state.selectedTemplateIDs];\r\n                selectedTemplateIDs.shift();\r\n                this.setState({ selectedTemplateIDs });\r\n              }, 500);\r\n            });\r\n          }}\r\n          onCancel={_ => {\r\n            this.setState({ selectedTemplateIDs: [] });\r\n          }}\r\n        />\r\n      );\r\n    } else {\r\n      const suggestions = [...this.props.typeSuggestions, ...this.props.thingSuggestions];\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          {this.props.selectedWorld !== null && \r\n            <Grid item container spacing={0} direction=\"row\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item xs={12} sm={8} container spacing={0} direction=\"column\">\r\n                <Grid item>\r\n                  <h2>{this.props.selectedWorld.Name}</h2>\r\n                </Grid>\r\n                <Grid item>\r\n                  <div  dangerouslySetInnerHTML={{__html: this.props.selectedWorld.Description}} />\r\n                  {/* {this.props.selectedWorld.Description} */}\r\n                </Grid>\r\n                <Grid item>\r\n                  <Box display={{ xs: 'none', sm: 'block' }}>\r\n                    <Index />\r\n                  </Box>\r\n                </Grid>\r\n              </Grid>\r\n              { this.props.user !== null &&\r\n                <Grid item xs={12} sm={4}>\r\n                  { this.props.selectedWorld.Owner === this.props.user._id ?\r\n                    <List>\r\n                      <ListItem>\r\n                        <Grid container spacing={1} direction=\"row\">\r\n                          <Grid item xs={4} sm={12}>\r\n                            <Tooltip title={`Edit ${this.props.selectedWorld.Name}`}>\r\n                              <Fab size=\"small\" color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/project/edit/${this.props.selectedWorldID}`})}}\r\n                              >\r\n                                <Edit />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                          <Grid item xs={4} sm={12}>\r\n                            <Tooltip title={`Edit Collaborators`}>\r\n                              <Fab size=\"small\" color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/project/collaborators/${this.props.selectedWorldID}`})}}\r\n                              >\r\n                              <People />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                          <Grid item xs={4} sm={12}>\r\n                            <Tooltip title={`Delete ${this.props.selectedWorld.Name}`}>\r\n                              <Fab size=\"small\" color=\"primary\"\r\n                                onClick={e => {this.setState({modalOpen: true})}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      </ListItem>\r\n                      <ListItem>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={_ => {\r\n                            this.setState({ templateMode: true });\r\n                          }}\r\n                        >\r\n                          Create a Template\r\n                        </Button>\r\n                      </ListItem>\r\n                      <ListItem>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={_ => {\r\n                            this.setState({ importMode: true });\r\n                          }}\r\n                        >\r\n                          Import Templates\r\n                        </Button>\r\n                      </ListItem>\r\n                    </List>\r\n                  : \r\n                    <List>\r\n                      { this.props.selectedWorld.Collaborators !== undefined && this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id).length === 0 ?\r\n                        <ListItem>\r\n                          { this.props.selectedWorld.AcceptingCollaborators && \r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={this.requestToCollaborate}\r\n                              type=\"button\"\r\n                            >\r\n                              Request to Collaborate\r\n                            </Button>\r\n                          }\r\n                        </ListItem>\r\n                      : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"request\").length > 0 ?\r\n                        <ListItem>\r\n                          Waiting on Collaboration Request\r\n                        </ListItem>\r\n                      : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\").length > 0 &&\r\n                        <ListItem>\r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={this.respondToInvite}\r\n                            type=\"button\"\r\n                          >\r\n                            You've been invited to Collaborate\r\n                          </Button>\r\n                        </ListItem>\r\n                      }\r\n                    </List>\r\n                  }\r\n                </Grid>\r\n              }\r\n              <Grid item xs={12}>\r\n                <Box display={{ xs: 'block', sm: 'none' }}>\r\n                  <Index />\r\n                </Box>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <CommentsControl \r\n                  user={this.props.user} \r\n                  allUsers={this.props.allUsers}\r\n                  object={this.props.selectedWorld}\r\n                  objectType=\"World\"\r\n                  world={this.props.selectedWorld}\r\n                  api={this.api} \r\n                  onChange={this.commentsChange}\r\n                  suggestions={suggestions}\r\n                /> \r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          <Modal\r\n              aria-labelledby=\"delete-thing-modal\"\r\n              aria-describedby=\"delete-thing-modal-description\"\r\n              open={this.state.modalOpen}\r\n              onClose={e => {this.setState({modalOpen: false})}}\r\n            >\r\n              <div style={this.getModalStyle()} className=\"paper\">\r\n                <Grid container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    Are you sure you want to delete {this.props.selectedWorld !== null ? this.props.selectedWorld.Name : \"\"}?\r\n                  </Grid>\r\n                  <Grid item>\r\n                    (All external references to it will be left alone and may not work correctly)\r\n                  </Grid>\r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={this.delete}\r\n                      >\r\n                        Yes\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        onClick={e => {this.setState({modalOpen: false})}}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\nconst WorldDetailsPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldDetailsPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectWorld,\r\n  addAndSelectWorld,\r\n  updateWorld,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  logout\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, Tooltip, Fab\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n// import TemplatesModal from \"../../components/Modals/TemplatesModal\";\r\nimport ImportTemplatesControl from \"../../components/WorldTemplateControls/ImportTemplatesControl\";\r\nimport ImportingTemplatesControl from \"../../components/WorldTemplateControls/ImportingTemplatesControl\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin,\r\n    templates: state.app.templates,\r\n    types: state.app.types,\r\n    attributesByName: state.app.attributesByName,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    addAndSelectWorld: world => dispatch(addAndSelectWorld(world)),\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      // _id: null, // This gets used, but I'm intentionally making it undefined to start\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Public: false,\r\n      AcceptingCollaborators: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      loaded: true,\r\n      importMode: false,\r\n      selectedTemplateIDs: [],\r\n      tempSelectedTemplateIDs: []\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  }\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Project Names\";\r\n        else if (value.length < 4) {\r\n          valid = false;\r\n          message = \"Project Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.worlds.filter(\r\n              w => w.Name === value && w._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Project Name is already in use\";\r\n        }\r\n        break;\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  }\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  }\r\n\r\n  /**\r\n   * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p><p><br></p>\r\n   * gets translated to \r\n   * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p>\r\n   */\r\n  cleanWYSIWYG = (str) => {\r\n    if (str.endsWith(\"<p><br></p>\")) {\r\n      str = str.substring(0, str.length - 11);\r\n    }\r\n    return str;\r\n  }\r\n\r\n  submitThroughAPI = () => {\r\n    const world = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Description: this.cleanWYSIWYG(this.state.Description.trim()),\r\n      Public: this.state.Public,\r\n      AcceptingCollaborators: this.state.AcceptingCollaborators,\r\n      Owner: this.props.user._id\r\n    };\r\n\r\n    if (world._id === null) {\r\n      this.api\r\n        .createWorld(world)\r\n        .then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({ message: res.error }, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n          else {\r\n            world._id = res.worldID;\r\n            this.props.addAndSelectWorld(world);\r\n            // this.props.selectWorld(world._id);\r\n            if (this.state.tempSelectedTemplateIDs === undefined || this.state.tempSelectedTemplateIDs.length === 0) {\r\n              this.setState({\r\n                waiting: false,\r\n                redirectTo: `/project/details/${res.worldID}`\r\n              });\r\n            } else {\r\n              this.setState({\r\n                selectedTemplateIDs: this.state.tempSelectedTemplateIDs,\r\n                tempSelectedTemplateIDs: []\r\n              });\r\n            }\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateWorld(world)\r\n        .then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({ message: res.error }, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n          else {\r\n            this.props.updateWorld(world);\r\n            if (this.state.tempSelectedTemplateIDs === undefined || this.state.tempSelectedTemplateIDs.length === 0) {\r\n              this.setState({\r\n                waiting: false,\r\n                redirectTo: `/project/details/${this.props.selectedWorldID}`\r\n              });\r\n            } else {\r\n              this.setState({\r\n                selectedTemplateIDs: this.state.tempSelectedTemplateIDs,\r\n                tempSelectedTemplateIDs: []\r\n              });\r\n            }\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      if (this.props.selectedWorldID !== id) {\r\n        this.props.selectWorld(id);\r\n      }\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.state._id === null) {\r\n      this.setState({\r\n        Name: \"\",\r\n        Description: \"\",\r\n        AcceptingCollaborators: false,\r\n        Public: false,\r\n        loaded: true\r\n      });\r\n    }\r\n    else {\r\n      this.props.selectWorld(this.state._id);\r\n      this.api.selectWorld(this.state._id).then(res => {\r\n        this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n\r\n          this.setState({\r\n            Name: this.props.selectedWorld.Name,\r\n            Description: this.props.selectedWorld.Description === undefined ? \"\" : this.props.selectedWorld.Description,\r\n            AcceptingCollaborators: this.props.selectedWorld.AcceptingCollaborators === undefined ? false : this.props.selectedWorld.AcceptingCollaborators,\r\n            Public: this.props.selectedWorld.Public,\r\n            loaded: true\r\n          });\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading...</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.state._id !== null && this.props.selectedWorld !== null && \r\n      (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.state.importMode) {\r\n      return (\r\n        <ImportTemplatesControl \r\n          templates={this.props.templates} \r\n          selectedTemplateIDs={this.state.tempSelectedTemplateIDs}\r\n          onSubmit={ tempSelectedTemplateIDs => {\r\n            this.setState({ tempSelectedTemplateIDs, importMode: false });\r\n          }}\r\n          onCancel={_ => {\r\n            this.setState({ importMode: false });\r\n          }} \r\n        />\r\n      );\r\n    } else if (this.state.selectedTemplateIDs.length > 0) {\r\n      return (\r\n        <ImportingTemplatesControl \r\n          templateID={this.state.selectedTemplateIDs[0]} \r\n          onComplete={_ => {\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res => {\r\n              this.props.setAttributes(res.attributes);\r\n              this.props.setTypes(res.types);\r\n              this.props.setThings(res.things);\r\n\r\n              setTimeout(() => {\r\n                const selectedTemplateIDs = [...this.state.selectedTemplateIDs];\r\n                selectedTemplateIDs.shift();\r\n                if (selectedTemplateIDs.length > 0) {\r\n                  this.setState({ selectedTemplateIDs });\r\n                } else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/project/details/${this.props.selectedWorldID}`\r\n                  });\r\n                }\r\n              }, 500);\r\n            });\r\n          }}\r\n          onCancel={_ => {\r\n            this.setState({ selectedTemplateIDs: [] });\r\n          }}\r\n        />\r\n      );\r\n    } else {\r\n      const suggestions = [...this.props.typeSuggestions, ...this.props.thingSuggestions];\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              { this.props.selectedWorld !== null &&\r\n                <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                  <Fab size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={ _ => {this.setState({redirectTo:`/project/details/${this.props.selectedWorldID}`})}}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>\r\n              }\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>\r\n                {this.state._id === null ? \"Create New Project\" : \"Edit Project\"}\r\n              </h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <TextBox \r\n              Value={this.state.Description} \r\n              fieldName=\"Description\" \r\n              multiline={true}\r\n              onBlur={desc => {\r\n                this.setState({ Description: desc });\r\n                // const type = this.props.selectedType;\r\n                // type.Description = desc;\r\n                // this.props.updateSelectedType(type);\r\n              }}\r\n              labelWidth={82}\r\n              options={suggestions}\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.Public}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"Public\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Public\"\r\n            />\r\n            { this.state.Public ?\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.AcceptingCollaborators}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"AcceptingCollaborators\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Accepting Collaborator Requests\"\r\n            /> : \"\" }\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          { this.state.tempSelectedTemplateIDs !== undefined && this.state.tempSelectedTemplateIDs.length > 0 &&\r\n            <Grid item>Templates will be imported on submit</Grid>\r\n          }\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={12} sm={4}>\r\n              <Button\r\n                variant=\"contained\"\r\n                fullWidth\r\n                color=\"primary\"\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  this.setState({ importMode: true });\r\n                }}\r\n                type=\"submit\"\r\n              >\r\n                Import Templates\r\n              </Button>\r\n            </Grid>\r\n            <Grid item xs={12} sm={4}>\r\n              <Button\r\n                variant=\"contained\"\r\n                fullWidth\r\n                color=\"primary\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n            </Grid>\r\n            <Grid item xs={12} sm={4}>\r\n              <Button\r\n                variant=\"contained\"\r\n                fullWidth\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  this.setState({\r\n                    redirectTo: this.state._id === null ? `/` : `/project/details/${this.state._id}`\r\n                  });\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst WorldEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldEditPage;","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport { \r\n  userLogin, setWorlds, setFollowingWorlds, setAllUsers\r\n} from \"../../redux/actions/index\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Cookies from \"universal-cookie\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    // selectedPage: state.app.selectedPage, \r\n    user: state.app.user, \r\n    loginError: state.app.loginError,\r\n    followingWorlds: state.app.followingWorlds,\r\n    allUsers: state.app.allUsers\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    userLogin: user => dispatch(userLogin(user)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const cookies = new Cookies();\r\n    const emailCookie = cookies.get('email');\r\n    const passCookie = cookies.get('password');\r\n    this.state = {\r\n      formMode: \"login\",\r\n      email: (emailCookie === undefined ? \"\" : emailCookie),\r\n      password: (passCookie === undefined ? \"\" : passCookie),\r\n      confirmEmail: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        email: { valid: true, message: \"\" }, \r\n        password: { valid: true, message: \"\" }, \r\n        confirmEmail: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" },\r\n        username: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      remember: false,\r\n      message: \"\",\r\n      username: \"\",\r\n      // redirectTo: null,\r\n      // allUsers: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    if (this.state.email) {\r\n      this.validateField(\"email\");\r\n      this.validateField(\"password\");\r\n      this.setState({remember: true});\r\n    }\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        if (valid && this.props.allUsers.filter(u=>u.username === value).length !== 0) {\r\n          valid = false;\r\n          message = \"This Username is taken\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const emailValid = this.validateField(\"email\");\r\n    let confirmEmailValid = { valid: true, message: \"\" };\r\n    let passwordValid = { valid: true, message: \"\" };\r\n    let confirmPasswordValid = { valid: true, message: \"\" };\r\n    let usernameValid = { valid: true, message: \"\" };\r\n    switch (this.state.formMode) {\r\n      case \"Login\":\r\n        passwordValid = this.validateField(\"password\");\r\n        break;\r\n      case \"Register\":\r\n        confirmEmailValid = this.validateField(\"confirmEmail\");\r\n        passwordValid = this.validateField(\"password\");\r\n        confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n        usernameValid = this.validateField(\"username\");\r\n      break;\r\n      default:\r\n      break;\r\n    }\r\n    const formValid = \r\n      emailValid.valid && \r\n      passwordValid.valid && \r\n      confirmEmailValid.valid && \r\n      confirmPasswordValid.valid && \r\n      usernameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.email = emailValid;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmEmail = confirmEmailValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    fieldValidation.username = usernameValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      email: this.state.email.trim(),\r\n      password: this.state.password,\r\n      username: this.state.username.trim(),\r\n      followingWorlds: this.props.followingWorlds\r\n    };\r\n    if (this.state.formMode === \"login\") {\r\n      this.api.login(user, this.state.remember).then(res => {\r\n        if (res.user === null) {\r\n          let errors = this.state.fieldValidation;\r\n          errors.loginError = { message: res.error, valid: false, show: true };\r\n          this.setState({ fieldValidation: errors, waiting: false });\r\n        }\r\n        else {\r\n          this.props.userLogin(res.user);\r\n          this.api.getWorldsForUser(res.user._id).then(res => {\r\n            this.props.setWorlds(res.worlds);\r\n            this.props.onLogin(res.user);\r\n            // this.setState({ redirectTo: \"/\" });\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"register\") {\r\n      this.api.register(user).then(res => {\r\n        if (res.error === undefined) {\r\n          this.setState({ \r\n            message: res.message, \r\n            formMode: \"login\", \r\n            fieldValidation: { \r\n              email: { valid: true, message: \"\" }, \r\n              password: { valid: true, message: \"\" }, \r\n              confirmEmail: { valid: true, message: \"\" }, \r\n              confirmPassword: { valid: true, message: \"\" },\r\n              username: { valid: true, message: \"\" }\r\n            },\r\n            waiting: false\r\n          }, _ => {\r\n            this.api.getAllUsers(true).then(users => {\r\n              this.props.setAllUsers(users);\r\n              // this.setState({allUsers: res});\r\n            });\r\n          });\r\n        }\r\n        else {\r\n          this.setState({ \r\n            message: res.error,\r\n            waiting: false\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"password\") {\r\n      this.api.sendReset(user).then(res => {\r\n        this.setState({ message: res.message, \r\n          formMode: \"login\", \r\n          fieldValidation: { \r\n            email: { valid: true, message: \"\" }, \r\n            password: { valid: true, message: \"\" }, \r\n            confirmEmail: { valid: true, message: \"\" }, \r\n            confirmPassword: { valid: true, message: \"\" },\r\n            username: { valid: true, message: \"\" }\r\n          },\r\n          waiting: false \r\n        });\r\n      })\r\n      .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  loginClick = () => {\r\n    this.setState({ formMode: \"login\" });\r\n  };\r\n\r\n  registerClick = () => {\r\n    this.setState({ formMode: \"register\" });\r\n  };\r\n\r\n  passwordClick = () => {\r\n    this.setState({ formMode: \"password\" });\r\n  };\r\n\r\n  render() {\r\n    if (this.props.allUsers === null) {\r\n      this.api.getAllUsers(true).then(res => {\r\n        this.props.setAllUsers(res);\r\n        // this.setState({allUsers: res});\r\n      });\r\n      return (<div></div>);\r\n    }\r\n    // else if (this.state.redirectTo !== null && \r\n    //   this.props.user !== null && \r\n    //   this.props.user !== undefined && \r\n    //   this.props.user.username !== undefined && \r\n    //   this.props.user.username !== \"\") {\r\n    //   return (<Redirect to={this.state.redirectTo} />);\r\n    // }\r\n    else {\r\n      if (this.state.formMode === \"login\") {\r\n        return (\r\n          <div>\r\n            <h2>Login</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        value={this.state.email}\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          checked={this.state.remember}\r\n                          onChange={this.handleUserInput}\r\n                          name=\"remember\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Stay Signed In\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"register\") {\r\n        return (\r\n          <div>\r\n            <h2>Register</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"username\">Username</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"username\"\r\n                            name=\"username\"\r\n                            type=\"text\"\r\n                            value={this.state.username}\r\n                            error={ !this.state.fieldValidation.username.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={80}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.username.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={this.state.email}\r\n                            error={ !this.state.fieldValidation.email.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={40}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                          fullWidth>\r\n                          <InputLabel htmlFor=\"confirmEmail\">Confirm Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"confirmEmail\"\r\n                            name=\"confirmEmail\"\r\n                            type=\"email\"\r\n                            error={ !this.state.fieldValidation.confirmEmail.valid }\r\n                            value={this.state.confirmEmail}\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={100}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.confirmEmail.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div> \r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"confirm-password\"\r\n                        name=\"confirmPassword\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.confirmPassword}\r\n                        error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={130}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>{\" \"}\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"password\") {\r\n        return (\r\n          <div>\r\n            <h2>Forgot Password?</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        value={this.state.email}\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default LoginControl;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Button,\r\n  Grid\r\n} from \"@material-ui/core\";\r\nimport LoginControl from '../User/LoginControl';\r\nimport {\r\n  setWorlds,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      worldID: null,\r\n      collabID: null,\r\n      codeValid: false,\r\n      accepted: null,\r\n      message: \"Please wait.  Validating code.\",\r\n      world: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  accept = () => {\r\n    if (this.props.user === null) {\r\n      this.setState({waiting: false, accepted: true});\r\n    }\r\n    else {\r\n      this.setState({waiting: true},\r\n        this.submitAccept\r\n      );\r\n    }\r\n  }\r\n\r\n  submitAccept = () => {\r\n    this.api.acceptCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: true}, this.getWorlds);\r\n    });\r\n  }\r\n\r\n  getWorlds = () => {\r\n    this.api.getWorldsForUser().then(res => {\r\n      if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n      this.refreshWorld();\r\n    });\r\n  }\r\n\r\n  refreshWorld = () => {\r\n    this.api.getWorld(this.state.worldID, true).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n    });\r\n  }\r\n\r\n  onLoginAccept = (user) => {\r\n    this.setState({waiting: true},\r\n      this.submitAccept\r\n    );\r\n  }\r\n\r\n  decline = () => {\r\n    this.setState({waiting: true},\r\n      this.submitDecline\r\n    );\r\n  }\r\n\r\n  submitDecline = () => {\r\n    this.api.declineCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: false}, this.refreshWorld);\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.collabID === null) {\r\n      const { worldID, collabID } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkCollabID(worldID, collabID).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({collabID, worldID, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({collabID, worldID, world: res.world, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      if (this.state.accepted === null) {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              <h2>You've been invited to collaborate on {this.state.world.Name}</h2>\r\n            </Grid>\r\n            <Grid item xs={12} container spacing={1}>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.accept}\r\n                  type=\"button\">\r\n                  Accept\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.decline}\r\n                  type=\"button\">\r\n                  Decline\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n      else if (this.state.accepted) {\r\n        if (this.props.user === null) {\r\n          return (\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <h2>Please log in (or register and then log in if you're new) so we can add you as a collaborator on {this.state.world.Name}.</h2>\r\n              </Grid>\r\n              <Grid item>\r\n                <LoginControl onLogin={this.onLoginAccept}/>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={12}>\r\n                <h2>Congratulations! You can now collaborate on {this.state.world.Name}</h2>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              Okay.  Well, we hope you enjoy working on other projects.\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst CollaboratePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default CollaboratePage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateWorld, selectWorld,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  setAllUsers\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, \r\n  ListItem, ListItemText, \r\n  Tooltip, Fab, AppBar, Tabs, Tab, Box, \r\n  InputAdornment, IconButton,\r\n  Select, MenuItem\r\n} from \"@material-ui/core\";\r\nimport { Add, ArrowBack, FileCopyOutlined, Delete, Check } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index } = props;\r\n\r\n  return (\r\n    <div>{value === index && <Box p={3}>{children}</Box>}</div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user,\r\n    fromLogin: state.app.fromLogin,\r\n    allUsers: state.app.allUsers\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Collaborators: [],\r\n      // allUsers: null,\r\n      fieldValidation: {\r\n        inviteEmail: { valid: true, message: \"\" }\r\n      },\r\n      message: \"\",\r\n      redirectTo: null,\r\n      newCollaborators: false,\r\n      newCollabTab: 0,\r\n      collabTab: 0,\r\n      collabLink: null,\r\n      collabLinkCopied: false,\r\n      selectedUser: \"\",\r\n      inviteEmail: \"\",\r\n      inviteMessage: \"\", \r\n      waiting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  addNewCollaborator = () => {\r\n    function respond() {\r\n      this.api.addNewCollaborator(this.props.selectedWorldID, this.state.selectedUser._id, this.state.selectedUser.email).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, \r\n            inviteMessage: \"Invite Sent\",\r\n            selectedUser: \"\",\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  emailCollaborator = () => {\r\n    const emailValid = this.validateField(\"inviteEmail\");\r\n    if (emailValid) {\r\n      function respond() {\r\n        this.api.emailCollaborator(this.props.selectedWorldID, this.state.inviteEmail).then(res => {\r\n          if (res.error === undefined) {\r\n            const collabs = [...this.state.Collaborators];\r\n            collabs.push(res);\r\n            const world = this.props.selectedWorld;\r\n            world.Collaborators = collabs;\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              Collaborators: collabs, \r\n              inviteMessage: \"Email Sent\", \r\n              inviteEmail: \"\",\r\n              waiting: false\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error, waiting: false}, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n        });\r\n      }\r\n      this.setState({waiting: true}, respond);\r\n    }\r\n  }\r\n\r\n  updateCollaboratorPermission = (collaborator, permission) => {\r\n    collaborator.editPermission = permission;\r\n    function respond() {\r\n      this.api.updateCollaboratorPermission(this.props.selectedWorldID, collaborator.collabID, permission).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          const collab = collabs.filter(c=>c.collabID === collaborator.collabID)[0];\r\n          collab.editPermission = permission;\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Creates a collab invite on the world, but no user or email associated\r\n  generateCollabLink = () => {\r\n    function respond() {\r\n      this.api.generateCollabLink(this.props.selectedWorldID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  deleteCollab = (collab) => {\r\n    function respond() {\r\n      this.api.deleteCollab(this.props.selectedWorldID, collab.collabID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = this.state.Collaborators.filter(c=>c.collabID !== collab.collabID);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  acceptCollab = (collab) => {\r\n    function respond() {\r\n      this.api.acceptCollabRequest(this.props.selectedWorldID, collab.collabID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          const collab2 = collabs.filter(c => c.collabID === collab.collabID)[0];\r\n          collab2.type = \"collab\";\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false}, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Copies the collaborator link to the user's clipboard\r\n  copyCollabLink = () => {\r\n    const el = this.generatedLink;\r\n    const textarea = el.children[0];\r\n    textarea.select();\r\n    document.execCommand(\"copy\");\r\n    this.setState({collabLinkCopied: true});\r\n  }\r\n\r\n  load = (id) => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    \r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    this.api.selectWorld(this.state._id);\r\n    this.props.selectWorld(this.state._id);\r\n    this.api.getWorld(this.state._id).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n      \r\n      if (this.props.allUsers.length === 0) {\r\n        this.api.getAllUsers().then(res => {\r\n          this.props.setAllUsers(res);\r\n          this.setState({\r\n            // allUsers: res, \r\n            loaded: true}, \r\n            this.actuallyFinishLoading);\r\n        });\r\n      } else {\r\n        // this.api.getAllUsers().then(res => {\r\n        this.setState({\r\n          // allUsers: res, \r\n          loaded: true}, \r\n          this.actuallyFinishLoading);\r\n        // });\r\n      }\r\n    });\r\n  }\r\n\r\n  actuallyFinishLoading = () => {\r\n    let world = this.props.worlds.filter(w => w._id === this.state._id);\r\n    if (world.length > 0) {\r\n      world = world[0];\r\n      this.setState({\r\n        Name: world.Name,\r\n        Public: world.Public,\r\n        AcceptingCollaborators: world.AcceptingCollaborators === undefined || world.AcceptingCollaborators === null ? false : world.AcceptingCollaborators,\r\n        Collaborators: world.Collaborators === undefined ? [] : world.Collaborators\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading...</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      this.props.selectedWorld.Owner !== this.props.user._id) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const collabs = this.state.Collaborators.filter(c=>c.type===\"collab\");\r\n      const invites = this.state.Collaborators.filter(c=>c.type===\"invite\");\r\n      const requests = this.state.Collaborators.filter(c=>c.type===\"request\");\r\n      const selectUsers = this.props.allUsers.filter(u=>u._id !== this.props.selectedWorld.Owner && this.state.Collaborators.filter(c=>c.userID === u._id).length === 0);\r\n      const userMenuItems = selectUsers.map((u, i) => {\r\n        return (\r\n          <MenuItem key={i} value={u}>\r\n            {u.username}\r\n          </MenuItem>\r\n        );\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name} Collaborators` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                <Fab size=\"small\"\r\n                  color=\"primary\"\r\n                  onClick={ _ => {this.setState({redirectTo:`/project/details/${this.props.selectedWorldID}`})}}\r\n                >\r\n                  <ArrowBack />\r\n                </Fab>\r\n              </Tooltip>\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>Edit Collaborators</h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <ListItem style={{maxWidth: \"200px\"}}>\r\n              <ListItemText primary=\"Collaborators\" />\r\n              { this.state.newCollaborators ?\r\n                <Tooltip title={`Manage Existing Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: false });\r\n                    }}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>  :\r\n                <Tooltip title={`Add New Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: true });\r\n                    }}\r\n                  >\r\n                    <Add />\r\n                  </Fab>\r\n                </Tooltip> \r\n              }\r\n            </ListItem>\r\n          </Grid>\r\n          { this.state.newCollaborators ?\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.newCollabTab} onChange={(_, newValue) => { this.setState({newCollabTab: newValue, inviteMessage: \"\"})}} aria-label=\"Add Collaborator Method\">\r\n                    <Tab label=\"Find Existing User\" {...this.a11yProps(0)} />\r\n                    <Tab label=\"Invite via Email\" {...this.a11yProps(1)} />\r\n                    <Tab label=\"Get an Invite Link\" {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.newCollabTab} index={0}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"user-select\" id=\"user-select-label\">\r\n                          Select a User\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"user-select-label\"\r\n                          id=\"user-select\"\r\n                          value={this.state.selectedUser}\r\n                          onChange={e => {\r\n                            this.setState({selectedUser: e.target.value, inviteMessage: \"\" })\r\n                          }}\r\n                          labelWidth={90}\r\n                        >\r\n                          {userMenuItems}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.selectedUser === \"\" || this.state.waiting}\r\n                        onClick={this.addNewCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={1}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"inviteEmail\">Collaborator Email</InputLabel>\r\n                        <OutlinedInput\r\n                          id=\"inviteEmail\"\r\n                          name=\"inviteEmail\"\r\n                          type=\"email\"\r\n                          autoComplete=\"Off\"\r\n                          error={!this.state.fieldValidation.inviteEmail.valid}\r\n                          value={this.state.inviteEmail}\r\n                          onChange={this.handleUserInput}\r\n                          onBlur={this.inputBlur}\r\n                          labelWidth={140}\r\n                          fullWidth\r\n                        />\r\n                        <FormHelperText>\r\n                          {this.state.fieldValidation.inviteEmail.message}\r\n                        </FormHelperText>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.emailCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={2}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Generate a single use link to send someone yourself\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.generateCollabLink}\r\n                      >\r\n                        Generate Link\r\n                      </Button> \r\n                    </Grid>\r\n                      { this.state.collabLink !== null && \r\n                        <Grid item>\r\n                          <OutlinedInput\r\n                            id=\"generatedLink\"\r\n                            name=\"generatedLink\"\r\n                            ref={(input) => this.generatedLink = input}\r\n                            type=\"text\"\r\n                            multiline={true}\r\n                            value={this.state.collabLink}\r\n                            // disabled={true}\r\n                            endAdornment={\r\n                              <InputAdornment position=\"end\">\r\n                                <IconButton\r\n                                  aria-label=\"copy to clipboard\"\r\n                                  onClick={this.copyCollabLink}\r\n                                  edge=\"end\"\r\n                                >\r\n                                  <FileCopyOutlined />\r\n                                </IconButton>\r\n                              </InputAdornment>\r\n                            }\r\n                            labelWidth={70}\r\n                            fullWidth\r\n                          />\r\n                          { this.state.collabLinkCopied && \r\n                            <span style={{fontColor: \"red\"}}>\r\n                              Link Copied to Clipboard\r\n                            </span>\r\n                          }\r\n                        </Grid>\r\n                      }\r\n                  </Grid>\r\n                  \r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid> :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.collabTab} onChange={(_, newValue) => { this.setState({collabTab: newValue})}} aria-label=\"Collaborators\">\r\n                    <Tab label={`Collaborators (${collabs.length})`} {...this.a11yProps(0)} />\r\n                    <Tab label={`Invites (${invites.length})`} {...this.a11yProps(1)} />\r\n                    <Tab label={`Requests (${requests.length})`} {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.collabTab} index={0}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { collabs.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={3}>\r\n                            {this.props.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <FormControlLabel\r\n                              control={\r\n                                <Checkbox \r\n                                  checked={c.editPermission} \r\n                                  disabled={this.state.waiting}\r\n                                  onChange={e => {\r\n                                    this.updateCollaboratorPermission(c, e.target.checked);\r\n                                  }}\r\n                                  color=\"primary\" />\r\n                              }\r\n                              label=\"Full Permissions\"\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Remove Collaborator`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={1}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { invites.map((c, key) => {\r\n                      let user = this.props.allUsers.filter(u=>u._id === c.userID);\r\n                      if (user.length === 0)\r\n                        user = null;\r\n                      else {\r\n                        user = user[0];\r\n                      }\r\n                      return (\r\n                        <Grid item container spacing={1} direction=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={9} container spacing={1} direction=\"column\">\r\n                            { user !== null &&\r\n                              <Grid item>\r\n                                Username: {user.username}\r\n                              </Grid>\r\n                            }\r\n                            { c.email !== \"\" &&\r\n                              <Grid item>\r\n                                Email: {c.email}\r\n                              </Grid>\r\n                            }\r\n                            <Grid item>\r\n                              Invite Link: {c.collabLink}\r\n                            </Grid>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Invite`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>  \r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={2}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { requests.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={6}>\r\n                            {this.props.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Accept Request`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={_ => {this.acceptCollab(c)}}\r\n                              >\r\n                                <Check />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Request`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={_ => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst EditCollaboratorPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default EditCollaboratorPage;","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  setTypes,\r\n  setAttributes,\r\n  setThings,\r\n  setAllUsers,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout,\r\n  selectWorld\r\n} from \"../../redux/actions/index\";\r\nimport { Edit, Delete, Add, ArrowBack } from \"@material-ui/icons\";\r\nimport {\r\n  Fab,\r\n  Modal,\r\n  Grid,\r\n  Button,\r\n  Tooltip,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n} from \"@material-ui/core\";\r\nimport { Helmet } from \"react-helmet\";\r\nimport API from \"../../smartAPI\";\r\nimport CommentsControl from \"../../components/Inputs/CommentsControl\";\r\nimport UnderConstruction from \"../../assets/img/under_construction.png\";\r\n// import ReactQuill from '../../components/Inputs/ReactQuill';\r\n// import '../../assets/css/quill.read-only.css';\r\n\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Super Types \r\n  to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = (state) => {\r\n  const type = state.app.selectedType;\r\n  const subTypes =\r\n    type === null\r\n      ? []\r\n      : state.app.types.filter((t) => t.SuperIDs.includes(type._id));\r\n  const things =\r\n    type === null\r\n      ? []\r\n      : state.app.things.filter((t) => t.TypeIDs.includes(type._id));\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: type,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    subTypes: subTypes,\r\n    instances: things,\r\n    user: state.app.user,\r\n    things: state.app.things,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin,\r\n    allUsers: state.app.allUsers,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: (type) => dispatch(updateSelectedType(type)),\r\n    addType: (type) => dispatch(addType(type)),\r\n    updateType: (type) => dispatch(updateType(type)),\r\n    setTypes: (types) => dispatch(setTypes(types)),\r\n    setAttributes: (attributes) => dispatch(setAttributes(attributes)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers)),\r\n    setThings: (things) => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false,\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    // load();\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n\r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  };\r\n\r\n  delete = (e) => {\r\n    this.api\r\n      .deleteType(this.props.selectedWorldID, this.state._id)\r\n      .then((res) => {\r\n        if (res.error === undefined) {\r\n          this.api.getWorld(this.props.selectedWorldID, true).then((res2) => {\r\n            this.props.setAttributes(res2.attributes);\r\n            this.props.setTypes(res2.types);\r\n            this.props.setThings(res2.things);\r\n\r\n            this.setState({\r\n              redirectTo: `/project/details/${this.props.selectedWorldID}`,\r\n            });\r\n          });\r\n          // this.getWorld().then(res2 => {\r\n          //   this.setState({redirectTo: `/project/details/${this.props.selectedWorldID}`});\r\n          // });\r\n        } else {\r\n          this.setState({ waiting: false, message: res.error }, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      });\r\n  };\r\n\r\n  load = (id) => {\r\n    // const { id } = this.props.match.params;\r\n    setTimeout(() => {\r\n      this.setState(\r\n        {\r\n          _id: id,\r\n          redirectTo: null,\r\n          loaded: false\r\n        },\r\n        this.finishLoading\r\n      );\r\n    }, 500);\r\n  };\r\n\r\n  finishLoading = () => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    const id = this.state._id;\r\n    if (id !== undefined) {\r\n      if (this.props.selectedWorldID) {\r\n        this.api.getWorld(this.props.selectedWorldID).then((res) => {\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n\r\n          if (id !== null) {\r\n            let type = res.types.filter((t) => t._id === id);\r\n            if (type.length > 0) {\r\n              type = type[0];\r\n\r\n              this.props.updateSelectedType(type);\r\n              this.setState({ loaded: true });\r\n            } else {\r\n              this.setState({ message: \"Invalid ID\", loaded: true });\r\n            }\r\n          } else {\r\n            this.props.updateSelectedType({\r\n              _id: null,\r\n              Name: \"\",\r\n              Description: \"\",\r\n              Supers: [],\r\n              SuperIDs: [],\r\n              AttributesArr: [],\r\n              Attributes: [],\r\n              Major: false,\r\n              NeedsWork: false,\r\n              DefaultsHash: {},\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        this.api.getWorldByTypeID(id).then((res) => {\r\n          console.log(res);\r\n          this.props.selectWorld(res.worldID);\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n\r\n          if (id !== null) {\r\n            let type = res.types.filter((t) => t._id === id);\r\n            if (type.length > 0) {\r\n              type = type[0];\r\n\r\n              this.props.updateSelectedType(type);\r\n              this.setState({ loaded: true });\r\n            } else {\r\n              this.setState({ message: \"Invalid ID\", loaded: true });\r\n            }\r\n          } else {\r\n            this.props.updateSelectedType({\r\n              _id: null,\r\n              Name: \"\",\r\n              Description: \"\",\r\n              Supers: [],\r\n              SuperIDs: [],\r\n              AttributesArr: [],\r\n              Attributes: [],\r\n              Major: false,\r\n              NeedsWork: false,\r\n              DefaultsHash: {},\r\n            });\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      this.props.updateSelectedType({\r\n        _id: null,\r\n        Name: \"\",\r\n        Description: \"\",\r\n        Supers: [],\r\n        AttributesArr: [],\r\n        Attributes: [],\r\n        Major: false,\r\n        NeedsWork: false\r\n      });\r\n    }\r\n  };\r\n\r\n  redirectToNext = () => {\r\n    // Find the next type\r\n    let index = 0;\r\n    while (this.props.types[index]._id !== this.props.selectedType._id) index++;\r\n    index++;\r\n    if (index === this.props.types.length) index = 0;\r\n    this.setState({\r\n      redirectTo: `/type/details/${this.props.types[index]._id}`,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (\r\n      this.props.selectedWorld !== null &&\r\n      !this.props.selectedWorld.Public &&\r\n      this.props.user === null\r\n    ) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (\r\n      this.props.selectedWorld !== null &&\r\n      !this.props.selectedWorld.Public &&\r\n      this.props.selectedWorld.Owner !== this.props.user._id &&\r\n      this.props.selectedWorld.Collaborators.filter(\r\n        (c) => c.userID === this.props.user._id && c.type === \"collab\"\r\n      ).length === 0\r\n    ) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (\r\n      this.props.selectedType === undefined ||\r\n      this.props.selectedType === null\r\n    ) {\r\n      return <span>Loading</span>;\r\n    // } else if (this.props.allUsers.length === 0) {\r\n    //   setTimeout(() => {\r\n    //     this.api.getAllUsers().then(res => {\r\n    //       this.props.setAllUsers(res);\r\n    //     });\r\n    //   }, 500);\r\n    //   return (<span>Loading</span>);\r\n    } else {\r\n      const references = this.props.types.filter(\r\n        (t) =>\r\n          t.ReferenceIDs !== undefined &&\r\n          t.ReferenceIDs.includes(this.state._id)\r\n      );\r\n      const inheritedAttributes = [];\r\n      this.props.selectedType.Supers.forEach((superType) => {\r\n        superType.AttributesArr.forEach((attribute) => {\r\n          if (\r\n            inheritedAttributes.filter((a) => a.attrID === attribute.attrID)\r\n              .length === 0\r\n          ) {\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n        });\r\n      });\r\n      const suggestions = [...this.props.typeSuggestions, ...this.props.thingSuggestions];\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          {this.props.selectedWorld !== null && \r\n            <div>\r\n              <Helmet>\r\n                <title>{`Author's Notebook: ${this.props.selectedWorld.Name}`}</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={12} sm={8} container spacing={0} direction=\"column\">\r\n                  <Grid item container spacing={0} direction=\"row\">\r\n                    <Grid item xs={1}>\r\n                      <Tooltip\r\n                        title={`Back to ${this.props.selectedWorld.Name}`}\r\n                      >\r\n                        <Fab\r\n                          size=\"small\"\r\n                          color=\"primary\"\r\n                          onClick={(_) => {\r\n                            this.setState({\r\n                              redirectTo: `/project/details/${this.props.selectedWorldID}`,\r\n                            });\r\n                          }}\r\n                        >\r\n                          <ArrowBack />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </Grid>\r\n                    <Grid item xs={11}>\r\n                      <h2>{this.props.selectedType.Name}</h2>\r\n                    </Grid>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <h3>\r\n                      { this.props.selectedType.NeedsWork && \r\n                      <span>\r\n                        <img style={{ height: \"50px\" }} src={UnderConstruction} alt=\"Needs Work\" /> Needs Work\r\n                      </span> \r\n                      }\r\n                    </h3>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <h3>{this.props.selectedType.Major && \"Major Type\" }</h3>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <div  dangerouslySetInnerHTML={{__html: this.props.selectedType.Description}} />\r\n                    {/* {this.props.selectedType.Description} */}\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item xs={12} sm={4}>\r\n                  <List>\r\n                    {this.props.user !== null &&\r\n                      this.props.selectedWorld !== null &&\r\n                      (this.props.selectedWorld.Owner === this.props.user._id ||\r\n                        this.props.selectedWorld.Collaborators.filter(\r\n                          (c) =>\r\n                            c.userID === this.props.user._id &&\r\n                            c.type === \"collab\" &&\r\n                            c.editPermission\r\n                        ).length > 0) && (\r\n                        <ListItem>\r\n                          <Grid container spacing={1} direction=\"row\">\r\n                            <Grid item xs={4} sm={12}>\r\n                              <Tooltip title={`Create New ${this.props.selectedType.Name}`}>\r\n                                <Fab\r\n                                  size=\"small\" color=\"primary\"\r\n                                  onClick={(_) => {\r\n                                    this.setState({\r\n                                      redirectTo: `/thing/create/type_id_${this.state._id}`,\r\n                                    });\r\n                                  }}>\r\n                                  <Add />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                            <Grid item xs={4} sm={12}>\r\n                              <Tooltip title={`Edit ${this.props.selectedType.Name}`}>\r\n                                <Fab\r\n                                  size=\"small\" color=\"primary\"\r\n                                  onClick={(_) => {\r\n                                    this.setState({\r\n                                      redirectTo: `/type/edit/${this.state._id}`,\r\n                                    });\r\n                                  }}>\r\n                                  <Edit />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                            <Grid item xs={4} sm={12}>\r\n                              <Tooltip title={`Delete ${this.props.selectedType.Name}`}>\r\n                                <Fab\r\n                                  size=\"small\" color=\"primary\"\r\n                                  onClick={(e) => {\r\n                                    this.setState({ modalOpen: true });\r\n                                  }}>\r\n                                  <Delete />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                          </Grid>\r\n                        </ListItem>\r\n                      )}\r\n                    <ListItem>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={(_) => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary=\"Next Type\" />\r\n                      </Button>\r\n                    </ListItem>\r\n                  </List>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={12} sm={8} container spacing={0} direction=\"column\">\r\n                  <Grid item>Attributes</Grid>\r\n                  <Grid item>\r\n                    <List>\r\n                      {this.props.selectedType !== null &&\r\n                        this.props.selectedType !== undefined &&\r\n                        inheritedAttributes.map((attribute, i) => {\r\n                          let definedType = this.props.types.filter(\r\n                            (t) => t._id === attribute.DefinedType\r\n                          );\r\n                          definedType =\r\n                            definedType.length === 0\r\n                              ? { Name: \"\" }\r\n                              : definedType[0];\r\n                          const def = this.props.selectedType.DefaultsHash[\r\n                            attribute.attrID\r\n                          ];\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <ListItemText>\r\n                                {attribute.Name}:&nbsp;\r\n                                {attribute.AttributeType === \"Options\" ? (\r\n                                  <span>\r\n                                    Options:\r\n                                    {attribute.Options.map((option, j) => {\r\n                                      return (\r\n                                        <span key={j}>\r\n                                          {j === 0 ? \" \" : \", \"}\r\n                                          {option}\r\n                                        </span>\r\n                                      );\r\n                                    })}\r\n                                    {def !== undefined &&\r\n                                      def.DefaultValue !== undefined &&\r\n                                      def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`}\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"Type\" ? (\r\n                                  <span>\r\n                                    <Button\r\n                                      variant=\"contained\"\r\n                                      color=\"primary\"\r\n                                      onClick={(_) => {\r\n                                        this.setState({\r\n                                          redirectTo: `/type/details/${attribute.DefinedType}`,\r\n                                        });\r\n                                      }}\r\n                                    >\r\n                                      <ListItemText\r\n                                        primary={definedType.Name}\r\n                                      />\r\n                                    </Button>\r\n                                    {def !== undefined &&\r\n                                      def.DefaultValue !== undefined &&\r\n                                      def.DefaultValue !== \"\" &&\r\n                                      this.props.things.filter(\r\n                                        (t) => def.DefaultValue === t._id\r\n                                      ).length > 0 &&\r\n                                      ` (Default: ${\r\n                                        this.props.things.filter(\r\n                                          (t) => t._id === def.DefaultValue\r\n                                        )[0].Name\r\n                                      })`}\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"List\" ? (\r\n                                  <span>\r\n                                    List:&nbsp;\r\n                                    {attribute.ListType === \"Options\" ? (\r\n                                      <span>\r\n                                        Options:\r\n                                        {attribute.Options.map(\r\n                                          (option, j) => {\r\n                                            return (\r\n                                              <span key={j}>\r\n                                                {j === 0 ? \" \" : \", \"}\r\n                                                {option}\r\n                                              </span>\r\n                                            );\r\n                                          }\r\n                                        )}\r\n                                        {def !== undefined &&\r\n                                          def.DefaultListValues !==\r\n                                            undefined &&\r\n                                          def.DefaultListValues.length >\r\n                                            0 && (\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map(\r\n                                                (defaultValue, j) => {\r\n                                                  return (\r\n                                                    <span key={j}>\r\n                                                      {j === 0 ? \" \" : \", \"}\r\n                                                      {defaultValue}\r\n                                                    </span>\r\n                                                  );\r\n                                                }\r\n                                              )}\r\n                                              )\r\n                                            </span>\r\n                                          )}\r\n                                      </span>\r\n                                    ) : attribute.ListType === \"Type\" ? (\r\n                                      <span>\r\n                                        <Button\r\n                                          variant=\"contained\"\r\n                                          color=\"primary\"\r\n                                          onClick={(_) => {\r\n                                            this.setState({\r\n                                              redirectTo: `/type/details/${attribute.DefinedType}`,\r\n                                            });\r\n                                          }}\r\n                                        >\r\n                                          <ListItemText\r\n                                            primary={definedType.Name}\r\n                                          />\r\n                                        </Button>\r\n                                        {def !== undefined &&\r\n                                          def.DefaultListValues !==\r\n                                            undefined &&\r\n                                          def.DefaultListValues.length > 0 &&\r\n                                          this.props.things.filter((t) =>\r\n                                            def.DefaultListValues.includes(\r\n                                              t._id\r\n                                            )\r\n                                          ).length > 0 && (\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map(\r\n                                                (defaultValue, j) => {\r\n                                                  let defaultThing = this.props.things.filter(\r\n                                                    (t) =>\r\n                                                      t._id === defaultValue\r\n                                                  );\r\n                                                  if (\r\n                                                    defaultThing.length === 0\r\n                                                  )\r\n                                                    return (\r\n                                                      <span key={j}></span>\r\n                                                    );\r\n                                                  else {\r\n                                                    defaultThing =\r\n                                                      defaultThing[0];\r\n                                                    return (\r\n                                                      <span key={j}>\r\n                                                        {j === 0 ? \" \" : \", \"}\r\n                                                        <Button\r\n                                                          variant=\"contained\"\r\n                                                          color=\"primary\"\r\n                                                          onClick={(_) => {\r\n                                                            this.setState({\r\n                                                              redirectTo: `/thing/details/${defaultValue}`,\r\n                                                            });\r\n                                                          }}\r\n                                                        >\r\n                                                          <ListItemText\r\n                                                            primary={\r\n                                                              defaultThing.Name\r\n                                                            }\r\n                                                          />\r\n                                                        </Button>\r\n                                                      </span>\r\n                                                    );\r\n                                                  }\r\n                                                }\r\n                                              )}\r\n                                              )\r\n                                            </span>\r\n                                          )}\r\n                                      </span>\r\n                                    ) : (\r\n                                      <span>\r\n                                        {attribute.ListType}\r\n                                        {def !== undefined &&\r\n                                          def.DefaultListValues !==\r\n                                            undefined &&\r\n                                          def.DefaultListValues.length >\r\n                                            0 && (\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map(\r\n                                                (defaultValue, j) => {\r\n                                                  return (\r\n                                                    <span key={j}>\r\n                                                      {j === 0 ? \" \" : \", \"}\r\n                                                      {defaultValue}\r\n                                                    </span>\r\n                                                  );\r\n                                                }\r\n                                              )}\r\n                                              )\r\n                                            </span>\r\n                                          )}\r\n                                      </span>\r\n                                    )}\r\n                                  </span>\r\n                                ) : attribute.AttributeType ===\r\n                                  \"True/False\" ? (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    {def !== undefined &&\r\n                                    def.DefaultValue !== undefined &&\r\n                                    def.DefaultValue !== \"\"\r\n                                      ? ` (Default: ${def.DefaultValue})`\r\n                                      : \" (Default: False)\"}\r\n                                  </span>\r\n                                ) : (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    {def !== undefined &&\r\n                                      def.DefaultValue !== undefined &&\r\n                                      def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`}\r\n                                  </span>\r\n                                )}\r\n                              </ListItemText>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      {this.props.selectedType !== null &&\r\n                        this.props.selectedType !== undefined &&\r\n                        this.props.selectedType.AttributesArr.map(\r\n                          (attribute, i) => {\r\n                            let definedType = this.props.types.filter(\r\n                              (t) => t._id === attribute.DefinedType\r\n                            );\r\n                            definedType =\r\n                              definedType.length === 0\r\n                                ? { Name: \"\" }\r\n                                : definedType[0];\r\n                            const def = this.props.selectedType.DefaultsHash[\r\n                              attribute.attrID\r\n                            ];\r\n                            return (\r\n                              <ListItem key={i}>\r\n                                <ListItemText>\r\n                                  {attribute.Name}:&nbsp;\r\n                                  {attribute.AttributeType === \"Options\" ? (\r\n                                    <span>\r\n                                      Options:\r\n                                      {attribute.Options.map((option, j) => {\r\n                                        return (\r\n                                          <span key={j}>\r\n                                            {j === 0 ? \" \" : \", \"}\r\n                                            {option}\r\n                                          </span>\r\n                                        );\r\n                                      })}\r\n                                      {def !== undefined &&\r\n                                        def.DefaultValue !== undefined &&\r\n                                        def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`}\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"Type\" ? (\r\n                                    <span>\r\n                                      <Button\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                        onClick={(_) => {\r\n                                          this.setState({\r\n                                            redirectTo: `/type/details/${attribute.DefinedType}`,\r\n                                          });\r\n                                        }}\r\n                                      >\r\n                                        <ListItemText\r\n                                          primary={definedType.Name}\r\n                                        />\r\n                                      </Button>\r\n                                      {def !== undefined &&\r\n                                        def.DefaultValue !== undefined &&\r\n                                        def.DefaultValue !== \"\" &&\r\n                                        this.props.things.filter(\r\n                                          (t) => def.DefaultValue === t._id\r\n                                        ).length > 0 &&\r\n                                        ` (Default: ${\r\n                                          this.props.things.filter(\r\n                                            (t) => t._id === def.DefaultValue\r\n                                          )[0].Name\r\n                                        })`}\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"List\" ? (\r\n                                    <span>\r\n                                      List:&nbsp;\r\n                                      {attribute.ListType === \"Options\" ? (\r\n                                        <span>\r\n                                          Options:\r\n                                          {attribute.Options.map(\r\n                                            (option, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {option}\r\n                                                </span>\r\n                                              );\r\n                                            }\r\n                                          )}\r\n                                          {def !== undefined &&\r\n                                            def.DefaultListValues !==\r\n                                              undefined &&\r\n                                            def.DefaultListValues.length >\r\n                                              0 && (\r\n                                              <span>\r\n                                                &nbsp;(Defaults:\r\n                                                {def.DefaultListValues.map(\r\n                                                  (defaultValue, j) => {\r\n                                                    return (\r\n                                                      <span key={j}>\r\n                                                        {j === 0 ? \" \" : \", \"}\r\n                                                        {defaultValue}\r\n                                                      </span>\r\n                                                    );\r\n                                                  }\r\n                                                )}\r\n                                                )\r\n                                              </span>\r\n                                            )}\r\n                                        </span>\r\n                                      ) : attribute.ListType === \"Type\" ? (\r\n                                        <span>\r\n                                          <Button\r\n                                            variant=\"contained\"\r\n                                            color=\"primary\"\r\n                                            onClick={(_) => {\r\n                                              this.setState({\r\n                                                redirectTo: `/type/details/${attribute.DefinedType}`,\r\n                                              });\r\n                                            }}\r\n                                          >\r\n                                            <ListItemText\r\n                                              primary={definedType.Name}\r\n                                            />\r\n                                          </Button>\r\n                                          {def !== undefined &&\r\n                                            def.DefaultListValues !==\r\n                                              undefined &&\r\n                                            def.DefaultListValues.length >\r\n                                              0 &&\r\n                                            this.props.things.filter((t) =>\r\n                                              def.DefaultListValues.includes(\r\n                                                t._id\r\n                                              )\r\n                                            ).length > 0 && (\r\n                                              <span>\r\n                                                &nbsp;(Defaults:\r\n                                                {def.DefaultListValues.map(\r\n                                                  (defaultValue, j) => {\r\n                                                    let defaultThing = this.props.things.filter(\r\n                                                      (t) =>\r\n                                                        t._id === defaultValue\r\n                                                    );\r\n                                                    if (\r\n                                                      defaultThing.length ===\r\n                                                      0\r\n                                                    )\r\n                                                      return (\r\n                                                        <span key={j}></span>\r\n                                                      );\r\n                                                    else {\r\n                                                      defaultThing =\r\n                                                        defaultThing[0];\r\n                                                      return (\r\n                                                        <span key={j}>\r\n                                                          {j === 0\r\n                                                            ? \" \"\r\n                                                            : \", \"}\r\n                                                          <Button\r\n                                                            variant=\"contained\"\r\n                                                            color=\"primary\"\r\n                                                            onClick={(_) => {\r\n                                                              this.setState({\r\n                                                                redirectTo: `/thing/details/${defaultValue}`,\r\n                                                              });\r\n                                                            }}\r\n                                                          >\r\n                                                            <ListItemText\r\n                                                              primary={\r\n                                                                defaultThing.Name\r\n                                                              }\r\n                                                            />\r\n                                                          </Button>\r\n                                                        </span>\r\n                                                      );\r\n                                                    }\r\n                                                  }\r\n                                                )}\r\n                                                )\r\n                                              </span>\r\n                                            )}\r\n                                        </span>\r\n                                      ) : (\r\n                                        <span>\r\n                                          {attribute.ListType}\r\n                                          {def !== undefined &&\r\n                                            def.DefaultListValues !==\r\n                                              undefined &&\r\n                                            def.DefaultListValues.length >\r\n                                              0 && (\r\n                                              <span>\r\n                                                &nbsp;(Defaults:\r\n                                                {def.DefaultListValues.map(\r\n                                                  (defaultValue, j) => {\r\n                                                    return (\r\n                                                      <span key={j}>\r\n                                                        {j === 0 ? \" \" : \", \"}\r\n                                                        {defaultValue}\r\n                                                      </span>\r\n                                                    );\r\n                                                  }\r\n                                                )}\r\n                                                )\r\n                                              </span>\r\n                                            )}\r\n                                        </span>\r\n                                      )}\r\n                                    </span>\r\n                                  ) : attribute.AttributeType ===\r\n                                    \"True/False\" ? (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      {def !== undefined &&\r\n                                      def.DefaultValue !== undefined &&\r\n                                      def.DefaultValue !== \"\"\r\n                                        ? ` (Default: ${def.DefaultValue})`\r\n                                        : \" (Default: False)\"}\r\n                                    </span>\r\n                                  ) : (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      {def !== undefined &&\r\n                                        def.DefaultValue !== undefined &&\r\n                                        def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`}\r\n                                    </span>\r\n                                  )}\r\n                                </ListItemText>\r\n                              </ListItem>\r\n                            );\r\n                          }\r\n                        )}\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item xs={12} sm={4} container spacing={0} direction=\"column\">\r\n                  {this.props.selectedType.Supers.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Super Types\"} />\r\n                        </ListItem>\r\n                        {this.props.selectedType.Supers.map((superType, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button\r\n                                fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={(_) => {\r\n                                  this.setState({\r\n                                    redirectTo: `/type/details/${superType._id}`,\r\n                                  });\r\n                                }}\r\n                              >\r\n                                <ListItemText primary={superType.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.subTypes.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Sub Types\"} />\r\n                        </ListItem>\r\n                        {this.props.subTypes.map((sub, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button\r\n                                fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={(_) => {\r\n                                  this.setState({\r\n                                    redirectTo: `/type/details/${sub._id}`,\r\n                                  });\r\n                                }}\r\n                              >\r\n                                <ListItemText primary={sub.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {references.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button\r\n                                fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={(_) => {\r\n                                  this.setState({\r\n                                    redirectTo: `/type/details/${type._id}`,\r\n                                  });\r\n                                }}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.instances.length > 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Instances\"} />\r\n                        </ListItem>\r\n                        {this.props.instances.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button\r\n                                fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={(_) => {\r\n                                  this.setState({\r\n                                    redirectTo: `/thing/details/${thing._id}`,\r\n                                  });\r\n                                }}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <CommentsControl \r\n                  user={this.props.user} \r\n                  allUsers={this.props.allUsers}\r\n                  object={this.props.selectedType}\r\n                  objectType=\"Type\"\r\n                  world={this.props.selectedWorld}\r\n                  api={this.api} \r\n                  onChange={this.commentsChange}\r\n                  suggestions={suggestions}\r\n                /> \r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-type-modal\"\r\n                aria-describedby=\"delete-type-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={(e) => {\r\n                  this.setState({ modalOpen: false });\r\n                }}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete{\" \"}\r\n                      {this.props.selectedType.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work\r\n                      correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={(e) => {\r\n                            this.setState({ modalOpen: false });\r\n                          }}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport {Delete} from \"@material-ui/icons\";\r\nimport {Fab, Tooltip} from \"@material-ui/core\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ChipInput from \"material-ui-chip-input\";\r\n\r\nconst handleTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"AttributeType\"] = e.target.value;\r\n  attr[\"ListType\"] = \"Text\";\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleDefinedTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    // function respond(newType) {\r\n    //   attr[\"DefinedType\"] = newType._id;\r\n    //   props.onChange(attr);\r\n    // }\r\n    // props.onNewType(respond);\r\n    props.onNewType(attr);\r\n  }\r\n  else \r\n    props.onChange(attr);\r\n};\r\n\r\nconst handleListTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"ListType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleOptionsChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.Options = e;\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [name, changeName] = useState(props.attribute.Name);\r\n\r\n  const attributeTypes = [\r\n    \"Text\",\r\n    \"Number\",\r\n    \"True/False\",\r\n    \"Options\", \r\n    \"Type\", \r\n    \"List\"\r\n  ];\r\n  const listTypes = [\r\n    \"Text\",\r\n    \"Options\", \r\n    \"Type\"\r\n  ];\r\n\r\n  const selectedType =\r\n    props.attribute.AttributeType === undefined || props.attribute.AttributeType === null || props.attribute.AttributeType === \"\" ? attributeTypes[0] : props.attribute.AttributeType;\r\n\r\n  const selectedListType =\r\n    props.attribute.ListType === undefined || props.attribute.ListType === \"\" ? listTypes[0] : props.attribute.ListType;\r\n\r\n  const selectedDefinedType =\r\n    props.attribute.DefinedType === undefined || props.attribute.DefinedType === \"\" ? \"\" : props.attribute.DefinedType;\r\n\r\n  let fromTypes = props.attribute.FromTypeIDs === undefined ? [] : props.types.filter(t=> props.attribute.FromTypeIDs.includes(t._id));\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}>Name</InputLabel>\r\n          <OutlinedInput\r\n            disabled={props.disabled}\r\n            id={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            name={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={name}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = props.attribute;\r\n              attr.Name = name;\r\n              // const attr = {\r\n              //   index: props.attribute.index,\r\n              //   Name: name,\r\n              //   Type: props.attribute.AttributeType,\r\n              //   Options: props.attribute.Options,\r\n              //   ListType: props.attribute.ListType,\r\n              //   FromSupers: props.attribute.FromSupers,\r\n              //   DefinedType: props.attribute.DefinedType,\r\n              //   AttributeTypes: props.attribute.AttributeTypes,\r\n              //   DefaultValue: defaultValue,\r\n              //   DefaultListValues: defaultListValues\r\n              // };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n            Attribute Type\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"attribute-type-label\"\r\n            id=\"attribute-type\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0} \r\n            value={selectedType}\r\n            onChange={e => {handleTypeChange(e, props)}}\r\n            fullWidth\r\n            labelWidth={100}\r\n          >\r\n            {attributeTypes.map((type, i) => {\r\n              return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        {selectedType === \"Options\" ? (\r\n          <ChipInput\r\n            variant=\"outlined\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0}\r\n            defaultValue={props.attribute.Options}\r\n            onChange={chips => handleOptionsChange(chips, props)}\r\n          />\r\n        ) : selectedType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n              Defined Type\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"definedType-label\"\r\n              id=\"definedType\"\r\n              disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0} \r\n              value={selectedDefinedType}\r\n              onChange={e => {handleDefinedTypeChange(e, props)}}\r\n              fullWidth\r\n              labelWidth={100}\r\n            >\r\n              <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n              {props.types.map((type, i) => {\r\n                return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : selectedType === \"List\" ? (\r\n          <Grid container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                  List Type\r\n                </InputLabel>\r\n                <Select\r\n                  labelId=\"list-type-label\"\r\n                  id=\"list-type\"\r\n                  disabled={props.disabled}\r\n                  // disabled={props.attribute.FromSupers.length > 0} \r\n                  value={selectedListType}\r\n                  onChange={e => {handleListTypeChange(e, props)}}\r\n                  fullWidth\r\n                  labelWidth={70}\r\n                >\r\n                  {listTypes.map((type, i) => {\r\n                    return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                  })}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            { props.attribute.ListType === \"Type\" ? \r\n              (\r\n                <Grid item>\r\n                  <FormControl variant=\"outlined\" fullWidth>\r\n                    <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                      Defined Type\r\n                    </InputLabel>\r\n                    <Select\r\n                      labelId=\"definedType-label\"\r\n                      id=\"definedType\"\r\n                      disabled={props.disabled}\r\n                      // disabled={props.attribute.FromSupers.length > 0} \r\n                      value={selectedDefinedType}\r\n                      onChange={e => {handleDefinedTypeChange(e, props)}}\r\n                      fullWidth\r\n                      labelWidth={100}\r\n                    >\r\n                      <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                      {props.types.map((type, i) => {\r\n                        return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                      })}\r\n                    </Select>\r\n                  </FormControl>\r\n                </Grid>\r\n              ) : props.attribute.ListType === \"Options\" ?\r\n              (\r\n                <Grid item>\r\n                  <ChipInput\r\n                    variant=\"outlined\"\r\n                    disabled={props.disabled}\r\n                    // disabled={props.attribute.FromSupers.length > 0}\r\n                    defaultValue={props.attribute.Options}\r\n                    onChange={chips => handleOptionsChange(chips, props)}\r\n                  />\r\n                </Grid>\r\n              ) : \"\"\r\n            }\r\n          </Grid>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item xs={3}>\r\n        { fromTypes.length === 1 ? \r\n          `From Type: ${fromTypes[0].Name}`\r\n        : fromTypes.length > 1 ?\r\n          <span>\r\n            From Types: \r\n            { fromTypes.map((type, i) => {\r\n              return (<span key={i}>{i > 0 && \", \"}{type.Name}</span>)\r\n            })}\r\n          </span>\r\n        : \r\n          <Tooltip title={`Delete Attribute`}>\r\n            <Fab size=\"small\"\r\n              color=\"primary\"\r\n              // disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0}\r\n              onClick={_ => props.onDelete(props.attribute)}\r\n            >\r\n              <Delete />\r\n            </Fab>\r\n          </Tooltip>\r\n        }\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = e;\r\n  props.onChange(def);\r\n};\r\nconst handleDefinedTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  if (e.target.value === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   // attr[\"DefinedType\"] = newType._id;\r\n    //   // props.onChange(attr);\r\n    //   const def = props.def;\r\n    //   def.DefaultValue = newThing._id;\r\n    //   props.onChange(def);\r\n    //   respond(newThing._id);\r\n    // }\r\n    // const attr = props.attribute;\r\n    props.onNewThing(\r\n      // respond2,\r\n      attr,\r\n      // props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    attr[\"DefaultValue\"] = e.target.value;\r\n    props.onChange(attr);\r\n    // respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues.push(selectedItem.Name);\r\n  props.onChange(def);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o.Name);\r\n  });\r\n  props.onChange(def);\r\n};\r\nconst addThingOfType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   const def = props.def;\r\n    //   def.DefaultListValues.push(newThing._id);\r\n    //   props.onChange(def);\r\n    // }\r\n    // props.onNewThing(\r\n    //   respond2,\r\n      \r\n    // );\r\n    // function respond(newThing) {\r\n    //   const def = props.def;\r\n    //   def.DefaultListValues.push(newThing._id);\r\n    //   props.onChange(def);\r\n    // }\r\n    setTimeout(() => {\r\n      const attr = props.attribute;\r\n      // const thingType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n      props.onNewThing(attr);// , thingType);\r\n    }, 500);\r\n  } else {\r\n    const def = props.def;\r\n    def.DefaultListValues.push(selectedItem._id);\r\n    props.onChange(def);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o._id);\r\n  });\r\n  props.onChange(def);\r\n};\r\n\r\nexport default function AttributeDefaultControl(props) {\r\n  // I'm passing in attribute and def.\r\n  const [value, changeValue] = useState(props.def.DefaultValue);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n  \r\n  const selectedTypeValue = attributeType !== \"Type\" ? \"\" :\r\n    (props.def.DefaultValue === undefined || props.def.DefaultValue === \"\" ? \"\" : props.def.DefaultValue);\r\n  \r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.def.DefaultListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n    props.things\r\n      .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n      .forEach(t => {\r\n        listOptions.push({ Name: t.Name, _id: t._id });\r\n      });\r\n    listOptions\r\n      .filter(t => props.def.DefaultListValues.includes(t._id))\r\n      .forEach(t => {\r\n        listOptionValues.push(t);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item xs={12}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`attribute_name_${props.attribute.attrID}`}>{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id={`attribute_name_${props.attribute.attrID}`}\r\n              name={`attribute_name_${props.attribute.attrID}`}\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.def.DefaultValue===\"True\"} onChange={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(def);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={`${props.attribute.Name} Default True`}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={selectedTypeValue}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props);\r\n              }}\r\n              // onBlur={e => {\r\n              //   const def = props.def;\r\n              //   def.DefaultValue = value;\r\n              //   props.onChange(def);\r\n              // }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                variant=\"outlined\"\r\n                defaultValue={props.def.DefaultListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addThingOfType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport uuid from 'react-uuid';\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  addThing\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport AttributeDefaultControl from \"./AttributeDefaultControl\";\r\nimport API from \"../../smartAPI\";\r\n\r\n// It will let you add and remove attributes.\r\n// Each needs to have a unique name as part of validation.\r\n// Each also needs to have a valid type.\r\n// The type can be string, integer, double, enum, any Type\r\n// already defined for this world, or a list of any of the\r\n// other types.\r\n// In future versions I will add support for additional types:\r\n// Color, DateTime, Schedule.\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedType: state.app.selectedType,\r\n    // attributesArr: state.app.attributesArr,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    // updateAttributesArr: arr => dispatch(updateAttributesArr(arr)),\r\n    addType: type => dispatch(addType(type)),\r\n    addThing: thing => dispatch(addThing(thing))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      message: \"\",\r\n      waiting: false,\r\n      defaultsMode: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\"\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  changeDefault = value => {\r\n    const type = this.props.selectedType;\r\n    type.DefaultsHash[value.attrID] = {\r\n      attrID: value.attrID,\r\n      DefaultValue: value.DefaultValue,\r\n      DefaultListValues: value.DefaultListValues,\r\n      FromTypeIDs: value.FromTypeIDs\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  blurAttribute = e => {\r\n  }\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributes = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributes.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    let defaults = {...type.DefaultsHash};\r\n    if (defaults[value.attrID] !== undefined) {\r\n      delete defaults[value.attrID];\r\n    }\r\n    type.DefaultsHash = {};\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributes;\r\n      type.DefaultsHash = defaults;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  }\r\n\r\n  addNewType = (attribute) => {\r\n    this.props.addNewType(attribute);\r\n  }\r\n\r\n  addNewThing = (attribute) => {\r\n    this.props.addNewThing(attribute);\r\n  }\r\n\r\n  render() {\r\n    // I should move this somewhere else so it's not happening on every render.\r\n    const inheritedAttributes = [];\r\n    this.props.selectedType.SuperIDs.forEach(s => {\r\n      let superType = this.props.types.filter(t => t._id === s);\r\n      if (superType.length > 0) {\r\n        superType = superType[0];\r\n        superType.AttributesArr.forEach(attribute => {\r\n          let inheritedAttribute = inheritedAttributes.filter(a=>a.attrID === attribute.attrID);\r\n          if (inheritedAttribute.length === 0) {\r\n            attribute.FromTypeIDs = [superType._id];\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n          else {\r\n            inheritedAttribute = inheritedAttribute[0];\r\n            inheritedAttribute.FromTypeIDs.push(superType._id);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item>\r\n          <List>\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              inheritedAttributes.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.props.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        disabled={true}\r\n                        attribute={attribute}\r\n                        // onChange={this.changeAttribute}\r\n                        // onDelete={this.deleteAttribute}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                \r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.props.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        onChange={this.changeAttribute}\r\n                        onDelete={this.deleteAttribute}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n          </List>\r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  // Modal,\r\n  Button,\r\n} from \"@material-ui/core\";\r\n\r\n// const getModalStyle = () => {\r\n//   const top = Math.round(window.innerHeight / 2) - 100;\r\n//   const left = Math.round(window.innerWidth / 2) - 200;\r\n\r\n//   return {\r\n//     top: `${top}%`,\r\n//     left: `${left}%`,\r\n//     transform: `translate(${left}px, ${top}px)`,\r\n//   };\r\n// };\r\n\r\nconst validate = (value, props, changeMessage) => {\r\n  const valid = props.types.filter((t) => t.Name === value).length === 0;\r\n  changeMessage(valid ? \"\" : \"This Type Name is already in use\");\r\n};\r\n\r\nconst saveNewType = (value, props, changeName, changeMessage, changeWaiting) => {\r\n  // if (props.onSave !== undefined && props.onSave !== null)\r\n  //   props.onSave();\r\n\r\n  const type = {\r\n    _id: null,\r\n    Name: value.trim(),\r\n    Description: \"\",\r\n    SuperIDs: [],\r\n    AttributesArr: [],\r\n    Attributes: [],\r\n    worldID: props.selectedWorldID,\r\n    Major: false, \r\n    NeedsWork: true\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .createType(type)\r\n    .then((res) => {\r\n      if (res.typeID !== undefined) {\r\n        type._id = res.typeID;\r\n        type.Supers = [];\r\n        // Adds to redux\r\n        if (props.addType) props.addType(type);\r\n        // Calls respond back to Attribute to set the type\r\n\r\n        changeWaiting(false);\r\n        if (props.onSave) {\r\n          // setTimeout(() => {\r\n          changeName(\"\");\r\n          props.onSave(type);\r\n          // }, 500);\r\n        }\r\n        // this.state.modalSubmit(type);\r\n        // this.setState({\r\n        //   waiting: false,\r\n        //   typeModalOpen: false\r\n        // });\r\n      } else if (res.error !== undefined) {\r\n        // this.setState({\r\n        //   waiting: false,\r\n        //   message: res.error\r\n        // });\r\n        changeWaiting(false);\r\n        changeMessage(res.error);\r\n        props.logout();\r\n      }\r\n    })\r\n    .catch((err) => console.log(err));\r\n};\r\n\r\nexport default function NewTypeModal(props) {\r\n  const [name, changeName] = useState(\"\");\r\n  const [message, changeMessage] = useState(\"\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      <Grid item>Just give the new Type a name.</Grid>\r\n      <Grid item>(You can do the rest later.)</Grid>\r\n      <Grid item>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n          <OutlinedInput\r\n            id=\"name\"\r\n            name=\"Name\"\r\n            type=\"text\"\r\n            autoComplete=\"Off\"\r\n            error={message !== \"\"}\r\n            value={name}\r\n            onChange={(e) => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={(e) => {\r\n              validate(name, props, changeMessage);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={(e) => {\r\n              changeWaiting(true);\r\n              saveNewType(name, props, changeName, changeMessage, changeWaiting);\r\n            }}\r\n          >\r\n            {waiting ? \"Please Wait\" : \"Submit\"}\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={(e) => {\r\n              if (props.onCancel !== undefined && props.onCancel !== null)\r\n                props.onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  Button,\r\n} from \"@material-ui/core\";\r\n\r\n\r\nconst validate = (value, props, changeMessage) => {\r\n  const valid = props.things.filter((t) => t.Name === value).length === 0;\r\n  changeMessage(valid ? \"\" : \"This Thing Name is already in use\");\r\n};\r\n\r\nconst saveNewThing = (value, props, changeName, changeMessage, changeWaiting) => {\r\n  \r\n  changeWaiting(true);\r\n  const thing = {\r\n    _id: null,\r\n    Name: value.trim(),\r\n    Description: \"\",\r\n    TypeIDs: props.newThingType === undefined ? [] : [props.newThingType._id],\r\n    Attributes: [],\r\n    worldID: props.selectedWorldID,\r\n    ReferenceIDs: [], \r\n    NeedsWork: true\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .createThing(thing)\r\n    .then((res) => {\r\n      if (res.thingID !== undefined) {\r\n        thing._id = res.thingID;\r\n        thing.Types = props.newThingType === undefined ? [] : [props.newThingType];\r\n        thing.AttributesArr = [];\r\n        // Adds to props \r\n        props.addThing(thing);\r\n        setTimeout(() => {\r\n          // Calls respond back to Attribute to set the thing\r\n          changeName(\"\");\r\n          changeWaiting(false);\r\n          props.onSave(thing);\r\n        }, 500);\r\n\r\n        // this.state.modalSubmit(thing);\r\n        // this.setState({\r\n        //   waiting: false, \r\n        //   thingModalOpen: false,\r\n        //   Name: \"\"\r\n        // });\r\n      }\r\n      else if (res.error !== undefined) {\r\n        // this.setState({\r\n        //   waiting: false, \r\n        //   message: res.error \r\n        // });\r\n        changeMessage(res.error);\r\n        changeWaiting(false);\r\n        props.logout();\r\n      }\r\n    })\r\n    .catch(err => console.log(err));\r\n};\r\n\r\nexport default function NewThingModal(props) {\r\n  const [name, changeName] = useState(\"\");\r\n  const [message, changeMessage] = useState(\"\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"column\">\r\n      <Grid item>Just give the new {props.newThingType.Name === undefined ? \"Thing\" : props.newThingType.Name} a name.</Grid>\r\n      <Grid item>(You can do the rest later.)</Grid>\r\n      <Grid item>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n          <OutlinedInput\r\n            id=\"name\"\r\n            name=\"Name\"\r\n            type=\"text\"\r\n            autoComplete=\"Off\"\r\n            error={message !== \"\"}\r\n            value={name}\r\n            onChange={(e) => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={(e) => {\r\n              validate(name, props, changeMessage);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item container spacing={1} direction=\"row\">\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={waiting}\r\n            onClick={(e) => {\r\n              changeWaiting(true);\r\n              saveNewThing(name, props, changeName, changeMessage, changeWaiting);\r\n            }}\r\n          >\r\n            {waiting ? \"Please Wait\" : \"Submit\"}\r\n          </Button>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={(e) => {\r\n              if (props.onCancel !== undefined && props.onCancel !== null)\r\n                props.onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport uuid from 'react-uuid';\r\nimport { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport { \r\n  Grid, Button, Checkbox, FormControl, FormControlLabel,\r\n  InputLabel, Tooltip, Fab,\r\n  Select, MenuItem,\r\n  ListItem, ListItemText\r\n} from \"@material-ui/core\";\r\nimport UnderConstruction from \"../../assets/img/under_construction.png\";\r\nimport { Helmet } from 'react-helmet';\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport AttributesControl from \"./AttributesControl\";\r\n// import AttributeControl from \"./AttributeControl\";\r\n// import AttributeDefaultControl from \"./AttributeDefaultControl\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  addAttributes,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin,\r\n  addThing,\r\n  toggleLogin,\r\n  logout,\r\n  selectWorld\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\nimport NewTypeModal from \"../../components/Modals/NewTypeModal\";\r\nimport NewThingModal from \"../../components/Modals/NewThingModal\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: state.app.selectedType,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addAttributes: attrs => dispatch(addAttributes(attrs)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      // Name: \"\",\r\n      // Description: \"\",\r\n      // Supers: [],\r\n      // Attributes: [],\r\n      Major: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: \"\",\r\n      resetting: false,\r\n      browseAttributes: false,\r\n      browseAttributesSelected: \"\",\r\n      browseTypesSelected: \"\",\r\n      newThingType: {}\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        this.setState({\r\n          resetting: false, \r\n          loaded: true,\r\n          redirectTo: `/type/create`\r\n        });\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false,\r\n          loaded: true\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  // handleUserInput = e => {\r\n  //   const name = e.target.name;\r\n  //   const value =\r\n  //     e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n  //   this.setState({ [name]: value });\r\n  // };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.props.selectedType[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          const attrByName = this.props.attributesByName[value[i].Name];\r\n          if (attrByName !== undefined && \r\n            attrByName._id !== value[i].attrID) {\r\n            valid = false;\r\n            message = `An attribute with the name '${value[i].Name}' already exists`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      case \"Attributes\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          const attrByName = this.props.attributesByName[value[i].Name];\r\n          if (attrByName !== undefined && \r\n            attrByName._id !== value[i].attrID) {\r\n            valid = false;\r\n            message = `An attribute with this name already exists`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  }\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrArrValid = this.validateField(\"AttributesArr\");\r\n    // const attrValid = this.validateField(\"Attributes\");\r\n    const formValid = nameValid.valid && attrArrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.AttributesArr = attrArrValid;\r\n    // fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  }\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true, addMore: addMore }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  }\r\n\r\n  /**\r\n   * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p><p><br></p>\r\n   * gets translated to \r\n   * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p>\r\n   */\r\n  cleanWYSIWYG = (str) => {\r\n    if (str.endsWith(\"<p><br></p>\")) {\r\n      str = str.substring(0, str.length - 11);\r\n    }\r\n    return str;\r\n  }\r\n\r\n  submitThroughAPI = () => {\r\n    const superIDs = this.props.selectedType.Supers.map(s => {\r\n      return s._id;\r\n    });\r\n\r\n    const attributes = this.props.selectedType.AttributesArr.map(a => {\r\n      return {\r\n        _id: a.attrID,\r\n        Name: a.Name.trim(),\r\n        AttributeType: a.AttributeType,\r\n        Options: a.Options,\r\n        DefinedType: a.DefinedType,\r\n        ListType: a.ListType\r\n      };\r\n    });\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      const typeAttributes = [];\r\n      this.props.selectedType.AttributesArr.forEach(a => {\r\n        const id = a.attrID.includes(\"null\") ? res.attributes[a.Name] : a.attrID;\r\n        typeAttributes.push({\r\n          attrID: id,\r\n          index: a.index,\r\n          // Name: a.Name,\r\n          // AttributeType: a.AttributeType,\r\n          // Options: a.Options,\r\n          // DefinedType: a.DefinedType,\r\n          // ListType: a.ListType\r\n        });\r\n      });\r\n\r\n      const type = {\r\n        _id: this.state._id,\r\n        Name: this.props.selectedType.Name.trim(),\r\n        PluralName: this.props.selectedType.PluralName === undefined ? \"\" : this.props.selectedType.PluralName.trim(),\r\n        Description: this.cleanWYSIWYG(this.props.selectedType.Description),\r\n        SuperIDs: superIDs,\r\n        // AttributesArr: this.props.selectedType.AttributesArr,\r\n        Attributes: typeAttributes,\r\n        Defaults: [],\r\n        worldID: this.props.selectedWorld._id,\r\n        Major: this.props.selectedType.Major,\r\n        NeedsWork: this.props.selectedType.NeedsWork,\r\n        ReferenceIDs: [],\r\n        DefaultReferenceIDs: []\r\n      };\r\n      // this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n      //   if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n      //     type.ReferenceIDs.push(a.DefinedType);\r\n      //   }\r\n      // });\r\n      this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n        if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n          type.ReferenceIDs.push(a.DefinedType);\r\n        }\r\n      });\r\n      this.props.selectedType.Supers.forEach(s=> {\r\n        s.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n          if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n            type.ReferenceIDs.push(a.DefinedType);\r\n          }\r\n        });\r\n      });\r\n      Object.keys(this.props.selectedType.DefaultsHash).forEach(attrID => {\r\n        // There's the situation which can happen here where a default thing gets deleted (not removed as default).\r\n        // I really should filter it out, but it's not hurting anything for now, so I'm going to leave it.\r\n        const def = this.props.selectedType.DefaultsHash[attrID];\r\n        type.Defaults.push({\r\n          attrID, \r\n          FromTypeID: def.FromTypeID, \r\n          DefaultValue: def.DefaultValue, \r\n          DefaultListValues: def.DefaultListValues \r\n        });\r\n      });\r\n  \r\n      if (type._id === null) {\r\n        this.api\r\n          .createType(type)\r\n          .then(res => {\r\n            if (res.typeID !== undefined) {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n\r\n                if (this.state.addMore === \"add\") {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    PluralName: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    SuperIDs: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false,\r\n                    NeedsWork: false,\r\n                    DefaultsHash: {}\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    // Name: \"\",\r\n                    // Description: \"\",\r\n                    // Supers: [],\r\n                    // Attributes: [],\r\n                    // Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true,\r\n                    loaded: false\r\n                  }, this.resetForm);\r\n                } else if (this.state.addMore === \"next\") {\r\n                  this.redirectToNext();\r\n                } else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/project/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            else if (res.error !== undefined) {\r\n              this.setState({\r\n                waiting: false, \r\n                message: res.error \r\n              }, () => {\r\n                this.props.logout();\r\n              });\r\n            }\r\n          })\r\n          .catch(err => console.log(err));\r\n      } else {\r\n        this.api\r\n          .updateType(type)\r\n          .then(res => {\r\n            if (res.error === undefined) {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n\r\n                if (this.state.addMore === \"add\") {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    PluralName: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    SuperIDs: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false,\r\n                    NeedsWork: false,\r\n                    DefaultsHash: {}\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    // Name: \"\",\r\n                    // Description: \"\",\r\n                    // Supers: [],\r\n                    // Attributes: [],\r\n                    // Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true,\r\n                    loaded: false\r\n                  }, this.resetForm);\r\n                } else if (this.state.addMore === \"next\") {\r\n                  this.redirectToNext();\r\n                } else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/project/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            else {\r\n              this.setState({\r\n                waiting: false, \r\n                message: res.error \r\n              }, () => {\r\n                this.props.logout();\r\n              });\r\n            }\r\n          })\r\n          .catch(err => console.log(err));\r\n      }\r\n    });\r\n  }\r\n\r\n  supersChange = (e, value) => {\r\n    let supers = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      supers.push(t);\r\n      supers = supers.concat(t.Supers);\r\n    }\r\n    const type = this.props.selectedType;\r\n    type.Supers = supers;\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: supers });\r\n  }\r\n\r\n  addSuper = (selectedList, selectedItem) => {\r\n    const type = this.props.selectedType;\r\n    type.SuperIDs.push(selectedItem._id);\r\n    selectedItem.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    // We need to go through all the attributes on type, \r\n    // and make sure that none of them are also on a super type\r\n    let duplicateAttributes = [];\r\n    selectedList.forEach(t => {\r\n      duplicateAttributes = duplicateAttributes.concat(type.AttributesArr.filter(a => a.TypeIDs.includes(t._id)));\r\n    });\r\n    type.AttributesArr = type.AttributesArr.filter(a => duplicateAttributes.filter(d => d.attrID === a.attrID).length === 0);\r\n    \r\n    type.Supers = selectedList;\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: selectedList });\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\",\r\n      TypeIDs: []\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  addSelectedAttribute = () => {\r\n    const attr = this.props.attributesByID[this.state.browseAttributesSelected];\r\n    \r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: attr._id,\r\n      Name: attr.Name,\r\n      AttributeType: attr.AttributeType,\r\n      Options: attr.Options,\r\n      DefinedType: attr.DefinedType,\r\n      ListType: attr.ListType,\r\n      TypeIDs: attr.TypeIDs\r\n    });\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ \r\n      browseAttributesSelected: \"\",\r\n      browseTypesSelected: \"\" \r\n    });\r\n  }\r\n\r\n  addBrowsedType = (typeID) => {\r\n    const type = this.props.selectedType;\r\n    let attrType = this.props.types.filter(t => t._id === typeID)[0];\r\n    \r\n    type.SuperIDs.push(attrType._id);\r\n    const selectedList = type.Supers;\r\n    selectedList.push(attrType);\r\n\r\n    attrType.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    // We need to go through all the attributes on type, \r\n    // and make sure that none of them are also on a super type\r\n    let duplicateAttributes = [];\r\n    selectedList.forEach(t => {\r\n      duplicateAttributes = duplicateAttributes.concat(type.AttributesArr.filter(a => a.TypeIDs.includes(t._id)));\r\n    });\r\n    type.AttributesArr = type.AttributesArr.filter(a => duplicateAttributes.filter(d => d.attrID === a.attrID).length === 0);\r\n    \r\n    type.Supers = [];\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: [] });\r\n    setTimeout(() => {\r\n      type.Supers = selectedList;\r\n      this.props.updateSelectedType(type);\r\n      this.setState({ \r\n        browseAttributesSelected: \"\", \r\n        browseTypesSelected: \"\", \r\n        // Supers: selectedList \r\n      });\r\n    }, 500);\r\n  }\r\n  \r\n  removeSuper = (selectedList, removedItem) => {\r\n    let supers = [];\r\n    let superIDs = [];\r\n    let removeUs = [removedItem._id];\r\n    const type = this.props.selectedType;\r\n    for (let i = 0; i < type.Supers.length; i++) {\r\n      const checkMe = this.props.types.filter(\r\n        t => t._id === type.Supers[i]._id\r\n      )[0];\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else {\r\n        supers.push(checkMe);\r\n        superIDs.push(checkMe._id);\r\n      }\r\n    }\r\n    type.Supers = []; // supers;\r\n    type.SuperIDs = []; // superIDs;\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ \r\n      // Supers: supers, \r\n      loaded: false \r\n    });\r\n    setTimeout(() => {\r\n      type.Supers = supers;\r\n      type.SuperIDs =  superIDs;\r\n      this.props.updateSelectedType(type);\r\n      this.setState({ loaded: true });\r\n    }, 500);\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next type\r\n    let index = 0;\r\n    if (this.props.selectedType === undefined || this.props.selectedType._id !== null) {\r\n      while (this.props.types[index]._id !== this.props.selectedType._id)\r\n        index++;\r\n      index++;\r\n    }\r\n    if (index === this.props.types.length)\r\n      index = 0;\r\n    this.setState({ \r\n      waiting: false, \r\n      redirectTo: `/type/edit/${this.props.types[index]._id}` \r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false,\r\n        message: \"Loading...\"\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n      this.setState({\r\n        _id: id,\r\n        loaded: true,\r\n        message: \"\"\r\n      });\r\n    }\r\n    else {\r\n      if (this.props.selectedWorldID) {\r\n        this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n          if (id !== null) {\r\n            let type = res.types.filter(t => t._id === id);\r\n            if (type.length > 0) {\r\n              type = type[0];\r\n\r\n              const supers = this.props.types.filter(t =>\r\n                type.SuperIDs.includes(t._id)\r\n              );\r\n              type.Supers = supers;\r\n              this.props.updateSelectedType(type);\r\n              this.setState({\r\n                // Name: type.Name,\r\n                // Description: type.Description,\r\n                _id: id,\r\n                // Supers: supers,\r\n                // Major: type.Major,\r\n                loaded: true,\r\n                message: \"\"\r\n              });\r\n            }\r\n            else {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n                if (id !== null) {\r\n                  let type = res2.types.filter(t => t._id === id);\r\n                  if (type.length > 0) {\r\n                    type = type[0];\r\n        \r\n                    const supers = this.props.types.filter(t =>\r\n                      type.SuperIDs.includes(t._id)\r\n                    );\r\n                    type.Supers = supers;\r\n                    this.props.updateSelectedType(type);\r\n                    this.setState({\r\n                      // Name: type.Name,\r\n                      // Description: type.Description,\r\n                      _id: id,\r\n                      // Supers: supers,\r\n                      // Major: type.Major,\r\n                      loaded: true,\r\n                      message: \"\"\r\n                    });\r\n                  }\r\n                  else {\r\n                    // I had it get here with an ID from Cosmere, when I was supposed to be looking at a Type from Ozzie.\r\n                    // Need to figure out how it got the wrong ID.\r\n                    this.setState({ \r\n                      message: `Invalid ID: ${id}`, \r\n                      loaded: true \r\n                    });\r\n                  }\r\n                } else {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    PluralName: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    SuperIDs: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false,\r\n                    NeedsWork: false,\r\n                    DefaultsHash: {}\r\n                  });\r\n                  this.setState({ \r\n                    message: \"\", \r\n                    loaded: true \r\n                  });\r\n                }\r\n              });\r\n            }\r\n          } else {\r\n            this.props.updateSelectedType({\r\n              _id: null,\r\n              Name: \"\",\r\n              PluralName: \"\",\r\n              Description: \"\",\r\n              Supers: [],\r\n              SuperIDs: [],\r\n              AttributesArr: [],\r\n              Attributes: [],\r\n              Major: false,\r\n              NeedsWork: false,\r\n              DefaultsHash: {}\r\n            });\r\n            this.setState({ \r\n              message: \"\",\r\n              loaded: true \r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        this.api.getWorldByTypeID(id).then((res) => {\r\n          this.props.selectWorld(res.worldID);\r\n          this.props.setAttributes(res.attributes);\r\n          this.props.setTypes(res.types);\r\n          this.props.setThings(res.things);\r\n          if (id !== null) {\r\n            let type = res.types.filter(t => t._id === id);\r\n            if (type.length > 0) {\r\n              type = type[0];\r\n\r\n              const supers = this.props.types.filter(t =>\r\n                type.SuperIDs.includes(t._id)\r\n              );\r\n              type.Supers = supers;\r\n              this.props.updateSelectedType(type);\r\n              this.setState({\r\n                // Name: type.Name,\r\n                // Description: type.Description,\r\n                _id: id,\r\n                // Supers: supers,\r\n                // Major: type.Major,\r\n                loaded: true,\r\n                message: \"\"\r\n              });\r\n            }\r\n            else {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n                if (id !== null) {\r\n                  let type = res2.types.filter(t => t._id === id);\r\n                  if (type.length > 0) {\r\n                    type = type[0];\r\n        \r\n                    const supers = this.props.types.filter(t =>\r\n                      type.SuperIDs.includes(t._id)\r\n                    );\r\n                    type.Supers = supers;\r\n                    this.props.updateSelectedType(type);\r\n                    this.setState({\r\n                      // Name: type.Name,\r\n                      // Description: type.Description,\r\n                      _id: id,\r\n                      // Supers: supers,\r\n                      // Major: type.Major,\r\n                      loaded: true,\r\n                      message: \"\"\r\n                    });\r\n                  }\r\n                  else {\r\n                    // I had it get here with an ID from Cosmere, when I was supposed to be looking at a Type from Ozzie.\r\n                    // Need to figure out how it got the wrong ID.\r\n                    this.setState({ \r\n                      message: `Invalid ID: ${id}`, \r\n                      loaded: true \r\n                    });\r\n                  }\r\n                } else {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    PluralName: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    SuperIDs: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false,\r\n                    NeedsWork: false,\r\n                    DefaultsHash: {}\r\n                  });\r\n                  this.setState({ \r\n                    message: \"\", \r\n                    loaded: true \r\n                  });\r\n                }\r\n              });\r\n            }\r\n          } else {\r\n            this.props.updateSelectedType({\r\n              _id: null,\r\n              Name: \"\",\r\n              PluralName: \"\",\r\n              Description: \"\",\r\n              Supers: [],\r\n              SuperIDs: [],\r\n              AttributesArr: [],\r\n              Attributes: [],\r\n              Major: false,\r\n              NeedsWork: false,\r\n              DefaultsHash: {}\r\n            });\r\n            this.setState({ \r\n              message: \"\",\r\n              loaded: true \r\n            });\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  changeDefault = value => {\r\n    const type = this.props.selectedType;\r\n    type.DefaultsHash[value.attrID] = {\r\n      attrID: value.attrID,\r\n      DefaultValue: value.DefaultValue,\r\n      DefaultListValues: value.DefaultListValues,\r\n      FromTypeIDs: value.FromTypeIDs\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\"\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributes = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributes.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    let defaults = {...type.DefaultsHash};\r\n    if (defaults[value.attrID] !== undefined) {\r\n      delete defaults[value.attrID];\r\n    }\r\n    type.DefaultsHash = {};\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributes;\r\n      type.DefaultsHash = defaults;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  }\r\n\r\n  renderAttributes = () => {\r\n    return (\r\n      <AttributesControl \r\n        defaultsMode={this.state.defaultsMode} \r\n        addNewType={attribute => {\r\n          this.setState({ \r\n            typeModalOpen: true,\r\n            putTypeOnAttribute: attribute\r\n          });\r\n        }}\r\n        addNewThing={attribute => {\r\n          this.setState({ \r\n            thingModalOpen: true,\r\n            newThingType: this.props.types.filter(t => t._id === attribute.DefinedType)[0],\r\n            putThingOnAttribute: attribute\r\n          });\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    }\r\n    else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedType === null || this.props.selectedType._id !== id) {\r\n      return <span>{this.state.message}</span>;\r\n    } else if (this.state.typeModalOpen) {\r\n      return (\r\n        <NewTypeModal \r\n          types={this.props.types}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({\r\n              typeModalOpen: false\r\n            });\r\n          }}\r\n          addType={type => {\r\n            this.props.addType(type);\r\n          }}\r\n          onSave={newType => {\r\n            const type = this.props.selectedType;\r\n            const attr = type.AttributesArr.filter(a => a.attrID === this.state.putTypeOnAttribute.attrID)[0];\r\n            attr.DefinedType = newType._id;\r\n            this.props.updateSelectedType(type);\r\n            this.setState({\r\n              typeModalOpen: false\r\n            });\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else if (this.state.thingModalOpen) {\r\n      return (\r\n        <NewThingModal \r\n          things={this.props.things}\r\n          newThingType={this.state.newThingType}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            });\r\n          }}\r\n          addThing={thing => {\r\n            this.props.addThing(thing);\r\n          }}\r\n          onSave={thing => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            }, _ => {\r\n              // Need to put it on putThingOnAttribute\r\n              const type = this.props.selectedType;\r\n              const attr = type.AttributesArr.filter(a => a.attrID === this.state.putThingOnAttribute.attrID)[0];\r\n              let def = this.props.selectedType.DefaultsHash[attr.attrID];\r\n              if (def === undefined)\r\n                def = { attrID: attr.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n              if (attr.AttributeType === \"Type\") {\r\n                def.DefaultValue = thing._id;\r\n              }\r\n              else {\r\n                // The only way it can be here is if it's List and ListType is Type\r\n                def.DefaultListValues.push(thing._id);\r\n              }\r\n              this.props.updateSelectedType(type);\r\n            });\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else {\r\n      const types =\r\n        this.props.types === undefined || this.state._id === null\r\n          ? this.props.types\r\n          : this.props.types.filter(type => type._id !== this.state._id);\r\n      let additionalAttributes = [];\r\n      let selectedAttributeTypes = [];\r\n      let selectedAttributeName = \"\";\r\n      if (this.state.browseAttributes) {\r\n        Object.keys(this.props.attributesByID).forEach(id => {\r\n          const attr = this.props.attributesByID[id];\r\n          if (!attr.TypeIDs.includes(this.props.selectedType._id) && \r\n            this.props.selectedType.AttributesArr.filter(a => a.attrID === attr._id).length === 0) { // This second condition will make newly added attributes not show up.\r\n            let found = false;\r\n            for (let i = 0; i < this.props.selectedType.Supers.length; i++) {\r\n              if (attr.TypeIDs.includes(this.props.selectedType.Supers[i]._id)) {\r\n                found = true;\r\n                break;\r\n              }\r\n            }\r\n            if (!found) {\r\n              additionalAttributes.push({\r\n                _id: attr._id,\r\n                Name: attr.Name\r\n              });\r\n            }\r\n          }\r\n        });\r\n\r\n        if (this.state.browseAttributesSelected !== \"\") {\r\n          selectedAttributeName = this.props.attributesByID[this.state.browseAttributesSelected].Name;\r\n          selectedAttributeTypes = this.props.types.filter(t => this.props.attributesByID[this.state.browseAttributesSelected].TypeIDs.includes(t._id));\r\n        }\r\n      }\r\n      const suggestions = [...this.props.typeSuggestions, ...this.props.thingSuggestions];\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/project/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={7} sm={9}>\r\n                  <h2>{this.state._id === null ? \"Create New Type\" : \"Edit Type\"}</h2>\r\n                </Grid>\r\n                { this.props.types.length > 1 &&\r\n                  <Grid item xs={4} sm={2}>\r\n                    <ListItem>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary=\"Next Type\"/>\r\n                      </Button>\r\n                    </ListItem>\r\n                  </Grid>\r\n                }\r\n              </Grid>\r\n              { !this.state.resetting &&\r\n                <Grid item container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    { this.state.loaded &&  \r\n                      <TextBox \r\n                        Value={this.props.selectedType.Name} \r\n                        fieldName=\"Name\" \r\n                        message={this.state.fieldValidation.Name.message}\r\n                        onBlur={name => {\r\n                          const type = this.props.selectedType;\r\n                          type.Name = name;\r\n                          this.props.updateSelectedType(type);\r\n                          this.validateForm();\r\n                          // this.setState({ Name: name }, \r\n                          //   this.validateForm);\r\n                        }}\r\n                        labelWidth={43}/>\r\n                    }\r\n                  </Grid>\r\n                  <Grid item>\r\n                    { this.state.loaded &&  \r\n                      <TextBox \r\n                        Value={this.props.selectedType.PluralName} \r\n                        fieldName=\"PluralName\" \r\n                        displayName=\"Plural Name\" \r\n                        onBlur={name => {\r\n                          const type = this.props.selectedType;\r\n                          type.PluralName = name;\r\n                          this.props.updateSelectedType(type);\r\n                          this.validateForm();\r\n                          // this.setState({ Name: name }, \r\n                          //   this.validateForm);\r\n                        }}\r\n                        labelWidth={85}/>\r\n                    }\r\n                  </Grid>\r\n                  <Grid item>\r\n                    { this.state.loaded &&  \r\n                      <TextBox \r\n                        Value={this.props.selectedType.Description} \r\n                        fieldName=\"Description\" \r\n                        multiline={true}\r\n                        onBlur={desc => {\r\n                          const type = this.props.selectedType;\r\n                          type.Description = desc;\r\n                          this.props.updateSelectedType(type);\r\n                        }}\r\n                        labelWidth={82}\r\n                        options={suggestions}\r\n                      />\r\n                    }\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox \r\n                          icon={\r\n                            <img style={{ opacity: \"0.5\", height: \"30px\" }} src={UnderConstruction} alt=\"No Work Planned\" /> \r\n                          } \r\n                          checkedIcon={\r\n                            <img style={{ height: \"30px\" }} src={UnderConstruction} alt=\"Needs Work\" />\r\n                          }\r\n                          checked={this.props.selectedType.NeedsWork}\r\n                          onChange={ e => {\r\n                            const value = e.target.checked;\r\n                            const type = this.props.selectedType;\r\n                            type.NeedsWork = value;\r\n                            this.props.updateSelectedType(type);\r\n                            // this.setState({ [name]: value });\r\n                            // this.handleUserInput(e);\r\n                          }}\r\n                          name=\"NeedsWork\"\r\n                        />\r\n                      }\r\n                      label=\"Needs Work\"\r\n                    />\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          checked={this.props.selectedType.Major}\r\n                          onChange={ e => {\r\n                            const value = e.target.checked;\r\n                            const type = this.props.selectedType;\r\n                            type.Major = value;\r\n                            this.props.updateSelectedType(type);\r\n                            // this.setState({ [name]: value });\r\n                            // this.handleUserInput(e);\r\n                          }}\r\n                          name=\"Major\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Major Type\"\r\n                    />\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <Multiselect\r\n                      placeholder=\"Super Types\"\r\n                      options={types}\r\n                      selectedValues={this.props.selectedType.Supers}\r\n                      onSelect={this.addSuper}\r\n                      onRemove={this.removeSuper}\r\n                      displayValue=\"Name\"\r\n                    />\r\n                  </Grid>\r\n                  <Grid item container spacing={0} direction=\"row\">\r\n                    <Grid item xs={6}>\r\n                      <span>Attributes&nbsp;\r\n                        <Tooltip \r\n                          title={`Add New Attribute`}>\r\n                          <span>\r\n                            <Fab size=\"small\"\r\n                              color=\"primary\"\r\n                              disabled={this.state.defaultsMode}\r\n                              onClick={ _ => { this.newAttribute()}}\r\n                            >\r\n                              <Add />\r\n                            </Fab>\r\n                          </span>\r\n                        </Tooltip>\r\n                        <Tooltip \r\n                          title={`Browse Additional Attributes`}>\r\n                          <span>\r\n                            <Fab\r\n                              size=\"small\"\r\n                              color=\"primary\" \r\n                              disabled={this.state.defaultsMode}\r\n                              onClick={e => {\r\n                                this.setState({ browseAttributes: !this.state.browseAttributes });\r\n                              }}\r\n                            >\r\n                              <Search />\r\n                            </Fab>\r\n                          </span>\r\n                        </Tooltip>\r\n                      </span>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <Button variant=\"contained\" color=\"primary\" onClick={e => { this.setState({defaultsMode: !this.state.defaultsMode}) }}>\r\n                        { this.state.defaultsMode ? \"Set Attribute Types\" : \"Set Defaults\"}\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                  { this.state.browseAttributes && \r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12} sm={6}>\r\n                        <FormControl variant=\"outlined\" fullWidth>\r\n                          <InputLabel htmlFor=\"browseForAttributes\" id=\"browseForAttributes-label\">\r\n                            Browse Attributes\r\n                          </InputLabel>\r\n                          <Select\r\n                            labelId=\"browseForAttributes-label\"\r\n                            id=\"browseForAttributes\"\r\n                            value={this.state.browseAttributesSelected}\r\n                            onChange={e => {\r\n                              this.setState({ browseAttributesSelected: e.target.value });\r\n                            }}\r\n                            fullWidth\r\n                            labelWidth={130}\r\n                          >\r\n                            {\r\n                              additionalAttributes.map((attr, i) => {\r\n                                return (\r\n                                  <MenuItem key={i} value={attr._id}>\r\n                                    {attr.Name}\r\n                                  </MenuItem>\r\n                                );\r\n                              })\r\n                            }\r\n                          </Select>\r\n                        </FormControl>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <Button\r\n                          variant=\"contained\" color=\"primary\"\r\n                          disabled={ this.state.browseAttributesSelected === \"\" }\r\n                          onClick={e => {this.addSelectedAttribute();}}\r\n                          type=\"submit\"\r\n                        >\r\n                          Add Attribute\r\n                        </Button>\r\n                      </Grid>\r\n                      { selectedAttributeTypes.length === 1 ?\r\n                        <Grid style={{color: \"red\"}} item xs={12} container spacing={1} direction=\"row\">\r\n                          <Grid item xs={12}>\r\n                            This Attribute is also found on the Type '{selectedAttributeTypes[0].Name}'.  You may want to add '{selectedAttributeTypes[0].Name}' as a Super Type instead of adding the Attribute.\r\n                          </Grid>                      \r\n                          <Grid item xs={12} sm={6}>\r\n                            <Button\r\n                              variant=\"contained\" color=\"primary\"\r\n                              onClick={e => {this.addBrowsedType(selectedAttributeTypes[0]._id);}}\r\n                              type=\"submit\"\r\n                            >\r\n                              Add {selectedAttributeTypes[0].Name}\r\n                            </Button>\r\n                          </Grid>\r\n                        </Grid>\r\n                      : selectedAttributeTypes.length > 1 &&\r\n                        <Grid style={{color: \"red\"}} item xs={12} container spacing={1} direction=\"row\">\r\n                          <Grid item xs={12}>\r\n                            This Attribute is also found on other Types.  You may want to add one as a Super Type instead of adding the Attribute.\r\n                          </Grid>                      \r\n                          <Grid item xs={12} sm={6}>\r\n                            <FormControl variant=\"outlined\" fullWidth>\r\n                              <InputLabel htmlFor=\"browseTypesWithAttribute\" id=\"browseTypesWithAttribute-label\">\r\n                                Browse Types with {selectedAttributeName}\r\n                              </InputLabel>\r\n                              <Select\r\n                                labelId=\"browseTypesWithAttribute-label\"\r\n                                id=\"browseTypesWithAttribute\"\r\n                                value={this.state.browseTypesSelected}\r\n                                onChange={e => {\r\n                                  this.setState({ browseTypesSelected: e.target.value });\r\n                                }}\r\n                                fullWidth\r\n                                labelWidth={140 + selectedAttributeName.length * 9}\r\n                              >\r\n                                { selectedAttributeTypes.map((type, i) => {\r\n                                  return (\r\n                                    <MenuItem key={i} value={type._id}>\r\n                                      {type.Name}\r\n                                    </MenuItem>\r\n                                  );\r\n                                })}\r\n                              </Select>\r\n                            </FormControl>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <Button\r\n                              variant=\"contained\" color=\"primary\"\r\n                              disabled={ this.state.browseTypesSelected === \"\" }\r\n                              onClick={e => {this.addBrowsedType(this.state.browseTypesSelected);}}\r\n                              type=\"submit\"\r\n                            >\r\n                              Add Type\r\n                            </Button>\r\n                          </Grid>\r\n                        </Grid>\r\n                      }\r\n                    </Grid>\r\n                  }\r\n                  <Grid item>\r\n                    { this.state.loaded &&\r\n                      this.renderAttributes()\r\n                    }\r\n                  </Grid>\r\n                  <Grid item>\r\n                    {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                      if (\r\n                        this.state.fieldValidation[fieldName] !== undefined &&\r\n                        this.state.fieldValidation[fieldName].message.length > 0\r\n                      ) {\r\n                        return (\r\n                          <p className=\"redFont\" key={i}>\r\n                            {this.state.fieldValidation[fieldName].message}\r\n                          </p>\r\n                        );\r\n                      } else {\r\n                        return \"\";\r\n                      }\r\n                    })}\r\n                  </Grid>\r\n                  { this.props.types.length > 0 ?\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"next\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit and Edit Next\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"add\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={_ => {\r\n                            if (this.props.selectedType._id === null) {\r\n                              this.setState({\r\n                                redirectTo: `/project/details/${this.props.selectedWorldID}`\r\n                              });\r\n                            }\r\n                            else {\r\n                              this.setState({\r\n                                redirectTo: `/type/details/${this.props.selectedType._id}`\r\n                              });\r\n                            }\r\n                          }}\r\n                          type=\"button\"\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  : \r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12} sm={4}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"add\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={4}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={4}>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={_ => {\r\n                            if (this.props.selectedType._id === null) {\r\n                              this.setState({\r\n                                redirectTo: `/project/details/${this.props.selectedWorldID}`\r\n                              });\r\n                            }\r\n                            else {\r\n                              this.setState({\r\n                                redirectTo: `/type/details/${this.props.selectedType._id}`\r\n                              });\r\n                            }\r\n                          }}\r\n                          type=\"button\"\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  }\r\n                  <Grid item style={{color:\"red\"}}>{this.state.message}</Grid>\r\n                </Grid>\r\n              }\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeEditPage;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n// import clsx from 'clsx';\r\nimport { lighten, makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport TableSortLabel from '@material-ui/core/TableSortLabel';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Box from '@material-ui/core/Box';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { \r\n  Button, ListItemText\r\n} from \"@material-ui/core\";\r\n\r\nlet rows = [];\r\n\r\nfunction descendingComparator(a, b, orderBy) {\r\n  if (b[orderBy] < a[orderBy]) {\r\n    return -1;\r\n  }\r\n  if (b[orderBy] > a[orderBy]) {\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getComparator(order, orderBy) {\r\n  return order === 'desc'\r\n    ? (a, b) => descendingComparator(a, b, orderBy)\r\n    : (a, b) => -descendingComparator(a, b, orderBy);\r\n}\r\n\r\nfunction stableSort(array, comparator) {\r\n  const stabilizedThis = array.map((el, index) => [el, index]);\r\n  stabilizedThis.sort((a, b) => {\r\n    const order = comparator(a[0], b[0]);\r\n    if (order !== 0) return order;\r\n    return a[1] - b[1];\r\n  });\r\n  return stabilizedThis.map((el) => el[0]);\r\n}\r\n\r\nfunction ThingTableHead(props) {\r\n  const { classes, order, orderBy, onRequestSort, columnMap } = props;\r\n  const createSortHandler = (property) => (event) => {\r\n    onRequestSort(event, property);\r\n  };\r\n\r\n  return (\r\n    <TableHead>\r\n      <TableRow>\r\n        {columnMap.map((headCell) => (\r\n          <TableCell\r\n            key={headCell.id}\r\n            align={headCell.numeric ? 'right' : 'left'}\r\n            padding={headCell.disablePadding ? 'none' : 'default'}\r\n            sortDirection={orderBy === headCell.id ? order : false}\r\n          >\r\n            <TableSortLabel\r\n              active={orderBy === headCell.id}\r\n              direction={orderBy === headCell.id ? order : 'asc'}\r\n              onClick={createSortHandler(headCell.id)}\r\n            >\r\n              {headCell.label}\r\n              {orderBy === headCell.id ? (\r\n                <span className={classes.visuallyHidden}>\r\n                  {order === 'desc' ? 'sorted descending' : 'sorted ascending'}\r\n                </span>\r\n              ) : null}\r\n            </TableSortLabel>\r\n          </TableCell>\r\n        ))}\r\n      </TableRow>\r\n    </TableHead>\r\n  );\r\n}\r\n\r\nThingTableHead.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  numSelected: PropTypes.number.isRequired,\r\n  onRequestSort: PropTypes.func.isRequired,\r\n  onSelectAllClick: PropTypes.func.isRequired,\r\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\r\n  orderBy: PropTypes.string.isRequired,\r\n  rowCount: PropTypes.number.isRequired,\r\n  columnMap: PropTypes.array.isRequired\r\n};\r\n\r\nconst useToolbarStyles = makeStyles((theme) => ({\r\n  root: {\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(1),\r\n  },\r\n  highlight:\r\n    theme.palette.type === 'light'\r\n      ? {\r\n          color: theme.palette.secondary.main,\r\n          backgroundColor: lighten(theme.palette.secondary.light, 0.85),\r\n        }\r\n      : {\r\n          color: theme.palette.text.primary,\r\n          backgroundColor: theme.palette.secondary.dark,\r\n        },\r\n  title: {\r\n    flex: '1 1 100%',\r\n  },\r\n}));\r\n\r\nconst ThingTableToolbar = (props) => {\r\n  const classes = useToolbarStyles();\r\n  const { label } = props;\r\n\r\n  return (\r\n    <Toolbar>\r\n      <Typography className={classes.title} variant=\"h6\" id=\"tableTitle\" component=\"div\">\r\n        {label}\r\n      </Typography>\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nThingTableToolbar.propTypes = {\r\n  // numSelected: PropTypes.number.isRequired,\r\n  label: PropTypes.string.isRequired\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '100%',\r\n  },\r\n  paper: {\r\n    width: '100%',\r\n    marginBottom: theme.spacing(2),\r\n  },\r\n  table: {\r\n    // minWidth: 750,\r\n  },\r\n  visuallyHidden: {\r\n    border: 0,\r\n    clip: 'rect(0 0 0 0)',\r\n    height: 1,\r\n    margin: -1,\r\n    overflow: 'hidden',\r\n    padding: 0,\r\n    position: 'absolute',\r\n    top: 20,\r\n    width: 1,\r\n  },\r\n}));\r\n\r\nexport default function ThingTable(props) {\r\n  const columnMap = [\r\n    { \r\n      id: 'Name', \r\n      numeric: false, \r\n      disablePadding: true, \r\n      label: 'Name' \r\n    },\r\n    { \r\n      id: 'Description', \r\n      numeric: false, \r\n      disablePadding: true, \r\n      label: 'Description' \r\n    }\r\n  ];\r\n  rows = [];\r\n  props.things.forEach(thing => {\r\n    const newRow = {\r\n      _id: thing._id,\r\n      Name: thing.Name,\r\n      Description: thing.Description\r\n    };\r\n    thing.Attributes.forEach(attr => {\r\n      const attribute = props.attributesByID[attr.attrID];\r\n      if (attribute.AttributeType === \"Type\") {\r\n        let attrThing = props.allThings.filter(t => t._id === attr.Value);\r\n        if (attrThing.length > 0) {\r\n          attrThing = attrThing[0];\r\n          newRow[attr.attrID] = attrThing.Name;\r\n        }\r\n      } else if (attribute.AttributeType === \"List\") {\r\n        newRow[attr.attrID] = \"\";\r\n        if (attribute.ListType === \"Type\") {\r\n          attr.ListValues.forEach(v => {\r\n            let attrThing = props.allThings.filter(t => t._id === v);\r\n            if (attrThing.length > 0) {\r\n              attrThing = attrThing[0];\r\n              newRow[attr.attrID] += (newRow[attr.attrID].length > 0 ? \", \" : \"\") + attrThing.Name;\r\n            }\r\n          });\r\n        }\r\n        else {\r\n          attr.ListValues.forEach(v => {\r\n            newRow[attr.attrID] += (newRow[attr.attrID].length > 0 ? \", \" : \"\") + v;\r\n          });\r\n        }\r\n      } else {\r\n        newRow[attr.attrID] = attr.Value;\r\n      }\r\n      if (columnMap.filter(c => c.id === attr.attrID).length === 0) {\r\n        columnMap.push({\r\n          id: attribute._id, \r\n          numeric: attribute.Type === \"Number\", \r\n          disablePadding: true, \r\n          label: attribute.Name\r\n        });\r\n      }\r\n    });\r\n    rows.push(newRow);\r\n  });\r\n\r\n  const classes = useStyles();\r\n  const [order, setOrder] = React.useState('asc');\r\n  const [orderBy, setOrderBy] = React.useState('Name');\r\n  const [selected, setSelected] = React.useState([]);\r\n  const [page, setPage] = React.useState(0);\r\n  // const [dense, setDense] = React.useState(false);\r\n  const dense = true;\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(5);\r\n\r\n  const handleRequestSort = (event, property) => {\r\n    const isAsc = orderBy === property && order === 'asc';\r\n    setOrder(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(property);\r\n  };\r\n\r\n  const handleSelectAllClick = (event) => {\r\n    if (event.target.checked) {\r\n      const newSelecteds = rows.map((n) => n.name);\r\n      setSelected(newSelecteds);\r\n      return;\r\n    }\r\n    setSelected([]);\r\n  };\r\n\r\n  // const handleClick = (event, name) => {\r\n  //   const selectedIndex = selected.indexOf(name);\r\n  //   let newSelected = [];\r\n\r\n  //   if (selectedIndex === -1) {\r\n  //     newSelected = newSelected.concat(selected, name);\r\n  //   } else if (selectedIndex === 0) {\r\n  //     newSelected = newSelected.concat(selected.slice(1));\r\n  //   } else if (selectedIndex === selected.length - 1) {\r\n  //     newSelected = newSelected.concat(selected.slice(0, -1));\r\n  //   } else if (selectedIndex > 0) {\r\n  //     newSelected = newSelected.concat(\r\n  //       selected.slice(0, selectedIndex),\r\n  //       selected.slice(selectedIndex + 1),\r\n  //     );\r\n  //   }\r\n\r\n  //   setSelected(newSelected);\r\n  // };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  // const handleChangeDense = (event) => {\r\n  //   setDense(event.target.checked);\r\n  // };\r\n\r\n  const isSelected = (name) => selected.indexOf(name) !== -1;\r\n\r\n  // const emptyRows = rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Box display={{ xs: 'none', sm: 'block' }}>\r\n        <Paper className={classes.paper}>\r\n          <ThingTableToolbar label={props.label} />\r\n          <TableContainer>\r\n            <Table\r\n              className={classes.table}\r\n              aria-labelledby=\"tableTitle\"\r\n              size={dense ? 'small' : 'medium'}\r\n              aria-label=\"enhanced table\"\r\n            >\r\n              <ThingTableHead\r\n                classes={classes}\r\n                numSelected={selected.length}\r\n                order={order}\r\n                orderBy={orderBy}\r\n                onSelectAllClick={handleSelectAllClick}\r\n                onRequestSort={handleRequestSort}\r\n                rowCount={rows.length}\r\n                columnMap={columnMap}\r\n              />\r\n              <TableBody>\r\n                {stableSort(rows, getComparator(order, orderBy))\r\n                  .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\r\n                  .map((row, index) => {\r\n                    const isItemSelected = isSelected(row.name);\r\n                    \r\n                    return (\r\n                      <TableRow\r\n                        hover\r\n                        role=\"checkbox\"\r\n                        aria-checked={isItemSelected}\r\n                        tabIndex={-1}\r\n                        key={index}\r\n                        selected={isItemSelected}\r\n                      >\r\n                        {columnMap.map((column, key) => {\r\n                          return (\r\n                            <TableCell key={key}>\r\n                              {column.id === \"Name\" ?\r\n                                <Button\r\n                                  variant=\"contained\"\r\n                                  color=\"primary\"\r\n                                  onClick={ _ => { props.buttonClick(row._id)}}\r\n                                >\r\n                                  <ListItemText primary={row.Name}/>\r\n                                </Button>\r\n                              :\r\n                                <span>{row[column.id]}</span>\r\n                              }\r\n                            </TableCell>\r\n                          );\r\n                        })}\r\n                      </TableRow>\r\n                    );\r\n                  })}\r\n              </TableBody>\r\n            </Table>\r\n          </TableContainer>\r\n          { rows.length > 5 &&\r\n            <TablePagination\r\n              rowsPerPageOptions={[5, 10, 25]}\r\n              component=\"div\"\r\n              count={rows.length}\r\n              rowsPerPage={rowsPerPage}\r\n              page={page}\r\n              onChangePage={handleChangePage}\r\n              onChangeRowsPerPage={handleChangeRowsPerPage}\r\n            />\r\n          }\r\n        </Paper>\r\n      </Box>\r\n      <Box display={{ xs: 'block', sm: 'none' }}>\r\n        { props.label }: \r\n        { props.things.map((thing, i) => {\r\n          return (\r\n            <Button key={i} style={{ marginLeft: \"4px\" }}\r\n              variant=\"contained\" color=\"primary\"\r\n              onClick={ _ => { props.buttonClick(thing._id)}}>\r\n              <ListItemText primary={thing.Name}/>\r\n            </Button>\r\n          );\r\n        })}\r\n      </Box>\r\n    </div>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { ArrowBack, Edit, Delete } from \"@material-ui/icons\";\r\nimport { \r\n  Fab, Tooltip, Modal, Grid, Button, \r\n  List, ListItem, ListItemText, Box\r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  setAllUsers,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout,\r\n  selectWorld\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport ThingTable from \"../../components/Displays/ThingTable\";\r\nimport CommentsControl from \"../../components/Inputs/CommentsControl\";\r\nimport UnderConstruction from \"../../assets/img/under_construction.png\";\r\n\r\nconst mapStateToProps = state => {\r\n  const thing = state.app.selectedThing;\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: thing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    fromLogin: state.app.fromLogin,\r\n    allUsers: state.app.allUsers,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setAllUsers: allUsers => dispatch(setAllUsers(allUsers)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      AttributesArr: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false,\r\n      majorType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.setState({ waiting: true }, this.finishDelete);\r\n  }\r\n\r\n  finishDelete = e => {\r\n    this.api.deleteThing(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n\r\n          this.setState({ waiting: false, redirectTo: `/project/details/${this.props.selectedWorldID}`});\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error }, () => {\r\n          this.props.logout();\r\n        });\r\n      }\r\n      // const things = this.props.things.filter(t=>t._id!==this.state._id);\r\n      // this.props.setThings(things);\r\n      // this.setState({redirectTo: `/project/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next thing\r\n    const things = this.state.majorType === null ? this.props.things : this.props.things.filter(t => t.TypeIDs.includes(this.state.majorType._id));\r\n    let index = 0;\r\n    while (things[index]._id !== this.props.selectedThing._id)\r\n      index++;\r\n    index++;\r\n    if (index === things.length)\r\n      index = 0;\r\n    this.setState({ \r\n      waiting: false, \r\n      redirectTo: `/thing/details/${things[index]._id}` \r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    const id = this.state._id;\r\n    if (this.props.selectedWorldID) {\r\n      this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n        \r\n        if (id !== undefined) {\r\n          let thing = res.things.filter(t => t._id === id);\r\n          if (thing.length === 0) {\r\n            this.setState({ message: \"Invalid Thing ID\", loaded: true });\r\n          }\r\n          else {\r\n            thing = thing[0];\r\n            thing.AttributesArr = [];\r\n            thing.Attributes.forEach(a => {\r\n              const attr = this.props.attributesByID[a.attrID];\r\n              thing.AttributesArr.push({\r\n                index: thing.AttributesArr.length,\r\n                Name: attr.Name,\r\n                AttributeType: attr.AttributeType,\r\n                Options: attr.Options,\r\n                DefinedType: attr.DefinedType,\r\n                ListType: attr.ListType,\r\n                attrID: a.attrID,\r\n                Value: a.Value,\r\n                ListValues: a.ListValues,\r\n                TypeIDs: attr.TypeIDs\r\n              });\r\n            });\r\n            this.props.updateSelectedThing(thing);\r\n            if (this.state.majorType === null) {\r\n              let majorType = thing.Types.filter(t=>t.Major);\r\n              if (majorType.length > 0) {\r\n                majorType = majorType[0];\r\n                \r\n                this.setState({\r\n                  Name: thing.Name,\r\n                  Description: thing.Description,\r\n                  _id: id,\r\n                  Types: thing.Types,\r\n                  majorType,\r\n                  loaded: true\r\n                });\r\n              }\r\n              else {\r\n                this.setState({\r\n                  Name: thing.Name,\r\n                  Description: thing.Description,\r\n                  _id: id,\r\n                  Types: thing.Types,\r\n                  loaded: true\r\n                });\r\n              }\r\n            }\r\n            else {\r\n              this.setState({\r\n                Name: thing.Name,\r\n                Description: thing.Description,\r\n                _id: id,\r\n                Types: thing.Types,\r\n                loaded: true\r\n              });\r\n            }\r\n          }\r\n        } else {\r\n          this.props.updateSelectedThing({\r\n            _id: null,\r\n            Name: \"\",\r\n            Description: \"\",\r\n            Types: [],\r\n            Attributes: [],\r\n            AttributesArr: []\r\n          });\r\n          this.setState({ loaded: true });\r\n        }\r\n      });\r\n    } else {\r\n      this.api.getWorldByThingID(id).then((res) => {\r\n        this.props.selectWorld(res.worldID);\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n        \r\n        if (id !== undefined) {\r\n          let thing = res.things.filter(t => t._id === id);\r\n          if (thing.length === 0) {\r\n            this.setState({ message: \"Invalid Thing ID\", loaded: true });\r\n          }\r\n          else {\r\n            thing = thing[0];\r\n            thing.AttributesArr = [];\r\n            thing.Attributes.forEach(a => {\r\n              const attr = this.props.attributesByID[a.attrID];\r\n              thing.AttributesArr.push({\r\n                index: thing.AttributesArr.length,\r\n                Name: attr.Name,\r\n                AttributeType: attr.AttributeType,\r\n                Options: attr.Options,\r\n                DefinedType: attr.DefinedType,\r\n                ListType: attr.ListType,\r\n                attrID: a.attrID,\r\n                Value: a.Value,\r\n                ListValues: a.ListValues,\r\n                TypeIDs: attr.TypeIDs\r\n              });\r\n            });\r\n            this.props.updateSelectedThing(thing);\r\n            if (this.state.majorType === null) {\r\n              let majorType = thing.Types.filter(t=>t.Major);\r\n              if (majorType.length > 0) {\r\n                majorType = majorType[0];\r\n                \r\n                this.setState({\r\n                  Name: thing.Name,\r\n                  Description: thing.Description,\r\n                  _id: id,\r\n                  Types: thing.Types,\r\n                  majorType,\r\n                  loaded: true\r\n                });\r\n              }\r\n              else {\r\n                this.setState({\r\n                  Name: thing.Name,\r\n                  Description: thing.Description,\r\n                  _id: id,\r\n                  Types: thing.Types,\r\n                  loaded: true\r\n                });\r\n              }\r\n            }\r\n            else {\r\n              this.setState({\r\n                Name: thing.Name,\r\n                Description: thing.Description,\r\n                _id: id,\r\n                Types: thing.Types,\r\n                loaded: true\r\n              });\r\n            }\r\n          }\r\n        } else {\r\n          this.props.updateSelectedThing({\r\n            _id: null,\r\n            Name: \"\",\r\n            Description: \"\",\r\n            Types: [],\r\n            Attributes: [],\r\n            AttributesArr: []\r\n          });\r\n          this.setState({ loaded: true });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    // } else if (this.props.allUsers.length === 0) {\r\n    //   setTimeout(() => {\r\n    //     this.api.getAllUsers().then(res => {\r\n    //       this.props.setAllUsers(res);\r\n    //     });\r\n    //   }, 500);\r\n    //   return (<span>Loading</span>);\r\n    } else {\r\n      const references = this.props.things.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      const suggestions = [...this.props.typeSuggestions, ...this.props.thingSuggestions];\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={12} sm={8} container spacing={0} direction=\"column\">\r\n                  <Grid item container spacing={0} direction=\"row\">\r\n                    <Grid item xs={1}>\r\n                      <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                        <Fab size=\"small\"\r\n                          color=\"primary\"\r\n                          onClick={ _ => {this.setState({redirectTo:`/project/details/${this.props.selectedWorldID}`})}}\r\n                        >\r\n                          <ArrowBack />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </Grid>\r\n                    <Grid item xs={11}>\r\n                      <h2>{this.state.Name}</h2>\r\n                    </Grid>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <h3>\r\n                      { this.props.selectedThing.NeedsWork && \r\n                      <span>\r\n                        <img style={{ height: \"50px\" }} src={UnderConstruction} alt=\"Needs Work\" /> Needs Work\r\n                      </span> \r\n                      }\r\n                    </h3>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <div  dangerouslySetInnerHTML={{__html: this.state.Description}} />\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item xs={12} sm={4}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Box display={{ xs: 'block', sm: 'none' }} width={1}>\r\n                          <Grid container spacing={1} direction=\"row\">\r\n                            <Grid item xs={3}>\r\n                              &nbsp;\r\n                            </Grid>\r\n                            <Grid item xs={4}>\r\n                              <Tooltip title={`Edit ${this.state.Name}`}>\r\n                                <Fab size=\"small\"\r\n                                  color=\"primary\"\r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/edit/${this.state._id}`})}}\r\n                                >\r\n                                  <Edit />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                            <Grid item xs={5}>\r\n                              <Tooltip title={`Delete ${this.state.Name}`}>\r\n                                <Fab size=\"small\"\r\n                                  color=\"primary\"\r\n                                  onClick={e => {this.setState({modalOpen: true})}}\r\n                                >\r\n                                  <Delete />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                          </Grid>\r\n                        </Box>\r\n                        <Box display={{ xs: 'none', sm: 'block' }}>\r\n                          <Grid container spacing={1} direction=\"column\">\r\n                            <Grid item>\r\n                              <Tooltip title={`Edit ${this.state.Name}`}>\r\n                                <Fab size=\"small\"\r\n                                  color=\"primary\"\r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/edit/${this.state._id}`})}}\r\n                                >\r\n                                  <Edit />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                            <Grid item>\r\n                              <Tooltip title={`Delete ${this.state.Name}`}>\r\n                                <Fab size=\"small\"\r\n                                  color=\"primary\"\r\n                                  onClick={e => {this.setState({modalOpen: true})}}\r\n                                >\r\n                                  <Delete />\r\n                                </Fab>\r\n                              </Tooltip>\r\n                            </Grid>\r\n                          </Grid>\r\n                        </Box>\r\n                      </ListItem>\r\n                    }\r\n                    <ListItem>\r\n                      { this.state.majorType === null ?\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={_ => {\r\n                            this.redirectToNext();\r\n                          }}\r\n                        >\r\n                          <ListItemText primary=\"Next\" />\r\n                        </Button>\r\n                      :\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={_ => {\r\n                            this.redirectToNext();\r\n                          }}\r\n                        >\r\n                          <ListItemText primary={`Next ${this.state.majorType.Name}`}/>\r\n                        </Button>\r\n                      }\r\n                    </ListItem>\r\n                  </List> \r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={12} sm={8}>\r\n                  Attributes\r\n                  <List>\r\n                    { this.props.selectedThing !== null && this.props.selectedThing !== undefined &&\r\n                      this.props.selectedThing.AttributesArr.map(\r\n                        (attribute, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              { attribute.AttributeType === \"Type\" && attribute.Value !== \"\" ?\r\n                                <ThingTable \r\n                                  attributesByID={this.props.attributesByID} \r\n                                  label={attribute.Name} \r\n                                  things={this.props.things.filter(t=>t._id === attribute.Value)} \r\n                                  allThings={this.props.things}\r\n                                />\r\n                              : attribute.AttributeType === \"List\" && attribute.ListType === \"Type\" ?\r\n                                <ThingTable \r\n                                  attributesByID={this.props.attributesByID} \r\n                                  label={attribute.Name} \r\n                                  things={this.props.things.filter(t=>attribute.ListValues.includes(t._id))} \r\n                                  allThings={this.props.things}\r\n                                  buttonClick={thingID => {\r\n                                    this.setState({redirectTo:`/thing/details/${thingID}`});\r\n                                  }}\r\n                                />\r\n                              : attribute.AttributeType === \"List\" ?\r\n                                <span>{attribute.Name}:&nbsp;\r\n                                { attribute.ListValues.map(\r\n                                  (listValue, i) => {\r\n                                    return(\r\n                                      <span key={i}>\r\n                                        { \r\n                                          i > 0 ? `, ${listValue}` : `${listValue}`\r\n                                        }\r\n                                      </span>\r\n                                    );\r\n                                  })\r\n                                }\r\n                                </span>\r\n                              : \r\n                                <span>{attribute.Name}:&nbsp;{attribute.Value}</span>\r\n                              }\r\n                            </ListItem>\r\n                          );\r\n                        }\r\n                      )\r\n                    }\r\n                  </List>\r\n                </Grid>\r\n                <Grid item xs={12} sm={4} container spacing={0} direction=\"column\">\r\n                  { this.state.Types.length > 0 && \r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Types\"} />\r\n                        </ListItem>\r\n                        {this.state.Types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  }\r\n                  { references.length > 0 &&\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  }\r\n                </Grid>\r\n              </Grid>\r\n              { this.props.selectedThing !== null &&\r\n                <Grid item xs={12}>\r\n                  <CommentsControl \r\n                    user={this.props.user} \r\n                    allUsers={this.props.allUsers}\r\n                    object={this.props.selectedThing}\r\n                    objectType=\"Thing\"\r\n                    world={this.props.selectedWorld}\r\n                    api={this.api} \r\n                    onChange={this.commentsChange}\r\n                    suggestions={suggestions}\r\n                  /> \r\n                </Grid>\r\n              }\r\n              <Modal\r\n                aria-labelledby=\"delete-thing-modal\"\r\n                aria-describedby=\"delete-thing-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.state.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = e;\r\n  props.onChange(attr);\r\n};\r\nconst handleDefinedTypeChange = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   // attr[\"DefinedType\"] = newType._id;\r\n    //   // props.onChange(attr);\r\n    //   respond(newThing._id);\r\n    // }\r\n    // props.onNewThing(\r\n    //   // respond2,\r\n    //   props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    // );\r\n    const attr = props.attribute;\r\n    props.onNewThing(attr);\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues.push(selectedItem.Name);\r\n  props.onChange(attr);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o.Name);\r\n  });\r\n  props.onChange(attr);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    // function respond2(newThing) {\r\n    //   const attr = props.attribute;\r\n    //   attr.ListValues.push(newThing._id);\r\n    //   props.onChange(attr);\r\n    // }\r\n    \r\n    // setTimeout(() => {\r\n    const attr = props.attribute;\r\n    props.onNewThing(attr);\r\n    // }, 500);\r\n    // props.onNewThing(\r\n    //   // respond2,\r\n    //   // props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    //   props.attribute\r\n    // );\r\n  } else {\r\n    const attr = props.attribute;\r\n    attr.ListValues.push(selectedItem._id);\r\n    props.onChange(attr);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o._id);\r\n  });\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [value, changeValue] = useState(props.attribute.Value);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n\r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.attribute.ListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    if (definedType !== undefined) {\r\n      listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n      props.things\r\n        .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n        .forEach(t => {\r\n          listOptions.push({ Name: t.Name, _id: t._id });\r\n        });\r\n      listOptions\r\n        .filter(t => props.attribute.ListValues.includes(t._id))\r\n        .forEach(t => {\r\n          listOptionValues.push(t);\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Grid item container spacing={1} direction=\"row\">\r\n      <Grid item xs={11}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`attribute_name_${props.attribute.attrID}`}>{props.attribute.Name}</InputLabel>\r\n            <OutlinedInput\r\n              id={`attribute_name_${props.attribute.attrID}`}\r\n              name={`attribute_name_${props.attribute.attrID}`}\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9}\r\n              fullWidth\r\n              multiline\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name}</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.attribute.Value===\"True\"} onChange={e => {\r\n                const attr = props.attribute;\r\n                attr.Value = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(attr);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={props.attribute.Name}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name}\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name}\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props, changeValue);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={props.attribute.Name}\r\n                variant=\"outlined\" fullWidth\r\n                defaultValue={props.attribute.ListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n                blurBehavior=\"add\"\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={props.attribute.Name}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={props.attribute.Name}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item xs={1}>\r\n        <InfoIcon\r\n          style={{ cursor: \"pointer\" }}\r\n          onClick={ _ => {\r\n            props.infoModal(props.attribute);\r\n          }} \r\n        />\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  Grid, Modal, FormControl, InputLabel, \r\n  OutlinedInput, FormHelperText, Button,\r\n  // List,\r\n  // ListItem,\r\n} from \"@material-ui/core\";\r\nimport { \r\n  updateSelectedThing, addThing, logout\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedThing: state.app.selectedThing,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    logout: () => dispatch(logout({}))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n      infoModalOpen: false,\r\n      // infoAttribute: null,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.push({\r\n      index: thing.AttributesArr.length,\r\n      _id: null,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"Text\",\r\n      FromTypes: [],\r\n      Value: \"\",\r\n      ListValues: [],\r\n      FromTypeIDs: [],\r\n      TypeIDs: []\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    const attribute = thing.AttributesArr.filter(a=>a.attrID === value.attrID)[0];\r\n    attribute.Value = value.Value;\r\n    attribute.ListValues = value.ListValues;\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.splice(value.index, 1);\r\n    thing.AttributesArr.forEach(a => {\r\n      if (a.index > this.state.infoAttribute.index) {\r\n        a.index--;\r\n      }\r\n    })\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  optionsChange = (e, props) => {\r\n  }\r\n\r\n  // addNewThing = (respond, type) => {\r\n  //   // Opens a Modal where they enter a name.\r\n  //   this.setState({modalOpen: true, modalSubmit: respond, newThingType: type});\r\n  // }\r\n\r\n  addNewThing = (attribute) => {\r\n    this.props.addNewThing(attribute);\r\n  }\r\n\r\n  infoModal = (attribute) => {\r\n    this.props.onInfo(attribute);\r\n  }\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 100;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          thing.AttributesArr = [];\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            modalOpen: false\r\n          });\r\n        }\r\n        else if (res.error !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.error \r\n          }, () => {\r\n            this.props.logout();\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={1} direction=\"column\">\r\n        {this.props.selectedThing !== null && this.props.selectedThing !== undefined &&\r\n          this.props.selectedThing.AttributesArr.map((attribute, i) => {\r\n            return (\r\n              <AttributeControl\r\n                key={i}\r\n                thingID={this.props.selectedThing._id}\r\n                attribute={attribute}\r\n                onChange={this.changeAttribute}\r\n                onDelete={this.deleteAttribute}\r\n                onBlur={this.blurAttribute}\r\n                things={this.props.things}\r\n                types={this.props.types}\r\n                onNewThing={this.addNewThing}\r\n                infoModal={this.infoModal}\r\n              />\r\n            );\r\n          })\r\n        }\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.modalOpen}\r\n          onClose={e => {this.setState({modalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({modalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","import React, { Component, createRef } from 'react';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  updateType,\r\n  addType,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin,\r\n  toggleLogin,\r\n  logout,\r\n  selectWorld\r\n} from \"../../redux/actions/index\";\r\nimport { \r\n  Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, \r\n  FormHelperText, Grid, \r\n  Fab, Tooltip,\r\n  List, ListItem, ListItemText,\r\n  Select, MenuItem,\r\n  // Modal\r\n} from \"@material-ui/core\";\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { ArrowBack, Add, Search, Delete } from \"@material-ui/icons\";\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\nimport NewTypeModal from \"../../components/Modals/NewTypeModal\";\r\nimport NewThingModal from \"../../components/Modals/NewThingModal\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\nimport UnderConstruction from \"../../assets/img/under_construction.png\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Thing.  It will allow the use of Types to make\r\n  it faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: state.app.selectedThing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin,\r\n    typeSuggestions: state.app.typeSuggestions,\r\n    thingSuggestions: state.app.thingSuggestions\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({})),\r\n    toggleLogin: () => dispatch(toggleLogin({})),\r\n    logout: () => dispatch(logout({})),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      // Name: \"\",\r\n      // Description: \"\",\r\n      // Types: [],\r\n      // AttributesArr: [],\r\n      // Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        // AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" },\r\n        infoAttributeName: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: \"\",\r\n      resetting: false,\r\n      loaded: true,\r\n      errors: [],\r\n      infoAttribute: null,\r\n      typeModalOpen: false,\r\n      newTypeForAttribute: \"\",\r\n      browseAttributes: false,\r\n      browseAttributesFilter: \"\",\r\n      browseAttributesSelected: \"\",\r\n      thingModalOpen: false,\r\n      newThingType: null,\r\n      putThingOnAttribute: null,\r\n      majorType: null\r\n    };\r\n    this.api = API.getInstance();\r\n    this.refDescription = createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  createThingFromType = type => {\r\n    let types = [];\r\n    types.push(type);\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n          types.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      NeedsWork: false,\r\n      Types: [],\r\n      Attributes: []\r\n    };\r\n    let newAttributes = [];\r\n    types.forEach(type=> {\r\n      for (let i = 0; i < type.Attributes.length; i++) {\r\n        const attribute = {...type.Attributes[i]};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      }\r\n    });\r\n    types.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      thing.AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    thing.Types = types;\r\n    this.props.updateSelectedThing(thing);\r\n    this.setState({ \r\n      _id: null, \r\n      // Types: types, \r\n      loaded: true,\r\n      majorType: type\r\n    }); //, errors });\r\n  };\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined && !id.includes(\"type_id_\")) {\r\n        if (this.state.majorType === null) {\r\n          this.setState({\r\n            resetting: false, \r\n            redirectTo: `/thing/create`\r\n          });\r\n        } else {\r\n          this.setState({\r\n            resetting: false, \r\n            redirectTo: `/thing/create/type_id_${this.state.majorType._id}`\r\n          });\r\n        }\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        }, this.finishResettingForm);\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  finishResettingForm = () => {\r\n    const { id } = this.props.match.params;\r\n    if (id !== undefined && id.includes(\"type_id_\")) {\r\n      // We're creating it from a type rather than from blank\r\n      const typeID = id.substring(8);\r\n      let type = this.props.types.filter(t=> t._id === typeID);\r\n      if (type.length > 0) {\r\n        type = type[0];\r\n        this.createThingFromType(type);\r\n      }\r\n      else {\r\n        this.setState({ message: \"Invalid Type\" });\r\n      }\r\n    }\r\n  }\r\n\r\n  // handleUserInput = e => {\r\n  //   const name = e.target.name;\r\n  //   const value =\r\n  //     e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n  //   this.setState({ [name]: value });\r\n  // };\r\n\r\n  handleInfoAttrNameChange = e => {\r\n    const infoAttribute = this.state.infoAttribute;\r\n    infoAttribute.Name = e.target.value;\r\n    this.setState({ infoAttribute });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      (fieldValidation[name].valid !== validation.valid ||\r\n        fieldValidation[name].message !== validation.message)\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  inputBlur2 = e => {\r\n    const name = \"infoAttributeName\";\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      (fieldValidation[name].valid !== validation.valid ||\r\n        fieldValidation[name].message !== validation.message)\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  addSelectedAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    const attr = this.props.attributesByID[this.state.browseAttributesSelected];\r\n    const attributes = thing.Attributes;\r\n    const AttributesArr = thing.AttributesArr;\r\n    attributes.push({\r\n      attrID: this.state.browseAttributesSelected,\r\n      Value: \"\",\r\n      ListValues: [],\r\n      index: attributes.length,\r\n      FromTypeIDs: []\r\n    });\r\n    AttributesArr.push({\r\n      attrID: this.state.browseAttributesSelected,\r\n      index: AttributesArr.length,\r\n      Value: \"\",\r\n      ListValues: [],\r\n      Name: attr.Name,\r\n      AttributeType: attr.AttributeType,\r\n      Options: attr.Options,\r\n      DefinedType: attr.DefinedType,\r\n      ListType: attr.ListType,\r\n      FromTypeIDs: [],\r\n      TypeIDs: attr.TypeIDs\r\n    });\r\n    thing.Attributes = [];\r\n    thing.AttributesArr = [];\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n      this.setState({ browseAttributesSelected: \"\" });\r\n    }, 500);\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.props.selectedThing[fieldName].trim();\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      case \"infoAttributeName\":\r\n        value = this.state.infoAttribute.Name.trim();\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Attribute Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Attribute Name is too short\";\r\n        } else {\r\n          const attrByName = this.props.attributesByName[value];\r\n          valid = attrByName === undefined || attrByName._id === this.state.infoAttribute.attrID;\r\n          if (!valid) message = \"There is another Attribute with this name.\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedThing[fieldName];\r\n        value.forEach(a => {\r\n          if (valid && value.filter(attr2 => attr2.Name === a.Name).length > 1) {\r\n            valid = false;\r\n          }\r\n        });\r\n        message = valid ? \"\" : \"Attribute Names must be unique\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrValid = this.validateField(\"AttributesArr\");\r\n    const formValid = nameValid.valid && attrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  validateAttrForm = respond => {\r\n    const nameValid = this.validateField(\"infoAttributeName\");\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.infoAttributeName = nameValid;\r\n    this.setState(\r\n      {\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ \r\n          waiting: true, \r\n          addMore: addMore \r\n        }, \r\n        this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const typeIDs = this.props.selectedThing.Types.map(s => {\r\n      return s._id;\r\n    });\r\n    \r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.props.selectedThing.Name.trim(),\r\n      Description: this.props.selectedThing.Description.trim(),\r\n      NeedsWork: this.props.selectedThing.NeedsWork,\r\n      TypeIDs: typeIDs,\r\n      // AttributesArr: this.props.selectedThing.AttributesArr,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorld._id,\r\n      ReferenceIDs: []\r\n    };\r\n    this.props.selectedThing.AttributesArr.forEach(a => {\r\n      thing.Attributes.push({\r\n        attrID: a.attrID,\r\n        index: a.index,\r\n        Value: a.Value.trim(),\r\n        ListValues: a.ListValues\r\n      });\r\n      if (a.AttributeType === \"Type\") {\r\n        if (!thing.ReferenceIDs.includes(a.Value)) {\r\n          thing.ReferenceIDs.push(a.Value);\r\n        }\r\n      }\r\n      if (a.AttributeType === \"List\" && a.ListType === \"Type\") {\r\n        a.ListValues.forEach(v=> {\r\n          if (!thing.ReferenceIDs.includes(v)) {\r\n            thing.ReferenceIDs.push(v);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    if (thing._id === null) {\r\n      this.api\r\n        .createThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined){\r\n            // thing._id = res.thingID;\r\n            // thing.Types = this.state.Types;\r\n            // thing.AttributesArr = this.props.selectedThing.AttributesArr;\r\n            // this.props.addThing(thing);\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n\r\n              if (this.state.addMore === \"add\") {\r\n                this.props.updateSelectedThing({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  Description: \"\",\r\n                  NeedsWork: false,\r\n                  Types: this.state.majorType === null ? [] : [this.state.majorType],\r\n                  Attributes: [],\r\n                  AttributesArr: []\r\n                });\r\n                this.setState({\r\n                  _id: null,\r\n                  // Name: \"\",\r\n                  // Description: \"\",\r\n                  // Types: [],\r\n                  // Attributes: [],\r\n                  fieldValidation: {\r\n                    Name: { valid: true, message: \"\" },\r\n                    Attributes: { valid: true, message: \"\" }\r\n                  },\r\n                  formValid: false,\r\n                  message: \"\",\r\n                  waiting: false,\r\n                  resetting: true\r\n                }, this.resetForm);\r\n              } else if (this.state.addMore === \"next\") {\r\n                this.redirectToNext();\r\n              } else {\r\n                this.setState({\r\n                  waiting: false,\r\n                  redirectTo: `/project/details/${this.props.selectedWorld._id}`\r\n                });\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error}, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined) {\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n              \r\n              if (this.state.addMore === \"add\") {\r\n                this.props.updateSelectedThing({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  Description: \"\",\r\n                  NeedsWork: false,\r\n                  Types: this.state.majorType === null ? [] : [this.state.majorType],\r\n                  Attributes: [],\r\n                  AttributesArr: []\r\n                });\r\n                this.setState({\r\n                  // Name: \"\",\r\n                  // Description: \"\",\r\n                  // Types: [],\r\n                  // Attributes: [],\r\n                  fieldValidation: {\r\n                    Name: { valid: true, message: \"\" },\r\n                    Attributes: { valid: true, message: \"\" }\r\n                  },\r\n                  formValid: false,\r\n                  message: \"\",\r\n                  waiting: false,\r\n                  addMore: false,\r\n                  resetting: true\r\n                }, this.resetForm);\r\n              } else if (this.state.addMore === \"next\") {\r\n                this.redirectToNext();\r\n              } else {\r\n                this.setState({\r\n                  waiting: false,\r\n                  redirectTo: `/project/details/${this.props.selectedWorld._id}`\r\n                });\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error}, () => {\r\n              this.props.logout();\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  typesChange = (e, value) => {\r\n    let types = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      types.push(t);\r\n      types = types.concat(t.Types);\r\n    }\r\n    const thing = this.props.selectedThing;\r\n    thing.Types = types;\r\n    this.props.updateSelectedThing(thing);\r\n    // this.setState({ Types: types });\r\n  };\r\n\r\n  addType = (selectedList, selectedItem) => {\r\n    const thing = this.props.selectedThing;\r\n    const newTypes = {};\r\n    newTypes[selectedItem._id] = selectedItem;\r\n    selectedItem.Supers.forEach(s=>{\r\n      if (selectedList.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && selectedList.filter(t=>t._id === superType[0]._id).length === 0){\r\n          selectedList.push(superType[0]);\r\n          newTypes[superType[0]._id] = superType[0];\r\n        }\r\n      }\r\n      if (this.props.selectedThing.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes[s._id] = s;\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    Object.keys(newTypes).forEach(typeID => {\r\n      const type = newTypes[typeID];\r\n      type.Attributes.forEach(a => {\r\n        const attribute = {...a};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      });\r\n    });\r\n    Object.keys(newTypes).forEach(typeID => {\r\n      const type = newTypes[typeID];\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          if (attribute.Value === undefined) {\r\n            attribute.Value = \"\";\r\n            attribute.ListValues = [];\r\n          }\r\n          if (attribute.Value === \"\") {\r\n            attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          }\r\n          type.DefaultsHash[attribute.attrID].DefaultListValues.forEach(listValue => {\r\n            if (!attribute.ListValues.includes(listValue))\r\n              attribute.ListValues.push(listValue);\r\n          });\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    // this.setState({ Types: selectedList });\r\n    thing.Types = selectedList;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    const AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n    }, 500);\r\n  }\r\n\r\n  addType2 = (type) => {\r\n    const types = this.props.selectedThing.Types;\r\n    types.push(type);\r\n    // this.addType(types, type);\r\n\r\n    const newTypes = [type];\r\n    const thing = this.props.selectedThing;\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && types.filter(t=>t._id === superType[0]._id).length === 0){\r\n          types.push(superType[0]);\r\n          newTypes.push(superType[0]);\r\n        }\r\n      }\r\n      if (this.props.selectedThing.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes.push(s);\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    newTypes.forEach(type => {\r\n      type.Attributes.forEach(a => {\r\n        const attribute = {...a};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      });\r\n    });\r\n    newTypes.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    this.setState({ \r\n      // Types: types, \r\n      resetting: true \r\n    });\r\n    thing.Types = types;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    const AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n      this.setState({ resetting: false, infoAttribute: null });\r\n    }, 500);\r\n  }\r\n\r\n  selectNewTypeForAttribute = (e) => {\r\n    if (e.target.value === \"new\") {\r\n      function respond(newType) {\r\n        // attr[\"DefinedType\"] = newType._id;\r\n        this.setState({ newTypeForAttribute: newType._id });\r\n      }\r\n      this.setState({ typeModalOpen: true, modalSubmit: respond});\r\n    }\r\n    else \r\n      this.setState({ newTypeForAttribute: e.target.value });\r\n  }\r\n\r\n  saveInfoAttribute = () => {\r\n    function respond() {\r\n      if (this.state.fieldValidation.infoAttributeName.valid) {\r\n        this.setState({ \r\n          waiting: true\r\n        }, \r\n        this.submitAttributeThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateAttrForm(respond);\r\n  }\r\n\r\n  deleteInfoAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.splice(this.state.infoAttribute.index, 1);\r\n    thing.AttributesArr.forEach(a => {\r\n      if (a.index > this.state.infoAttribute.index) {\r\n        a.index--;\r\n      }\r\n    })\r\n\r\n    function respond() {\r\n      this.props.updateSelectedThing(thing);\r\n    }\r\n    this.setState({infoAttribute: null}, respond);\r\n  }\r\n\r\n  /**\r\n   * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p><p><br></p>\r\n   * gets translated to \r\n   * <p>First Reply <a href=\"/type/details/5e7694ce7fc0e1501c57f7cb\" rel=\"noopener noreferrer\" target=\"_blank\">Completed Item</a></p>\r\n   */\r\n  cleanWYSIWYG = (str) => {\r\n    if (str.endsWith(\"<p><br></p>\")) {\r\n      str = str.substring(0, str.length - 11);\r\n    }\r\n    return str;\r\n  }\r\n\r\n  submitAttributeThroughAPI = () => {\r\n    // Need to upsert the attribute, and then move forward\r\n\r\n    const attributes = [{\r\n      _id: this.state.infoAttribute.attrID,\r\n      Name: this.state.infoAttribute.Name.trim(),\r\n      AttributeType: this.state.infoAttribute.AttributeType,\r\n      Options: this.state.infoAttribute.Options,\r\n      DefinedType: this.state.infoAttribute.DefinedType,\r\n      ListType: this.state.infoAttribute.ListType\r\n    }];\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      if (res.error === undefined) {\r\n        // res.attributes is a hash with the name as key and id as value\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n          \r\n          const attribute = this.state.infoAttribute;\r\n          if (this.state.newTypeForAttribute !== \"\") {\r\n            attribute.TypeIDs.push(this.state.newTypeForAttribute);\r\n            attribute.FromTypeIDs.push(this.state.newTypeForAttribute);\r\n          }\r\n          const thing = this.props.selectedThing;\r\n          if (attribute.attrID === null) {\r\n            attribute.attrID = res.attributes[attribute.Name];\r\n            // Add it to the Thing's attributes\r\n            const attr2 = {\r\n              attrID: attribute.attrID,\r\n              index: thing.Attributes.length,\r\n              Value: \"\",\r\n              ListValues: []\r\n            };\r\n            thing.Attributes.push(attr2);\r\n            thing.AttributesArr.push({\r\n              attrID: attribute.attrID,\r\n              index: attr2.index,\r\n              Value: \"\",\r\n              ListValues: [],\r\n              Name: attribute.Name,\r\n              AttributeType: attribute.AttributeType,\r\n              Options: attribute.Options,\r\n              DefinedType: attribute.DefinedType,\r\n              ListType: attribute.ListType,\r\n              FromTypeIDs: attribute.FromTypeIDs,\r\n              TypeIDs: attribute.TypeIDs\r\n            });\r\n          }\r\n          else {\r\n            // Update the attribute on the Thing\r\n            const attr2 = thing.AttributesArr.filter(a => a.attrID === attribute.attrID)[0];\r\n            attr2.Name = attribute.Name;\r\n            attr2.AttributeType = attribute.AttributeType;\r\n            attr2.Options = attribute.Options;\r\n            attr2.DefinedType = attribute.DefinedType;\r\n            attr2.ListType = attribute.ListType;\r\n            attr2.FromTypeIDs = attribute.FromTypeIDs;\r\n            attr2.TypeIDs = attribute.TypeIDs;\r\n          }\r\n          if (attribute.FromTypeIDs.length === 0) {\r\n            this.props.updateSelectedThing(thing);\r\n            this.setState({infoAttribute: null, waiting: false});\r\n          }\r\n          else {\r\n            // Need to add it to the type\r\n            const theType = this.props.types.filter(t => t._id === attribute.FromTypeIDs[0])[0];\r\n            const type = {\r\n              _id: theType._id,\r\n              Name: theType.Name,\r\n              Description: this.cleanWYSIWYG(theType.Description),\r\n              NeedsWork: theType.NeedsWork,\r\n              SuperIDs: theType.SuperIDs,\r\n              // AttributesArr: this.props.selectedType.AttributesArr,\r\n              Attributes: theType.Attributes,\r\n              Defaults: theType.Defaults,\r\n              worldID: this.props.selectedWorld._id,\r\n              Major: theType.Major,\r\n              ReferenceIDs: theType.ReferenceIDs,\r\n              DefaultReferenceIDs: theType.DefaultReferenceIDs\r\n            };\r\n            type.Attributes.push({\r\n              attrID: attribute.attrID,\r\n              index: type.Attributes.length,\r\n              // Name: a.Name,\r\n              // AttributeType: a.AttributeType,\r\n              // Options: a.Options,\r\n              // DefinedType: a.DefinedType,\r\n              // ListType: a.ListType\r\n            });\r\n            this.api\r\n              .updateType(type)\r\n              .then(res => {\r\n                if (res.error === undefined) {\r\n                  type.Supers = [];\r\n                  type.SuperIDs.forEach(sID=> {\r\n                    type.Supers = type.Supers.concat(this.props.types.filter(t2=>t2._id === sID));\r\n                  });\r\n                  type.AttributesArr = [];\r\n                  type.Attributes.forEach(a => {\r\n                    const attr = this.props.attributesByID[a.attrID];\r\n                    type.AttributesArr.push({\r\n                      index: type.AttributesArr.length,\r\n                      Name: attr.Name,\r\n                      AttributeType: attr.AttributeType,\r\n                      Options: attr.Options,\r\n                      DefinedType: attr.DefinedType,\r\n                      ListType: attr.ListType,\r\n                      attrID: a.attrID\r\n                    });\r\n                  });\r\n                  const defHash = {};\r\n                  if (type.Defaults !== undefined) {\r\n                    type.Defaults.forEach(def => {\r\n                      defHash[def.attrID] = def;\r\n                    });\r\n                  }\r\n                  type.DefaultsHash = defHash;\r\n                  this.props.updateType(type);\r\n\r\n                  function respond() {\r\n                    this.addType2(type);\r\n                  }\r\n                  \r\n                  this.setState({\r\n                    infoAttribute: null, waiting: false\r\n                  }, respond);\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false, \r\n                    message: res.error \r\n                  }, () => {\r\n                    this.props.logout();\r\n                  });\r\n                }\r\n              })\r\n              .catch(err => console.log(err));\r\n          }\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ message: res.error, waiting: false }, () => {\r\n          this.props.logout();\r\n        });\r\n      }\r\n    });\r\n  }\r\n  \r\n  removeType = (selectedList, removedItem) => {\r\n    // TODO: Add a confirmation before doing this\r\n    // to let them know it will also remove sub-types.\r\n    let types = [];\r\n    let removeUs = [];\r\n    this.props.selectedThing.Types.forEach(checkMe => {\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else types.push(checkMe);\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.Attributes];\r\n    attributes.forEach(attribute => {\r\n      const newFromTypeIDs = [];\r\n      attribute.FromTypeIDs.forEach(typeID => {\r\n        if (!removeUs.includes(typeID))\r\n          newFromTypeIDs.push(typeID);\r\n      });\r\n      attribute.FromTypeIDs = newFromTypeIDs;\r\n    });\r\n    // this.setState({ Types: types });\r\n    thing.Types = types;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      thing.AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n\r\n  redirectToNext = () => {\r\n    // Find the next thing\r\n    const things = this.state.majorType === null ? this.props.things : this.props.things.filter(t => t.TypeIDs.includes(this.state.majorType._id));\r\n    let index = 0;\r\n    if (this.props.selectedThing === undefined || this.props.selectedThing._id !== null) {\r\n      while (things[index]._id !== this.props.selectedThing._id)\r\n        index++;\r\n      index++;\r\n    }\r\n    if (index === things.length)\r\n      index = 0;\r\n    this.setState({ \r\n      waiting: false, \r\n      redirectTo: `/thing/edit/${things[index]._id}` \r\n    });\r\n  }\r\n\r\n  renderHeader() {\r\n    let typeStr = \"Thing\";\r\n    this.props.selectedThing.Types.forEach(t=>{\r\n      if (t.Major) { \r\n        if (typeStr === \"Thing\") {\r\n          typeStr = t.Name;\r\n        }\r\n        else {\r\n          typeStr += \"/\" + t.Name;\r\n        }\r\n      }\r\n    });\r\n    return <h2>{this.state._id === null ? `Create New ${typeStr}` : `Edit ${typeStr}`}</h2>;\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.props.selectedWorldID) {\r\n      this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n        \r\n        if (this.props.fromLogin) {\r\n          this.props.notFromLogin();\r\n          this.setState({\r\n            // _id: id,\r\n            loaded: true,\r\n            message: \"\"\r\n          });\r\n        }\r\n        else {\r\n          if (this.state._id !== null) {\r\n            // We're editing an existing Thing\r\n            let thing = res.things.filter(t => t._id === this.state._id);\r\n            if (thing.length === 0) {\r\n              this.setState({ message: \"Invalid ID\" });\r\n            }\r\n            else {\r\n              thing = thing[0];\r\n              // const things = this.props.things.filter(\r\n              //   t => t._id !== thing._id\r\n              // );\r\n              let Types = [];\r\n              thing.TypeIDs.forEach(tID=> {\r\n                Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n              });\r\n              let newAttributes = [];\r\n              Types.forEach(type=> {\r\n                for (let i = 0; i < type.Attributes.length; i++) {\r\n                  const attribute = {...type.Attributes[i]};\r\n                  let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n                  if (existing.length === 0) {\r\n                    attribute.FromTypeIDs = [type._id];\r\n                    attribute.index = thing.Attributes.length + newAttributes.length;\r\n                    newAttributes.push(attribute);\r\n                  }\r\n                  else {\r\n                    existing = existing[0];\r\n                    if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n                      existing.FromTypeIDs = [];\r\n                    existing.FromTypeIDs.push(type._id);\r\n                  }\r\n                }\r\n              });\r\n              Types.forEach(type=> {\r\n                newAttributes.forEach(attribute => {\r\n                  if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n                    attribute.Value = \"\";\r\n                    attribute.ListValues = [];\r\n                  }\r\n                  else {\r\n                    attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n                    attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n                  }\r\n                })\r\n              });\r\n              let attributes = [...thing.Attributes, ...newAttributes];\r\n              attributes.forEach(a => {\r\n                if (a.FromTypeIDs === undefined) {\r\n                  a.FromTypeIDs = [];\r\n                }\r\n              });\r\n              thing.Attributes = attributes;\r\n              thing.AttributesArr = [];\r\n              thing.Attributes.forEach(a => {\r\n                // if (a.attrID !== undefined) {\r\n                const attr = this.props.attributesByID[a.attrID];\r\n                thing.AttributesArr.push({\r\n                  index: thing.AttributesArr.length,\r\n                  Name: attr.Name,\r\n                  AttributeType: attr.AttributeType,\r\n                  Options: attr.Options,\r\n                  DefinedType: attr.DefinedType,\r\n                  ListType: attr.ListType,\r\n                  attrID: a.attrID,\r\n                  Value: a.Value,\r\n                  ListValues: a.ListValues,\r\n                  FromTypeIDs: a.FromTypeIDs,\r\n                  TypeIDs: attr.TypeIDs\r\n                });\r\n                // }\r\n              });\r\n              thing.Types = Types;\r\n              this.props.updateSelectedThing(thing);\r\n              if (this.state.majorType === null) {\r\n                let majorType = thing.Types.filter(t=>t.Major);\r\n                if (majorType.length > 0) {\r\n                  majorType = majorType[0];\r\n                  \r\n                  this.setState({\r\n                    loaded: true,\r\n                    majorType\r\n                  });\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    loaded: true\r\n                  });\r\n                }\r\n              }\r\n              else {\r\n                this.setState({\r\n                  loaded: true\r\n                });\r\n              }\r\n            }\r\n          } else {\r\n            let { id } = this.props.match.params;\r\n            if (id !== undefined && id.includes(\"type_id_\")) {\r\n              // We're creating it from a type rather than from blank\r\n              const typeID = id.substring(8);\r\n              let type = this.props.types.filter(t=> t._id === typeID);\r\n              if (type.length > 0) {\r\n                type = type[0];\r\n                this.createThingFromType(type);\r\n              }\r\n              else {\r\n                this.setState({ message: \"Invalid Type\", loaded: true });\r\n              }\r\n            }\r\n            else {\r\n              // We're creating a new thing from blank.\r\n              this.props.updateSelectedThing({\r\n                _id: null,\r\n                Name: \"\",\r\n                Description: \"\",\r\n                NeedsWork: false,\r\n                Types: [],\r\n                Attributes: [],\r\n                AttributesArr: []\r\n              });\r\n              this.setState({ loaded: true });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      this.api.getWorldByThingID(this.state._id).then((res) => {\r\n        this.props.selectWorld(res.worldID);\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n        \r\n        if (this.props.fromLogin) {\r\n          this.props.notFromLogin();\r\n          this.setState({\r\n            // _id: id,\r\n            loaded: true,\r\n            message: \"\"\r\n          });\r\n        }\r\n        else {\r\n          if (this.state._id !== null) {\r\n            // We're editing an existing Thing\r\n            let thing = res.things.filter(t => t._id === this.state._id);\r\n            if (thing.length === 0) {\r\n              this.setState({ message: \"Invalid ID\" });\r\n            }\r\n            else {\r\n              thing = thing[0];\r\n              // const things = this.props.things.filter(\r\n              //   t => t._id !== thing._id\r\n              // );\r\n              let Types = [];\r\n              thing.TypeIDs.forEach(tID=> {\r\n                Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n              });\r\n              let newAttributes = [];\r\n              Types.forEach(type=> {\r\n                for (let i = 0; i < type.Attributes.length; i++) {\r\n                  const attribute = {...type.Attributes[i]};\r\n                  let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n                  if (existing.length === 0) {\r\n                    attribute.FromTypeIDs = [type._id];\r\n                    attribute.index = thing.Attributes.length + newAttributes.length;\r\n                    newAttributes.push(attribute);\r\n                  }\r\n                  else {\r\n                    existing = existing[0];\r\n                    if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n                      existing.FromTypeIDs = [];\r\n                    existing.FromTypeIDs.push(type._id);\r\n                  }\r\n                }\r\n              });\r\n              Types.forEach(type=> {\r\n                newAttributes.forEach(attribute => {\r\n                  if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n                    attribute.Value = \"\";\r\n                    attribute.ListValues = [];\r\n                  }\r\n                  else {\r\n                    attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n                    attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n                  }\r\n                })\r\n              });\r\n              let attributes = [...thing.Attributes, ...newAttributes];\r\n              attributes.forEach(a => {\r\n                if (a.FromTypeIDs === undefined) {\r\n                  a.FromTypeIDs = [];\r\n                }\r\n              });\r\n              thing.Attributes = attributes;\r\n              thing.AttributesArr = [];\r\n              thing.Attributes.forEach(a => {\r\n                // if (a.attrID !== undefined) {\r\n                const attr = this.props.attributesByID[a.attrID];\r\n                thing.AttributesArr.push({\r\n                  index: thing.AttributesArr.length,\r\n                  Name: attr.Name,\r\n                  AttributeType: attr.AttributeType,\r\n                  Options: attr.Options,\r\n                  DefinedType: attr.DefinedType,\r\n                  ListType: attr.ListType,\r\n                  attrID: a.attrID,\r\n                  Value: a.Value,\r\n                  ListValues: a.ListValues,\r\n                  FromTypeIDs: a.FromTypeIDs,\r\n                  TypeIDs: attr.TypeIDs\r\n                });\r\n                // }\r\n              });\r\n              thing.Types = Types;\r\n              this.props.updateSelectedThing(thing);\r\n              if (this.state.majorType === null) {\r\n                let majorType = thing.Types.filter(t=>t.Major);\r\n                if (majorType.length > 0) {\r\n                  majorType = majorType[0];\r\n                  \r\n                  this.setState({\r\n                    loaded: true,\r\n                    majorType\r\n                  });\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    loaded: true\r\n                  });\r\n                }\r\n              }\r\n              else {\r\n                this.setState({\r\n                  loaded: true\r\n                });\r\n              }\r\n            }\r\n          } else {\r\n            let { id } = this.props.match.params;\r\n            if (id !== undefined && id.includes(\"type_id_\")) {\r\n              // We're creating it from a type rather than from blank\r\n              const typeID = id.substring(8);\r\n              let type = this.props.types.filter(t=> t._id === typeID);\r\n              if (type.length > 0) {\r\n                type = type[0];\r\n                this.createThingFromType(type);\r\n              }\r\n              else {\r\n                this.setState({ message: \"Invalid Type\", loaded: true });\r\n              }\r\n            }\r\n            else {\r\n              // We're creating a new thing from blank.\r\n              this.props.updateSelectedThing({\r\n                _id: null,\r\n                Name: \"\",\r\n                Description: \"\",\r\n                NeedsWork: false,\r\n                Types: [],\r\n                Attributes: [],\r\n                AttributesArr: []\r\n              });\r\n              this.setState({ loaded: true });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined || id.includes(\"type_id_\"))\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n      return (<span>Loading...</span>);\r\n    } else if (!this.state.loaded) {\r\n      return (<span>Loading...</span>);\r\n    } else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      this.props.user === null) {\r\n      setTimeout(() => {\r\n        this.props.toggleLogin();\r\n      }, 500);\r\n      return <span>Requires Login</span>;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedThing === null || this.props.selectedThing._id !== id) {\r\n      return <span>Loading...</span>;\r\n    } else if (this.state.typeModalOpen) {\r\n      return (\r\n        <NewTypeModal \r\n          types={this.props.types}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({typeModalOpen: false});\r\n          }}\r\n          addType={type => {\r\n            this.props.addType(type);\r\n          }}\r\n          onSave={type => {\r\n            this.setState({typeModalOpen: false, newTypeForAttribute: type._id});\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else if (this.state.infoAttribute !== null) {\r\n      const connectedTypes = this.props.types.filter(t=> this.state.infoAttribute.FromTypeIDs.includes(t._id));\r\n      const otherTypes = this.props.types.filter(t=> !this.state.infoAttribute.FromTypeIDs.includes(t._id) && this.state.infoAttribute.TypeIDs.includes(t._id));\r\n      if (connectedTypes.length === 0) {\r\n        if (otherTypes.length === 0) {\r\n          const attributeTypes = [\r\n            \"Text\",\r\n            \"Number\",\r\n            \"True/False\",\r\n            \"Options\", \r\n            \"Type\", \r\n            \"List\"\r\n          ];\r\n          const listTypes = [\r\n            \"Text\",\r\n            \"Options\", \r\n            \"Type\"\r\n          ];\r\n          // This attribute isn't on any types, so we need to give the ability to add it to a type, as well as to edit it.\r\n          return (\r\n            <Grid item xs={12} container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <List>\r\n                  <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"infoAttributeName\">Name</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"infoAttributeName\"\r\n                        name=\"infoAttributeName\"\r\n                        type=\"text\"\r\n                        autoComplete=\"Off\"\r\n                        error={!this.state.fieldValidation.infoAttributeName.valid}\r\n                        value={this.state.infoAttribute.Name}\r\n                        onChange={this.handleInfoAttrNameChange}\r\n                        onBlur={this.inputBlur2}\r\n                        labelWidth={43}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>\r\n                        {this.state.fieldValidation.infoAttributeName.message}\r\n                      </FormHelperText>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n                        Attribute Type\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"attribute-type-label\"\r\n                        id=\"attribute-type\"\r\n                        disabled={this.state.waiting}\r\n                        // disabled={props.attribute.FromSupers.length > 0} \r\n                        value={this.state.infoAttribute.AttributeType}\r\n                        onChange={e => {\r\n                          const attr = this.state.infoAttribute;\r\n                          attr[\"AttributeType\"] = e.target.value;\r\n                          this.setState({ infoAttribute: attr });\r\n                        }}\r\n                        fullWidth\r\n                        labelWidth={100}\r\n                      >\r\n                        {attributeTypes.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  { this.state.infoAttribute.AttributeType === \"List\" && \r\n                    <ListItem>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                          List Type\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"list-type-label\"\r\n                          id=\"list-type\"\r\n                          disabled={this.state.waiting}\r\n                          // disabled={props.attribute.FromSupers.length > 0} \r\n                          value={this.state.infoAttribute.ListType}\r\n                          onChange={e => {\r\n                            const attr = this.state.infoAttribute;\r\n                            attr[\"ListType\"] = e.target.value;\r\n                            this.setState({ infoAttribute: attr });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={70}\r\n                        >\r\n                          {listTypes.map((type, i) => {\r\n                            return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                    <ListItem>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                          Defined Type\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"definedType-label\"\r\n                          id=\"definedType\"\r\n                          disabled={this.state.waiting}\r\n                          // disabled={props.attribute.FromSupers.length > 0} \r\n                          value={this.state.infoAttribute.DefinedType}\r\n                          onChange={e => {\r\n                            const attr = this.state.infoAttribute;\r\n                            attr[\"DefinedType\"] = e.target.value;\r\n                            if (e.target.value === \"new\") {\r\n                              function respond(newType) {\r\n                                attr[\"DefinedType\"] = newType._id;\r\n                                this.setState({ typeModalOpen: false, infoAttribute: attr });\r\n                              }\r\n                              this.setState({ typeModalOpen: true, modalSubmit: respond});\r\n                            }\r\n                            else \r\n                              this.setState({ infoAttribute: attr });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={100}\r\n                        >\r\n                          <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                          {this.props.types.map((type, i) => {\r\n                            return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                    <ListItem>\r\n                      <ChipInput\r\n                        variant=\"outlined\"\r\n                        disabled={this.state.waiting}\r\n                        // disabled={props.attribute.FromSupers.length > 0}\r\n                        defaultValue={this.state.infoAttribute.Options}\r\n                        onChange={chips => {\r\n                          const attr = this.state.infoAttribute;\r\n                          attr[\"Options\"] = chips;\r\n                          this.setState({ infoAttribute: attr });\r\n                        }}\r\n                      />\r\n                    </ListItem>\r\n                  }\r\n                  <ListItem>\r\n                    Select a Type to add this attribute to, and to add to {this.props.selectedThing.Name}\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"newTypeForAttribute\" id=\"newTypeForAttribute-label\">\r\n                        Type For Attribute\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"newTypeForAttribute-label\"\r\n                        id=\"newTypeForAttribute\"\r\n                        value={this.state.newTypeForAttribute}\r\n                        onChange={e => {this.selectNewTypeForAttribute(e)}}\r\n                        fullWidth\r\n                        labelWidth={125}\r\n                      >\r\n                        <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                        {this.props.types.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    Or you can also remove this attribute from {this.props.selectedThing.Name}\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <Tooltip title={`Delete Attribute`}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.deleteInfoAttribute}\r\n                      >\r\n                        <Delete />\r\n                      </Button>\r\n                    </Tooltip>\r\n                  </ListItem>\r\n                </List>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveInfoAttribute}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={_ => {this.setState({infoAttribute: null})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid item xs={12} container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <List>\r\n                  <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                  <ListItem>Name: {this.state.infoAttribute.Name}</ListItem>\r\n                  <ListItem>Type: {this.state.infoAttribute.AttributeType}</ListItem>\r\n                  { this.state.infoAttribute.AttributeType === \"List\" && \r\n                    <ListItem>List Type: {this.state.infoAttribute.ListType}</ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                    <ListItem>\r\n                      Defined Type: \r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={ _ => {this.setState({redirectTo:`/type/details/${this.state.infoAttribute.DefinedType}`})}}\r\n                      >\r\n                        {this.props.types.filter(t=>t._id === this.state.infoAttribute.DefinedType)[0].Name}\r\n                      </Button>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                    <ListItem>\r\n                      Options: \r\n                      {this.state.infoAttribute.Options.map((option, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            {j === 0 ? \" \" : \", \"}\r\n                            {option}\r\n                          </span>\r\n                        );\r\n                      })}\r\n                    </ListItem>\r\n                  }\r\n                  <ListItem>\r\n                    { otherTypes.length === 1 ? \"Type associated with this attribute:\" : \"Types associated with this attribute:\" }\r\n                    <List>\r\n                      { otherTypes.map((type, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                            >\r\n                              {type.Name}\r\n                            </Button>\r\n\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.addType2(type)}}\r\n                            >\r\n                              Add {type.Name} to {this.props.selectedThing.Name}\r\n                            </Button>\r\n                          </span>\r\n                        );\r\n                      })}\r\n                    </List>\r\n                  </ListItem>\r\n                </List>\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  fullWidth\r\n                  variant=\"contained\"\r\n                  onClick={e => {this.setState({infoAttribute: null})}}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid item xs={12} container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <List>\r\n                <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                <ListItem>Name: {this.state.infoAttribute.Name}</ListItem>\r\n                <ListItem>Type: {this.state.infoAttribute.AttributeType}</ListItem>\r\n                { this.state.infoAttribute.AttributeType === \"List\" && \r\n                  <ListItem>List Type: {this.state.infoAttribute.ListType}</ListItem> \r\n                }\r\n                { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                  <ListItem>\r\n                    Defined Type: \r\n                    <Button\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/type/details/${this.state.infoAttribute.DefinedType}`})}}\r\n                    >\r\n                      {this.props.types.filter(t=>t._id === this.state.infoAttribute.DefinedType)[0].Name}\r\n                    </Button>\r\n                  </ListItem> \r\n                }\r\n                { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                  <ListItem>\r\n                    Options: \r\n                    {this.state.infoAttribute.Options.map((option, j) => {\r\n                      return (\r\n                        <span key={j}>\r\n                          {j === 0 ? \" \" : \", \"}\r\n                          {option}\r\n                        </span>\r\n                      );\r\n                    })}\r\n                  </ListItem>\r\n                }\r\n                { connectedTypes.length > 0 &&\r\n                  <ListItem>\r\n                    { connectedTypes.length === 1 ? \"From Type:\" : \"From Types:\" }\r\n                    {\r\n                      connectedTypes.map((type, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            {j === 0 ? \" \" : \", \"}\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                            >\r\n                              {type.Name}\r\n                            </Button>\r\n                          </span>\r\n                        );\r\n                      })\r\n                    }\r\n                  </ListItem>\r\n                }\r\n                { otherTypes.length > 0 &&\r\n                  <ListItem>\r\n                    { otherTypes.length === 1 ? \"Other Associated Type:\" : \"Other Associated Types:\" }\r\n                    { otherTypes.map((type, j) => {\r\n                      return (\r\n                        <span key={j}>\r\n                          {j === 0 ? \" \" : \", \"}\r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                          >\r\n                            {type.Name}\r\n                          </Button>\r\n                        </span>\r\n                      );\r\n                    })}\r\n                  </ListItem>\r\n                }\r\n              </List>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button\r\n                variant=\"contained\"\r\n                onClick={e => {this.setState({infoAttribute: null})}}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    } else if (this.state.thingModalOpen) {\r\n      return (\r\n        <NewThingModal \r\n          things={this.props.things}\r\n          newThingType={this.state.newThingType}\r\n          selectedWorldID={this.props.selectedWorldID}\r\n          onCancel={_ => {\r\n            this.setState({\r\n              thingModalOpen: false\r\n            });\r\n          }}\r\n          addThing={thing => {\r\n            this.props.addThing(thing);\r\n          }}\r\n          onSave={newThing => {\r\n            // Need to put it on putThingOnAttribute\r\n            const thing = this.props.selectedThing;\r\n            const attr = thing.AttributesArr.filter(a => a.attrID === this.state.putThingOnAttribute.attrID)[0];\r\n            if (attr.AttributeType === \"Type\") {\r\n              attr.Value = newThing._id;\r\n            }\r\n            else {\r\n              // The only way it can be here is if it's List and ListType is Type\r\n              attr.ListValues.push(newThing._id);\r\n            }\r\n            this.props.updateSelectedThing(thing);\r\n            this.setState({\r\n              thingModalOpen: false\r\n            });\r\n          }}\r\n          api={this.api}\r\n          logout={() => {\r\n            this.props.logout();\r\n          }}\r\n        />\r\n      );\r\n    } else {\r\n      let additionalAttributes = [];\r\n      if (this.state.browseAttributes) {\r\n        Object.keys(this.props.attributesByID).forEach(id => {\r\n          if (this.props.selectedThing.Attributes.filter(a => a.attrID === id).length === 0){\r\n            additionalAttributes.push(this.props.attributesByID[id]);\r\n          }\r\n        });\r\n      }\r\n      const suggestions = [...this.props.typeSuggestions, ...this.props.thingSuggestions];\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld !== null &&\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/project/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={7} sm={9}>\r\n                  {this.renderHeader()}\r\n                </Grid>\r\n                <Grid item xs={4} sm={2}>\r\n                  <ListItem>\r\n                    { this.state.majorType === null && this.props.things.length > 1 ?\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary=\"Next\" />\r\n                      </Button>\r\n                    : this.state.majorType !== null && this.props.things.filter(t => t.TypeIDs.includes(this.state.majorType._id)).length > 1 &&\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={_ => {\r\n                          this.redirectToNext();\r\n                        }}\r\n                      >\r\n                        <ListItemText primary={`Next ${this.state.majorType.Name}`}/>\r\n                      </Button>\r\n                    }\r\n                  </ListItem>\r\n                </Grid>\r\n              </Grid>\r\n              { !this.state.resetting &&\r\n                <Grid item container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    { this.state.loaded && \r\n                      <TextBox \r\n                        Value={this.props.selectedThing.Name} \r\n                        fieldName=\"Name\" \r\n                        message={this.state.fieldValidation.Name.message}\r\n                        onBlur={name => {\r\n                          const thing = this.props.selectedThing;\r\n                          thing.Name = name;\r\n                          this.props.updateSelectedThing(thing);\r\n                          this.validateForm();\r\n                          // this.setState({ Name: name }, this.validateForm);\r\n                        }}\r\n                        labelWidth={43}/>\r\n                    }\r\n                  </Grid>\r\n                  <Grid item>\r\n                    { this.state.loaded &&  \r\n                      <TextBox \r\n                        Value={this.props.selectedThing.Description} \r\n                        fieldName=\"Description\" \r\n                        multiline={true}\r\n                        onBlur={desc => {\r\n                          const thing = this.props.selectedThing;\r\n                          thing.Description = desc;\r\n                          this.props.updateSelectedThing(thing);\r\n                          // this.setState({ Description: desc });\r\n                        }}\r\n                        options={suggestions}\r\n                        labelWidth={82}/>\r\n                    }\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          icon={\r\n                            <img style={{ opacity: \"0.5\", height: \"30px\" }} src={UnderConstruction} alt=\"No Work Planned\" /> \r\n                          } \r\n                          checkedIcon={\r\n                            <img style={{ height: \"30px\" }} src={UnderConstruction} alt=\"Needs Work\" />\r\n                          }\r\n                          checked={this.props.selectedThing.NeedsWork}\r\n                          onChange={ e => {\r\n                            const value = e.target.checked;\r\n                            const thing = this.props.selectedThing;\r\n                            thing.NeedsWork = value;\r\n                            this.props.updateSelectedThing(thing);\r\n                            // this.setState({ [name]: value });\r\n                            // this.handleUserInput(e);\r\n                          }}\r\n                          name=\"NeedsWork\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Needs Work\"\r\n                    />\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <Multiselect\r\n                      placeholder=\"Types\"\r\n                      options={this.props.types}\r\n                      selectedValues={this.props.selectedThing.Types}\r\n                      onSelect={this.addType}\r\n                      onRemove={this.removeType}\r\n                      displayValue=\"Name\"\r\n                    />\r\n                  </Grid>\r\n                  <Grid item container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <span>Attributes&nbsp;\r\n                        <Tooltip title={`Add New Attribute`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {\r\n                              this.setState({ infoAttribute: {\r\n                                index: this.props.selectedThing.AttributesArr.length,\r\n                                Name: \"\",\r\n                                AttributeType: \"Text\",\r\n                                Options: [],\r\n                                DefinedType: \"\",\r\n                                ListType: \"\",\r\n                                attrID: null,\r\n                                Value: \"\",\r\n                                ListValues: [],\r\n                                FromTypeIDs: [],\r\n                                TypeIDs: []\r\n                              }});\r\n                            }}\r\n                          >\r\n                            <Add />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                        <Tooltip title={`Browse Additional Attributes`}>\r\n                          <Fab\r\n                            size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {\r\n                              this.setState({ browseAttributes: !this.state.browseAttributes });\r\n                            }}\r\n                          >\r\n                            <Search />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </span>\r\n                    </Grid>\r\n                    { this.state.browseAttributes && \r\n                      <Grid item container spacing={1} direction=\"row\">\r\n                        <Grid item xs={12} sm={6}>\r\n                          <FormControl variant=\"outlined\" fullWidth>\r\n                            <InputLabel htmlFor=\"browseForAttributes\" id=\"browseForAttributes-label\">\r\n                              Browse Additional Attributes\r\n                            </InputLabel>\r\n                            <Select\r\n                              labelId=\"browseForAttributes-label\"\r\n                              id=\"browseForAttributes\"\r\n                              value={this.state.browseAttributesSelected}\r\n                              onChange={e => {\r\n                                this.setState({ browseAttributesSelected: e.target.value });\r\n                              }}\r\n                              fullWidth\r\n                              labelWidth={200}\r\n                            >\r\n                              {additionalAttributes.map((attr, i) => {\r\n                                return (<MenuItem key={i} value={attr._id}>{attr.Name}</MenuItem>);\r\n                              })}\r\n                            </Select>\r\n                          </FormControl>\r\n                        </Grid>\r\n                        <Grid item xs={12} sm={6}>\r\n                          <Button\r\n                            variant=\"contained\" color=\"primary\"\r\n                            disabled={ this.state.browseAttributesSelected === \"\" }\r\n                            onClick={e => {this.addSelectedAttribute();}}\r\n                            type=\"submit\"\r\n                          >\r\n                            Add Attribute\r\n                          </Button>\r\n                        </Grid>\r\n                      </Grid>\r\n                    }\r\n                    { this.state.loaded &&\r\n                      <AttributesControl \r\n                        addNewThing={attribute => {\r\n                          this.setState({ \r\n                            thingModalOpen: true,\r\n                            newThingType: this.props.types.filter(t => t._id === attribute.DefinedType)[0],\r\n                            putThingOnAttribute: attribute\r\n                          });\r\n                        }} \r\n                        onInfo={e => {\r\n                          this.setState({ infoAttribute: e});\r\n                        }} />\r\n                    }\r\n                    <FormHelperText>\r\n                      {this.state.fieldValidation.Attributes.message}\r\n                    </FormHelperText>\r\n                  </Grid>\r\n                  { ((this.state.majorType === null && this.props.things.length > 0) || (this.state.majorType !== null && this.props.things.filter(t => t.TypeIDs.includes(this.state.majorType._id)).length > 0)) ? \r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"next\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit and Edit Next\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"add\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={3}>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={_ => {\r\n                            if (this.props.selectedThing._id === null) {\r\n                              this.setState({\r\n                                redirectTo: `/project/details/${this.props.selectedWorldID}`\r\n                              });\r\n                            }\r\n                            else {\r\n                              this.setState({\r\n                                redirectTo: `/thing/details/${this.props.selectedThing._id}`\r\n                              });\r\n                            }\r\n                          }}\r\n                          type=\"button\"\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  :\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12} sm={4}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"add\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={4}>\r\n                        <Button\r\n                          variant=\"contained\" \r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={e => {this.onSubmit(\"\")}}\r\n                          type=\"submit\"\r\n                        >\r\n                          {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={4}>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          fullWidth\r\n                          disabled={this.state.waiting}\r\n                          onClick={_ => {\r\n                            if (this.props.selectedThing._id === null) {\r\n                              this.setState({\r\n                                redirectTo: `/project/details/${this.props.selectedWorldID}`\r\n                              });\r\n                            }\r\n                            else {\r\n                              this.setState({\r\n                                redirectTo: `/thing/details/${this.props.selectedThing._id}`\r\n                              });\r\n                            }\r\n                          }}\r\n                          type=\"button\"\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  }\r\n                  <Grid item>{this.state.message}</Grid>\r\n                  <Grid item>\r\n                    {this.state.errors.map((e, key) => {\r\n                      return (<div key={key}>{e}</div>);\r\n                    })}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                      if (\r\n                        this.state.fieldValidation[fieldName] !== undefined &&\r\n                        this.state.fieldValidation[fieldName].message.length > 0\r\n                      ) {\r\n                        return (\r\n                          <p className=\"redFont\" key={i}>\r\n                            {this.state.fieldValidation[fieldName].message}\r\n                          </p>\r\n                        );\r\n                      } else {\r\n                        return \"\";\r\n                      }\r\n                    })}\r\n                  </Grid>\r\n                </Grid>\r\n              }\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport API from '../../smartAPI';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      resetPasswordCode: null,\r\n      codeValid: false,\r\n      password: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        password: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const passwordValid = this.validateField(\"password\");\r\n    const confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n    const formValid = \r\n      passwordValid.valid && \r\n      confirmPasswordValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    this.api.resetPassword(this.state.resetPasswordCode, this.state.password).then(res => {\r\n      this.setState({ \r\n        message: res.message,\r\n        waiting: false\r\n      });\r\n    })\r\n    .catch(err => console.log(err));\r\n  }\r\n\r\n  render() {\r\n    if (this.state.resetPasswordCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkResetPasswordCode(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({resetPasswordCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({resetPasswordCode: id, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"outlined-adornment-password\"\r\n                      name=\"password\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.password}\r\n                      error={ !this.state.fieldValidation.password.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={70}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"confirm-password\"\r\n                      name=\"confirmPassword\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.confirmPassword}\r\n                      error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={130}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"float-right\">\r\n                <Button className=\"w200\" disabled={this.state.waiting}\r\n                  onClick={this.onSubmit}\r\n                  type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {this.state.message}\r\n          {\r\n            Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })\r\n          }\r\n        </div>\r\n      );\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ResetPasswordPage = connect()(Page);\r\nexport default ResetPasswordPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      confirmEmailCode: null,\r\n      codeValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  render() {\r\n    if (this.state.confirmEmailCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.confirmEmail(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({confirmEmailCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({confirmEmailCode: id, codeValid: true, message: res.message});\r\n          }\r\n        });\r\n      }, 500);\r\n    }\r\n    return (\r\n      <div>\r\n        <h2>Confirming Email</h2>\r\n        {this.state.message}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst ConfirmEmailPage = connect()(Page);\r\nexport default ConfirmEmailPage;\r\n","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { \r\n  Route, \r\n  Switch } from \"react-router-dom\";\r\n  import { connect } from \"react-redux\";\r\nimport HomePage from \"./Home\";\r\nimport GeneralDiscussionPage from \"./Discussion/GeneralDiscussion\";\r\nimport ProfilePage from \"./User/Profile\";\r\n// import UserEditPage from \"./User/Edit\";\r\nimport WorldDetailsPage from \"./World/Details\";\r\nimport WorldEditPage from \"./World/Edit\";\r\nimport CollaboratePage from \"./World/Collaborate\";\r\nimport EditCollaboratorsPage from \"./World/EditCollaborators\";\r\n// import WorldDeletePage from \"./World/Delete\";\r\nimport TypeDetailsPage from \"./Type/Details\";\r\nimport TypeEditPage from \"./Type/Edit\";\r\n// import TypeDeletePage from \"./Type/Delete\";\r\nimport ThingDetailsPage from \"./Thing/Details\";\r\nimport ThingEditPage from \"./Thing/Edit\";\r\nimport ResetPasswordPage from \"./User/ResetPassword\";\r\nimport ConfirmEmailPage from \"./User/ConfirmEmail\";\r\n// import ThingDeletePage from \"./Thing/Delete\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport LoginControl from './User/LoginControl';\r\nimport {\r\n  toggleLogin\r\n} from \"../redux/actions/index\";\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    loginOpen: state.app.loginOpen\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item className=\"h-100 margined\">\r\n          { this.props.loginOpen ?\r\n            <LoginControl onLogin={_ => { \r\n              this.props.toggleLogin();\r\n            }}/>\r\n          :\r\n            <Switch>\r\n              {/* <Route exact path=\"/Template\" component={TemplatePage} /> */}\r\n              <Route exact path=\"/\" component={HomePage} />\r\n              <Route exact path=\"/home\" component={HomePage} />\r\n              <Route exact path=\"/User/Profile\" component={ProfilePage} />\r\n              <Route exact path=\"/User/resetPassword/:id\" component={ResetPasswordPage} />\r\n              <Route exact path=\"/User/confirmEmail/:id\" component={ConfirmEmailPage} />\r\n              {/* <Route exact path=\"/profile\" component={UserEditPage} /> */}\r\n              \r\n              {/* <Route exact path=\"/test/:testtext\" component={Test} /> */}\r\n              <Route exact path=\"/discussion\" component={GeneralDiscussionPage} />\r\n              <Route exact path=\"/project/details/:id\" component={WorldDetailsPage} />\r\n              <Route exact path=\"/project/create\" component={WorldEditPage} />\r\n              <Route exact path=\"/project/edit/:id\" component={WorldEditPage} />\r\n              <Route exact path=\"/project/collaborators/:id\" component={EditCollaboratorsPage} />\r\n              <Route exact path=\"/project/collaborate/:worldID/:collabID\" component={CollaboratePage} />\r\n              {/* <Route exact path=\"/project/delete/:id\" component={WorldDeletePage} /> */}\r\n              <Route exact path=\"/type/create\" component={TypeEditPage} />\r\n              <Route exact path=\"/type/details/:id\" component={TypeDetailsPage} />\r\n              <Route exact path=\"/type/edit/:id\" component={TypeEditPage} />\r\n              {/* <Route exact path=\"/type/delete/:id\" component={TypeDeletePage} /> */}\r\n              <Route exact path=\"/thing/create\" component={ThingEditPage} />\r\n              <Route exact path=\"/thing/create/:id\" component={ThingEditPage} />\r\n              <Route exact path=\"/thing/details/:id\" component={ThingDetailsPage} />\r\n              <Route exact path=\"/thing/edit/:id\" component={ThingEditPage} />\r\n              {/* <Route exact path=\"/thing/delete/:id\" component={ThingDeletePage} /> */}\r\n            </Switch>\r\n          }\r\n        </Grid>\r\n        <Grid item style={{ minHeight: \"100px\" }}>&nbsp;</Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst MainPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default MainPage;\r\n","\nimport React, { Component } from \"react\";\nimport \"./assets/css/material-dashboard-react.css\";\nimport {\n  BrowserRouter as Router\n} from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport NavBar from \"./components/Navigation/Navbar\";\nimport Sidebar from \"./components/Navigation/Sidebar\";\nimport MainPage from \"./views/MainPage\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport { \n  setWidth,\n  setAPI\n} from \"./redux/actions/index\";\nimport API from \"./smartAPI\";\nimport \"./assets/css/quill.snow.css\";\n\nconst mapStateToProps = state => {\n  return {\n    menuOpen: state.app.menuOpen,\n    api: state.app.api\n  };\n};\nfunction mapDispatchToProps(dispatch) {\n  return {\n    setWidth: width => dispatch(setWidth(width)),\n    setAPI: api => dispatch(setAPI(api))\n  };\n}\nclass AppLayout extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      version: \"0\",\n      width: 0,\n      marginLeft: 220\n    };\n    this.api = API.getInstance();\n  }\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    let w = window.innerWidth;\n    if (w >= 600) {\n      w -= 200;\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 220, innerWidth: window.innerWidth });\n    }\n    else {\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 0, innerWidth: window.innerWidth });\n    }\n  }\n\n  render() {\n    if (this.props.api === null) {\n      this.props.setAPI(this.api);\n    }\n    return (\n      <Router>\n        {this.props.menuOpen &&\n          <Box display={{ xs: 'none', sm: 'inline' }} className=\"Sidebar\">\n            <Sidebar className=\"\" logoText={\"Author's Notebook\"} />\n          </Box>\n        }\n        <Grid container>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft : 0}px`, \n              width: `${this.props.menuOpen ? this.state.width : this.state.innerWidth}px` \n            }}>\n            <NavBar />\n          </Grid>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft + 10 : 10}px`, \n              width: `${this.props.menuOpen ? this.state.width - 20 : this.state.innerWidth - 20}px`,\n              marginRight: \"10px\",\n              marginTop: \"10px\" \n            }}>\n            <MainPage />\n          </Grid>\n        </Grid>\n      </Router>\n    );\n  }\n}\n\nconst App = connect(mapStateToProps, mapDispatchToProps)(AppLayout);\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\r\n  UPDATE_INDEX_EXPANDED_PANEL,\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOGOUT,\r\n  REDIRECT_TO,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  SET_TEMPLATES,\r\n  SET_ALL_USERS,\r\n  ADD_WORLD,\r\n  ADD_AND_SELECT_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  // UPDATE_ATTRIBUTES_ARR,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_ATTRIBUTES,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  TOGGLE_LOGIN,\r\n  NOT_FROM_LOGIN,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH\r\n} from \"../constants/actionTypes\";\r\n\r\nconst initialState = {\r\n  indexExpandedPanel: false,\r\n  api: null,\r\n  articles: [],\r\n  user: null,\r\n  redirectToURL: null,\r\n  loginError: \"\",\r\n  worlds: [],\r\n  publicWorlds: [],\r\n  followingWorlds: [],\r\n  selectedWorld: null,\r\n  selectedWorldID: null,\r\n  types: [],\r\n  things: [],\r\n  selectedType: null,\r\n  // attributesArr: [],\r\n  // attributes: [],\r\n  attributesByID: {},\r\n  attributesByName: {},\r\n  selectedThing: null,\r\n  loadIt: true,\r\n  menuOpen: true,\r\n  loginOpen: false,\r\n  fromLogin: false,\r\n  width: 0,\r\n  templates: [],\r\n  allUsers: [],\r\n  userSuggestions: [],\r\n  collabSuggestions: [],\r\n  worldSuggestions: [],\r\n  typeSuggestions: [],\r\n  thingSuggestions: []\r\n};\r\nfunction rootReducer(state = initialState, action) {\r\n  if (action.type === UPDATE_INDEX_EXPANDED_PANEL) {\r\n    return Object.assign({}, state, {\r\n      indexExpandedPanel: action.payload\r\n    });\r\n  } else if (action.type === LOAD_FROM_STORAGE) {\r\n    let user = JSON.parse(localStorage.getItem(\"user\"));\r\n    if (user !== undefined && user !== null && user.body !== undefined && user.body.user !== undefined)\r\n      user = user.body.user;\r\n    else \r\n      user = null;\r\n    const selectedWorld = JSON.parse(localStorage.getItem(\"selectedWorld\"));\r\n    const selectedWorldID = localStorage.getItem(\"selectedWorldID\");\r\n    const types = JSON.parse(localStorage.getItem(\"types\"));\r\n    const things = JSON.parse(localStorage.getItem(\"things\"));\r\n    const followingWorlds = JSON.parse(localStorage.getItem(\"followingWorlds\"));\r\n    const attributesByID = JSON.parse(localStorage.getItem(\"attributesByID\"));\r\n    const attributesByName = JSON.parse(localStorage.getItem(\"attributesByName\"));\r\n    const worldSuggestions = JSON.parse(localStorage.getItem(\"worldSuggestions\"));\r\n    const userSuggestions = JSON.parse(localStorage.getItem(\"userSuggestions\"));\r\n    const collabSuggestions = JSON.parse(localStorage.getItem(\"collabSuggestions\"));\r\n    const typeSuggestions = JSON.parse(localStorage.getItem(\"typeSuggestions\"));\r\n    const thingSuggestions = JSON.parse(localStorage.getItem(\"thingSuggestions\"));\r\n    \r\n    return Object.assign({}, state, {\r\n      user: user,\r\n      // worlds: worlds === null ? [] : worlds,\r\n      // publicWorlds: publicWorlds === null ? [] : publicWorlds,\r\n      selectedWorld,\r\n      selectedWorldID,\r\n      types: types === null ? [] : types,\r\n      things: things === null ? [] : things,\r\n      followingWorlds: followingWorlds === null ? [] : followingWorlds,\r\n      // attributes: attributes === null ? [] : attributes,\r\n      attributesByID: attributesByID === null ? {} : attributesByID,\r\n      attributesByName: attributesByName === null ? {} : attributesByName,\r\n      worldSuggestions: worldSuggestions === null ? [] : worldSuggestions,\r\n      userSuggestions: userSuggestions === null ? [] : userSuggestions,\r\n      collabSuggestions: collabSuggestions === null ? [] : collabSuggestions,\r\n      typeSuggestions: typeSuggestions === null ? [] : typeSuggestions,\r\n      thingSuggestions: thingSuggestions === null ? [] : thingSuggestions\r\n    });\r\n  } else if (action.type === SET_API) {\r\n    return Object.assign({}, state, {\r\n      api: action.payload\r\n    });\r\n  } else if (action.type === ADD_ARTICLE) {\r\n    return Object.assign({}, state, {\r\n      articles: state.articles.concat(action.payload)\r\n    });\r\n  } else if (action.type === LOGIN) {\r\n    localStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload.followingWorlds));\r\n    return Object.assign({}, state, {\r\n      user: action.payload, \r\n      followingWorlds: action.payload.followingWorlds\r\n    });\r\n  } else if (action.type === LOGOUT) {\r\n    return Object.assign({}, state, {\r\n      user: null\r\n    });\r\n  } else if (action.type === REDIRECT_TO) {\r\n    return Object.assign({}, state, {\r\n      redirectToURL: action.payload\r\n    });\r\n  } else if (action.type === SET_WORLDS) {\r\n    if (action.payload !== undefined && action.payload.error === undefined){\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          localStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            selectedWorld: world,\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          worlds: action.payload,\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === SET_PUBLIC_WORLDS) {\r\n    if (action.payload.error === undefined) {\r\n      const worldSuggestions = [];\r\n      action.payload.forEach(w => {\r\n        worldSuggestions.push({\r\n          _id: w._id,\r\n          suggestionType: \"world\",\r\n          Display: `${w.Name}`\r\n        });\r\n      });\r\n      localStorage.setItem(\"worldSuggestions\", JSON.stringify(worldSuggestions));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          localStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          \r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload,\r\n            selectedWorld: world,\r\n            worldSuggestions\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload,\r\n            worldSuggestions\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          publicWorlds: action.payload,\r\n          worldSuggestions\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === SET_TEMPLATES) {\r\n    return Object.assign({}, state, {\r\n      templates: action.payload\r\n    });\r\n  } else if (action.type === SET_ALL_USERS) {\r\n    const userSuggestions = [];\r\n    action.payload.forEach(u => {\r\n      // userSuggestions.push(`${u.username}-${u._id}`);\r\n      userSuggestions.push({\r\n        _id: u._id,\r\n        suggestionType: \"user\",\r\n        Display: `${u.username}`\r\n      });\r\n    });\r\n    localStorage.setItem(\"userSuggestions\", JSON.stringify(userSuggestions));\r\n    if (state.selectedWorld !== null){\r\n      const collabSuggestions = [];\r\n      action.payload.forEach(u => {\r\n        if (state.selectedWorld.Owner === u._id || (state.selectedWorld.Collaborators !== undefined && state.selectedWorld.Collaborators !== null && state.selectedWorld.Collaborators.filter(c => c.userID === u._id).length > 0)) {\r\n          // collabSuggestions.push(`${u.username}-${u._id}`);\r\n          collabSuggestions.push({\r\n            _id: u._id,\r\n            suggestionType: \"user\",\r\n            Display: `${u.username}`\r\n          });\r\n        }\r\n      });\r\n      localStorage.setItem(\"collabSuggestions\", JSON.stringify(collabSuggestions));\r\n      return Object.assign({}, state, {\r\n        allUsers: action.payload,\r\n        userSuggestions,\r\n        collabSuggestions\r\n      });\r\n    } else {\r\n      return Object.assign({}, state, {\r\n        allUsers: action.payload,\r\n        userSuggestions\r\n      });\r\n    }\r\n  } else if (action.type === ADD_WORLD) {\r\n    if (action.payload.Public) {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      const publicWorlds = state.publicWorlds.concat(action.payload);\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      return Object.assign({}, state, {\r\n        worlds: state.worlds.concat(action.payload)\r\n      });\r\n    }\r\n  } else if (action.type === ADD_AND_SELECT_WORLD) {\r\n    if (action.payload.Public) {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      const publicWorlds = state.publicWorlds.concat(action.payload);\r\n      \r\n      const world = action.payload;\r\n      localStorage.setItem(\"selectedWorldID\", action.payload._id);\r\n      localStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n      if (state.allUsers.length > 0) {\r\n        const collabSuggestions = [];\r\n        state.allUsers.forEach(u => {\r\n          if (world.Owner === u._id) {\r\n            // collabSuggestions.push(`${u.username}-${u._id}`);\r\n            collabSuggestions.push({\r\n              _id: u._id,\r\n              suggestionType: \"user\",\r\n              Display: `${u.username}`\r\n            });\r\n          }\r\n        });\r\n        localStorage.setItem(\"collabSuggestions\", JSON.stringify(collabSuggestions));\r\n        return Object.assign({}, state, {\r\n          selectedWorldID: action.payload._id,\r\n          selectedWorld: world,\r\n          attributesByID: {},\r\n          attributesByName: {},\r\n          types: [],\r\n          things: [],\r\n          selectedType: null,\r\n          selectedThing: null,\r\n          collabSuggestions,\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          selectedWorldID: action.payload,\r\n          selectedWorld: world,\r\n          attributesByID: {},\r\n          attributesByName: {},\r\n          types: [],\r\n          things: [],\r\n          selectedType: null,\r\n          selectedThing: null,\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      }\r\n    } else {\r\n      const world = action.payload;\r\n      localStorage.setItem(\"selectedWorldID\", action.payload._id);\r\n      localStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n      if (state.allUsers.length > 0) {\r\n        const collabSuggestions = [];\r\n        state.allUsers.forEach(u => {\r\n          if (world.Owner === u._id) {\r\n            // collabSuggestions.push(`${u.username}-${u._id}`);\r\n            collabSuggestions.push({\r\n              _id: u._id,\r\n              suggestionType: \"user\",\r\n              Display: `${u.username}`\r\n            });\r\n          }\r\n        });\r\n        localStorage.setItem(\"collabSuggestions\", JSON.stringify(collabSuggestions));\r\n        return Object.assign({}, state, {\r\n          selectedWorldID: action.payload._id,\r\n          selectedWorld: world,\r\n          attributesByID: {},\r\n          attributesByName: {},\r\n          types: [],\r\n          things: [],\r\n          selectedType: null,\r\n          selectedThing: null,\r\n          collabSuggestions,\r\n          worlds: state.worlds.concat(action.payload)\r\n        });\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          selectedWorldID: action.payload,\r\n          selectedWorld: world,\r\n          attributesByID: {},\r\n          attributesByName: {},\r\n          types: [],\r\n          things: [],\r\n          selectedType: null,\r\n          selectedThing: null,\r\n          worlds: state.worlds.concat(action.payload)\r\n        });\r\n      }\r\n    }\r\n  } else if (action.type === UPDATE_WORLD) {\r\n    const worlds = [...state.worlds];\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = worlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Name = action.payload.Name;\r\n    world.Description = action.payload.Description;\r\n    const wasPublic = world.Public;\r\n    world.Public = action.payload.Public;\r\n    world.AcceptingCollaborators = action.payload.AcceptingCollaborators;\r\n    world.Collaborators = action.payload.Collaborators;\r\n    if (world.Public) {\r\n      if (wasPublic) {\r\n        // It was already public so we just need to update the name\r\n        const publicWorld = publicWorlds.filter(t => t._id === world._id)[0];\r\n        publicWorld.Name = world.Name;\r\n      }\r\n      else {\r\n        // It's been changed to public, so we need to add it\r\n        publicWorlds = publicWorlds.concat(world);\r\n      }\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      if (wasPublic) {\r\n        // It used to be public, so we need to remove it\r\n        publicWorlds = publicWorlds.filter(t => t._id !== world._id);\r\n        return Object.assign({}, state, {\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      }\r\n      else {\r\n        // It's still not public, so we can leave it\r\n        return Object.assign({}, state, {\r\n          worlds\r\n        });\r\n      }\r\n    }\r\n  } else if (action.type === UPDATE_PUBLIC_WORLD_COLLAB) {\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = publicWorlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Collaborators = action.payload.Collaborators;\r\n    return Object.assign({}, state, {\r\n      publicWorlds\r\n    });\r\n  } else if (action.type === SELECT_WORLD) {\r\n    let world = state.worlds.filter(world => world._id === action.payload);\r\n    if (world.length === 0)\r\n      world = state.publicWorlds.filter(world => world._id === action.payload);\r\n    if (world.length > 0) {\r\n      world = world[0];\r\n      localStorage.setItem(\"selectedWorldID\", action.payload);\r\n      localStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n      if (state.allUsers.length > 0) {\r\n        const collabSuggestions = [];\r\n        state.allUsers.forEach(u => {\r\n          if (world.Owner === u._id || (world.Collaborators !== undefined && world.Collaborators !== null && world.Collaborators.filter(c => c.userID === u._id).length > 0)) {\r\n            collabSuggestions.push({\r\n              _id: u._id,\r\n              suggestionType: \"user\",\r\n              Display: `${u.username}`\r\n            });\r\n          }\r\n        });\r\n        localStorage.setItem(\"collabSuggestions\", JSON.stringify(collabSuggestions));\r\n        return Object.assign({}, state, {\r\n          selectedWorldID: action.payload,\r\n          selectedWorld: world,\r\n          attributesByID: {},\r\n          attributesByName: {},\r\n          types: [],\r\n          things: [],\r\n          selectedType: null,\r\n          selectedThing: null,\r\n          collabSuggestions,\r\n          thingSuggestions: [],\r\n          typeSuggestions: []\r\n        });\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          selectedWorldID: action.payload,\r\n          selectedWorld: world,\r\n          attributesByID: {},\r\n          attributesByName: {},\r\n          types: [],\r\n          things: [],\r\n          selectedType: null,\r\n          selectedThing: null,\r\n          thingSuggestions: [],\r\n          typeSuggestions: []\r\n        });\r\n      }\r\n    } else {\r\n      localStorage.setItem(\"selectedWorldID\", action.payload);\r\n      localStorage.removeItem(\"selectedWorld\");\r\n      localStorage.removeItem(\"collabSuggestions\");\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: null,\r\n        attributesByID: {},\r\n        attributesByName: {},\r\n        types: [],\r\n        things: [],\r\n        selectedType: null,\r\n        selectedThing: null,\r\n        collabSuggestions: [],\r\n        thingSuggestions: [],\r\n        typeSuggestions: []\r\n      });\r\n    }\r\n  } else if (action.type === SET_ATTRIBUTES) {\r\n    const attributesByID = {};\r\n    const attributesByName = {};\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    localStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    localStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === UPDATE_ATTRIBUTES) {\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    localStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    localStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      // attributes: action.payload,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === ADD_ATTRIBUTES) {\r\n    // const attributes = state.attributes.concat(action.payload);\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    localStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    localStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n    \r\n    return Object.assign({}, state, {\r\n      // attributes: attributes,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === SET_TYPES) {\r\n    localStorage.setItem(\"types\", JSON.stringify(action.payload));\r\n    const typeSuggestions = [];\r\n    action.payload.forEach(t => {\r\n      // typeSuggestions.push(`${t.Name}-${t._id}`);\r\n      typeSuggestions.push({\r\n        _id: t._id,\r\n        suggestionType: \"type\",\r\n        Display: `${t.Name}`\r\n      });\r\n    });\r\n    localStorage.setItem(\"typeSuggestions\", JSON.stringify(typeSuggestions));\r\n    return Object.assign({}, state, {\r\n      types: action.payload,\r\n      typeSuggestions\r\n    });\r\n  } else if (action.type === ADD_TYPE) {\r\n    const types = state.types.concat(action.payload);\r\n    localStorage.setItem(\"types\", JSON.stringify(types));\r\n    const typeSuggestions = [];\r\n    types.forEach(t => {\r\n      // typeSuggestions.push(`${t.Name}-${t._id}`);\r\n      typeSuggestions.push({\r\n        _id: t._id,\r\n        suggestionType: \"type\",\r\n        Display: `${t.Name}`\r\n      });\r\n    });\r\n    localStorage.setItem(\"typeSuggestions\", JSON.stringify(typeSuggestions));\r\n    return Object.assign({}, state, {\r\n      types,\r\n      typeSuggestions\r\n    });\r\n  } else if (action.type === SET_THINGS) {\r\n    localStorage.setItem(\"things\", JSON.stringify(action.payload));\r\n    \r\n    const thingSuggestions = [];\r\n    action.payload.forEach(t => {\r\n      // thingSuggestions.push(`${t.Name}-${t._id}`);\r\n      thingSuggestions.push({\r\n        _id: t._id,\r\n        suggestionType: \"thing\",\r\n        Display: `${t.Name}`\r\n      });\r\n      t.Types.forEach(t2 => {\r\n        // thingSuggestions.push(`${t2.Name}-${t.Name}-${t._id}`);\r\n        thingSuggestions.push({\r\n          _id: t._id,\r\n          suggestionType: \"thing\",\r\n          Display: `${t2.Name}-${t.Name}`\r\n        });\r\n      });\r\n    });\r\n    localStorage.setItem(\"thingSuggestions\", JSON.stringify(thingSuggestions));\r\n    return Object.assign({}, state, {\r\n      things: action.payload, \r\n      thingSuggestions\r\n    });\r\n  } else if (action.type === ADD_THING) {\r\n    const things = state.things.concat(action.payload);\r\n    localStorage.setItem(\"things\", JSON.stringify(things));\r\n    const thingSuggestions = [];\r\n    things.forEach(t => {\r\n      // thingSuggestions.push(`${t.Name}-${t._id}`);\r\n      thingSuggestions.push({\r\n        _id: t._id,\r\n        suggestionType: \"thing\",\r\n        Display: `${t.Name}`\r\n      });\r\n      t.Types.forEach(t2 => {\r\n        // thingSuggestions.push(`${t2.Name}-${t.Name}-${t._id}`);\r\n        thingSuggestions.push({\r\n          _id: t._id,\r\n          suggestionType: \"thing\",\r\n          Display: `${t2.Name}-${t.Name}`\r\n        });\r\n      });\r\n    });\r\n    localStorage.setItem(\"thingSuggestions\", JSON.stringify(thingSuggestions));\r\n    \r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === UPDATE_SELECTED_TYPE) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedType = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedType: changedType\r\n    });\r\n  } else if (action.type === UPDATE_TYPE) {\r\n    const types = [...state.types];\r\n    const type = types.filter(t => t._id === action.payload._id)[0];\r\n    type.Name = action.payload.Name;\r\n    type.Description = action.payload.Description;\r\n    type.Supers = action.payload.Supers;\r\n    type.AttributesArr = action.payload.AttributesArr;\r\n    type.Attributes = action.payload.Attributes;\r\n    localStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  // } else if (action.type === UPDATE_ATTRIBUTES_ARR) {\r\n  //   return Object.assign({}, state, {\r\n  //     attributesArr: action.payload\r\n  //   });\r\n  } else if (action.type === UPDATE_SELECTED_THING) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedThing = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedThing: changedThing\r\n    });\r\n  } else if (action.type === UPDATE_THING) {\r\n    const things = [...state.things];\r\n    const thing = things.filter(t => t._id === action.payload._id)[0];\r\n    thing.Name = action.payload.Name;\r\n    thing.Description = action.payload.Description;\r\n    thing.Types = action.payload.Types;\r\n    thing.Attributes = action.payload.Attributes;\r\n    localStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === TOGGLE_MENU) {\r\n    return Object.assign({}, state, {\r\n      menuOpen: !state.menuOpen\r\n    });\r\n  } else if (action.type === TOGGLE_LOGIN) {\r\n    return Object.assign({}, state, {\r\n      fromLogin: state.loginOpen,\r\n      loginOpen: !state.loginOpen\r\n    });\r\n  } else if (action.type === NOT_FROM_LOGIN) {\r\n    return Object.assign({}, state, {\r\n      fromLogin: false\r\n    });\r\n  } else if (action.type === SET_WIDTH) {\r\n    return Object.assign({}, state, {\r\n      width: action.payload\r\n    });\r\n  } else if (action.type === SET_FOLLOWING_WORLDS) {\r\n    localStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      followingWorlds: action.payload\r\n    });\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default rootReducer;\r\n\r\nexport const login = (user, history) => {};\r\n\r\nexport const logout = history => {};\r\n","import { createStore, combineReducers } from \"redux\";\r\nimport { sessionService, sessionReducer } from \"redux-react-session\";\r\nimport rootReducer from \"../reducers/index\";\r\nconst reducers = {\r\n  app: rootReducer,\r\n  session: sessionReducer\r\n};\r\n\r\nconst reducer = combineReducers(reducers);\r\nconst store = createStore(reducer);\r\nconst validateSession = session => {\r\n  // check if your session is still valid\r\n  return true;\r\n};\r\nconst options = {\r\n  refreshFromLocalStorage: true,\r\n  refreshOnCheckAuth: true,\r\n  redirectPath: \"/home\",\r\n  driver: \"COOKIES\",\r\n  validateSession\r\n};\r\n\r\nsessionService\r\n  .initSessionService(store, options)\r\n  .then(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and a session was refreshed from your storage\"\r\n    )\r\n  )\r\n  .catch(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and there is no session in your storage\"\r\n    )\r\n  );\r\nexport default store;\r\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store/index\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/under_construction_white.378ee889.png\";"],"sourceRoot":""}
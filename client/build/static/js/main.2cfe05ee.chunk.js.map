{"version":3,"sources":["assets/img/ANB.png","redux/actions/index.js","redux/constants/actionTypes.js","smartAPI.js","views/Home.js","views/Template.js","components/Navigation/routes.js","components/Navigation/MobileMenu.js","components/Navigation/Navbar.js","components/Navigation/Sidebar.js","views/Forum/ForumMenu.js","views/User/LoginControl.js","views/User/Login.js","views/User/Edit.js","views/World/Index.js","views/World/Details.js","views/World/Edit.js","views/World/Collaborate.js","views/World/EditCollaborators.js","views/Type/Details.js","views/Type/AttributeControl.js","views/Type/AttributeDefaultControl.js","views/Type/AttributesControl.js","components/Inputs/TextBox.js","views/Type/Edit.js","views/Thing/Details.js","views/Thing/AttributeControl.js","views/Thing/AttributesControl.js","components/Modals/NewTypeModal.js","views/Thing/Edit.js","views/User/ResetPassword.js","views/User/ConfirmEmail.js","views/MainPage.js","App.js","serviceWorker.js","redux/reducers/index.js","redux/store/index.js","index.js"],"names":["module","exports","setWorlds","payload","type","updateWorld","setPublicWorlds","selectWorld","setAttributes","setTypes","addType","setThings","addThing","updateType","updateSelectedType","updateThing","updateSelectedThing","toggleMenu","toggleLogin","notFromLogin","setFollowingWorlds","UnauthorizedError","message","this","name","prototype","Error","API","instance","getInstance","APIClass","logErrorReason","reason","console","log","Promise","reject","checkStatus","response","status","unauthorizedError","statusText","error","getVersion","a","real","fetchData","processResponse","version","getAllUsers","_id","email","username","login","user","postData","logout","register","confirmEmail","code","patchData","sendReset","checkResetPasswordCode","resetPassword","newPassword","emailTest","updateUser","getWorldsForUser","getWorldsForUserFromAPI","data","sessionStorage","getItem","JSON","parse","OwnerID","Name","Public","getPublicWorlds","getPublicWorldsFromAPI","getWorld","worldID","refresh","getAttributesForWorld","attributes","getTypesForWorld","types","getThingsForWorld","things","attributesByID","attributesByName","forEach","attribute","TypeIDs","t","Supers","SuperIDs","sID","concat","filter","t2","AttributesArr","Attributes","attr","attrID","undefined","push","index","length","trim","AttributeType","Options","DefinedType","ListType","defHash","Defaults","def","DefaultsHash","Types","tID","createWorld","world","deleteWorld","deleteData","generateCollabLink","addNewCollaborator","userID","emailCollaborator","deleteCollab","collabID","updateCollaboratorPermission","editPermission","checkCollabID","requestToCollaborate","declineCollabInvite","acceptCollabInvite","getAttributesForWorldFromAPI","getAttribute","Description","createAttribute","upsertAttributes","getTypesForWorldFromAPI","getType","typeID","createType","deleteType","getThingsForWorldFromAPI","getThing","thingID","createThing","thing","deleteThing","path","options","fetch","mode","credentials","headers","Accept","then","catch","method","body","stringify","putData","sessionName","json","setItem","Page","props","state","Component","HomePage","connect","className","TemplatePage","selectedPage","app","dispatch","menuRoutes","icon","Home","component","Forum","Menu","toggleFollow","follow","followingWorlds","indexOf","splice","api","handleUserInput","e","target","value","checked","setState","browse","Filter","res","worlds","map","prop","key","ListItem","to","onClick","_","style","width","activeClassName","button","Icon","ListItemText","primary","otherWorlds","publicWorlds","w","toLowerCase","includes","Grid","container","spacing","direction","item","FormControl","variant","fullWidth","InputLabel","htmlFor","OutlinedInput","id","autoComplete","onChange","labelWidth","List","Fab","size","color","Star","links","display","Tooltip","title","Search","Add","myWorlds","MobileMenu","worldIDs","Bar","menuClick","loadFromStorage","AppBar","position","Toolbar","xs","IconButton","aria-label","selectedWorld","cursor","mobileMenuOpen","Box","sm","NavBar","menuOpen","setTimeout","src","logo","alt","logoText","brand","Divider","light","Sidebar","window","location","pathname","ForumMenuPage","Control","componentDidMount","validateField","remember","inputBlur","validation","fieldValidation","valid","handleClickShowPassword","showPassword","handleMouseDownPassword","event","preventDefault","fieldName","match","password","allUsers","u","validateForm","respond","emailValid","confirmEmailValid","passwordValid","confirmPasswordValid","usernameValid","formMode","formValid","confirmPassword","onSubmit","waiting","submitThroughAPI","errors","loginError","show","cookies","Cookies","set","userLogin","onLogin","err","loginClick","registerClick","passwordClick","emailCookie","get","passCookie","onBlur","FormHelperText","endAdornment","InputAdornment","onMouseDown","edge","FormControlLabel","control","Checkbox","label","Link","Button","disabled","Object","keys","i","LoginControl","redirectTo","Helmet","LoginPage","UserEditPage","Index","handleChange","panel","updateIndexExpandedPanel","indexExpandedPanel","majorLess","Major","majorless","editButtons","Owner","Collaborators","c","createButtons","maxWidth","j","ThingIndex","delete","selectedWorldID","res2","res3","modalOpen","getModalStyle","top","Math","round","innerHeight","left","innerWidth","transform","load","updatePublicWorldForCollab","respondToInvite","invite","getTypes","updateAttributes","getThings","params","People","AcceptingCollaborators","Modal","aria-labelledby","aria-describedby","open","onClose","WorldDetailsPage","a11yProps","nameValid","addWorld","ArrowBack","marginLeft","WorldEditPage","accept","accepted","submitAccept","getWorlds","onLoginAccept","decline","submitDecline","codeValid","CollaboratePage","TabPanel","children","p","selectedUser","collabs","inviteMessage","inviteEmail","collaborator","permission","collabLink","collabLinkCopied","collab","copyCollabLink","generatedLink","select","document","execCommand","newCollaborators","newCollabTab","collabTab","invites","requests","userMenuItems","MenuItem","Tabs","newValue","Tab","Select","labelId","ref","input","multiline","FileCopyOutlined","fontColor","direcion","EditCollaboratorPage","finishLoading","loaded","selectedType","references","ReferenceIDs","inheritedAttributes","superType","definedType","option","DefaultValue","DefaultListValues","defaultValue","subTypes","sub","instances","TypeDetails","handleDefinedTypeChange","onNewType","newType","handleOptionsChange","AttributeControl","useState","changeName","attributeTypes","listTypes","selectedListType","selectedDefinedType","fromTypes","FromTypeIDs","handleTypeChange","chips","handleListTypeChange","onDelete","AttributeDefaultControl","changeValue","attributeType","listOptions","listOptionValues","o","onNewThing","newThing","placeholder","handleTextListChange","selectedValues","onSelect","selectedItem","addOption","onRemove","selectedList","removeOption","displayValue","removeType","newAttribute","uuid","changeAttribute","changeDefault","blurAttribute","deleteAttribute","defaults","addNewType","typeModalOpen","modalSubmit","addNewThing","thingModalOpen","newThingType","saveNewType","saveNewThing","submitThingThroughAPI","typeIDs","s","defaultsMode","inheritedAttribute","AttributesControl","TextBox","Value","resetForm","resetting","attrByName","attrArrValid","addMore","superIDs","typeAttributes","DefaultReferenceIDs","FromTypeID","supersChange","supers","addSuper","s2","duplicateAttributes","d","addSelectedAttribute","browseAttributesSelected","browseTypesSelected","addBrowsedType","attrType","removeSuper","removedItem","removeUs","checkMe","fromLogin","browseAttributes","additionalAttributes","selectedAttributeTypes","selectedAttributeName","found","desc","TypeEditPage","addAttributes","attrs","finishDelete","ListValues","selectedThing","listValue","ThingDetails","FromTypes","infoModal","optionsChange","onInfo","infoModalOpen","NewTypeModal","changeMessage","changeWaiting","onCancel","validate","onSave","createThingFromType","newAttributes","existing","finishResettingForm","substring","handleInfoAttrNameChange","infoAttribute","inputBlur2","attr2","attrValid","validateAttrForm","infoAttributeName","v","typesChange","newTypes","addType2","selectNewTypeForAttribute","newTypeForAttribute","saveInfoAttribute","submitAttributeThroughAPI","theType","newFromTypeIDs","browseAttributesFilter","typeStr","connectedTypes","otherTypes","fontSize","renderHeader","ThingEditPage","resetPasswordCode","ResetPasswordPage","confirmEmailCode","ConfirmEmailPage","loginOpen","exact","EditCollaboratorsPage","TypeDetailsPage","ThingDetailsPage","MainPage","AppLayout","updateDimensions","addEventListener","bind","removeEventListener","setWidth","setAPI","marginRight","marginTop","App","Boolean","hostname","initialState","articles","loadIt","rootReducer","reducers","action","assign","removeItem","worldArr","wasPublic","publicWorld","changedType","changedAt","Date","now","changedThing","session","sessionReducer","reducer","combineReducers","store","createStore","refreshFromLocalStorage","refreshOnCheckAuth","redirectPath","driver","validateSession","sessionService","initSessionService","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.2cfe05ee.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import {\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOG_OUT,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_ATTRIBUTES,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  TOGGLE_LOGIN,\r\n  NOT_FROM_LOGIN,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH,\r\n  UPDATE_INDEX_EXPANDED_PANEL\r\n} from \"../constants/actionTypes\";\r\n\r\nexport function updateIndexExpandedPanel(payload) {\r\n  return { type: UPDATE_INDEX_EXPANDED_PANEL, payload };\r\n}\r\nexport function setAPI(payload) {\r\n  return { type: SET_API, payload };\r\n}\r\nexport function addArticle(payload) {\r\n  return { type: ADD_ARTICLE, payload };\r\n}\r\nexport function userLogin(payload) {\r\n  return { type: LOGIN, payload };\r\n}\r\nexport function logOut(payload) {\r\n  return { type: LOG_OUT, payload };\r\n}\r\nexport function setWorlds(payload) {\r\n  return { type: SET_WORLDS, payload };\r\n}\r\nexport function addWorld(payload) {\r\n  return { type: ADD_WORLD, payload };\r\n}\r\nexport function updateWorld(payload) {\r\n  return { type: UPDATE_WORLD, payload };\r\n}\r\nexport function updatePublicWorldForCollab(payload) {\r\n  return { type: UPDATE_PUBLIC_WORLD_COLLAB, payload };\r\n}\r\nexport function setPublicWorlds(payload) {\r\n  return { type: SET_PUBLIC_WORLDS, payload };\r\n}\r\nexport function selectWorld(payload) {\r\n  return { type: SELECT_WORLD, payload };\r\n}\r\nexport function setAttributes(payload) {\r\n  return { type: SET_ATTRIBUTES, payload };\r\n}\r\nexport function addAttributes(payload) {\r\n  return { type: ADD_ATTRIBUTES, payload };\r\n}\r\nexport function updateAttributes(payload) {\r\n  return { type: UPDATE_ATTRIBUTES, payload };\r\n}\r\nexport function setTypes(payload) {\r\n  return { type: SET_TYPES, payload };\r\n}\r\nexport function addType(payload) {\r\n  return { type: ADD_TYPE, payload };\r\n}\r\nexport function setThings(payload) {\r\n  return { type: SET_THINGS, payload };\r\n}\r\nexport function addThing(payload) {\r\n  return { type: ADD_THING, payload };\r\n}\r\nexport function updateType(payload) {\r\n  return { type: UPDATE_TYPE, payload };\r\n}\r\nexport function updateSelectedType(payload) {\r\n  return { type: UPDATE_SELECTED_TYPE, payload };\r\n}\r\nexport function updateThing(payload) {\r\n  return { type: UPDATE_THING, payload };\r\n}\r\nexport function updateSelectedThing(payload) {\r\n  return { type: UPDATE_SELECTED_THING, payload };\r\n}\r\nexport function loadFromStorage(payload) {\r\n  return { type: LOAD_FROM_STORAGE, payload };\r\n}\r\nexport function toggleMenu(payload) {\r\n  return { type: TOGGLE_MENU, payload };\r\n}\r\nexport function toggleLogin(payload) {\r\n  return { type: TOGGLE_LOGIN, payload };\r\n}\r\nexport function notFromLogin(payload) {\r\n  return { type: NOT_FROM_LOGIN, payload };\r\n}\r\nexport function setFollowingWorlds(payload) {\r\n  return { type: SET_FOLLOWING_WORLDS, payload };\r\n}\r\nexport function setWidth(payload) {\r\n  return { type: SET_WIDTH, payload };\r\n}\r\n","\r\nexport const UPDATE_INDEX_EXPANDED_PANEL = \"UPDATE_INDEX_EXPANDED_PANEL\";\r\nexport const SET_API = \"SET_API\";\r\nexport const ADD_ARTICLE = \"ADD_ARTICLE\";\r\nexport const LOGIN = \"LOGIN\";\r\nexport const LOG_OUT = \"LOG_OUT\";\r\nexport const SET_WORLDS = \"SET_WORLDS\";\r\nexport const SET_PUBLIC_WORLDS = \"SET_PUBLIC_WORLDS\";\r\nexport const ADD_WORLD = \"ADD_WORLD\";\r\nexport const UPDATE_WORLD = \"UPDATE_WORLD\";\r\nexport const UPDATE_PUBLIC_WORLD_COLLAB = \"UPDATE_PUBLIC_WORLD_COLLAB\";\r\nexport const SELECT_WORLD = \"SELECT_WORLD\";\r\nexport const SET_TYPES = \"SET_TYPES\";\r\nexport const ADD_TYPE = \"ADD_TYPE\";\r\nexport const SET_THINGS = \"SET_THINGS\";\r\nexport const ADD_THING = \"ADD_THING\";\r\nexport const UPDATE_TYPE = \"UPDATE_TYPE\";\r\n// export const UPDATE_ATTRIBUTES_ARR = \"UPDATE_ATTRIBUTES_ARR\";\r\nexport const SET_ATTRIBUTES = \"SET_ATTRIBUTES\";\r\nexport const ADD_ATTRIBUTES = \"ADD_ATTRIBUTES\";\r\nexport const UPDATE_ATTRIBUTES = \"UPDATE_ATTRIBUTES\";\r\nexport const UPDATE_SELECTED_TYPE = \"UPDATE_SELECTED_TYPE\";\r\nexport const UPDATE_THING = \"UPDATE_THING\";\r\nexport const UPDATE_SELECTED_THING = \"UPDATE_SELECTED_THING\";\r\nexport const LOAD_FROM_STORAGE = \"LOAD_FROM_STORAGE\";\r\nexport const TOGGLE_MENU = \"TOGGLE_MENU\";\r\nexport const TOGGLE_LOGIN = \"TOGGLE_LOGIN\";\r\nexport const NOT_FROM_LOGIN = \"NOT_FROM_LOGIN\";\r\nexport const SET_FOLLOWING_WORLDS = \"SET_FOLLOWING_WORLDS\";\r\nexport const SET_WIDTH = \"SET_WIDTH\";\r\n","\r\n// This is our special type of Error that represents\r\n// when a request got a 401 Unauthorized response\r\nfunction UnauthorizedError(message) {\r\n  this.name = \"UnauthorizedError\";\r\n  this.message = message;\r\n}\r\nUnauthorizedError.prototype = new Error();\r\n\r\nvar API = (function() {\r\n  var instance;\r\n\r\n  function createInstance() {\r\n    var api = new APIClass();\r\n    return api;\r\n  }\r\n\r\n  return {\r\n    getInstance: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nclass APIClass {\r\n  constructor() {\r\n    this.real = true;\r\n  }\r\n\r\n  logErrorReason = reason => {\r\n    // log the error reason but keep the rejection\r\n    console.log(\"Response error reason:\", reason);\r\n    return Promise.reject(reason);\r\n  };\r\n\r\n  checkStatus = response => {\r\n    if (response.status >= 200 && response.status < 300) {\r\n      return response;\r\n    } else if (response.status === 401) {\r\n      var unauthorizedError = new UnauthorizedError(response.statusText);\r\n      unauthorizedError.response = response;\r\n      return Promise.reject(unauthorizedError);\r\n    } else {\r\n      var error = new Error(response.statusText);\r\n      error.response = response;\r\n      return Promise.reject(error);\r\n    }\r\n  };\r\n\r\n  getVersion = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/version\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return { version: \"0.0.1\" };\r\n    }\r\n  };\r\n\r\n  // User\r\n  getAllUsers = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/user/getAllUsers\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      }];\r\n    }\r\n  };\r\n\r\n  login = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/login\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  logout = async user => {\r\n    if (this.real) {\r\n      await this.postData(\"/api/user/logout\");\r\n    }\r\n  };\r\n\r\n  register = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/register\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  confirmEmail = async (code) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/confirmEmail\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  sendReset = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/sendReset\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkResetPasswordCode = async code => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/checkResetPasswordCode\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  resetPassword = async (code, newPassword) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/resetPassword\", {code, newPassword});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  emailTest = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/emailTest\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  updateUser = async user => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/update\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  // World\r\n  getWorldsForUser = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getWorldsForUserFromAPI();\r\n    }\r\n    else {\r\n      const data = sessionStorage.getItem(\"worlds\");\r\n      if (data !== null) {\r\n        return JSON.parse(data);\r\n      }\r\n      else {\r\n        return this.getWorldsForUserFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getWorldsForUserFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n      return this.processResponse(response, \"worlds\");\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getPublicWorlds = async (refresh = false) => {\r\n    if (refresh) {\r\n      return this.getPublicWorldsFromAPI();\r\n    }\r\n    else {\r\n      const data = sessionStorage.getItem(\"publicWorlds\");\r\n      if (data !== null) {\r\n        return JSON.parse(data);\r\n      }\r\n      else {\r\n        return this.getPublicWorldsFromAPI();\r\n      }\r\n    }\r\n  };\r\n  getPublicWorldsFromAPI = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n      return this.processResponse(response, \"publicWorlds\");\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getWorld = async (worldID, refresh = false) => {\r\n    try {\r\n      let attributes = await this.getAttributesForWorld(worldID, refresh);\r\n      attributes = attributes.attributes;\r\n      let types = await this.getTypesForWorld(worldID, refresh);\r\n      types = types.types;\r\n      let things = await this.getThingsForWorld(worldID, refresh);\r\n      things = things.things;\r\n\r\n      // Now connect them all as is appropriate.\r\n      const attributesByID = {};\r\n      const attributesByName = {};\r\n      attributes.forEach(attribute => {\r\n        attribute.TypeIDs = [];\r\n        attributesByID[attribute._id] = attribute;\r\n        attributesByName[attribute.Name] = attribute;\r\n      });\r\n      types.forEach(t=> {\r\n        t.Supers = [];\r\n        t.SuperIDs.forEach(sID=> {\r\n          t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n        });\r\n        t.AttributesArr = [];\r\n        t.Attributes.forEach(a => {\r\n          const attr = attributesByID[a.attrID];\r\n          if (attr === undefined) {\r\n          }\r\n          else {\r\n            attr.TypeIDs.push(t._id);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name.trim(),\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          }\r\n        });\r\n        const defHash = {};\r\n        if (t.Defaults !== undefined) {\r\n          t.Defaults.forEach(def => {\r\n            defHash[def.attrID] = def;\r\n          });\r\n        }\r\n        t.DefaultsHash = defHash;\r\n      });\r\n      things.forEach(t=> {\r\n        t.Types = [];\r\n        t.TypeIDs.forEach(tID=> {\r\n          t.Types = t.Types.concat(types.filter(t2=>t2._id === tID));\r\n        });\r\n      });\r\n      return {\r\n        attributes,\r\n        attributesByID,\r\n        attributesByName,\r\n        types,\r\n        things\r\n      };\r\n    }\r\n    catch (error) {\r\n      console.log(error);\r\n      return { error };\r\n    }\r\n  };\r\n\r\n  createWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  generateCollabLink = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/generateCollabLink\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  addNewCollaborator = async (worldID, userID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/addNewCollaborator\", { worldID, userID, email });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  emailCollaborator = async (worldID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/emailCollaborator\", { worldID, email });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  deleteCollab = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteCollab\", { worldID, collabID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateCollaboratorPermission = async (worldID, collabID, editPermission) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateCollaboratorPermission\", { worldID, collabID, editPermission });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkCollabID = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/checkCollabID\", {worldID, collabID});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  requestToCollaborate = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/requestToCollaborate\", { worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  declineCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/declineCollabInvite\", { worldID, collabID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  acceptCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/acceptCollabInvite\", { worldID, collabID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  selectWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Attribute\r\n  getAttributesForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getAttributesForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = sessionStorage.getItem(`attributes_${worldID}`);\r\n      if (data !== null) {\r\n        return JSON.parse(data);\r\n      }\r\n      else {\r\n        return this.getAttributesForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getAttributesForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttributesForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response, `attributes_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getAttribute = async (worldID, attrID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttribute/${worldID}/${attrID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createAttribute = async (attribute) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createAttribute\", { attribute: attribute });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  // deleteAttribute = async (worldID, attrID) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.deleteData(\"/api/world/deleteAttribute\", { worldID: worldID, attrID: attrID });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  // updateAttribute = async (attribute) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.patchData(\"/api/world/updateAttribute\", { attribute: attribute });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  upsertAttributes = async (worldID, attributes) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/upsertAttributes\", { worldID, attributes: attributes });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  // Type\r\n  getTypesForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getTypesForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = sessionStorage.getItem(`types_${worldID}`);\r\n      if (data !== null) {\r\n        return JSON.parse(data);\r\n      }\r\n      else {\r\n        return this.getTypesForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getTypesForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getTypesForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response, `types_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getType/${worldID}/${typeID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createType\", { type: type });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Thing\r\n  getThingsForWorld = async (worldID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getThingsForWorldFromAPI(worldID);\r\n    }\r\n    else {\r\n      const data = sessionStorage.getItem(`things_${worldID}`);\r\n      if (data !== null) {\r\n        return JSON.parse(data);\r\n      }\r\n      else {\r\n        return this.getThingsForWorldFromAPI(worldID);\r\n      }\r\n    }\r\n  };\r\n  getThingsForWorldFromAPI = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getThingsForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response, `things_${worldID}`);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  getThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Types: [-1],\r\n        Name: \"Alice\",\r\n        Description: \"\"\r\n      };\r\n    }\r\n  };\r\n\r\n  createThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Core API Calls\r\n  fetchData = async (path, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        ...options.headers\r\n      }\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  postData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  putData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  patchData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  deleteData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"DELETE\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  processResponse = async (response, sessionName = null) => {\r\n    const body = await response.json();\r\n    if (response.status !== 200) throw Error(body.message);\r\n    else {\r\n      if (sessionName !== null) {\r\n        sessionStorage.setItem(sessionName, JSON.stringify(body));\r\n      }\r\n      return body;\r\n    };\r\n  };\r\n}\r\n\r\nexport default API;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h3>Author's Notebook</h3>\r\n        <p>\r\n          This is something that I've been wanting to build for a while. It's\r\n          purpose is to provide a place for keeping track of various aspects of\r\n          books that an author is writing. It is able to keep track of details\r\n          about characters, organizations, systems, and even storylines. I would\r\n          like to make it so it's publicly available, and that any authors\r\n          (aspiring and published) can use it to help them organize their\r\n          stories. I want to make it automate a number of things, but the\r\n          biggest part is to make it very dynamic and to allow for storage of\r\n          all different kinds of notes. In order to make it publicly available\r\n          however, it needs to at least be able to pay for itself. I'm not\r\n          talking about the time I spent/spend working on it, but the costs of\r\n          hosting the website, the db, and the url. Until I'm sure it's capable\r\n          of doing those things, I can't let everyone have access to it.\r\n        </p>\r\n        <p>\r\n          This is version 1 of instructions of how to use it. If I make it\r\n          available for anyone, I'll update it with some video instructions.\r\n        </p>\r\n        <p>\r\n          One thing you need to know is that this is a hobby project of mine.\r\n          I'm working on it by myself for now. I've got a real job, and I've got\r\n          a family, so this isn't my top priority, but that being said I do care\r\n          about this probject, and I do plan to get to all the things that are\r\n          on my to do list.\r\n        </p>\r\n        <p>\r\n          If you want to do more than just look at the things others have put on\r\n          (and which they're allowing you to see), then you'll have to register.\r\n          Making it use Facebook and/or Google authentication is on my to do\r\n          list. I know how to do that, but I just haven't gotten around to it.\r\n          So, for now, just register and login. It currently doesn't send any\r\n          emails, so if you forget your password or something, you'll have to\r\n          reach out to me, and I can straighten it out. Again, that kind of\r\n          thing is also on my to do list.\r\n        </p>\r\n        <p>\r\n          Once you're logged in then you're able to start keeping track of\r\n          things.\r\n        </p>\r\n        <p>\r\n          The first thing you create is currently called a World. This is a\r\n          holdover from when I was calling this my World Building App because I\r\n          was aiming it for Fantasy/Sci-Fi authors (like me), but I realized\r\n          that it could be used for anything really. If anyone has any\r\n          suggestions for something to call this instead of World, I'm open to\r\n          considering other options. Currently I'm considering changing it to\r\n          'Project', and I may do that before showing it to anyone other than\r\n          family and close friends. Anyway, a World is basically the root of\r\n          everything. Different Worlds aren't connected to each other. Each\r\n          World has a Name, and you can choose whether or not to make it Public.\r\n          If it's not Public then only the Owner (whoever created it) is able to\r\n          see it. If it is Public then anyone can see it, but only the Owner can\r\n          edit it. (Planned Future Features: When you create a new world you can\r\n          use a template which will include generic Types common to that type of\r\n          World, such as Character, Location, etc. I'm also planning to add the\r\n          ability for Owners to add Collaborators to their World. Collaborators\r\n          would be able to see the World, and the Owner would be able to control\r\n          their other permissions as well (create/edit type, delete type,\r\n          create/edit thing, and delete thing.). Only the Owner will have the\r\n          ability to Edit or Delete the World itself, but they will be able to\r\n          make someone else the Owner.)\r\n        </p>\r\n        <p>\r\n          Within a World you are able to define Types. Basically a Type is just\r\n          that. It's a Type of Thing that you want to keep track of. In each\r\n          Type you are able to define attributes which that Type of Thing share,\r\n          such as Characters having Age, Race, Gender, Height, Weight, Skin\r\n          Color, Eye Color, etc. Types can also be hierarchical through\r\n          inheritance. For example, in Harry Potter I would have a 'Character'\r\n          Type with all the attributes I listed above, but then I could have a\r\n          'Witch or Wizard' Type which has 'Character' as a Super Type. This\r\n          means that 'Witch or Wizard' already has all those same Attributes as\r\n          'Character', but you can add more Attributes like Wand, Known Spells,\r\n          etc. The way to set the Super Types for a type is with a control\r\n          called a Multi Select. It's basically a textbox, but as you type it\r\n          gives you suggestions. You click a suggestion and it adds a chip\r\n          showing it as selected. Clicking the x on the right of the chip\r\n          unselects it. When selecting a Type to be a Super Type it adds all the\r\n          Attributes of that Type to the Type you're creating or editing, but\r\n          they are greyed out and disabled for editing. The reason they're grey\r\n          and disabled is that they come from a Super Type, so their definition\r\n          is there. If a Super Type is removed then the Attributes remain, but\r\n          are no longer grey and disabled. They can then be edited. There are a\r\n          few more things to note however. First is that when adding a Super\r\n          Type which has Super Types, those Super Types will be added as well.\r\n          An example of this could be the 'Animagus' Type in Harry Potter.\r\n          'Animagus' has the Super Type 'Witch or Wizard', which has the Super\r\n          Type 'Character', so when defining 'Animagus' I could add 'Witch or\r\n          Wizard' as a Super Type, and that will automatically add 'Character'\r\n          as well. Removing a Super Type of other Super Types will remove all\r\n          Sub Types of the Super Type removed. An example of that would be\r\n          removing 'Character' from 'Animagus'. This would automatically remove\r\n          'Witch or Wizard' as well. It doesn't make sense to do that for\r\n          'Animagus', but it may be necessary for you if you want to rethink how\r\n          you're organizing things. The last thing to note about removing Super\r\n          Types is that so long as a single Super Type exists which has an\r\n          Attribute with that name, it will be greyed out and disabled. Another\r\n          note about Attributes is that their names have to be unique on the\r\n          Type (or Thing). It's generally a good idea to make sure that any\r\n          Attributes you define with the same name also have the same Attribute\r\n          type as well, otherwise you may run into Attribute name collisions.\r\n          One last thing about Types. I've added an option to Types called Major\r\n          Type. If it's checked then the Type is considered a Major Type and\r\n          will show up in places of the UI where a regular Type will not. This\r\n          makes finding, creating, and editing Things of that Type easier. I\r\n          would make 'Character' a Major Type, but 'Witch or Wizard' and\r\n          'Animagus' would be regular Types. (Planned Future Features: Template\r\n          Types like I have above for Template Worlds, but they're individual\r\n          Types. Also add Plural Name field which will be used in the UI for\r\n          places where we put the plural name of something. Currently it just\r\n          adds an 's' to the end of the Type name, and I want to continue to do\r\n          that if the Plural Name is left empty, but if it's not empty then\r\n          display the Plural Name instead.)\r\n        </p>\r\n        <p>\r\n          Types have Attributes (as mentioned above). Things (which I'll get\r\n          into more below) also have Attributes. The same Attributes really. In\r\n          the Harry Potter World the Attributes on the 'Character' Type would\r\n          then be given to every character you create afterward, but now instead\r\n          of naming the Attribute and saying what type of Attribute it is, you\r\n          get to specify a value for the Attribute.\r\n        </p>\r\n        <p>\r\n          An Attribute is anything you may wish to keep track of for anything.\r\n          These do not include Name or Description, because all Types and Things\r\n          always have Name and Description by default. Attributes are for\r\n          anything else you want to keep track of. It could be a relationship\r\n          like 'Friend', 'Family Member', 'Significant Other', 'Coworker', etc.\r\n          It could be skills and abilities, or possessions, or jobs, or home\r\n          address, or work or school schedule. Really anything you want to keep\r\n          track of which is part of something can be an Attribute. Currently\r\n          there are six types of Attributes that are supported: Text, Number,\r\n          True/False, Options, Type, and List. Text is just that. A Text\r\n          Attribute gives you a textbox where you can type anything you want to\r\n          keep track of. Number gives you a number box, which is like a textbox\r\n          but it only accepts numbers, and it has arrows on the right which can\r\n          be used to increment or decrement the number. True/False gives you a\r\n          checkbox. Options allows you to specify possible choices for the\r\n          Attribute, and then they show up in a drop down list (A quick example\r\n          of this could be 'Gender' having 'Male', 'Female', and others if you\r\n          wanted. They can have as many options as you want, and it can be used\r\n          for whatever Attribute you want.). Specifying the choices is done\r\n          using a control called a Chip Input. This looks like a regular\r\n          textbox, but whenever you hit enter the text in it is added as a chip.\r\n          Chips show the text, but have an x on their right which can be used to\r\n          remove them. It's basically like the Multiselect except without the\r\n          suggestions. The Chips are the choices that will be in the drop down\r\n          list which the user has when creating or editing a Thing with that\r\n          Attribute.\r\n        </p>\r\n        <p>The last two Attribute types are a little more complicated.</p>\r\n        <p>\r\n          When adding Attributes to a Type, the 'Type' Attribute type allows you\r\n          to then choose from the various Types you've defined for the World,\r\n          and then when you're creating or editing a Thing (such as the\r\n          'Character' 'Harry Potter') you would get all the Things of that Type\r\n          as choices in a drop down list. For example you could have a 'Best\r\n          Friend' Attribute which has the Attribute type of 'Type' and uses the\r\n          Defined Type of 'Character'. Then when editing Harry you would have a\r\n          drop down list which shows all the 'Characters' you've added to the\r\n          World as possible 'Best Friends'. You would of course then choose 'Ron\r\n          Weasley' (Sorry, Hermione, but you're a close second.).\r\n        </p>\r\n        <p>\r\n          The Attribute Type 'List' is still more complicated than 'Type'. It\r\n          allows you to decide which type of 'List' it's going to be. For now it\r\n          only supports 'Text', 'Options', and 'Type'. (I'm not planning to add\r\n          any others, but if it's requested I may consider it. A List of Text\r\n          could be anything really, so other types shouldn't be necessary.) If\r\n          an Attribute is defined as a List of Text then when creating or\r\n          editing a Thing the Attribute gives a Chip Input, which works the same\r\n          as it does for Options (described above). A List of Options allows you\r\n          to define the choices when creating or editing the Type, the same as\r\n          with a regular Options Attribute, and then when creating or editing a\r\n          Thing of that Type it gives a Multiselect which works the same as when\r\n          choosing Super Types (described above) with the Options defined\r\n          previously on the Type as the suggestions. A List of 'Type' allows you\r\n          to choose a Defined Type (like with the Attribute type 'Type'), but\r\n          when creating or editing a Thing it gives you a Multiselect instead of\r\n          a regular drop down list so you can select more than one. With all\r\n          'List' Attributes, the items in the list are displayed separated by\r\n          commas when looking at the details page rather than creating or\r\n          editing.\r\n        </p>\r\n        <p>\r\n          One last note about Attributes of type 'Type' or 'List' of 'Type'.\r\n          I've made it so that if you want to choose a Defined Type which you\r\n          haven't defined yet you can choose '+ Create New Type' and it opens a\r\n          quick little window (modal for those who care) which lets you define a\r\n          Type using just the name you want it to have. You'll have to edit that\r\n          Type later to give it any Super Types or Attributes it should have,\r\n          but you can create it there so you can continue defining the Type\r\n          you're already working on rather than having to leave and come back to\r\n          it. The same thing can be done when creating or editing a Thing with\r\n          an Attribute of type 'Type' or 'List' of 'Type', but for Things the\r\n          Type has already been chosen. Now you will be creating a Thing of that\r\n          Type. An example of this would be if you're editing the 'Character'\r\n          'Harry Potter', but when you get to 'Best Friend' you realize you\r\n          haven't added the 'Ron Weasley' 'Character' yet. You would choose '+\r\n          Create New Character', and then in the quick little window you would\r\n          type 'Ron Weasley'. He would get added as a blank character with just\r\n          his Name, but he would then be selected as Harry's 'Best Friend', and\r\n          you could finish defining Harry, and get to Ron later.\r\n        </p>\r\n        <p>\r\n          And one more thing about Attributes in general.  I added the ability to\r\n          set Default values for attributes on the Type.  Default Values will \r\n          automatically be set on any Things of that Type.  I made it as user \r\n          friendly as I could think to make it.\r\n        </p>\r\n        <p>\r\n          (Planned Future Features: Other Attribute types, including: Image,\r\n          Event, and External Link. If you have any suggestions of others, feel\r\n          free to recommend them.  Also need to put in validation to detect \r\n          Name and Default collisions.)\r\n        </p>\r\n        <p>\r\n          And that brings us to Things. If you've gotten to this point, then you\r\n          probably already understand what Things are, but I'll outline it\r\n          anyway. The generic term Thing is used to mean any actual thing you're\r\n          keeping track of. This would be your Characters, your Places, your\r\n          Items, Spells, whatever. When creating or editing a Thing you are able\r\n          to choose Types for the Thing (works the same as Super Types for\r\n          Types), and all the Attributes of those Types are added to the Thing,\r\n          but now you're able to give values for them. Again remember to avoid\r\n          Attribute Name collisions (If for some reason you've defined 2\r\n          unrelated Types with an Attribute that has the same name but different\r\n          Attribute types then you won't be able to have a Thing of both\r\n          Types.). If a Type is edited to remove an Attribute, Things which use\r\n          that Type and existed already will still have that Attribute. It will\r\n          just be an orphaned Attribute. Currently there's no way to remove\r\n          Attributes from Things. If a Type is edited to add Attributes then\r\n          Things which already existed will gain those Attributes as soon as\r\n          they're edited again. If a Type is edited and an Attribute is\r\n          changed... I'm not actually sure what would happen to Things that\r\n          already exist which have that Type. I'll have to test that. That's\r\n          really it for Things. They're the simple part. (Planned Future\r\n          Features: I'm planning to add the ability to add/remove/edit orphaned\r\n          Attributes for Things. When I do, I'll probably try to find a way to\r\n          make it so with adding/editing orphaned Attributes you'll be able to\r\n          add the Attribute to a selected Type already on the Thing.)\r\n        </p>\r\n        <p>I probably should have put Attributes below Things, but oh well.</p>\r\n        <p>Other Planned Future Features:</p>\r\n        <div>\r\n          <p>\r\n            Forums: I'm going to have a General Site Forum, and each World will\r\n            automatically get its own Forum.\r\n          </p>\r\n          <p>\r\n            Direct Messages: I'll add a simple messaging system to allow people\r\n            to communicate directly with one another.\r\n          </p>\r\n          <p>\r\n            Auto-links: For both Forums and DMs I'll allow users to put links to\r\n            pages through a simple system similar to hashtags in Social Media.\r\n            I'm thinking I also want to add this capability to Descriptions on\r\n            Types and Things.\r\n          </p>\r\n          <p>\r\n            Following Public Worlds: Currently all Public Worlds are listed in\r\n            the menu, but I should make it so only those that the user follows\r\n            are shown there, and have a button to pull up the full list, and add\r\n            a button for people who neither own or collaborate on a Public World\r\n            to 'Follow' the World.\r\n          </p>\r\n          <p>\r\n            Home Page content: I'm planning to have actual Home Page content.\r\n            This will have a link to a video tutorial for new users (which I\r\n            have yet to make, and will need occasional updating after it's\r\n            made), as well as things like recent software changes. I also want\r\n            to make it so it can automatically have links to recently added or\r\n            edited Types or Things and recent Forum posts which may be of\r\n            interest to the user.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst HomePage = connect()(Page);\r\nexport default HomePage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-12\">\r\n        Template Page\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst TemplatePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TemplatePage;\r\n","\r\nimport Home from \"@material-ui/icons/Home\";\r\nimport Forum from \"@material-ui/icons/Forum\";\r\nimport HomePage from \"../../views/Home\";\r\nimport TemplatePage from \"../../views/Template\";\r\n\r\n\r\nconst menuRoutes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home\",\r\n    icon: Home,\r\n    component: HomePage,\r\n  },\r\n  {\r\n    path: \"/Forums\",\r\n    name: \"Forums\",\r\n    icon: Forum,\r\n    component: TemplatePage,\r\n  }\r\n];\r\n\r\nexport default menuRoutes;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport StarBorderIcon from \"@material-ui/icons/StarBorder\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds,\r\n  toggleMenu,\r\n  // toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds,\r\n    width: state.app.width\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    toggleMenu: () => dispatch(toggleMenu({})),\r\n    // toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Menu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds().then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    if (this.props.user !== null) {\r\n      this.api.getWorldsForUser().then(res => {\r\n        if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n      });\r\n    }\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      <div>\r\n        {menuRoutes.map((prop, key) => (\r\n          <ListItem key={key} className=\"curvedButton\">\r\n            <NavLink\r\n              to={prop.path}\r\n              onClick={_ => {\r\n                this.props.toggleMenu();\r\n              }}\r\n              style={{\r\n                width: `${this.props.width}px`\r\n              }}\r\n              className=\"MyButton\"\r\n              activeClassName=\"active\"\r\n            >\r\n              <ListItem button>\r\n                {typeof prop.icon === \"string\" ? (\r\n                  <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n                ) : (\r\n                  <prop.icon className=\"marginLeft\" />\r\n                )}\r\n                &nbsp;\r\n                <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n              </ListItem>\r\n            </NavLink>\r\n          </ListItem>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (\r\n      this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined\r\n    ) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (\r\n            this.state.Filter === \"\" ||\r\n            w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())\r\n          ) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            } else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {followingWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/world/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, false);\r\n                    }}\r\n                  >\r\n                    <Star />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n              {otherWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/world/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, true);\r\n                    }}\r\n                  >\r\n                    <StarBorderIcon />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return followingWorlds.map((w, key) => (\r\n      <ListItem key={key} className=\"curvedButton\">\r\n        <NavLink\r\n          to={`/world/details/${w._id}`}\r\n          onClick={_ => {\r\n            this.props.toggleMenu();\r\n          }}\r\n          style={{\r\n            width: `${this.props.width}px`\r\n          }}\r\n          className=\"MyButton\"\r\n          activeClassName=\"active\"\r\n        >\r\n          <ListItem button>\r\n            <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n          </ListItem>\r\n        </NavLink>\r\n      </ListItem>\r\n    ));\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => (\r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink\r\n                  to={`/world/details/${w._id}`}\r\n                  onClick={_ => {\r\n                    this.props.toggleMenu();\r\n                  }}\r\n                  style={{\r\n                    width: `${this.props.width}px`\r\n                  }}\r\n                  className=\"MyButton\"\r\n                  activeClassName=\"active\"\r\n                >\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            ));\r\n      return worldLinks;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Tooltip title={`Browse Public Worlds`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        <ListItem>\r\n          <ListItemText primary={\"My Worlds\"} />\r\n        </ListItem>\r\n        <ListItem className=\"curvedButton\">\r\n          <NavLink\r\n            to={`/world/create`}\r\n            onClick={_ => {\r\n              this.props.toggleMenu();\r\n            }}\r\n            style={{\r\n              width: `${this.props.width}px`\r\n            }}\r\n            className=\"MyButton\"\r\n            activeClassName=\"active\"\r\n          >\r\n            <ListItem button>\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst MobileMenu = connect(mapStateToProps, mapDispatchToProps)(Menu);\r\nexport default MobileMenu;\r\n","import React, { Component } from \"react\";\r\nimport {\r\n  AppBar, Toolbar, ListItem, \r\n  ListItemText, Icon, IconButton, \r\n  // Button\r\n} from \"@material-ui/core\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\n// import { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  setWorlds,\r\n  loadFromStorage,\r\n  toggleMenu,\r\n  toggleLogin\r\n} from \"../../redux/actions/index\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport API from \"../../smartAPI\";\r\nimport MobileMenu from \"./MobileMenu\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    user: state.app.user,\r\n    selectedWorld: state.app.selectedWorld,\r\n    mobileMenuOpen: !state.app.menuOpen // This defaults to closed instead of open\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    loadFromStorage: () => dispatch(loadFromStorage({})),\r\n    toggleMenu: () => dispatch(toggleMenu({})),\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.loadFromStorage();\r\n  }\r\n\r\n  menuClick = () => {\r\n    this.props.toggleMenu();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Grid container spacing={0}>\r\n            <Grid item xs>\r\n              <IconButton\r\n                style={{ color: \"white\" }}\r\n                aria-label=\"Menu\"\r\n                onClick={this.menuClick}\r\n              >\r\n                <MenuIcon />\r\n              </IconButton>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <ListItem className=\"curvedButton\">\r\n                <ListItemText\r\n                  primary={\r\n                    this.props.selectedWorld === null\r\n                      ? \"Welcome!\"\r\n                      : this.props.selectedWorld.Name\r\n                  }\r\n                />\r\n              </ListItem>\r\n            </Grid>\r\n            <Grid item xs>\r\n              {/* <Button\r\n                // fullWidth\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                onClick={_ => {\r\n                  this.props.toggleLogin();\r\n                }}\r\n              > */}\r\n              <span style={{cursor: \"pointer\"}} \r\n                onClick={_ => {\r\n                  this.props.toggleLogin();\r\n                }}\r\n                className=\"float-right blue whiteFont\">\r\n                <ListItem className=\"curvedButton float-right\">\r\n                  <Icon>person</Icon>\r\n                  <ListItemText\r\n                    primary={\r\n                      this.props.user === null ||\r\n                      this.props.user.username === undefined\r\n                        ? \" Login/Register\"\r\n                        : ` ${this.props.user.username}`\r\n                    }\r\n                  />\r\n                </ListItem>\r\n              </span>\r\n              {/* </Button> */}\r\n              {/* <NavLink\r\n                className=\"float-right blue whiteFont\"\r\n                to=\"/User/Login\"\r\n                // onClick={_ => {\r\n                //   this.props.toggleLogin();\r\n                // }}\r\n                activeClassName=\"active\"\r\n              >\r\n                <ListItem className=\"curvedButton float-right\">\r\n                  <Icon>person</Icon>\r\n                  <ListItemText\r\n                    primary={\r\n                      this.props.user === null ||\r\n                      this.props.user.username === undefined\r\n                        ? \" Login/Register\"\r\n                        : ` ${this.props.user.username}`\r\n                    }\r\n                  />\r\n                </ListItem>\r\n              </NavLink> */}\r\n            </Grid>\r\n          </Grid>\r\n        </Toolbar>\r\n        {this.props.mobileMenuOpen ? \r\n          <Box display={{ xs: 'inline', sm: 'none' }}>\r\n            <MobileMenu />\r\n          </Box>\r\n        : \"\" }\r\n      </AppBar>\r\n    );\r\n  }\r\n}\r\n\r\nconst NavBar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default NavBar;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\n// import logo from \"../../logo.svg\";\r\nimport logo from \"../../assets/img/ANB.png\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  Divider,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds(true).then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    // These kinds of things can also be done in render,\r\n    // but I prefer to put it here because it's only run once.\r\n    // The downside is that it's run before props gets populated\r\n    // so, it needs to be put into setTimeout to give the props\r\n    // a chance to get populated.\r\n    setTimeout(() => {\r\n      if (this.props.user !== null) {\r\n        this.api.getWorldsForUser().then(res => {\r\n          if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      menuRoutes.map((prop, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={prop.path} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              {typeof prop.icon === \"string\" ? (\r\n                <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n              ) : (\r\n                <prop.icon className=\"marginLeft\" />\r\n              )}\r\n              &nbsp;\r\n              <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  brand() {\r\n    return (\r\n      <NavLink to={`/`} className=\"BlackTextButton\" activeClassName=\"active\">\r\n        <ListItem>\r\n          <img src={logo} alt=\"logo\" className=\"App-logo\" />\r\n          <ListItemText primary={this.props.logoText} />\r\n        </ListItem>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (this.state.Filter === \"\" || w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            }\r\n            else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {\r\n                followingWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/world/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, false);\r\n                      }}\r\n                    >\r\n                      <Star />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n              {\r\n                otherWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/world/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, true);\r\n                      }}\r\n                    >\r\n                      <StarBorderIcon />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return (\r\n      followingWorlds.map((w, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={`/world/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => \r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink to={`/world/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            );\r\n      return (worldLinks);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.brand()}\r\n        <Divider light />\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Tooltip title={`Browse Public Worlds`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        <ListItem>\r\n          <ListItemText primary={\"My Worlds\"} />\r\n        </ListItem>\r\n        <ListItem className=\"curvedButton\">\r\n          <NavLink to={`/world/create`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst Sidebar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default Sidebar;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\n// import { selectPage } from \"../../redux/actions/index\";\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    if (\r\n      this.props.selectedPage === null ||\r\n      `/${this.props.selectedPage}` === window.location.pathname\r\n    ) {\r\n      return (\r\n        <div className=\"col-sm-12\">\r\n          Forum Menu Page!\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <Redirect\r\n          to={`/${this.props.selectedPage}`}\r\n        />\r\n      );\r\n    }\r\n  }\r\n}\r\nconst ForumMenuPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ForumMenuPage;\r\n","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport { userLogin, setWorlds, setFollowingWorlds } from \"../../redux/actions/index\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Cookies from \"universal-cookie\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    // selectedPage: state.app.selectedPage, \r\n    user: state.app.user, \r\n    loginError: state.app.loginError,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    userLogin: user => dispatch(userLogin(user)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const cookies = new Cookies();\r\n    const emailCookie = cookies.get('email');\r\n    const passCookie = cookies.get('password');\r\n    this.state = {\r\n      formMode: \"login\",\r\n      email: (emailCookie === undefined ? \"\" : emailCookie),\r\n      password: (passCookie === undefined ? \"\" : passCookie),\r\n      confirmEmail: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        email: { valid: true, message: \"\" }, \r\n        password: { valid: true, message: \"\" }, \r\n        confirmEmail: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" },\r\n        username: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      remember: false,\r\n      message: \"\",\r\n      username: \"\",\r\n      // redirectTo: null,\r\n      allUsers: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    if (this.state.email) {\r\n      this.validateField(\"email\");\r\n      this.validateField(\"password\");\r\n      this.setState({remember: true});\r\n    }\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        if (valid && this.state.allUsers.filter(u=>u.username === value).length !== 0) {\r\n          valid = false;\r\n          message = \"This Username is taken\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const emailValid = this.validateField(\"email\");\r\n    let confirmEmailValid = { valid: true, message: \"\" };\r\n    let passwordValid = { valid: true, message: \"\" };\r\n    let confirmPasswordValid = { valid: true, message: \"\" };\r\n    let usernameValid = { valid: true, message: \"\" };\r\n    switch (this.state.formMode) {\r\n      case \"Login\":\r\n        passwordValid = this.validateField(\"password\");\r\n        break;\r\n      case \"Register\":\r\n        confirmEmailValid = this.validateField(\"confirmEmail\");\r\n        passwordValid = this.validateField(\"password\");\r\n        confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n        usernameValid = this.validateField(\"username\");\r\n      break;\r\n      default:\r\n      break;\r\n    }\r\n    const formValid = \r\n      emailValid.valid && \r\n      passwordValid.valid && \r\n      confirmEmailValid.valid && \r\n      confirmPasswordValid.valid && \r\n      usernameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.email = emailValid;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmEmail = confirmEmailValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    fieldValidation.username = usernameValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      email: this.state.email.trim(),\r\n      password: this.state.password,\r\n      username: this.state.username.trim(),\r\n      followingWorlds: this.props.followingWorlds\r\n    };\r\n    if (this.state.formMode === \"login\") {\r\n      this.api.login(user).then(res => {\r\n        if (res.user === null) {\r\n          let errors = this.state.fieldValidation;\r\n          errors.loginError = { message: res.error, valid: false, show: true };\r\n          this.setState({ fieldValidation: errors, waiting: false });\r\n        }\r\n        else {\r\n          if (this.state.remember) {\r\n            const cookies = new Cookies();\r\n            cookies.set('email', this.state.email);\r\n            cookies.set('password', this.state.password);\r\n          }\r\n          this.props.userLogin(res.user);\r\n          this.api.getWorldsForUser(res.user._id).then(res => {\r\n            this.props.setWorlds(res.worlds);\r\n            this.props.onLogin(res.user);\r\n            // this.setState({ redirectTo: \"/\" });\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"register\") {\r\n      this.api.register(user).then(res => {\r\n        if (res.error === undefined) {\r\n          this.setState({ \r\n            message: res.message, \r\n            formMode: \"login\", \r\n            fieldValidation: { \r\n              email: { valid: true, message: \"\" }, \r\n              password: { valid: true, message: \"\" }, \r\n              confirmEmail: { valid: true, message: \"\" }, \r\n              confirmPassword: { valid: true, message: \"\" },\r\n              username: { valid: true, message: \"\" }\r\n            },\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({ \r\n            message: res.error,\r\n            waiting: false\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"password\") {\r\n      this.api.sendReset(user).then(res => {\r\n        this.setState({ message: res.message, \r\n          formMode: \"login\", \r\n          fieldValidation: { \r\n            email: { valid: true, message: \"\" }, \r\n            password: { valid: true, message: \"\" }, \r\n            confirmEmail: { valid: true, message: \"\" }, \r\n            confirmPassword: { valid: true, message: \"\" },\r\n            username: { valid: true, message: \"\" }\r\n          },\r\n          waiting: false \r\n        });\r\n      })\r\n      .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  loginClick = () => {\r\n    this.setState({ formMode: \"login\" });\r\n  };\r\n\r\n  registerClick = () => {\r\n    this.setState({ formMode: \"register\" });\r\n  };\r\n\r\n  passwordClick = () => {\r\n    this.setState({ formMode: \"password\" });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.allUsers === null) {\r\n      this.api.getAllUsers().then(res => {\r\n        this.setState({allUsers: res});\r\n      });\r\n      return (<div></div>);\r\n    }\r\n    // else if (this.state.redirectTo !== null && \r\n    //   this.props.user !== null && \r\n    //   this.props.user !== undefined && \r\n    //   this.props.user.username !== undefined && \r\n    //   this.props.user.username !== \"\") {\r\n    //   return (<Redirect to={this.state.redirectTo} />);\r\n    // }\r\n    else {\r\n      if (this.state.formMode === \"login\") {\r\n        return (\r\n          <div>\r\n            <h2>Login</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        value={this.state.email}\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          checked={this.state.remember}\r\n                          onChange={this.handleUserInput}\r\n                          name=\"remember\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Remember Me\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"register\") {\r\n        return (\r\n          <div>\r\n            <h2>Register</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"username\">Username</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"username\"\r\n                            name=\"username\"\r\n                            type=\"text\"\r\n                            value={this.state.username}\r\n                            error={ !this.state.fieldValidation.username.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={80}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.username.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={this.state.email}\r\n                            error={ !this.state.fieldValidation.email.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={40}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                          fullWidth>\r\n                          <InputLabel htmlFor=\"confirmEmail\">Confirm Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"confirmEmail\"\r\n                            name=\"confirmEmail\"\r\n                            type=\"email\"\r\n                            error={ !this.state.fieldValidation.confirmEmail.valid }\r\n                            value={this.state.confirmEmail}\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={100}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.confirmEmail.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div> \r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"confirm-password\"\r\n                        name=\"confirmPassword\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.confirmPassword}\r\n                        error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={130}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>{\" \"}\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"password\") {\r\n        return (\r\n          <div>\r\n            <h2>Forgot Password?</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        value={this.state.email}\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default LoginControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { Helmet } from 'react-helmet';\r\nimport LoginControl from './LoginControl';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    // if (this.state.email) {\r\n    //   this.validateField(\"email\");\r\n    //   this.validateField(\"password\");\r\n    //   this.setState({remember: true});\r\n    // }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return (<Redirect to={this.state.redirectTo} />);\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <Helmet>\r\n            <title>Author's Notebook: Login</title>\r\n          </Helmet>\r\n          <LoginControl onLogin={user => { this.setState({redirectTo: \"/\"}); }}/>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginPage = connect()(Page);\r\nexport default LoginPage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n// import { selectPage } from \"../../redux/actions/index\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-12\">\r\n        Profile Page\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst UserEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default UserEditPage;\r\n","import React, { Component } from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n// import { Fab } from \"@material-ui/core\";\r\nimport {\r\n  updateIndexExpandedPanel\r\n} from \"../../redux/actions/index\";\r\n\r\n/* \r\n  This component will be used by the WorldDetails component.  It will\r\n  have a link at the top for creating new Things, and will list all\r\n  Things in the selected World, allowing navigation to their Details.  \r\n  The List will have pagination and filtering controls to make it \r\n  easier to manage.\r\n*/\r\nconst mapStateToProps = state => {\r\n  return { \r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorld: state.app.selectedWorld,\r\n    user: state.app.user,\r\n    indexExpandedPanel: state.app.indexExpandedPanel\r\n  };\r\n}\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateIndexExpandedPanel: panel => dispatch(updateIndexExpandedPanel(panel))\r\n  };\r\n}\r\nclass Index extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleChange = panel => {\r\n    this.props.updateIndexExpandedPanel(this.props.indexExpandedPanel === panel ? false : panel);\r\n  }\r\n\r\n  renderListForType(type) {\r\n    // TODO: Add a PluralName field to types so I can use it here.  It may end up being useful other places too.\r\n    const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n              <Add/><ListItemText primary={`Create New ${type.Name}`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            things.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMajorTypelessThings() {\r\n    const majorLess = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n              <Add/><ListItemText primary={`Create New Thing`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            majorLess.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    }\r\n    else {\r\n      const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n      const editButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n      const createButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n\r\n      return (\r\n        <div>\r\n          <List>\r\n            <ListItem>\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  {this.props.indexExpandedPanel === \"TYPES\" ? \r\n                    <Tooltip title={`Collapse Types`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                          <KeyboardArrowDownIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  :\r\n                    <Tooltip title={`Expand Types`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                          <KeyboardArrowRightIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Types (${this.props.types.length})`}</span>\r\n                  { createButtons &&\r\n                    <Tooltip title={`Create New Type`}>\r\n                      <Button \r\n                        onClick={ _ => {this.setState({redirectTo:`/type/create`})}}>\r\n                        <Add/>\r\n                      </Button>\r\n                    </Tooltip> \r\n                  }\r\n                </Grid>\r\n                {this.props.indexExpandedPanel === \"TYPES\" &&\r\n                  <Grid item>\r\n                    <List style={{ maxWidth: \"300px\" }}>\r\n                      {\r\n                        this.props.types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Tooltip title={`Details for ${type.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                                  <ListItemText primary={type.Name} className=\"marginLeft\" />\r\n                                </Button>\r\n                              </Tooltip>\r\n                              { createButtons &&\r\n                                <Grid container spacing={0} direction=\"row\">\r\n                                  <Grid item xs={6}>\r\n                                    <Tooltip title={`Create New ${type.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                                        <Add/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                  <Grid item xs={6}>\r\n                                    <Tooltip title={`Edit ${type.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                                        <Edit/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                </Grid>\r\n                              }\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                }\r\n              </Grid>\r\n            </ListItem>\r\n            { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n              const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      {this.props.indexExpandedPanel === type._id ? \r\n                        <Tooltip title={`Collapse ${type.Name}s`}>\r\n                          <Button \r\n                            onClick={_ => {this.handleChange(type._id)}}>\r\n                            <KeyboardArrowDownIcon/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                        :\r\n                        <Tooltip title={`Expand ${type.Name}s`}>\r\n                          <Button \r\n                            onClick={_ => {this.handleChange(type._id)}}>\r\n                            <KeyboardArrowRightIcon/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                      }\r\n                      <Tooltip title={`Details for ${type.Name}`}>\r\n                        <Button \r\n                          onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                          <ListItemText>{type.Name}s ({things.length})</ListItemText>\r\n                        </Button>\r\n                      </Tooltip>\r\n                      { createButtons &&\r\n                        <span>\r\n                          <Tooltip title={`Create New ${type.Name}`}>\r\n                            <Button \r\n                              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                              <Add/>\r\n                            </Button>\r\n                          </Tooltip>\r\n                          <Tooltip title={`Edit ${type.Name}`}>\r\n                            <Button \r\n                              onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                              <Edit/>\r\n                            </Button>\r\n                          </Tooltip>\r\n                        </span>\r\n                      }\r\n                    </Grid>\r\n                    {this.props.indexExpandedPanel === type._id &&\r\n                      <Grid item>\r\n                        <List style={{ maxWidth: \"300px\" }}>\r\n                          {\r\n                            things.map((thing, j) => {\r\n                              return (\r\n                                <ListItem key={j}>\r\n                                  <Tooltip title={`Details for ${thing.Name}`}>\r\n                                    <Button \r\n                                      fullWidth variant=\"contained\" color=\"primary\" \r\n                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                      <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                    </Button>\r\n                                  </Tooltip>\r\n                                  { editButtons &&\r\n                                    <Tooltip title={`Edit ${thing.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                        <Edit/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  }\r\n                                </ListItem>\r\n                              );\r\n                            })\r\n                          }\r\n                        </List>\r\n                      </Grid>\r\n                    }\r\n                  </Grid>\r\n                </ListItem>\r\n              );\r\n            })}\r\n            <ListItem>\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  {this.props.indexExpandedPanel === \"OTHER\" ? \r\n                    <Tooltip title={`Collapse Other Things`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                        <KeyboardArrowDownIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  :\r\n                    <Tooltip title={`Expand Other Things`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                        <KeyboardArrowRightIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Other Things (${majorless.length})`}</span>\r\n                  { createButtons &&\r\n                    <Tooltip title={`Create New Thing`}>\r\n                      <Button \r\n                        onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n                        <Add/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  }\r\n                </Grid>\r\n                {this.props.indexExpandedPanel === \"OTHER\" &&\r\n                  <Grid item>\r\n                    <List style={{ maxWidth: \"300px\" }}>\r\n                      {\r\n                        majorless.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Tooltip title={`Details for ${thing.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                  <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                </Button>\r\n                              </Tooltip>\r\n                              { editButtons &&\r\n                                <Tooltip title={`Edit ${thing.Name}`}>\r\n                                  <Button \r\n                                    onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                    <Edit/>\r\n                                  </Button>\r\n                                </Tooltip>\r\n                              }\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                }\r\n              </Grid>\r\n            </ListItem>\r\n          </List>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingIndex = connect(mapStateToProps, mapDispatchToProps)(Index);\r\nexport default ThingIndex;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  selectWorld, setTypes, setThings, setWorlds, \r\n  setPublicWorlds, updatePublicWorldForCollab,\r\n  setAttributes, updateAttributes\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport Index from \"./Index\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Delete from \"@material-ui/icons/Delete\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { Fab } from \"@material-ui/core\";\r\nimport { People } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    updatePublicWorldForCollab: world => dispatch(updatePublicWorldForCollab(world)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    updateAttributes: attributes => dispatch(updateAttributes(attributes))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      world: null,\r\n      modalOpen: false,\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n  componentDidMount() {\r\n  }\r\n\r\n  getAttributes() {\r\n    this.api.getAttributesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // We store the attributes in two hashes, by name and by id\r\n        this.props.setAttributes(res.attributes);\r\n        this.getTypes();\r\n      }\r\n    });\r\n  }\r\n\r\n  getTypes() {\r\n    this.api.getTypesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // Add Supers to each type\r\n        const types = res.types;\r\n        const updateAttributes = [];\r\n        types.forEach(t=> {\r\n          t.Supers = [];\r\n          t.SuperIDs.forEach(sID=> {\r\n            t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n          });\r\n          t.AttributesArr = [];\r\n          t.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            attr.TypeIDs.push(t._id);\r\n            updateAttributes.push(attr);\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              TypeIDs: a.TypeIDs\r\n            });\r\n          });\r\n          const defHash = {};\r\n          if (t.Defaults !== undefined) {\r\n            t.Defaults.forEach(def => {\r\n              defHash[def.attrID] = def;\r\n            });\r\n          }\r\n          t.DefaultsHash = defHash;\r\n        });\r\n        this.props.updateAttributes(updateAttributes);\r\n        this.props.setTypes(types);\r\n        this.getThings();\r\n      }\r\n    });\r\n  }\r\n\r\n  getThings() {\r\n    this.api.getThingsForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        const things = res.things;\r\n        things.forEach(t=> {\r\n          t.Types = [];\r\n          t.TypeIDs.forEach(tID=> {\r\n            t.Types = t.Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n          });\r\n        });\r\n        this.props.setThings(things);\r\n      }\r\n    });\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteWorld(this.props.selectedWorldID).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getPublicWorlds(true).then(res2 => {\r\n          if (res2.worlds !== undefined) this.props.setPublicWorlds(res2.worlds);\r\n          this.api.getWorldsForUser(true).then(res3 => {\r\n            if (res3.worlds !== undefined) this.props.setWorlds(res3.worlds);\r\n            this.api.selectWorld(null);\r\n            this.props.selectWorld(null);\r\n            this.setState({modalOpen: false, redirectTo: `/`});\r\n          });\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error });\r\n      }\r\n    });\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.props.selectWorld(id);\r\n      this.api.getWorld(id).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n      });\r\n    }, 500);\r\n  }\r\n\r\n  requestToCollaborate = () => {\r\n    this.api.requestToCollaborate(this.props.selectedWorldID).then(res => {\r\n      const world = this.props.selectedWorld;\r\n      world.Collaborators.push(res);\r\n      this.props.updatePublicWorldForCollab(world);\r\n    });\r\n  }\r\n\r\n  respondToInvite = () => {\r\n    const invite = this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\")[0];\r\n    this.setState({ redirectTo: `/world/collaborate/${this.props.selectedWorldID}/${invite.collabID}` });\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.props.selectedWorldID === null || this.props.selectedWorldID !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          {this.props.selectedWorld === null ? (\r\n            \"\"\r\n          ) : (\r\n            <Grid item container spacing={0} direction=\"row\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item xs={9}>\r\n                <h2>{this.props.selectedWorld.Name}</h2>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                { this.props.user !== null && this.props.user !== null && this.props.selectedWorld.Owner === this.props.user._id ?\r\n                  <List>\r\n                    <ListItem>\r\n                      <Tooltip title={`Edit ${this.props.selectedWorld.Name}`}>\r\n                        <Fab size=\"small\" color=\"primary\"\r\n                          onClick={ _ => {this.setState({redirectTo:`/world/edit/${this.props.selectedWorldID}`})}}\r\n                        >\r\n                        <Edit />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </ListItem>\r\n                    <ListItem>\r\n                      <Tooltip title={`Edit Collaborators`}>\r\n                        <Fab size=\"small\" color=\"primary\"\r\n                          onClick={ _ => {this.setState({redirectTo:`/world/collaborators/${this.props.selectedWorldID}`})}}\r\n                        >\r\n                        <People />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </ListItem>\r\n                    <ListItem>\r\n                      <Tooltip title={`Delete ${this.props.selectedWorld.Name}`}>\r\n                        <Fab size=\"small\" color=\"primary\"\r\n                          onClick={e => {this.setState({modalOpen: true})}}\r\n                        >\r\n                          <Delete />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </ListItem>\r\n                  </List>\r\n                : \r\n                  <List>\r\n                    { this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id).length === 0 ?\r\n                      <ListItem>\r\n                        { this.props.selectedWorld.AcceptingCollaborators && \r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={this.requestToCollaborate}\r\n                            type=\"button\"\r\n                          >\r\n                            Request to Collaborate\r\n                          </Button>\r\n                        }\r\n                      </ListItem>\r\n                    : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"request\").length > 0 ?\r\n                      <ListItem>\r\n                        Waiting on Collaboration Request\r\n                      </ListItem>\r\n                    : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\").length > 0 &&\r\n                      <ListItem>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.respondToInvite}\r\n                          type=\"button\"\r\n                        >\r\n                          You've been invited to Collaborate\r\n                        </Button>\r\n                      </ListItem>\r\n                    }\r\n                  </List>\r\n                }\r\n              </Grid>\r\n            </Grid>\r\n          )}\r\n          <Grid item>\r\n            <Index />\r\n          </Grid>\r\n          {/* <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item xs={6}>\r\n              <TypeIndex />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <ThingIndex />\r\n            </Grid>\r\n          </Grid> */}\r\n          <Modal\r\n              aria-labelledby=\"delete-thing-modal\"\r\n              aria-describedby=\"delete-thing-modal-description\"\r\n              open={this.state.modalOpen}\r\n              onClose={e => {this.setState({modalOpen: false})}}\r\n            >\r\n              <div style={this.getModalStyle()} className=\"paper\">\r\n                <Grid container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    Are you sure you want to delete {this.props.selectedWorld !== null ? this.props.selectedWorld.Name : \"\"}?\r\n                  </Grid>\r\n                  <Grid item>\r\n                    (All external references to it will be left alone and may not work correctly)\r\n                  </Grid>\r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={this.delete}\r\n                      >\r\n                        Yes\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        onClick={e => {this.setState({modalOpen: false})}}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\nconst WorldDetailsPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldDetailsPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectWorld,\r\n  addWorld,\r\n  updateWorld\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, Tooltip, Fab\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    addWorld: world => dispatch(addWorld(world)),\r\n    updateWorld: world => dispatch(updateWorld(world))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Public: false,\r\n      AcceptingCollaborators: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        const { id } = this.props.match.params;\r\n        let world = this.props.worlds.filter(w => w._id === id);\r\n        if (world.length > 0) {\r\n          world = world[0];\r\n          this.setState({\r\n            Name: world.Name,\r\n            Public: world.Public,\r\n            AcceptingCollaborators: world.AcceptingCollaborators === undefined || world.AcceptingCollaborators === null ? false : world.AcceptingCollaborators,\r\n            _id: id\r\n          });\r\n          this.api.selectWorld(id);\r\n          this.props.selectWorld(id);\r\n          this.api.getWorld(id).then(res => {\r\n            this.props.setAttributes(res.attributes);\r\n            this.props.setTypes(res.types);\r\n            this.props.setThings(res.things);\r\n          });\r\n        }\r\n      } else {\r\n        this.api.selectWorld(null);\r\n        this.props.selectWorld(null);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in World Names\";\r\n        else if (value.length < 4) {\r\n          valid = false;\r\n          message = \"World Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.worlds.filter(\r\n              w => w.Name === value && w._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This World Name is already in use\";\r\n        }\r\n        break;\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const world = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Public: this.state.Public,\r\n      AcceptingCollaborators: this.state.AcceptingCollaborators,\r\n      Owner: this.props.user._id\r\n    };\r\n\r\n    if (world._id === null) {\r\n      this.api\r\n        .createWorld(world)\r\n        .then(res => {\r\n          if (res.error  !== undefined) {\r\n            this.setState({ message: res.error });\r\n          }\r\n          else {\r\n            world._id = res.worldID;\r\n            this.props.addWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${res.worldID}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateWorld(world)\r\n        .then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({ message: res.error });\r\n          }\r\n          else {\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              { this.props.selectedWorld !== null &&\r\n                <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                  <Fab size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>\r\n              }\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>\r\n                {this.state._id === null ? \"Create New World\" : \"Edit World\"}\r\n              </h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.Public}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"Public\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Public\"\r\n            />\r\n            { this.state.Public ?\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.AcceptingCollaborators}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"AcceptingCollaborators\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Accepting Collaborator Requests\"\r\n            /> : \"\" }\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                style={{ marginLeft: \"4px\" }}\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  this.setState({\r\n                    redirectTo: this.state._id === null ? `/` : `/world/details/${this.state._id}`\r\n                  });\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst WorldEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldEditPage;","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Button,\r\n  Grid\r\n} from \"@material-ui/core\";\r\nimport LoginControl from '../User/LoginControl';\r\nimport {\r\n  setWorlds\r\n} from \"../../redux/actions/index\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      worldID: null,\r\n      collabID: null,\r\n      codeValid: false,\r\n      accepted: null,\r\n      message: \"Please wait.  Validating code.\",\r\n      world: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  accept = () => {\r\n    if (this.props.user === null) {\r\n      this.setState({waiting: false, accepted: true});\r\n    }\r\n    else {\r\n      this.setState({waiting: true},\r\n        this.submitAccept\r\n      );\r\n    }\r\n  }\r\n\r\n  submitAccept = () => {\r\n    this.api.acceptCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: true}, this.getWorlds);\r\n    });\r\n  }\r\n\r\n  getWorlds = () => {\r\n    this.api.getWorldsForUser().then(res => {\r\n      if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n    });\r\n  }\r\n\r\n  onLoginAccept = (user) => {\r\n    this.setState({waiting: true},\r\n      this.submitAccept\r\n    );\r\n  }\r\n\r\n  decline = () => {\r\n    this.setState({waiting: true},\r\n      this.submitDecline\r\n    );\r\n  }\r\n\r\n  submitDecline = () => {\r\n    this.api.declineCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: false});\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.collabID === null) {\r\n      const { worldID, collabID } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkCollabID(worldID, collabID).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({collabID, worldID, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({collabID, worldID, world: res.world, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      if (this.state.accepted === null) {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              <h2>You've been invited to collaborate on {this.state.world.Name}</h2>\r\n            </Grid>\r\n            <Grid item xs={12} container spacing={1}>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.accept}\r\n                  type=\"button\">\r\n                  Accept\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.decline}\r\n                  type=\"button\">\r\n                  Decline\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n      else if (this.state.accepted) {\r\n        if (this.props.user === null) {\r\n          return (\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <h2>Please log in (or register and then log in if you're new) so we can add you as a collaborator on {this.state.world.Name}.</h2>\r\n              </Grid>\r\n              <Grid item>\r\n                <LoginControl onLogin={this.onLoginAccept}/>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={12}>\r\n                <h2>Congratulations! You can now collaborate on {this.state.world.Name}</h2>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              Okay.  Well, we hope you enjoy working on other worlds.\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst CollaboratePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default CollaboratePage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateWorld, selectWorld\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, \r\n  ListItem, ListItemText, \r\n  Tooltip, Fab, AppBar, Tabs, Tab, Box, \r\n  InputAdornment, IconButton,\r\n  Select, MenuItem\r\n} from \"@material-ui/core\";\r\nimport { Add, ArrowBack, FileCopyOutlined, Delete } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index } = props;\r\n\r\n  return (\r\n    <div>{value === index && <Box p={3}>{children}</Box>}</div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Collaborators: [],\r\n      allUsers: null,\r\n      fieldValidation: {\r\n        inviteEmail: { valid: true, message: \"\" }\r\n      },\r\n      message: \"\",\r\n      redirectTo: null,\r\n      newCollaborators: false,\r\n      newCollabTab: 0,\r\n      collabTab: 0,\r\n      collabLink: null,\r\n      collabLinkCopied: false,\r\n      selectedUser: \"\",\r\n      inviteEmail: \"\",\r\n      inviteMessage: \"\", \r\n      waiting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        const { id } = this.props.match.params;\r\n        let world = this.props.worlds.filter(w => w._id === id);\r\n        if (world.length > 0) {\r\n          world = world[0];\r\n          this.setState({\r\n            Name: world.Name,\r\n            Public: world.Public,\r\n            AcceptingCollaborators: world.AcceptingCollaborators === undefined || world.AcceptingCollaborators === null ? false : world.AcceptingCollaborators,\r\n            Collaborators: world.Collaborators === undefined ? [] : world.Collaborators,\r\n            _id: id\r\n          });\r\n          this.api.selectWorld(id);\r\n          this.props.selectWorld(id);\r\n        }\r\n      } else {\r\n        this.api.selectWorld(null);\r\n        this.props.selectWorld(null);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  addNewCollaborator = () => {\r\n    function respond() {\r\n      this.api.addNewCollaborator(this.props.selectedWorldID, this.state.selectedUser._id, this.state.selectedUser.email).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, \r\n            inviteMessage: \"Invite Sent\",\r\n            selectedUser: \"\",\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  emailCollaborator = () => {\r\n    const emailValid = this.validateField(\"inviteEmail\");\r\n    if (emailValid) {\r\n      function respond() {\r\n        this.api.emailCollaborator(this.props.selectedWorldID, this.state.inviteEmail).then(res => {\r\n          if (res.error === undefined) {\r\n            const collabs = [...this.state.Collaborators];\r\n            collabs.push(res);\r\n            const world = this.props.selectedWorld;\r\n            world.Collaborators = collabs;\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              Collaborators: collabs, \r\n              inviteMessage: \"Email Sent\", \r\n              inviteEmail: \"\",\r\n              waiting: false\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error, waiting: false});\r\n          }\r\n        });\r\n      }\r\n      this.setState({waiting: true}, respond);\r\n    }\r\n  }\r\n\r\n  updateCollaboratorPermission = (collaborator, permission) => {\r\n    collaborator.editPermission = permission;\r\n    function respond() {\r\n      this.api.updateCollaboratorPermission(this.props.selectedWorldID, collaborator.collabID, permission).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          const collab = collabs.filter(c=>c.collabID === collaborator.collabID)[0];\r\n          collab.editPermission = permission;\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Creates a collab invite on the world, but no user or email associated\r\n  generateCollabLink = () => {\r\n    function respond() {\r\n      this.api.generateCollabLink(this.props.selectedWorldID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  deleteCollab = (collab) => {\r\n    function respond() {\r\n      this.api.deleteCollab(this.props.selectedWorldID, collab.collabID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = this.state.Collaborators.filter(c=>c.collabID !== collab.collabID);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Copies the collaborator link to the user's clipboard\r\n  copyCollabLink = () => {\r\n    const el = this.generatedLink;\r\n    const textarea = el.children[0];\r\n    textarea.select();\r\n    document.execCommand(\"copy\");\r\n    this.setState({collabLinkCopied: true});\r\n  }\r\n\r\n  render() {\r\n    if (this.state.allUsers === null) {\r\n      this.api.getAllUsers().then(res => {\r\n        this.setState({allUsers: res});\r\n      });\r\n      return (<div></div>);\r\n    }\r\n    else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const collabs = this.state.Collaborators.filter(c=>c.type===\"collab\");\r\n      const invites = this.state.Collaborators.filter(c=>c.type===\"invite\");\r\n      const requests = this.state.Collaborators.filter(c=>c.type===\"request\");\r\n      const selectUsers = this.state.allUsers.filter(u=>u._id !== this.props.selectedWorld.Owner && this.state.Collaborators.filter(c=>c.userID === u._id).length === 0);\r\n      const userMenuItems = selectUsers.map((u, i) => {\r\n        return (\r\n          <MenuItem key={i} value={u}>\r\n            {u.username}\r\n          </MenuItem>\r\n        );\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name} Collaborators` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                <Fab size=\"small\"\r\n                  color=\"primary\"\r\n                  onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                >\r\n                  <ArrowBack />\r\n                </Fab>\r\n              </Tooltip>\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>Edit Collaborators</h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <ListItem style={{maxWidth: \"200px\"}}>\r\n              <ListItemText primary=\"Collaborators\" />\r\n              { this.state.newCollaborators ?\r\n                <Tooltip title={`Manage Existing Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: false });\r\n                    }}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>  :\r\n                <Tooltip title={`Add New Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: true });\r\n                    }}\r\n                  >\r\n                    <Add />\r\n                  </Fab>\r\n                </Tooltip> \r\n              }\r\n            </ListItem>\r\n          </Grid>\r\n          { this.state.newCollaborators ?\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.newCollabTab} onChange={(_, newValue) => { this.setState({newCollabTab: newValue, inviteMessage: \"\"})}} aria-label=\"Add Collaborator Method\">\r\n                    <Tab label=\"Find Existing User\" {...this.a11yProps(0)} />\r\n                    <Tab label=\"Invite via Email\" {...this.a11yProps(1)} />\r\n                    <Tab label=\"Get an Invite Link\" {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.newCollabTab} index={0}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"user-select\" id=\"user-select-label\">\r\n                          Select a User\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"user-select-label\"\r\n                          id=\"user-select\"\r\n                          value={this.state.selectedUser}\r\n                          onChange={e => {\r\n                            this.setState({selectedUser: e.target.value, inviteMessage: \"\" })\r\n                          }}\r\n                          labelWidth={90}\r\n                        >\r\n                          {userMenuItems}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.selectedUser === \"\" || this.state.waiting}\r\n                        onClick={this.addNewCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={1}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"inviteEmail\">Collaborator Email</InputLabel>\r\n                        <OutlinedInput\r\n                          id=\"inviteEmail\"\r\n                          name=\"inviteEmail\"\r\n                          type=\"email\"\r\n                          autoComplete=\"Off\"\r\n                          error={!this.state.fieldValidation.inviteEmail.valid}\r\n                          value={this.state.inviteEmail}\r\n                          onChange={this.handleUserInput}\r\n                          onBlur={this.inputBlur}\r\n                          labelWidth={140}\r\n                          fullWidth\r\n                        />\r\n                        <FormHelperText>\r\n                          {this.state.fieldValidation.inviteEmail.message}\r\n                        </FormHelperText>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.emailCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={2}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Generate a single use link to send someone yourself\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.generateCollabLink}\r\n                      >\r\n                        Generate Link\r\n                      </Button> \r\n                    </Grid>\r\n                      { this.state.collabLink !== null && \r\n                        <Grid item>\r\n                          <OutlinedInput\r\n                            id=\"generatedLink\"\r\n                            name=\"generatedLink\"\r\n                            ref={(input) => this.generatedLink = input}\r\n                            type=\"text\"\r\n                            multiline={true}\r\n                            value={this.state.collabLink}\r\n                            // disabled={true}\r\n                            endAdornment={\r\n                              <InputAdornment position=\"end\">\r\n                                <IconButton\r\n                                  aria-label=\"copy to clipboard\"\r\n                                  onClick={this.copyCollabLink}\r\n                                  edge=\"end\"\r\n                                >\r\n                                  <FileCopyOutlined />\r\n                                </IconButton>\r\n                              </InputAdornment>\r\n                            }\r\n                            labelWidth={70}\r\n                            fullWidth\r\n                          />\r\n                          { this.state.collabLinkCopied && \r\n                            <span style={{fontColor: \"red\"}}>\r\n                              Link Copied to Clipboard\r\n                            </span>\r\n                          }\r\n                        </Grid>\r\n                      }\r\n                  </Grid>\r\n                  \r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid> :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.collabTab} onChange={(_, newValue) => { this.setState({collabTab: newValue})}} aria-label=\"Collaborators\">\r\n                    <Tab label={`Collaborators (${collabs.length})`} {...this.a11yProps(0)} />\r\n                    <Tab label={`Invites (${invites.length})`} {...this.a11yProps(1)} />\r\n                    <Tab label={`Requests (${requests.length})`} {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.collabTab} index={0}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { collabs.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={3}>\r\n                            {this.state.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <FormControlLabel\r\n                              control={\r\n                                <Checkbox \r\n                                  checked={c.editPermission} \r\n                                  disabled={this.state.waiting}\r\n                                  onChange={e => {\r\n                                    this.updateCollaboratorPermission(c, e.target.checked);\r\n                                  }}\r\n                                  color=\"primary\" />\r\n                              }\r\n                              label=\"Full Permissions\"\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Remove Collaborator`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={1}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { invites.map((c, key) => {\r\n                      let user = this.state.allUsers.filter(u=>u._id === c.userID);\r\n                      if (user.length === 0)\r\n                        user = null;\r\n                      else {\r\n                        user = user[0];\r\n                      }\r\n                      return (\r\n                        <Grid item container spacing={1} direction=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={9} container spacing={1} direction=\"column\">\r\n                            { user !== null &&\r\n                              <Grid item>\r\n                                Username: {user.username}\r\n                              </Grid>\r\n                            }\r\n                            { c.email !== \"\" &&\r\n                              <Grid item>\r\n                                Email: {c.email}\r\n                              </Grid>\r\n                            }\r\n                            <Grid item>\r\n                              Invite Link: {c.collabLink}\r\n                            </Grid>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Invite`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>  \r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={2}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { requests.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={9}>\r\n                            {this.state.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Request`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst EditCollaboratorPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default EditCollaboratorPage;","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  setTypes,\r\n  setAttributes,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport { Edit, Delete, Add, ArrowBack } from \"@material-ui/icons\";\r\nimport { Fab, Modal, Grid, Button, Tooltip, List, ListItem, ListItemText } from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  const type = state.app.selectedType;\r\n  const subTypes =\r\n    type === null\r\n      ? []\r\n      : state.app.types.filter(t => t.SuperIDs.includes(type._id));\r\n  const things =\r\n    type === null\r\n      ? []\r\n      : state.app.things.filter(t => t.TypeIDs.includes(type._id));\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: type,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    subTypes: subTypes,\r\n    instances: things,\r\n    user: state.app.user,\r\n    things: state.app.things,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    // load();\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteType(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n\r\n          this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`});\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error });\r\n      }\r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    // const { id } = this.props.match.params;\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (id !== undefined) {\r\n      this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n\r\n        if (id !== null) {\r\n          let type = res.types.filter(t => t._id === id);\r\n          if (type.length > 0) {\r\n            type = type[0];\r\n\r\n            this.props.updateSelectedType(type);\r\n          }\r\n          else {\r\n            this.setState({ message: \"Invalid ID\", loaded: true });\r\n          }\r\n        } else {\r\n          this.props.updateSelectedType({\r\n            _id: null,\r\n            Name: \"\",\r\n            Description: \"\",\r\n            Supers: [],\r\n            SuperIDs: [],\r\n            AttributesArr: [],\r\n            Attributes: [],\r\n            Major: false,\r\n            DefaultsHash: {}\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      this.props.updateSelectedType({\r\n        _id: null,\r\n        Name: \"\",\r\n        Description: \"\",\r\n        Supers: [],\r\n        AttributesArr: [],\r\n        Attributes: [],\r\n        Major: false\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedType === undefined || this.props.selectedType === null) {\r\n      return (<span>Loading</span>);\r\n    } else {\r\n      const references = this.props.types.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      const inheritedAttributes = [];\r\n      this.props.selectedType.Supers.forEach(superType => {\r\n        superType.AttributesArr.forEach(attribute => {\r\n          if (inheritedAttributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n        });\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={5}>\r\n                  <h2>{this.props.selectedType.Name}</h2>\r\n                </Grid>\r\n                <Grid item sm={3} xs={6}>\r\n                  <h3>{this.props.selectedType.Major ? \"Major Type\" : \"\"}</h3>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Create New ${this.props.selectedType.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${this.state._id}`})}}\r\n                          >\r\n                            <Add />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.props.selectedType.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/edit/${this.state._id}`})}}\r\n                          >\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.props.selectedType.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                  </List>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n                  <Grid item>{this.props.selectedType.Description}</Grid>\r\n                  <Grid item>\r\n                    Attributes\r\n                    <List>\r\n                      { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n                        inheritedAttributes.map((attribute, i) => {\r\n                          let definedType = this.props.types.filter(t=>t._id === attribute.DefinedType);\r\n                          definedType = definedType.length === 0 ? {Name:\"\"} : definedType[0];\r\n                          const def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <ListItemText>\r\n                                {attribute.Name}:&nbsp;\r\n                                {attribute.AttributeType === \"Options\" ? (\r\n                                  <span>\r\n                                    Options:\r\n                                    {attribute.Options.map((option, j) => {\r\n                                      return (\r\n                                        <span key={j}>\r\n                                          {j === 0 ? \" \" : \", \"}\r\n                                          {option}\r\n                                        </span>\r\n                                      );\r\n                                    })}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    }\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"Type\" ? (\r\n                                  <span>\r\n                                    <Button\r\n                                      variant=\"contained\"\r\n                                      color=\"primary\"\r\n                                      onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                    >\r\n                                      <ListItemText primary={definedType.Name}/>\r\n                                    </Button>\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${this.props.things.filter(t=>t._id === def.DefaultValue)[0].Name})`\r\n                                    }\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"List\" ? (\r\n                                  <span>\r\n                                    List:&nbsp;\r\n                                    {attribute.ListType === \"Options\" ? (\r\n                                      <span>\r\n                                        Options:\r\n                                        {attribute.Options.map((option, j) => {\r\n                                          return (\r\n                                            <span key={j}>\r\n                                              {j === 0 ? \" \" : \", \"}\r\n                                              {option}\r\n                                            </span>\r\n                                          );\r\n                                        })}\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {defaultValue}\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    ) : attribute.ListType === \"Type\" ? (\r\n                                      <span>\r\n                                        <Button\r\n                                          variant=\"contained\"\r\n                                          color=\"primary\"\r\n                                          onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                        >\r\n                                          <ListItemText primary={definedType.Name}/>\r\n                                        </Button>\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {attribute.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  <Button\r\n                                                    variant=\"contained\"\r\n                                                    color=\"primary\"\r\n                                                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${defaultValue}`})}}\r\n                                                  >\r\n                                                    <ListItemText primary={this.props.things.filter(t=>t._id === defaultValue)[0].Name}/>\r\n                                                  </Button>\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    ) : (\r\n                                      <span>\r\n                                        {attribute.ListType}\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {defaultValue}\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    )}\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"True/False\" ? (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" ?\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    : \" (Default: False)\"}\r\n                                  </span>\r\n                                ) : (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    }\r\n                                  </span>\r\n                                )}\r\n                              </ListItemText>\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                      { this.props.selectedType !== null &&\r\n                        this.props.selectedType !== undefined && \r\n                          this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                            let definedType = this.props.types.filter(t=>t._id === attribute.DefinedType);\r\n                            definedType = definedType.length === 0 ? {Name:\"\"} : definedType[0];\r\n                            const def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                            return (\r\n                              <ListItem key={i}>\r\n                                <ListItemText>\r\n                                  {attribute.Name}:&nbsp;\r\n                                  {attribute.AttributeType === \"Options\" ? (\r\n                                    <span>\r\n                                      Options:\r\n                                      {attribute.Options.map((option, j) => {\r\n                                        return (\r\n                                          <span key={j}>\r\n                                            {j === 0 ? \" \" : \", \"}\r\n                                            {option}\r\n                                          </span>\r\n                                        );\r\n                                      })}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      }\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"Type\" ? (\r\n                                    <span>\r\n                                      <Button\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                        onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                      >\r\n                                        <ListItemText primary={definedType.Name}/>\r\n                                      </Button>\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${this.props.things.filter(t=>t._id === def.DefaultValue)[0].Name})`\r\n                                      }\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"List\" ? (\r\n                                    <span>\r\n                                      List:&nbsp;\r\n                                      {attribute.ListType === \"Options\" ? (\r\n                                        <span>\r\n                                          Options:\r\n                                          {attribute.Options.map((option, j) => {\r\n                                            return (\r\n                                              <span key={j}>\r\n                                                {j === 0 ? \" \" : \", \"}\r\n                                                {option}\r\n                                              </span>\r\n                                            );\r\n                                          })}\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    {defaultValue}\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      ) : attribute.ListType === \"Type\" ? (\r\n                                        <span>\r\n                                          <Button\r\n                                            variant=\"contained\"\r\n                                            color=\"primary\"\r\n                                            onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                          >\r\n                                            <ListItemText primary={definedType.Name}/>\r\n                                          </Button>\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {attribute.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    <Button\r\n                                                      variant=\"contained\"\r\n                                                      color=\"primary\"\r\n                                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${defaultValue}`})}}\r\n                                                    >\r\n                                                      <ListItemText primary={this.props.things.filter(t=>t._id === defaultValue)[0].Name}/>\r\n                                                    </Button>\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      ) : (\r\n                                        <span>\r\n                                          {attribute.ListType}\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    {defaultValue}\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      )}\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"True/False\" ? (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" ?\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      : \" (Default: False)\"}\r\n                                    </span>\r\n                                  ) : (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      }\r\n                                    </span>\r\n                                  )}\r\n                                </ListItemText>\r\n                              </ListItem>\r\n                            );\r\n                          })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n                  {this.props.selectedType.Supers.length === 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Super Types\"} />\r\n                        </ListItem>\r\n                        {this.props.selectedType.Supers.map((superType, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${superType._id}`})}}\r\n                              >\r\n                                <ListItemText primary={superType.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.subTypes.length === 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Sub Types\"} />\r\n                        </ListItem>\r\n                        {this.props.subTypes.map((sub, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${sub._id}`})}}\r\n                              >\r\n                                <ListItemText primary={sub.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {references.length !== 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.instances.length === 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Instances\"} />\r\n                        </ListItem>\r\n                        {this.props.instances.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-type-modal\"\r\n                aria-describedby=\"delete-type-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.props.selectedType.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport {Delete} from \"@material-ui/icons\";\r\nimport {Fab, Tooltip} from \"@material-ui/core\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ChipInput from \"material-ui-chip-input\";\r\n\r\nconst handleTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"AttributeType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleDefinedTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond(newType) {\r\n      attr[\"DefinedType\"] = newType._id;\r\n      props.onChange(attr);\r\n    }\r\n    props.onNewType(respond);\r\n  }\r\n  else \r\n    props.onChange(attr);\r\n};\r\n\r\nconst handleListTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"ListType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleOptionsChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.Options = e;\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [name, changeName] = useState(props.attribute.Name);\r\n\r\n  const attributeTypes = [\r\n    \"Text\",\r\n    \"Number\",\r\n    \"True/False\",\r\n    \"Options\", \r\n    \"Type\", \r\n    \"List\"\r\n  ];\r\n  const listTypes = [\r\n    \"Text\",\r\n    \"Options\", \r\n    \"Type\"\r\n  ];\r\n\r\n  const selectedType =\r\n    props.attribute.AttributeType === undefined || props.attribute.AttributeType === null || props.attribute.AttributeType === \"\" ? attributeTypes[0] : props.attribute.AttributeType;\r\n\r\n  const selectedListType =\r\n    props.attribute.ListType === undefined || props.attribute.ListType === \"\" ? listTypes[0] : props.attribute.ListType;\r\n\r\n  const selectedDefinedType =\r\n    props.attribute.DefinedType === undefined || props.attribute.DefinedType === \"\" ? \"\" : props.attribute.DefinedType;\r\n\r\n  let fromTypes = props.attribute.FromTypeIDs === undefined ? [] : props.types.filter(t=> props.attribute.FromTypeIDs.includes(t._id));\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}>Name</InputLabel>\r\n          <OutlinedInput\r\n            disabled={props.disabled}\r\n            id={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            name={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={name}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = props.attribute;\r\n              attr.Name = name;\r\n              // const attr = {\r\n              //   index: props.attribute.index,\r\n              //   Name: name,\r\n              //   Type: props.attribute.AttributeType,\r\n              //   Options: props.attribute.Options,\r\n              //   ListType: props.attribute.ListType,\r\n              //   FromSupers: props.attribute.FromSupers,\r\n              //   DefinedType: props.attribute.DefinedType,\r\n              //   AttributeTypes: props.attribute.AttributeTypes,\r\n              //   DefaultValue: defaultValue,\r\n              //   DefaultListValues: defaultListValues\r\n              // };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n            Attribute Type\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"attribute-type-label\"\r\n            id=\"attribute-type\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0} \r\n            value={selectedType}\r\n            onChange={e => {handleTypeChange(e, props)}}\r\n            fullWidth\r\n            labelWidth={100}\r\n          >\r\n            {attributeTypes.map((type, i) => {\r\n              return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        {selectedType === \"Options\" ? (\r\n          <ChipInput\r\n            variant=\"outlined\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0}\r\n            defaultValue={props.attribute.Options}\r\n            onChange={chips => handleOptionsChange(chips, props)}\r\n          />\r\n        ) : selectedType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n              Defined Type\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"definedType-label\"\r\n              id=\"definedType\"\r\n              disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0} \r\n              value={selectedDefinedType}\r\n              onChange={e => {handleDefinedTypeChange(e, props)}}\r\n              fullWidth\r\n              labelWidth={100}\r\n            >\r\n              <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n              {props.types.map((type, i) => {\r\n                return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : selectedType === \"List\" ? (\r\n          <Grid container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                  List Type\r\n                </InputLabel>\r\n                <Select\r\n                  labelId=\"list-type-label\"\r\n                  id=\"list-type\"\r\n                  disabled={props.disabled}\r\n                  // disabled={props.attribute.FromSupers.length > 0} \r\n                  value={selectedListType}\r\n                  onChange={e => {handleListTypeChange(e, props)}}\r\n                  fullWidth\r\n                  labelWidth={70}\r\n                >\r\n                  {listTypes.map((type, i) => {\r\n                    return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                  })}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            { props.attribute.ListType === \"Type\" ? \r\n              (\r\n                <Grid item>\r\n                  <FormControl variant=\"outlined\" fullWidth>\r\n                    <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                      Defined Type\r\n                    </InputLabel>\r\n                    <Select\r\n                      labelId=\"definedType-label\"\r\n                      id=\"definedType\"\r\n                      disabled={props.disabled}\r\n                      // disabled={props.attribute.FromSupers.length > 0} \r\n                      value={selectedDefinedType}\r\n                      onChange={e => {handleDefinedTypeChange(e, props)}}\r\n                      fullWidth\r\n                      labelWidth={100}\r\n                    >\r\n                      <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                      {props.types.map((type, i) => {\r\n                        return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                      })}\r\n                    </Select>\r\n                  </FormControl>\r\n                </Grid>\r\n              ) : props.attribute.ListType === \"Options\" ?\r\n              (\r\n                <Grid item>\r\n                  <ChipInput\r\n                    variant=\"outlined\"\r\n                    disabled={props.disabled}\r\n                    // disabled={props.attribute.FromSupers.length > 0}\r\n                    defaultValue={props.attribute.Options}\r\n                    onChange={chips => handleOptionsChange(chips, props)}\r\n                  />\r\n                </Grid>\r\n              ) : \"\"\r\n            }\r\n          </Grid>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item xs={3}>\r\n        { fromTypes.length === 1 ? \r\n          `From Type: ${fromTypes[0].Name}`\r\n        : fromTypes.length > 1 ?\r\n          <span>\r\n            From Types: \r\n            { fromTypes.map((type, i) => {\r\n              return (<span key={i}>{i > 0 && \", \"}{type.Name}</span>)\r\n            })}\r\n          </span>\r\n        : \r\n          <Tooltip title={`Delete Attribute`}>\r\n            <Fab size=\"small\"\r\n              color=\"primary\"\r\n              // disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0}\r\n              onClick={_ => props.onDelete(props.attribute)}\r\n            >\r\n              <Delete />\r\n            </Fab>\r\n          </Tooltip>\r\n        }\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = e;\r\n  props.onChange(def);\r\n};\r\nconst handleDefinedTypeChange = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond2(newThing) {\r\n      // attr[\"DefinedType\"] = newType._id;\r\n      // props.onChange(attr);\r\n      respond(newThing._id);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues.push(selectedItem.Name);\r\n  props.onChange(def);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o.Name);\r\n  });\r\n  props.onChange(def);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    function respond2(newThing) {\r\n      const def = props.def;\r\n      def.DefaultListValues.push(newThing._id);\r\n      props.onChange(def);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    const def = props.def;\r\n    def.DefaultListValues.push(selectedItem._id);\r\n    props.onChange(def);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o._id);\r\n  });\r\n  props.onChange(def);\r\n};\r\n\r\nexport default function AttributeDefaultControl(props) {\r\n  // I'm passing in attribute and def.\r\n  const [value, changeValue] = useState(props.def.DefaultValue);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n  \r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.def.DefaultListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n    props.things\r\n      .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n      .forEach(t => {\r\n        listOptions.push({ Name: t.Name, _id: t._id });\r\n      });\r\n    listOptions\r\n      .filter(t => props.def.DefaultListValues.includes(t._id))\r\n      .forEach(t => {\r\n        listOptionValues.push(t);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item xs={12}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`attribute_name_${props.attribute.attrID}`}>{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id={`attribute_name_${props.attribute.attrID}`}\r\n              name={`attribute_name_${props.attribute.attrID}`}\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.def.DefaultValue===\"True\"} onChange={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(def);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={`${props.attribute.Name} Default True`}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props, changeValue);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                variant=\"outlined\"\r\n                defaultValue={props.def.DefaultListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n// import styled from \"styled-components\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Button from \"@material-ui/core/Button\";\r\n// import Add from \"@material-ui/icons/Add\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\n// import ListItemText from \"@material-ui/core/ListItemText\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport uuid from 'react-uuid';\r\nimport {\r\n  updateSelectedType,\r\n  // updateAttributesArr,\r\n  addType,\r\n  addThing\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport AttributeDefaultControl from \"./AttributeDefaultControl\";\r\nimport API from \"../../smartAPI\";\r\n\r\n// It will let you add and remove attributes.\r\n// Each needs to have a unique name as part of validation.\r\n// Each also needs to have a valid type.\r\n// The type can be string, integer, double, enum, any Type\r\n// already defined for this world, or a list of any of the\r\n// other types.\r\n// In future versions I will add support for additional types:\r\n// Color, DateTime, Schedule.\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedType: state.app.selectedType,\r\n    // attributesArr: state.app.attributesArr,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    // updateAttributesArr: arr => dispatch(updateAttributesArr(arr)),\r\n    addType: type => dispatch(addType(type)),\r\n    addThing: thing => dispatch(addThing(thing))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      typeModalOpen: false,\r\n      thingModalOpen: false,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      defaultsMode: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\"\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  changeDefault = value => {\r\n    const type = this.props.selectedType;\r\n    type.DefaultsHash[value.attrID] = {\r\n      attrID: value.attrID,\r\n      DefaultValue: value.DefaultValue,\r\n      DefaultListValues: value.DefaultListValues,\r\n      FromTypeIDs: value.FromTypeIDs\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributes = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributes.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    let defaults = {...type.DefaultsHash};\r\n    if (defaults[value.attrID] !== undefined) {\r\n      delete defaults[value.attrID];\r\n    }\r\n    type.DefaultsHash = {};\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributes;\r\n      type.DefaultsHash = defaults;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  };\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  addNewType = (respond) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({typeModalOpen: true, modalSubmit: respond});\r\n  }\r\n\r\n  addNewThing = (respond, type) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({thingModalOpen: true, modalSubmit: respond, newThingType: type});\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          if (this.state.thingModalOpen) {\r\n            message = this.state.newThingType.Name + \" Name is too short\"\r\n          }\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewType = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const type = {\r\n      _id: null,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      SuperIDs: [],\r\n      AttributesArr: [],\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID,\r\n      Major: false\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createType(type)\r\n      .then(res => {\r\n        if (res.typeID !== undefined) {\r\n          type._id = res.typeID;\r\n          type.Supers = [];\r\n          // Adds to props \r\n          this.props.addType(type);\r\n          // Calls respond back to Attribute to set the type\r\n          this.state.modalSubmit(type);\r\n          this.setState({\r\n            waiting: false, \r\n            typeModalOpen: false\r\n          });\r\n        }\r\n        else if (res.error !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.error \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThingThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThingThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      // AttributesArr: [],\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          thing.AttributesArr = [];\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            thingModalOpen: false\r\n          });\r\n        }\r\n        else if (res.error !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.error \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    // I should move this somewhere else so it's not happening on every render.\r\n    const inheritedAttributes = [];\r\n    this.props.selectedType.SuperIDs.forEach(s => {\r\n      let superType = this.props.types.filter(t => t._id === s);\r\n      if (superType.length > 0) {\r\n        superType = superType[0];\r\n        superType.AttributesArr.forEach(attribute => {\r\n          let inheritedAttribute = inheritedAttributes.filter(a=>a.attrID === attribute.attrID);\r\n          if (inheritedAttribute.length === 0) {\r\n            attribute.FromTypeIDs = [superType._id];\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n          else {\r\n            inheritedAttribute = inheritedAttribute[0];\r\n            inheritedAttribute.FromTypeIDs.push(superType._id);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item>\r\n          <List>\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              inheritedAttributes.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.props.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        disabled={true}\r\n                        attribute={attribute}\r\n                        // onChange={this.changeAttribute}\r\n                        // onDelete={this.deleteAttribute}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                \r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.props.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        onChange={this.changeAttribute}\r\n                        onDelete={this.deleteAttribute}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n          </List>\r\n        </Grid>\r\n        <Modal\r\n          aria-labelledby=\"new-type-modal\"\r\n          aria-describedby=\"new-type-modal-description\"\r\n          open={this.state.typeModalOpen}\r\n          onClose={e => {this.setState({typeModalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new Type a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewType}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({typeModalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.thingModalOpen}\r\n          onClose={e => {this.setState({thingModalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({thingModalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText\r\n} from \"@material-ui/core\";\r\n  \r\n\r\nexport default function TextBox(props) {\r\n  const [value, changeValue] = useState(props.Value);\r\n  \r\n  return (\r\n    <FormControl variant=\"outlined\" fullWidth>\r\n      <InputLabel htmlFor={`text_field_${props.fieldName}`}>{props.fieldName}</InputLabel>\r\n      <OutlinedInput\r\n        id={`text_field_${props.fieldName}`}\r\n        name={`text_field_${props.fieldName}`}\r\n        type=\"text\"\r\n        autoComplete=\"Off\"\r\n        error={props.message !== undefined && props.message !== \"\"}\r\n        value={value}\r\n        onChange={e => {\r\n          changeValue(e.target.value);\r\n        }}\r\n        onBlur={e => {\r\n          props.onBlur(value);\r\n        }}\r\n        labelWidth={props.labelWidth}\r\n        fullWidth\r\n      />\r\n      <FormHelperText>\r\n        {props.message}\r\n      </FormHelperText>\r\n    </FormControl>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport uuid from 'react-uuid';\r\nimport { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport { \r\n  Grid, Button, Checkbox, FormControl, FormControlLabel,\r\n  InputLabel, Tooltip, Fab,\r\n  Select, MenuItem \r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  addAttributes,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: state.app.selectedType,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addAttributes: attrs => dispatch(addAttributes(attrs)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      // Name: \"\",\r\n      // Description: \"\",\r\n      // Supers: [],\r\n      // Attributes: [],\r\n      Major: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: false,\r\n      resetting: false,\r\n      browseAttributes: false,\r\n      browseAttributesSelected: \"\",\r\n      browseTypesSelected: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        this.setState({\r\n          resetting: false, \r\n          redirectTo: `/type/create`});\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        });\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  // handleUserInput = e => {\r\n  //   const name = e.target.name;\r\n  //   const value =\r\n  //     e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n  //   this.setState({ [name]: value });\r\n  // };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.props.selectedType[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          const attrByName = this.props.attributesByName[value[i].Name];\r\n          if (attrByName !== undefined && \r\n            attrByName._id !== value[i].attrID) {\r\n            valid = false;\r\n            message = `An attribute with the name '${value[i].Name}' already exists`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      case \"Attributes\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          const attrByName = this.props.attributesByName[value[i].Name];\r\n          if (attrByName !== undefined && \r\n            attrByName._id !== value[i].attrID) {\r\n            valid = false;\r\n            message = `An attribute with this name already exists`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrArrValid = this.validateField(\"AttributesArr\");\r\n    // const attrValid = this.validateField(\"Attributes\");\r\n    const formValid = nameValid.valid && attrArrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.AttributesArr = attrArrValid;\r\n    // fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true, addMore: addMore }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const superIDs = this.props.selectedType.Supers.map(s => {\r\n      return s._id;\r\n    });\r\n\r\n    const attributes = this.props.selectedType.AttributesArr.map(a => {\r\n      return {\r\n        _id: a.attrID,\r\n        Name: a.Name.trim(),\r\n        AttributeType: a.AttributeType,\r\n        Options: a.Options,\r\n        DefinedType: a.DefinedType,\r\n        ListType: a.ListType\r\n      };\r\n    });\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      const typeAttributes = [];\r\n      this.props.selectedType.AttributesArr.forEach(a => {\r\n        const id = a.attrID.includes(\"null\") ? res.attributes[a.Name] : a.attrID;\r\n        typeAttributes.push({\r\n          attrID: id,\r\n          index: a.index,\r\n          // Name: a.Name,\r\n          // AttributeType: a.AttributeType,\r\n          // Options: a.Options,\r\n          // DefinedType: a.DefinedType,\r\n          // ListType: a.ListType\r\n        });\r\n      });\r\n\r\n      const type = {\r\n        _id: this.state._id,\r\n        Name: this.props.selectedType.Name.trim(),\r\n        Description: this.props.selectedType.Description,\r\n        SuperIDs: superIDs,\r\n        // AttributesArr: this.props.selectedType.AttributesArr,\r\n        Attributes: typeAttributes,\r\n        Defaults: [],\r\n        worldID: this.props.selectedWorld._id,\r\n        Major: this.props.selectedType.Major,\r\n        ReferenceIDs: [],\r\n        DefaultReferenceIDs: []\r\n      };\r\n      // this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n      //   if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n      //     type.ReferenceIDs.push(a.DefinedType);\r\n      //   }\r\n      // });\r\n      this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n        if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n          type.ReferenceIDs.push(a.DefinedType);\r\n        }\r\n      });\r\n      this.props.selectedType.Supers.forEach(s=> {\r\n        s.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n          if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n            type.ReferenceIDs.push(a.DefinedType);\r\n          }\r\n        });\r\n      });\r\n      Object.keys(this.props.selectedType.DefaultsHash).forEach(attrID => {\r\n        const def = this.props.selectedType.DefaultsHash[attrID];\r\n        type.Defaults.push({\r\n          attrID, \r\n          FromTypeID: def.FromTypeID, \r\n          DefaultValue: def.DefaultValue, \r\n          DefaultListValues: def.DefaultListValues \r\n        });\r\n      });\r\n  \r\n      if (type._id === null) {\r\n        this.api\r\n          .createType(type)\r\n          .then(res => {\r\n            if (res.typeID !== undefined) {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n\r\n                if (this.state.addMore) {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    // Name: \"\",\r\n                    // Description: \"\",\r\n                    // Supers: [],\r\n                    // Attributes: [],\r\n                    // Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true\r\n                  }, this.resetForm);\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            else if (res.error !== undefined) {\r\n              this.setState({\r\n                waiting: false, \r\n                message: res.error \r\n              });\r\n            }\r\n          })\r\n          .catch(err => console.log(err));\r\n      } else {\r\n        this.api\r\n          .updateType(type)\r\n          .then(res => {\r\n            if (res.error === undefined) {\r\n              this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n                this.props.setAttributes(res2.attributes);\r\n                this.props.setTypes(res2.types);\r\n                this.props.setThings(res2.things);\r\n\r\n                if (this.state.addMore) {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    // Name: \"\",\r\n                    // Description: \"\",\r\n                    // Supers: [],\r\n                    // Attributes: [],\r\n                    // Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true\r\n                  }, this.resetForm);\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            else {\r\n              this.setState({\r\n                waiting: false, \r\n                message: res.error \r\n              });\r\n            }\r\n          })\r\n          .catch(err => console.log(err));\r\n      }\r\n    });\r\n  };\r\n\r\n  supersChange = (e, value) => {\r\n    let supers = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      supers.push(t);\r\n      supers = supers.concat(t.Supers);\r\n    }\r\n    const type = this.props.selectedType;\r\n    type.Supers = supers;\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: supers });\r\n  };\r\n\r\n  addSuper = (selectedList, selectedItem) => {\r\n    const type = this.props.selectedType;\r\n    type.SuperIDs.push(selectedItem._id);\r\n    selectedItem.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    // We need to go through all the attributes on type, \r\n    // and make sure that none of them are also on a super type\r\n    let duplicateAttributes = [];\r\n    selectedList.forEach(t => {\r\n      duplicateAttributes = duplicateAttributes.concat(type.AttributesArr.filter(a => a.TypeIDs.includes(t._id)));\r\n    });\r\n    type.AttributesArr = type.AttributesArr.filter(a => duplicateAttributes.filter(d => d.attrID === a.attrID).length === 0);\r\n    \r\n    type.Supers = selectedList;\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: selectedList });\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\",\r\n      TypeIDs: []\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  addSelectedAttribute = () => {\r\n    const attr = this.props.attributesByID[this.state.browseAttributesSelected];\r\n    \r\n    const type = this.props.selectedType;\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: attr._id,\r\n      Name: attr.Name,\r\n      AttributeType: attr.AttributeType,\r\n      Options: attr.Options,\r\n      DefinedType: attr.DefinedType,\r\n      ListType: attr.ListType,\r\n      TypeIDs: attr.TypeIDs\r\n    });\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ \r\n      browseAttributesSelected: \"\",\r\n      browseTypesSelected: \"\" \r\n    });\r\n  }\r\n\r\n  addBrowsedType = (typeID) => {\r\n    const type = this.props.selectedType;\r\n    let attrType = this.props.types.filter(t => t._id === typeID)[0];\r\n    \r\n    type.SuperIDs.push(attrType._id);\r\n    const selectedList = type.Supers;\r\n    selectedList.push(attrType);\r\n\r\n    attrType.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    // We need to go through all the attributes on type, \r\n    // and make sure that none of them are also on a super type\r\n    let duplicateAttributes = [];\r\n    selectedList.forEach(t => {\r\n      duplicateAttributes = duplicateAttributes.concat(type.AttributesArr.filter(a => a.TypeIDs.includes(t._id)));\r\n    });\r\n    type.AttributesArr = type.AttributesArr.filter(a => duplicateAttributes.filter(d => d.attrID === a.attrID).length === 0);\r\n    \r\n    type.Supers = [];\r\n    this.props.updateSelectedType(type);\r\n    // this.setState({ Supers: [] });\r\n    setTimeout(() => {\r\n      type.Supers = selectedList;\r\n      this.props.updateSelectedType(type);\r\n      this.setState({ \r\n        browseAttributesSelected: \"\", \r\n        browseTypesSelected: \"\", \r\n        // Supers: selectedList \r\n      });\r\n    }, 500);\r\n  }\r\n  \r\n  removeSuper = (selectedList, removedItem) => {\r\n    let supers = [];\r\n    let superIDs = [];\r\n    let removeUs = [removedItem._id];\r\n    const type = this.props.selectedType;\r\n    for (let i = 0; i < type.Supers.length; i++) {\r\n      const checkMe = this.props.types.filter(\r\n        t => t._id === type.Supers[i]._id\r\n      )[0];\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else {\r\n        supers.push(checkMe);\r\n        superIDs.push(checkMe._id);\r\n      }\r\n    }\r\n    type.Supers = []; // supers;\r\n    type.SuperIDs = []; // superIDs;\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ \r\n      // Supers: supers, \r\n      loaded: false \r\n    });\r\n    setTimeout(() => {\r\n      type.Supers = supers;\r\n      type.SuperIDs =  superIDs;\r\n      this.props.updateSelectedType(type);\r\n      this.setState({ loaded: true });\r\n    }, 500);\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n      this.setState({\r\n        _id: id,\r\n        loaded: true,\r\n        message: \"\"\r\n      });\r\n    }\r\n    else {\r\n      this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n        this.props.setAttributes(res.attributes);\r\n        this.props.setTypes(res.types);\r\n        this.props.setThings(res.things);\r\n        if (id !== null) {\r\n          let type = res.types.filter(t => t._id === id);\r\n          if (type.length > 0) {\r\n            type = type[0];\r\n            const supers = this.props.types.filter(type =>\r\n              type.SuperIDs.includes(type._id)\r\n            );\r\n            type.Supers = supers;\r\n            this.props.updateSelectedType(type);\r\n            this.setState({\r\n              // Name: type.Name,\r\n              // Description: type.Description,\r\n              _id: id,\r\n              // Supers: supers,\r\n              // Major: type.Major,\r\n              loaded: true\r\n            });\r\n          }\r\n          else {\r\n            this.setState({ message: \"Invalid ID\", loaded: true });\r\n          }\r\n        } else {\r\n          this.props.updateSelectedType({\r\n            _id: null,\r\n            Name: \"\",\r\n            Description: \"\",\r\n            Supers: [],\r\n            SuperIDs: [],\r\n            AttributesArr: [],\r\n            Attributes: [],\r\n            Major: false,\r\n            DefaultsHash: {}\r\n          });\r\n          this.setState({ loaded: true });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedType === null || this.props.selectedType._id !== id) {\r\n      return <span>Loading...</span>;\r\n    } else {\r\n      const types =\r\n        this.props.types === undefined || this.state._id === null\r\n          ? this.props.types\r\n          : this.props.types.filter(type => type._id !== this.state._id);\r\n      \r\n      let additionalAttributes = [];\r\n      let selectedAttributeTypes = [];\r\n      let selectedAttributeName = \"\";\r\n      if (this.state.browseAttributes) {\r\n        Object.keys(this.props.attributesByID).forEach(id => {\r\n          const attr = this.props.attributesByID[id];\r\n          if (!attr.TypeIDs.includes(this.props.selectedType._id) && \r\n            this.props.selectedType.AttributesArr.filter(a => a.attrID === attr._id).length === 0) { // This second condition will make newly added attributes not show up.\r\n            let found = false;\r\n            for (let i = 0; i < this.props.selectedType.Supers.length; i++) {\r\n              if (attr.TypeIDs.includes(this.props.selectedType.Supers[i]._id)) {\r\n                found = true;\r\n                break;\r\n              }\r\n            }\r\n            if (!found) {\r\n              additionalAttributes.push({\r\n                _id: attr._id,\r\n                Name: attr.Name\r\n              });\r\n            }\r\n          }\r\n        });\r\n\r\n        if (this.state.browseAttributesSelected !== \"\") {\r\n          selectedAttributeName = this.props.attributesByID[this.state.browseAttributesSelected].Name;\r\n          selectedAttributeTypes = this.props.types.filter(t => this.props.attributesByID[this.state.browseAttributesSelected].TypeIDs.includes(t._id));\r\n        }\r\n      }\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={11}>\r\n                  <h2>{this.state._id === null ? \"Create New Type\" : \"Edit Type\"}</h2>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedType.Name} \r\n                    fieldName=\"Name\" \r\n                    message={this.state.fieldValidation.Name.message}\r\n                    onBlur={name => {\r\n                      const type = this.props.selectedType;\r\n                      type.Name = name;\r\n                      this.props.updateSelectedType(type);\r\n                      this.validateForm();\r\n                      // this.setState({ Name: name }, \r\n                      //   this.validateForm);\r\n                    }}\r\n                    labelWidth={43}/>\r\n                }\r\n                {/* <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl> */}\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedType.Description} \r\n                    fieldName=\"Description\" \r\n                    onBlur={desc => {\r\n                      const type = this.props.selectedType;\r\n                      type.Description = desc;\r\n                      this.props.updateSelectedType(type);\r\n                      // this.setState({ Description: desc });\r\n                    }}\r\n                    labelWidth={82}/>\r\n                }\r\n                {/* <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"description\">Description</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"description\"\r\n                    name=\"Description\"\r\n                    type=\"text\"\r\n                    multiline={true}\r\n                    value={this.state.Description}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={82}\r\n                    fullWidth\r\n                  />\r\n                </FormControl> */}\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Checkbox\r\n                      checked={this.props.selectedType.Major}\r\n                      onChange={ e => {\r\n                        const value = e.target.checked;\r\n                        const type = this.props.selectedType;\r\n                        type.Major = value;\r\n                        this.props.updateSelectedType(type);\r\n                        // this.setState({ [name]: value });\r\n                        // this.handleUserInput(e);\r\n                      }}\r\n                      name=\"Major\"\r\n                      color=\"primary\"\r\n                    />\r\n                  }\r\n                  label=\"Major Type\"\r\n                />\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.resetting ? \"\" :\r\n                  <Multiselect\r\n                    placeholder=\"Super Types\"\r\n                    options={types}\r\n                    selectedValues={this.props.selectedType.Supers}\r\n                    onSelect={this.addSuper}\r\n                    onRemove={this.removeSuper}\r\n                    displayValue=\"Name\"\r\n                  />\r\n                }\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <span>Attributes&nbsp;\r\n                    <Tooltip \r\n                      title={`Add New Attribute`} \r\n                      disabled={this.state.defaultsMode}>\r\n                      <Fab size=\"small\"\r\n                        color=\"primary\"\r\n                        onClick={ _ => { this.newAttribute()}}\r\n                      >\r\n                        <Add />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                    <Tooltip \r\n                      title={`Browse Additional Attributes`} \r\n                      disabled={this.state.defaultsMode}>\r\n                      <Fab\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        onClick={e => {\r\n                          this.setState({ browseAttributes: !this.state.browseAttributes });\r\n                        }}\r\n                      >\r\n                        <Search />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                  </span>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button variant=\"contained\" color=\"primary\" onClick={e => { this.setState({defaultsMode: !this.state.defaultsMode}) }}>\r\n                    { this.state.defaultsMode ? \"Set Attribute Types\" : \"Set Defaults\"}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n              { this.state.browseAttributes && \r\n                <Grid item container spacing={1} direction=\"row\">\r\n                  <Grid item xs={12} sm={6}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"browseForAttributes\" id=\"browseForAttributes-label\">\r\n                        Browse Attributes\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"browseForAttributes-label\"\r\n                        id=\"browseForAttributes\"\r\n                        value={this.state.browseAttributesSelected}\r\n                        onChange={e => {\r\n                          this.setState({ browseAttributesSelected: e.target.value });\r\n                        }}\r\n                        fullWidth\r\n                        labelWidth={130}\r\n                      >\r\n                        {\r\n                          additionalAttributes.map((attr, i) => {\r\n                            return (\r\n                              <MenuItem key={i} value={attr._id}>\r\n                                {attr.Name}\r\n                              </MenuItem>\r\n                            );\r\n                          })\r\n                        }\r\n                      </Select>\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item xs={12} sm={6}>\r\n                    <Button\r\n                      variant=\"contained\" color=\"primary\"\r\n                      disabled={ this.state.browseAttributesSelected === \"\" }\r\n                      onClick={e => {this.addSelectedAttribute();}}\r\n                      type=\"submit\"\r\n                    >\r\n                      Add Attribute\r\n                    </Button>\r\n                  </Grid>\r\n                  { selectedAttributeTypes.length === 1 ?\r\n                    <Grid style={{color: \"red\"}} item xs={12} container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12}>\r\n                        This Attribute is also found on the Type '{selectedAttributeTypes[0].Name}'.  You may want to add '{selectedAttributeTypes[0].Name}' as a Super Type instead of adding the Attribute.\r\n                      </Grid>                      \r\n                      <Grid item xs={12} sm={6}>\r\n                        <Button\r\n                          variant=\"contained\" color=\"primary\"\r\n                          onClick={e => {this.addBrowsedType(selectedAttributeTypes[0]._id);}}\r\n                          type=\"submit\"\r\n                        >\r\n                          Add {selectedAttributeTypes[0].Name}\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  : selectedAttributeTypes.length > 1 &&\r\n                    <Grid style={{color: \"red\"}} item xs={12} container spacing={1} direction=\"row\">\r\n                      <Grid item xs={12}>\r\n                        This Attribute is also found on other Types.  You may want to add one as a Super Type instead of adding the Attribute.\r\n                      </Grid>                      \r\n                      <Grid item xs={12} sm={6}>\r\n                        <FormControl variant=\"outlined\" fullWidth>\r\n                          <InputLabel htmlFor=\"browseTypesWithAttribute\" id=\"browseTypesWithAttribute-label\">\r\n                            Browse Types with {selectedAttributeName}\r\n                          </InputLabel>\r\n                          <Select\r\n                            labelId=\"browseTypesWithAttribute-label\"\r\n                            id=\"browseTypesWithAttribute\"\r\n                            value={this.state.browseTypesSelected}\r\n                            onChange={e => {\r\n                              this.setState({ browseTypesSelected: e.target.value });\r\n                            }}\r\n                            fullWidth\r\n                            labelWidth={140 + selectedAttributeName.length * 9}\r\n                          >\r\n                            { selectedAttributeTypes.map((type, i) => {\r\n                              return (\r\n                                <MenuItem key={i} value={type._id}>\r\n                                  {type.Name}\r\n                                </MenuItem>\r\n                              );\r\n                            })}\r\n                          </Select>\r\n                        </FormControl>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <Button\r\n                          variant=\"contained\" color=\"primary\"\r\n                          disabled={ this.state.browseTypesSelected === \"\" }\r\n                          onClick={e => {this.addBrowsedType(this.state.browseTypesSelected);}}\r\n                          type=\"submit\"\r\n                        >\r\n                          Add Type\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  }\r\n                </Grid>\r\n              }\r\n              <Grid item>\r\n                { this.state.loaded &&\r\n                  <AttributesControl defaultsMode={this.state.defaultsMode} />\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                  if (\r\n                    this.state.fieldValidation[fieldName] !== undefined &&\r\n                    this.state.fieldValidation[fieldName].message.length > 0\r\n                  ) {\r\n                    return (\r\n                      <p className=\"redFont\" key={i}>\r\n                        {this.state.fieldValidation[fieldName].message}\r\n                      </p>\r\n                    );\r\n                  } else {\r\n                    return \"\";\r\n                  }\r\n                })}\r\n              </Grid>\r\n              <Grid item>\r\n                <div className=\"float-right\">\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(true);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    className=\"w-200\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(false);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={_ => {\r\n                      if (this.props.selectedType._id === null) {\r\n                        this.setState({\r\n                          redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                        });\r\n                      }\r\n                      else {\r\n                        this.setState({\r\n                          redirectTo: `/type/details/${this.props.selectedType._id}`\r\n                        });\r\n                      }\r\n                    }}\r\n                    type=\"button\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { ArrowBack, Edit, Delete } from \"@material-ui/icons\";\r\nimport { \r\n  Fab, Tooltip, Modal, Grid, Button, \r\n  List, ListItem, ListItemText\r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  const thing = state.app.selectedThing;\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: thing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      AttributesArr: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.setState({ waiting: true }, this.finishDelete);\r\n  }\r\n\r\n  finishDelete = e => {\r\n    this.api.deleteThing(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      if (res.error === undefined) {\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n\r\n          this.setState({ waiting: false, redirectTo: `/world/details/${this.props.selectedWorldID}`});\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ waiting: false, message: res.error });\r\n      }\r\n      // const things = this.props.things.filter(t=>t._id!==this.state._id);\r\n      // this.props.setThings(things);\r\n      // this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n      \r\n      if (id !== undefined) {\r\n        let thing = res.things.filter(t => t._id === id);\r\n        if (thing.length === 0) {\r\n          this.setState({ message: \"Invalid Thing ID\" });\r\n        }\r\n        else {\r\n          thing = thing[0];\r\n          thing.AttributesArr = [];\r\n          thing.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            thing.AttributesArr.push({\r\n              index: thing.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              Value: a.Value,\r\n              ListValues: a.ListValues,\r\n              TypeIDs: attr.TypeIDs\r\n            });\r\n          });\r\n          this.setState({\r\n            Name: thing.Name,\r\n            Description: thing.Description,\r\n            _id: id,\r\n            Types: thing.Types\r\n          });\r\n        }\r\n        this.props.updateSelectedThing(thing);\r\n      } else {\r\n        this.props.updateSelectedThing({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Types: [],\r\n          Attributes: [],\r\n          AttributesArr: []\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const references = this.props.things.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={8}>\r\n                  <h2>{this.state.Name}</h2>\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/edit/${this.state._id}`})}}\r\n                          >\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                  </List> \r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n                  <Grid item>{this.state.Description}</Grid>\r\n                  <Grid item>\r\n                    Attributes\r\n                    <List>\r\n                      {this.props.selectedThing === null ||\r\n                      this.props.selectedThing === undefined\r\n                        ? \"\"\r\n                        : this.props.selectedThing.AttributesArr.map(\r\n                            (attribute, i) => {\r\n                              return (\r\n                                <ListItem key={i}>\r\n                                  <ListItemText>\r\n                                    {attribute.Name}:&nbsp;\r\n                                    {attribute.AttributeType === \"Type\" && attribute.Value !== \"\" ?\r\n                                    <Button\r\n                                      variant=\"contained\"\r\n                                      color=\"primary\"\r\n                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${attribute.Value}`})}}\r\n                                    >\r\n                                      <ListItemText primary={this.props.things.filter(t=>t._id === attribute.Value)[0].Name}/>\r\n                                    </Button>\r\n                                    : attribute.AttributeType === \"List\" ?\r\n                                      attribute.ListValues.map(\r\n                                        (listValue, i) => {\r\n                                          let thing = this.props.things.filter(t=>t._id === listValue);\r\n                                          if (thing.length > 0)\r\n                                            thing = thing[0];\r\n                                          else \r\n                                            thing = null;\r\n                                          return (\r\n                                          <span key={i}>\r\n                                            {\r\n                                              attribute.ListType === \"Type\" ?\r\n                                              <span>\r\n                                                <Button\r\n                                                  variant=\"contained\"\r\n                                                  color=\"primary\"\r\n                                                  onClick={ _ => {this.setState({redirectTo:`/thing/details/${listValue}`})}}\r\n                                                >\r\n                                                  { thing === null ? `${listValue}` : \r\n                                                    <ListItemText primary={this.props.things.filter(t=>t._id === listValue)[0].Name}/>\r\n                                                  }\r\n                                                </Button> \r\n                                                &nbsp;\r\n                                              </span>\r\n                                              :\r\n                                              i > 0 ? `, ${listValue}` : `${listValue}`\r\n                                            }\r\n                                          </span>\r\n                                          );\r\n                                        })\r\n                                    : attribute.Value}\r\n                                  </ListItemText>\r\n                                </ListItem>\r\n                              );\r\n                            }\r\n                          )}\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n                  {this.state.Types.length === 0 ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Types\"} />\r\n                        </ListItem>\r\n                        {this.state.Types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {references.length === 0 ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-thing-modal\"\r\n                aria-describedby=\"delete-thing-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.state.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = e;\r\n  props.onChange(attr);\r\n};\r\nconst handleDefinedTypeChange = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond2(newThing) {\r\n      // attr[\"DefinedType\"] = newType._id;\r\n      // props.onChange(attr);\r\n      respond(newThing._id);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues.push(selectedItem.Name);\r\n  props.onChange(attr);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o.Name);\r\n  });\r\n  props.onChange(attr);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    function respond2(newThing) {\r\n      const attr = props.attribute;\r\n      attr.ListValues.push(newThing._id);\r\n      props.onChange(attr);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    const attr = props.attribute;\r\n    attr.ListValues.push(selectedItem._id);\r\n    props.onChange(attr);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o._id);\r\n  });\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [value, changeValue] = useState(props.attribute.Value);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n\r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.attribute.ListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    if (definedType !== undefined) {\r\n      listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n      props.things\r\n        .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n        .forEach(t => {\r\n          listOptions.push({ Name: t.Name, _id: t._id });\r\n        });\r\n      listOptions\r\n        .filter(t => props.attribute.ListValues.includes(t._id))\r\n        .forEach(t => {\r\n          listOptionValues.push(t);\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Grid item container spacing={1} direction=\"row\">\r\n      <Grid item xs={11}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor={`attribute_name_${props.attribute.attrID}`}>{props.attribute.Name}</InputLabel>\r\n            <OutlinedInput\r\n              id={`attribute_name_${props.attribute.attrID}`}\r\n              name={`attribute_name_${props.attribute.attrID}`}\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name}</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.attribute.Value===\"True\"} onChange={e => {\r\n                const attr = props.attribute;\r\n                attr.Value = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(attr);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={props.attribute.Name}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name}\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name}\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props, changeValue);\r\n              }}\r\n              onBlur={e => {\r\n                const attr = {\r\n                  index: props.attribute.index,\r\n                  attrID: props.attribute.attrID,\r\n                  Name: props.attribute.Name,\r\n                  AttributeType: props.attribute.AttributeType,\r\n                  Options: props.attribute.Options,\r\n                  DefinedType: props.attribute.DefinedType,\r\n                  ListType: props.attribute.ListType,\r\n                  FromTypes: props.attribute.FromTypes,\r\n                  Value: value,\r\n                  ListValues: props.attribute.ListValues\r\n                };\r\n                props.onChange(attr);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={props.attribute.Name}\r\n                variant=\"outlined\"\r\n                defaultValue={props.attribute.ListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={props.attribute.Name}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={props.attribute.Name}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n      <Grid item xs={1}>\r\n        <InfoIcon\r\n          style={{ cursor: \"pointer\" }}\r\n          onClick={ _ => {\r\n            props.infoModal(props.attribute);\r\n          }} \r\n        />\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  Grid, Modal, FormControl, InputLabel, \r\n  OutlinedInput, FormHelperText, Button,\r\n  // List,\r\n  // ListItem,\r\n} from \"@material-ui/core\";\r\nimport { \r\n  updateSelectedThing, addThing \r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport API from \"../../smartAPI\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedThing: state.app.selectedThing,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n      infoModalOpen: false,\r\n      // infoAttribute: null,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.push({\r\n      index: thing.AttributesArr.length,\r\n      _id: null,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"Text\",\r\n      FromTypes: [],\r\n      Value: \"\",\r\n      ListValues: [],\r\n      FromTypeIDs: [],\r\n      TypeIDs: []\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    const attribute = thing.AttributesArr.filter(a=>a.attrID === value.attrID)[0];\r\n    attribute.Value = value.Value;\r\n    attribute.ListValues = value.ListValues;\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.splice(value.index);\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  optionsChange = (e, props) => {\r\n  }\r\n\r\n  addNewThing = (respond, type) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({modalOpen: true, modalSubmit: respond, newThingType: type});\r\n  }\r\n\r\n  infoModal = (attribute) => {\r\n    this.props.onInfo(attribute);\r\n  }\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 100;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          thing.AttributesArr = [];\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            modalOpen: false\r\n          });\r\n        }\r\n        else if (res.message !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.message \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={1} direction=\"column\">\r\n        {this.props.selectedThing !== null && this.props.selectedThing !== undefined &&\r\n          this.props.selectedThing.AttributesArr.map((attribute, i) => {\r\n            return (\r\n              <AttributeControl\r\n                key={i}\r\n                thingID={this.props.selectedThing._id}\r\n                attribute={attribute}\r\n                onChange={this.changeAttribute}\r\n                onDelete={this.deleteAttribute}\r\n                onBlur={this.blurAttribute}\r\n                things={this.props.things}\r\n                types={this.props.types}\r\n                onNewThing={this.addNewThing}\r\n                infoModal={this.infoModal}\r\n              />\r\n            );\r\n          })\r\n        }\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.modalOpen}\r\n          onClose={e => {this.setState({modalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({modalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  Modal,\r\n  Button\r\n} from \"@material-ui/core\";\r\n  \r\nconst getModalStyle = () => {\r\n  const top = Math.round(window.innerHeight / 2) - 100;\r\n  const left = Math.round(window.innerWidth / 2) - 200;\r\n\r\n  return {\r\n    top: `${top}%`,\r\n    left: `${left}%`,\r\n    transform: `translate(${left}px, ${top}px)`,\r\n  };\r\n}\r\n\r\nconst validate = (value, props, changeMessage) => {\r\n  const valid = props.types.filter(t => t.Name === value).length === 0;\r\n  changeMessage(valid ? \"\" : \"This Type Name is already in use\");\r\n}\r\n\r\nconst saveNewType = (value, props, changeMessage, changeWaiting) => {\r\n  // if (props.onSave !== undefined && props.onSave !== null)\r\n  //   props.onSave();\r\n    \r\n  const type = {\r\n    _id: null,\r\n    Name: value.trim(),\r\n    Description: \"\",\r\n    SuperIDs: [],\r\n    AttributesArr: [],\r\n    Attributes: [],\r\n    worldID: props.selectedWorldID,\r\n    Major: false\r\n  };\r\n\r\n  // Calls API\r\n  props.api\r\n    .createType(type)\r\n    .then(res => {\r\n      if (res.typeID !== undefined) {\r\n        type._id = res.typeID;\r\n        type.Supers = [];\r\n        // Adds to redux\r\n        if (props.addType) \r\n          props.addType(type);\r\n        // Calls respond back to Attribute to set the type\r\n        \r\n            changeWaiting(false);\r\n        if (props.onSave) {\r\n          // setTimeout(() => {\r\n            props.onSave(type);\r\n          // }, 500);\r\n        }\r\n        // this.state.modalSubmit(type);\r\n        // this.setState({\r\n        //   waiting: false, \r\n        //   typeModalOpen: false\r\n        // });\r\n      }\r\n      else if (res.error !== undefined) {\r\n        // this.setState({\r\n        //   waiting: false, \r\n        //   message: res.error \r\n        // });\r\n        changeWaiting(false);\r\n        changeMessage(res.error);\r\n      }\r\n    })\r\n    .catch(err => console.log(err));\r\n}\r\n\r\nexport default function NewTypeModal(props) {\r\n  const [name, changeName] = useState(\"\");\r\n  const [message, changeMessage] = useState(\"\");\r\n  const [waiting, changeWaiting] = useState(false);\r\n  \r\n  return (\r\n    <Modal\r\n      aria-labelledby=\"new-type-modal\"\r\n      aria-describedby=\"new-type-modal-description\"\r\n      open={props.open}\r\n      onClose={(e) => {\r\n        if (props.onCancel !== undefined && props.onCancel !== null)\r\n          props.onCancel();\r\n      }}\r\n    >\r\n      <div style={getModalStyle()} className=\"paper\">\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>Just give the new Type a name.</Grid>\r\n          <Grid item>(You can do the rest later.)</Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={message !== \"\"}\r\n                value={name}\r\n                onChange={e => {\r\n                  changeName(e.target.value);\r\n                }}\r\n                onBlur={e => {\r\n                  validate(name, props, changeMessage);\r\n                }}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={6}>\r\n              <Button\r\n                fullWidth\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                disabled={waiting}\r\n                onClick={e => {\r\n                  changeWaiting(true);\r\n                  saveNewType(name, props, changeMessage, changeWaiting);\r\n                }}\r\n              >\r\n                {waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Button\r\n                fullWidth\r\n                variant=\"contained\"\r\n                onClick={(e) => {\r\n                  if (props.onCancel !== undefined && props.onCancel !== null)\r\n                    props.onCancel();\r\n                }}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  updateType,\r\n  addType,\r\n  setAttributes,\r\n  setTypes,\r\n  setThings,\r\n  notFromLogin\r\n} from \"../../redux/actions/index\";\r\nimport { \r\n  Button, FormControl, \r\n  OutlinedInput, InputLabel, \r\n  FormHelperText, Grid, \r\n  Fab, Tooltip,\r\n  List, ListItem,\r\n  Select, MenuItem,\r\n  // Modal\r\n} from \"@material-ui/core\";\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { ArrowBack, Add, Search } from \"@material-ui/icons\";\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../smartAPI\";\r\nimport NewTypeModal from \"../../components/Modals/NewTypeModal\";\r\nimport TextBox from \"../../components/Inputs/TextBox\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Thing.  It will allow the use of Types to make\r\n  it faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: state.app.selectedThing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n    fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      // Name: \"\",\r\n      // Description: \"\",\r\n      // Types: [],\r\n      // AttributesArr: [],\r\n      // Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        // AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" },\r\n        infoAttributeName: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: false,\r\n      resetting: false,\r\n      loaded: true,\r\n      errors: [],\r\n      infoAttribute: null,\r\n      typeModalOpen: false,\r\n      newTypeForAttribute: \"\",\r\n      browseAttributes: false,\r\n      browseAttributesFilter: \"\",\r\n      browseAttributesSelected: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  createThingFromType = type => {\r\n    let types = [];\r\n    types.push(type);\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n          types.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      Attributes: []\r\n    };\r\n    let newAttributes = [];\r\n    types.forEach(type=> {\r\n      for (let i = 0; i < type.Attributes.length; i++) {\r\n        const attribute = {...type.Attributes[i]};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      }\r\n    });\r\n    types.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      thing.AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    thing.Types = types;\r\n    this.props.updateSelectedThing(thing);\r\n    this.setState({ \r\n      _id: null, \r\n      // Types: types, \r\n      loaded: true \r\n    }); //, errors });\r\n  };\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined && !id.includes(\"type_id_\")) {\r\n        this.setState({\r\n          resetting: false, \r\n          redirectTo: `/thing/create`\r\n        });\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        }, this.finishResettingForm);\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  finishResettingForm = () => {\r\n    const { id } = this.props.match.params;\r\n    if (id !== undefined && id.includes(\"type_id_\")) {\r\n      // We're creating it from a type rather than from blank\r\n      const typeID = id.substring(8);\r\n      let type = this.props.types.filter(t=> t._id === typeID);\r\n      if (type.length > 0) {\r\n        type = type[0];\r\n        this.createThingFromType(type);\r\n      }\r\n      else {\r\n        this.setState({ message: \"Invalid Type\" });\r\n      }\r\n    }\r\n  }\r\n\r\n  // handleUserInput = e => {\r\n  //   const name = e.target.name;\r\n  //   const value =\r\n  //     e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n  //   this.setState({ [name]: value });\r\n  // };\r\n\r\n  handleInfoAttrNameChange = e => {\r\n    const infoAttribute = this.state.infoAttribute;\r\n    infoAttribute.Name = e.target.value;\r\n    this.setState({ infoAttribute });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      (fieldValidation[name].valid !== validation.valid ||\r\n        fieldValidation[name].message !== validation.message)\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  inputBlur2 = e => {\r\n    const name = \"infoAttributeName\";\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      (fieldValidation[name].valid !== validation.valid ||\r\n        fieldValidation[name].message !== validation.message)\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  addSelectedAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    const attr = this.props.attributesByID[this.state.browseAttributesSelected];\r\n    const attributes = thing.Attributes;\r\n    const AttributesArr = thing.AttributesArr;\r\n    attributes.push({\r\n      attrID: this.state.browseAttributesSelected,\r\n      Value: \"\",\r\n      ListValues: [],\r\n      index: attributes.length,\r\n      FromTypeIDs: []\r\n    });\r\n    AttributesArr.push({\r\n      attrID: this.state.browseAttributesSelected,\r\n      index: AttributesArr.length,\r\n      Value: \"\",\r\n      ListValues: [],\r\n      Name: attr.Name,\r\n      AttributeType: attr.AttributeType,\r\n      Options: attr.Options,\r\n      DefinedType: attr.DefinedType,\r\n      ListType: attr.ListType,\r\n      FromTypeIDs: [],\r\n      TypeIDs: attr.TypeIDs\r\n    });\r\n    thing.Attributes = [];\r\n    thing.AttributesArr = [];\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n      this.setState({ browseAttributesSelected: \"\" });\r\n    }, 500);\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.props.selectedThing[fieldName].trim();\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      case \"infoAttributeName\":\r\n        value = this.state.infoAttribute.Name.trim();\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Attribute Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Attribute Name is too short\";\r\n        } else {\r\n          const attrByName = this.props.attributesByName[value];\r\n          valid = attrByName === undefined || attrByName._id === this.state.infoAttribute.attrID;\r\n          if (!valid) message = \"There is another Attribute with this name.\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedThing[fieldName];\r\n        value.forEach(a => {\r\n          if (valid && value.filter(attr2 => attr2.Name === a.Name).length > 1) {\r\n            valid = false;\r\n          }\r\n        });\r\n        message = valid ? \"\" : \"Attribute Names must be unique\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrValid = this.validateField(\"AttributesArr\");\r\n    const formValid = nameValid.valid && attrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  validateAttrForm = respond => {\r\n    const nameValid = this.validateField(\"infoAttributeName\");\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.infoAttributeName = nameValid;\r\n    this.setState(\r\n      {\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ \r\n          waiting: true, \r\n          addMore: addMore \r\n        }, \r\n        this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const typeIDs = this.props.selectedThing.Types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.props.selectedThing.Name.trim(),\r\n      Description: this.props.selectedThing.Description.trim(),\r\n      TypeIDs: typeIDs,\r\n      // AttributesArr: this.props.selectedThing.AttributesArr,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorld._id,\r\n      ReferenceIDs: []\r\n    };\r\n    this.props.selectedThing.AttributesArr.forEach(a => {\r\n      thing.Attributes.push({\r\n        attrID: a.attrID,\r\n        index: a.index,\r\n        Value: a.Value.trim(),\r\n        ListValues: a.ListValues\r\n      });\r\n      if (a.AttributeType === \"Type\") {\r\n        if (!thing.ReferenceIDs.includes(a.Value)) {\r\n          thing.ReferenceIDs.push(a.Value);\r\n        }\r\n      }\r\n      if (a.AttributeType === \"List\" && a.ListType === \"Type\") {\r\n        a.ListValues.forEach(v=> {\r\n          if (!thing.ReferenceIDs.includes(v)) {\r\n            thing.ReferenceIDs.push(v);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    if (thing._id === null) {\r\n      this.api\r\n        .createThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined){\r\n            // thing._id = res.thingID;\r\n            // thing.Types = this.state.Types;\r\n            // thing.AttributesArr = this.props.selectedThing.AttributesArr;\r\n            // this.props.addThing(thing);\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n\r\n              if (this.state.addMore) {\r\n                this.props.updateSelectedThing({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  Description: \"\",\r\n                  Types: [],\r\n                  Attributes: [],\r\n                  AttributesArr: []\r\n                });\r\n                this.setState({\r\n                  _id: null,\r\n                  // Name: \"\",\r\n                  // Description: \"\",\r\n                  // Types: [],\r\n                  // Attributes: [],\r\n                  fieldValidation: {\r\n                    Name: { valid: true, message: \"\" },\r\n                    Attributes: { valid: true, message: \"\" }\r\n                  },\r\n                  formValid: false,\r\n                  message: \"\",\r\n                  waiting: false,\r\n                  resetting: true\r\n                }, this.resetForm);\r\n              }\r\n              else {\r\n                this.setState({\r\n                  waiting: false,\r\n                  redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                });\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error});\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined) {\r\n            this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n              this.props.setAttributes(res2.attributes);\r\n              this.props.setTypes(res2.types);\r\n              this.props.setThings(res2.things);\r\n              \r\n              if (this.state.addMore) {\r\n                this.props.updateSelectedThing({\r\n                  _id: null,\r\n                  Name: \"\",\r\n                  Description: \"\",\r\n                  Types: [],\r\n                  Attributes: [],\r\n                  AttributesArr: []\r\n                });\r\n                this.setState({\r\n                  // Name: \"\",\r\n                  // Description: \"\",\r\n                  // Types: [],\r\n                  // Attributes: [],\r\n                  fieldValidation: {\r\n                    Name: { valid: true, message: \"\" },\r\n                    Attributes: { valid: true, message: \"\" }\r\n                  },\r\n                  formValid: false,\r\n                  message: \"\",\r\n                  waiting: false,\r\n                  addMore: false,\r\n                  resetting: true\r\n                }, this.resetForm);\r\n              }\r\n              else {\r\n                this.setState({\r\n                  waiting: false,\r\n                  redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                });\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error});\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  typesChange = (e, value) => {\r\n    let types = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      types.push(t);\r\n      types = types.concat(t.Types);\r\n    }\r\n    const thing = this.props.selectedThing;\r\n    thing.Types = types;\r\n    this.props.updateSelectedThing(thing);\r\n    // this.setState({ Types: types });\r\n  };\r\n\r\n  addType = (selectedList, selectedItem) => {\r\n    const thing = this.props.selectedThing;\r\n    const newTypes = {};\r\n    newTypes[selectedItem._id] = selectedItem;\r\n    selectedItem.Supers.forEach(s=>{\r\n      if (selectedList.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && selectedList.filter(t=>t._id === superType[0]._id).length === 0){\r\n          selectedList.push(superType[0]);\r\n          newTypes[superType[0]._id] = superType[0];\r\n        }\r\n      }\r\n      if (this.props.selectedThing.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes[s._id] = s;\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    Object.keys(newTypes).forEach(typeID => {\r\n      const type = newTypes[typeID];\r\n      type.Attributes.forEach(a => {\r\n        const attribute = {...a};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      });\r\n    });\r\n    Object.keys(newTypes).forEach(typeID => {\r\n      const type = newTypes[typeID];\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          if (attribute.Value === undefined) {\r\n            attribute.Value = \"\";\r\n            attribute.ListValues = [];\r\n          }\r\n          if (attribute.Value === \"\") {\r\n            attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          }\r\n          type.DefaultsHash[attribute.attrID].DefaultListValues.forEach(listValue => {\r\n            if (!attribute.ListValues.includes(listValue))\r\n              attribute.ListValues.push(listValue);\r\n          });\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    // this.setState({ Types: selectedList });\r\n    thing.Types = selectedList;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    const AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n    }, 500);\r\n  }\r\n\r\n  addType2 = (type) => {\r\n    const types = this.props.selectedThing.Types;\r\n    types.push(type);\r\n    // this.addType(types, type);\r\n\r\n    const newTypes = [type];\r\n    const thing = this.props.selectedThing;\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && types.filter(t=>t._id === superType[0]._id).length === 0){\r\n          types.push(superType[0]);\r\n          newTypes.push(superType[0]);\r\n        }\r\n      }\r\n      if (this.props.selectedThing.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes.push(s);\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    newTypes.forEach(type => {\r\n      type.Attributes.forEach(a => {\r\n        const attribute = {...a};\r\n        let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n        if (existing.length === 0) {\r\n          attribute.FromTypeIDs = [type._id];\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n        else {\r\n          existing = existing[0];\r\n          if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n            existing.FromTypeIDs = [];\r\n          existing.FromTypeIDs.push(type._id);\r\n        }\r\n      });\r\n    });\r\n    newTypes.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    this.setState({ \r\n      // Types: types, \r\n      resetting: true \r\n    });\r\n    thing.Types = types;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    const AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      thing.AttributesArr = AttributesArr;\r\n      this.props.updateSelectedThing(thing);\r\n      this.setState({ resetting: false, infoAttribute: null });\r\n    }, 500);\r\n  }\r\n\r\n  selectNewTypeForAttribute = (e) => {\r\n    if (e.target.value === \"new\") {\r\n      function respond(newType) {\r\n        // attr[\"DefinedType\"] = newType._id;\r\n        this.setState({ newTypeForAttribute: newType._id });\r\n      }\r\n      this.setState({ typeModalOpen: true, modalSubmit: respond});\r\n    }\r\n    else \r\n      this.setState({ newTypeForAttribute: e.target.value });\r\n  }\r\n\r\n  saveInfoAttribute = () => {\r\n    function respond() {\r\n      if (this.state.fieldValidation.infoAttributeName.valid) {\r\n        this.setState({ \r\n          waiting: true\r\n        }, \r\n        this.submitAttributeThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateAttrForm(respond);\r\n  }\r\n\r\n  submitAttributeThroughAPI = () => {\r\n    // Need to upsert the attribute, and then move forward\r\n\r\n    const attributes = [{\r\n      _id: this.state.infoAttribute.attrID,\r\n      Name: this.state.infoAttribute.Name.trim(),\r\n      AttributeType: this.state.infoAttribute.AttributeType,\r\n      Options: this.state.infoAttribute.Options,\r\n      DefinedType: this.state.infoAttribute.DefinedType,\r\n      ListType: this.state.infoAttribute.ListType\r\n    }];\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      if (res.error === undefined) {\r\n        // res.attributes is a hash with the name as key and id as value\r\n        this.api.getWorld(this.props.selectedWorldID, true).then(res2 => {\r\n          this.props.setAttributes(res2.attributes);\r\n          this.props.setTypes(res2.types);\r\n          this.props.setThings(res2.things);\r\n          \r\n          const attribute = this.state.infoAttribute;\r\n          if (this.state.newTypeForAttribute !== \"\") {\r\n            attribute.TypeIDs.push(this.state.newTypeForAttribute);\r\n            attribute.FromTypeIDs.push(this.state.newTypeForAttribute);\r\n          }\r\n          const thing = this.props.selectedThing;\r\n          if (attribute.attrID === null) {\r\n            attribute.attrID = res.attributes[attribute.Name];\r\n            // Add it to the Thing's attributes\r\n            const attr2 = {\r\n              attrID: attribute.attrID,\r\n              index: thing.Attributes.length,\r\n              Value: \"\",\r\n              ListValues: []\r\n            };\r\n            thing.Attributes.push(attr2);\r\n            thing.AttributesArr.push({\r\n              attrID: attribute.attrID,\r\n              index: attr2.index,\r\n              Value: \"\",\r\n              ListValues: [],\r\n              Name: attribute.Name,\r\n              AttributeType: attribute.AttributeType,\r\n              Options: attribute.Options,\r\n              DefinedType: attribute.DefinedType,\r\n              ListType: attribute.ListType,\r\n              FromTypeIDs: attribute.FromTypeIDs,\r\n              TypeIDs: attribute.TypeIDs\r\n            });\r\n          }\r\n          else {\r\n            // Update the attribute on the Thing\r\n            const attr2 = thing.AttributesArr.filter(a => a.attrID === attribute.attrID)[0];\r\n            attr2.Name = attribute.Name;\r\n            attr2.AttributeType = attribute.AttributeType;\r\n            attr2.Options = attribute.Options;\r\n            attr2.DefinedType = attribute.DefinedType;\r\n            attr2.ListType = attribute.ListType;\r\n            attr2.FromTypeIDs = attribute.FromTypeIDs;\r\n            attr2.TypeIDs = attribute.TypeIDs;\r\n          }\r\n          if (attribute.FromTypeIDs.length === 0) {\r\n            this.props.updateSelectedThing(thing);\r\n            this.setState({infoAttribute: null, waiting: false});\r\n          }\r\n          else {\r\n            // Need to add it to the type\r\n            const theType = this.props.types.filter(t => t._id === attribute.FromTypeIDs[0])[0];\r\n            const type = {\r\n              _id: theType._id,\r\n              Name: theType.Name,\r\n              Description: theType.Description,\r\n              SuperIDs: theType.SuperIDs,\r\n              // AttributesArr: this.props.selectedType.AttributesArr,\r\n              Attributes: theType.Attributes,\r\n              Defaults: theType.Defaults,\r\n              worldID: this.props.selectedWorld._id,\r\n              Major: theType.Major,\r\n              ReferenceIDs: theType.ReferenceIDs,\r\n              DefaultReferenceIDs: theType.DefaultReferenceIDs\r\n            };\r\n            type.Attributes.push({\r\n              attrID: attribute.attrID,\r\n              index: type.Attributes.length,\r\n              // Name: a.Name,\r\n              // AttributeType: a.AttributeType,\r\n              // Options: a.Options,\r\n              // DefinedType: a.DefinedType,\r\n              // ListType: a.ListType\r\n            });\r\n            this.api\r\n              .updateType(type)\r\n              .then(res => {\r\n                if (res.error === undefined) {\r\n                  type.Supers = [];\r\n                  type.SuperIDs.forEach(sID=> {\r\n                    type.Supers = type.Supers.concat(this.props.types.filter(t2=>t2._id === sID));\r\n                  });\r\n                  type.AttributesArr = [];\r\n                  type.Attributes.forEach(a => {\r\n                    const attr = this.props.attributesByID[a.attrID];\r\n                    type.AttributesArr.push({\r\n                      index: type.AttributesArr.length,\r\n                      Name: attr.Name,\r\n                      AttributeType: attr.AttributeType,\r\n                      Options: attr.Options,\r\n                      DefinedType: attr.DefinedType,\r\n                      ListType: attr.ListType,\r\n                      attrID: a.attrID\r\n                    });\r\n                  });\r\n                  const defHash = {};\r\n                  if (type.Defaults !== undefined) {\r\n                    type.Defaults.forEach(def => {\r\n                      defHash[def.attrID] = def;\r\n                    });\r\n                  }\r\n                  type.DefaultsHash = defHash;\r\n                  this.props.updateType(type);\r\n\r\n                  function respond() {\r\n                    this.addType2(type);\r\n                  }\r\n                  \r\n                  this.setState({\r\n                    infoAttribute: null, waiting: false\r\n                  }, respond);\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false, \r\n                    message: res.error \r\n                  });\r\n                }\r\n              })\r\n              .catch(err => console.log(err));\r\n          }\r\n        });\r\n      }\r\n      else {\r\n        this.setState({ message: res.error, waiting: false });\r\n      }\r\n    });\r\n  }\r\n  \r\n  removeType = (selectedList, removedItem) => {\r\n    // TODO: Add a confirmation before doing this\r\n    // to let them know it will also remove sub-types.\r\n    let types = [];\r\n    let removeUs = [];\r\n    this.props.selectedThing.Types.forEach(checkMe => {\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else types.push(checkMe);\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.Attributes];\r\n    attributes.forEach(attribute => {\r\n      const newFromTypeIDs = [];\r\n      attribute.FromTypeIDs.forEach(typeID => {\r\n        if (!removeUs.includes(typeID))\r\n          newFromTypeIDs.push(typeID);\r\n      });\r\n      attribute.FromTypeIDs = newFromTypeIDs;\r\n    });\r\n    // this.setState({ Types: types });\r\n    thing.Types = types;\r\n    thing.Attributes = attributes;\r\n    thing.AttributesArr = [];\r\n    thing.Attributes.forEach(a => {\r\n      const attr = this.props.attributesByID[a.attrID];\r\n      thing.AttributesArr.push({\r\n        index: thing.AttributesArr.length,\r\n        Name: attr.Name,\r\n        AttributeType: attr.AttributeType,\r\n        Options: attr.Options,\r\n        DefinedType: attr.DefinedType,\r\n        ListType: attr.ListType,\r\n        attrID: a.attrID,\r\n        Value: a.Value,\r\n        ListValues: a.ListValues,\r\n        FromTypeIDs: a.FromTypeIDs,\r\n        TypeIDs: attr.TypeIDs\r\n      });\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n\r\n  renderHeader() {\r\n    let typeStr = \"Thing\";\r\n    this.props.selectedThing.Types.forEach(t=>{\r\n      if (t.Major) { \r\n        if (typeStr === \"Thing\") {\r\n          typeStr = t.Name;\r\n        }\r\n        else {\r\n          typeStr += \"/\" + t.Name;\r\n        }\r\n      }\r\n    });\r\n    return <h2>{this.state._id === null ? `Create New ${typeStr}` : `Edit ${typeStr}`}</h2>;\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    this.api.getWorld(this.props.selectedWorldID).then(res => {\r\n      this.props.setAttributes(res.attributes);\r\n      this.props.setTypes(res.types);\r\n      this.props.setThings(res.things);\r\n      \r\n      if (this.props.fromLogin) {\r\n        this.props.notFromLogin();\r\n        this.setState({\r\n          // _id: id,\r\n          loaded: true,\r\n          message: \"\"\r\n        });\r\n      }\r\n      else {\r\n        if (this.state._id !== null) {\r\n          // We're editing an existing Thing\r\n          let thing = res.things.filter(t => t._id === this.state._id);\r\n          if (thing.length === 0) {\r\n            this.setState({ message: \"Invalid ID\" });\r\n          }\r\n          else {\r\n            thing = thing[0];\r\n            // const things = this.props.things.filter(\r\n            //   t => t._id !== thing._id\r\n            // );\r\n            let Types = [];\r\n            thing.TypeIDs.forEach(tID=> {\r\n              Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n            });\r\n            let newAttributes = [];\r\n            Types.forEach(type=> {\r\n              for (let i = 0; i < type.Attributes.length; i++) {\r\n                const attribute = {...type.Attributes[i]};\r\n                let existing = thing.Attributes.filter(a=>a.attrID === attribute.attrID);\r\n                if (existing.length === 0) {\r\n                  attribute.FromTypeIDs = [type._id];\r\n                  attribute.index = thing.Attributes.length + newAttributes.length;\r\n                  newAttributes.push(attribute);\r\n                }\r\n                else {\r\n                  existing = existing[0];\r\n                  if (existing.FromTypeIDs === undefined || existing.FromTypeIDs === null)\r\n                    existing.FromTypeIDs = [];\r\n                  existing.FromTypeIDs.push(type._id);\r\n                }\r\n              }\r\n            });\r\n            Types.forEach(type=> {\r\n              newAttributes.forEach(attribute => {\r\n                if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n                  attribute.Value = \"\";\r\n                  attribute.ListValues = [];\r\n                }\r\n                else {\r\n                  attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n                  attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n                }\r\n              })\r\n            });\r\n            let attributes = [...thing.Attributes, ...newAttributes];\r\n            thing.Attributes = attributes;\r\n            thing.AttributesArr = [];\r\n            thing.Attributes.forEach(a => {\r\n              const attr = this.props.attributesByID[a.attrID];\r\n              thing.AttributesArr.push({\r\n                index: thing.AttributesArr.length,\r\n                Name: attr.Name,\r\n                AttributeType: attr.AttributeType,\r\n                Options: attr.Options,\r\n                DefinedType: attr.DefinedType,\r\n                ListType: attr.ListType,\r\n                attrID: a.attrID,\r\n                Value: a.Value,\r\n                ListValues: a.ListValues,\r\n                FromTypeIDs: a.FromTypeIDs,\r\n                TypeIDs: attr.TypeIDs\r\n              });\r\n            });\r\n            thing.Types = Types;\r\n            this.props.updateSelectedThing(thing);\r\n            this.setState({\r\n              // Name: thing.Name,\r\n              // Description: thing.Description,\r\n              // Things: things,\r\n              // Types: Types,\r\n              loaded: true\r\n            });\r\n          }\r\n        } else {\r\n          let { id } = this.props.match.params;\r\n          if (id !== undefined && id.includes(\"type_id_\")) {\r\n            // We're creating it from a type rather than from blank\r\n            const typeID = id.substring(8);\r\n            let type = this.props.types.filter(t=> t._id === typeID);\r\n            if (type.length > 0) {\r\n              type = type[0];\r\n              this.createThingFromType(type);\r\n            }\r\n            else {\r\n              this.setState({ message: \"Invalid Type\", loaded: true });\r\n            }\r\n          }\r\n          else {\r\n            // We're creating a new thing from blank.\r\n            this.props.updateSelectedThing({\r\n              _id: null,\r\n              Name: \"\",\r\n              Description: \"\",\r\n              Types: [],\r\n              Attributes: [],\r\n              AttributesArr: []\r\n            });\r\n            this.setState({ loaded: true });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined || id.includes(\"type_id_\"))\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedThing === null || this.props.selectedThing._id !== id) {\r\n      return <span>Loading...</span>;\r\n    } else if (this.state.infoAttribute !== null) {\r\n      const connectedTypes = this.props.types.filter(t=> this.state.infoAttribute.FromTypeIDs.includes(t._id));\r\n      const otherTypes = this.props.types.filter(t=> !this.state.infoAttribute.FromTypeIDs.includes(t._id) && this.state.infoAttribute.TypeIDs.includes(t._id));\r\n      if (connectedTypes.length === 0) {\r\n        if (otherTypes.length === 0) {\r\n          const attributeTypes = [\r\n            \"Text\",\r\n            \"Number\",\r\n            \"True/False\",\r\n            \"Options\", \r\n            \"Type\", \r\n            \"List\"\r\n          ];\r\n          const listTypes = [\r\n            \"Text\",\r\n            \"Options\", \r\n            \"Type\"\r\n          ];\r\n          // This attribute isn't on any types, so we need to give the ability to add it to a type, as well as to edit it.\r\n          return (\r\n            <Grid item xs={12} container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <List>\r\n                  <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"infoAttributeName\">Name</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"infoAttributeName\"\r\n                        name=\"infoAttributeName\"\r\n                        type=\"text\"\r\n                        autoComplete=\"Off\"\r\n                        error={!this.state.fieldValidation.infoAttributeName.valid}\r\n                        value={this.state.infoAttribute.Name}\r\n                        onChange={this.handleInfoAttrNameChange}\r\n                        onBlur={this.inputBlur2}\r\n                        labelWidth={43}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>\r\n                        {this.state.fieldValidation.infoAttributeName.message}\r\n                      </FormHelperText>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n                        Attribute Type\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"attribute-type-label\"\r\n                        id=\"attribute-type\"\r\n                        disabled={this.state.waiting}\r\n                        // disabled={props.attribute.FromSupers.length > 0} \r\n                        value={this.state.infoAttribute.AttributeType}\r\n                        onChange={e => {\r\n                          const attr = this.state.infoAttribute;\r\n                          attr[\"AttributeType\"] = e.target.value;\r\n                          this.setState({ infoAttribute: attr });\r\n                        }}\r\n                        fullWidth\r\n                        labelWidth={100}\r\n                      >\r\n                        {attributeTypes.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                  { this.state.infoAttribute.AttributeType === \"List\" && \r\n                    <ListItem>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                          List Type\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"list-type-label\"\r\n                          id=\"list-type\"\r\n                          disabled={this.state.waiting}\r\n                          // disabled={props.attribute.FromSupers.length > 0} \r\n                          value={this.state.infoAttribute.ListType}\r\n                          onChange={e => {\r\n                            const attr = this.state.infoAttribute;\r\n                            attr[\"ListType\"] = e.target.value;\r\n                            this.setState({ infoAttribute: attr });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={70}\r\n                        >\r\n                          {listTypes.map((type, i) => {\r\n                            return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                    <ListItem>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                          Defined Type\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"definedType-label\"\r\n                          id=\"definedType\"\r\n                          disabled={this.state.waiting}\r\n                          // disabled={props.attribute.FromSupers.length > 0} \r\n                          value={this.state.infoAttribute.DefinedType}\r\n                          onChange={e => {\r\n                            const attr = this.state.infoAttribute;\r\n                            attr[\"DefinedType\"] = e.target.value;\r\n                            if (e.target.value === \"new\") {\r\n                              function respond(newType) {\r\n                                attr[\"DefinedType\"] = newType._id;\r\n                                this.setState({ typeModalOpen: false, infoAttribute: attr });\r\n                              }\r\n                              this.setState({ typeModalOpen: true, modalSubmit: respond});\r\n                            }\r\n                            else \r\n                              this.setState({ infoAttribute: attr });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={100}\r\n                        >\r\n                          <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                          {this.props.types.map((type, i) => {\r\n                            return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                    <ListItem>\r\n                      <ChipInput\r\n                        variant=\"outlined\"\r\n                        disabled={this.state.waiting}\r\n                        // disabled={props.attribute.FromSupers.length > 0}\r\n                        defaultValue={this.state.infoAttribute.Options}\r\n                        onChange={chips => {\r\n                          const attr = this.state.infoAttribute;\r\n                          attr[\"Options\"] = chips;\r\n                          this.setState({ infoAttribute: attr });\r\n                        }}\r\n                      />\r\n                    </ListItem>\r\n                  }\r\n                  <ListItem>\r\n                    Select a Type to add this attribute to, and to add to {this.props.selectedThing.Name}\r\n                  </ListItem>\r\n                  <ListItem>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"newTypeForAttribute\" id=\"newTypeForAttribute-label\">\r\n                        Type For Attribute\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"newTypeForAttribute-label\"\r\n                        id=\"newTypeForAttribute\"\r\n                        value={this.state.newTypeForAttribute}\r\n                        onChange={e => {this.selectNewTypeForAttribute(e)}}\r\n                        fullWidth\r\n                        labelWidth={125}\r\n                      >\r\n                        <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                        {this.props.types.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </ListItem>\r\n                </List>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveInfoAttribute}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={_ => {this.setState({infoAttribute: null})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n              <NewTypeModal \r\n                open={this.state.typeModalOpen} \r\n                types={this.props.types}\r\n                selectedWorldID={this.props.selectedWorldID}\r\n                onCancel={_ => {\r\n                  this.setState({typeModalOpen: false});\r\n                }}\r\n                addType={type => {\r\n                  this.props.addType(type);\r\n                }}\r\n                onSave={type => {\r\n                  this.setState({typeModalOpen: false, newTypeForAttribute: type._id});\r\n                }}\r\n                api={this.api}\r\n              />\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid item xs={12} container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <List>\r\n                  <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                  <ListItem>Name: {this.state.infoAttribute.Name}</ListItem>\r\n                  <ListItem>Type: {this.state.infoAttribute.AttributeType}</ListItem>\r\n                  { this.state.infoAttribute.AttributeType === \"List\" && \r\n                    <ListItem>List Type: {this.state.infoAttribute.ListType}</ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                    <ListItem>\r\n                      Defined Type: \r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={ _ => {this.setState({redirectTo:`/type/details/${this.state.infoAttribute.DefinedType}`})}}\r\n                      >\r\n                        {this.props.types.filter(t=>t._id === this.state.infoAttribute.DefinedType)[0].Name}\r\n                      </Button>\r\n                    </ListItem> \r\n                  }\r\n                  { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                    <ListItem>\r\n                      Options: \r\n                      {this.state.infoAttribute.Options.map((option, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            {j === 0 ? \" \" : \", \"}\r\n                            {option}\r\n                          </span>\r\n                        );\r\n                      })}\r\n                    </ListItem>\r\n                  }\r\n                  <ListItem>\r\n                    { otherTypes.length === 1 ? \"Type associated with this attribute:\" : \"Types associated with this attribute:\" }\r\n                    <List>\r\n                      { otherTypes.map((type, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                            >\r\n                              {type.Name}\r\n                            </Button>\r\n\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.addType2(type)}}\r\n                            >\r\n                              Add {type.Name} to {this.props.selectedThing.Name}\r\n                            </Button>\r\n                          </span>\r\n                        );\r\n                      })}\r\n                    </List>\r\n                  </ListItem>\r\n                </List>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  {/* <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button> */}\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({infoAttribute: null})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid item xs={12} container spacing={1} direction=\"column\">\r\n            <Grid item>\r\n              <List>\r\n                <ListItem style={{fontSize:\"30px\"}}>Attribute Info</ListItem>\r\n                <ListItem>Name: {this.state.infoAttribute.Name}</ListItem>\r\n                <ListItem>Type: {this.state.infoAttribute.AttributeType}</ListItem>\r\n                { this.state.infoAttribute.AttributeType === \"List\" && \r\n                  <ListItem>List Type: {this.state.infoAttribute.ListType}</ListItem> \r\n                }\r\n                { (this.state.infoAttribute.AttributeType === \"Type\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Type\")) && \r\n                  <ListItem>\r\n                    Defined Type: \r\n                    <Button\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/type/details/${this.state.infoAttribute.DefinedType}`})}}\r\n                    >\r\n                      {this.props.types.filter(t=>t._id === this.state.infoAttribute.DefinedType)[0].Name}\r\n                    </Button>\r\n                  </ListItem> \r\n                }\r\n                { (this.state.infoAttribute.AttributeType === \"Options\" || (this.state.infoAttribute.AttributeType === \"List\" && this.state.infoAttribute.ListType === \"Options\")) && \r\n                  <ListItem>\r\n                    Options: \r\n                    {this.state.infoAttribute.Options.map((option, j) => {\r\n                      return (\r\n                        <span key={j}>\r\n                          {j === 0 ? \" \" : \", \"}\r\n                          {option}\r\n                        </span>\r\n                      );\r\n                    })}\r\n                  </ListItem>\r\n                }\r\n                { connectedTypes.length > 0 &&\r\n                  <ListItem>\r\n                    { connectedTypes.length === 1 ? \"From Type:\" : \"From Types:\" }\r\n                    {\r\n                      connectedTypes.map((type, j) => {\r\n                        return (\r\n                          <span key={j}>\r\n                            {j === 0 ? \" \" : \", \"}\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              color=\"primary\"\r\n                              onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                            >\r\n                              {type.Name}\r\n                            </Button>\r\n                          </span>\r\n                        );\r\n                      })\r\n                    }\r\n                  </ListItem>\r\n                }\r\n                { otherTypes.length > 0 &&\r\n                  <ListItem>\r\n                    { otherTypes.length === 1 ? \"Other Associated Type:\" : \"Other Associated Types:\" }\r\n                    { otherTypes.map((type, j) => {\r\n                      return (\r\n                        <span key={j}>\r\n                          {j === 0 ? \" \" : \", \"}\r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                          >\r\n                            {type.Name}\r\n                          </Button>\r\n                        </span>\r\n                      );\r\n                    })}\r\n                  </ListItem>\r\n                }\r\n              </List>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button\r\n                variant=\"contained\"\r\n                onClick={e => {this.setState({infoAttribute: null})}}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    } else {\r\n      let additionalAttributes = [];\r\n      if (this.state.browseAttributes) {\r\n        Object.keys(this.props.attributesByID).forEach(id => {\r\n          if (this.props.selectedThing.Attributes.filter(a => a.attrID === id).length === 0){\r\n            additionalAttributes.push(this.props.attributesByID[id]);\r\n          }\r\n        });\r\n      }\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld !== null &&\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={11}>\r\n                  {this.renderHeader()}\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedThing.Name} \r\n                    fieldName=\"Name\" \r\n                    message={this.state.fieldValidation.Name.message}\r\n                    onBlur={name => {\r\n                      const thing = this.props.selectedThing;\r\n                      thing.Name = name;\r\n                      this.props.updateSelectedThing(thing);\r\n                      this.validateForm();\r\n                      // this.setState({ Name: name }, this.validateForm);\r\n                    }}\r\n                    labelWidth={43}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&  \r\n                  <TextBox \r\n                    Value={this.props.selectedThing.Description} \r\n                    fieldName=\"Description\" \r\n                    onBlur={desc => {\r\n                      const thing = this.props.selectedThing;\r\n                      thing.Description = desc;\r\n                      this.props.updateSelectedThing(thing);\r\n                      // this.setState({ Description: desc });\r\n                    }}\r\n                    labelWidth={82}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { !this.state.resetting &&\r\n                  <Multiselect\r\n                    placeholder=\"Types\"\r\n                    options={this.props.types}\r\n                    selectedValues={this.props.selectedThing.Types}\r\n                    onSelect={this.addType}\r\n                    onRemove={this.removeType}\r\n                    displayValue=\"Name\"\r\n                  />\r\n                }\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  <span>Attributes&nbsp;\r\n                    <Tooltip title={`Add New Attribute`}>\r\n                      <Fab size=\"small\"\r\n                        color=\"primary\"\r\n                        onClick={ _ => {\r\n                          this.setState({ infoAttribute: {\r\n                            index: this.props.selectedThing.AttributesArr.length,\r\n                            Name: \"\",\r\n                            AttributeType: \"Text\",\r\n                            Options: [],\r\n                            DefinedType: \"\",\r\n                            ListType: \"\",\r\n                            attrID: null,\r\n                            Value: \"\",\r\n                            ListValues: [],\r\n                            FromTypeIDs: [],\r\n                            TypeIDs: []\r\n                          }});\r\n                        }}\r\n                      >\r\n                        <Add />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                    <Tooltip title={`Browse Additional Attributes`}>\r\n                      <Fab\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        onClick={e => {\r\n                          this.setState({ browseAttributes: !this.state.browseAttributes });\r\n                        }}\r\n                      >\r\n                        <Search />\r\n                      </Fab>\r\n                    </Tooltip>\r\n                  </span>\r\n                </Grid>\r\n                { this.state.browseAttributes && \r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={12} sm={6}>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"browseForAttributes\" id=\"browseForAttributes-label\">\r\n                          Browse Additional Attributes\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"browseForAttributes-label\"\r\n                          id=\"browseForAttributes\"\r\n                          value={this.state.browseAttributesSelected}\r\n                          onChange={e => {\r\n                            this.setState({ browseAttributesSelected: e.target.value });\r\n                          }}\r\n                          fullWidth\r\n                          labelWidth={200}\r\n                        >\r\n                          {additionalAttributes.map((attr, i) => {\r\n                            return (<MenuItem key={i} value={attr._id}>{attr.Name}</MenuItem>);\r\n                          })}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={6}>\r\n                      <Button\r\n                        variant=\"contained\" color=\"primary\"\r\n                        disabled={ this.state.browseAttributesSelected === \"\" }\r\n                        onClick={e => {this.addSelectedAttribute();}}\r\n                        type=\"submit\"\r\n                      >\r\n                        Add Attribute\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                }\r\n                { !this.state.resetting && this.state.loaded &&\r\n                  <AttributesControl onInfo={e => {this.setState({ infoAttribute: e})}} />\r\n                }\r\n                <FormHelperText>\r\n                  {this.state.fieldValidation.Attributes.message}\r\n                </FormHelperText>\r\n              </Grid>\r\n              <Grid item>\r\n                <div className=\"float-right\">\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(true);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    className=\"w200\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(false);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={_ => {\r\n                      if (this.props.selectedThing._id === null) {\r\n                        this.setState({\r\n                          redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                        });\r\n                      }\r\n                      else {\r\n                        this.setState({\r\n                          redirectTo: `/thing/details/${this.props.selectedThing._id}`\r\n                        });\r\n                      }\r\n                    }}\r\n                    type=\"button\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n              <Grid item>\r\n                {this.state.errors.map((e, key) => {\r\n                  return (<div key={key}>{e}</div>);\r\n                })}\r\n              </Grid>\r\n              <Grid item>\r\n                {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                  if (\r\n                    this.state.fieldValidation[fieldName] !== undefined &&\r\n                    this.state.fieldValidation[fieldName].message.length > 0\r\n                  ) {\r\n                    return (\r\n                      <p className=\"redFont\" key={i}>\r\n                        {this.state.fieldValidation[fieldName].message}\r\n                      </p>\r\n                    );\r\n                  } else {\r\n                    return \"\";\r\n                  }\r\n                })}\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport API from '../../smartAPI';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      resetPasswordCode: null,\r\n      codeValid: false,\r\n      password: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        password: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const passwordValid = this.validateField(\"password\");\r\n    const confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n    const formValid = \r\n      passwordValid.valid && \r\n      confirmPasswordValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    this.api.resetPassword(this.state.resetPasswordCode, this.state.password).then(res => {\r\n      this.setState({ \r\n        message: res.message,\r\n        waiting: false\r\n      });\r\n    })\r\n    .catch(err => console.log(err));\r\n  }\r\n\r\n  render() {\r\n    if (this.state.resetPasswordCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkResetPasswordCode(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({resetPasswordCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({resetPasswordCode: id, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"outlined-adornment-password\"\r\n                      name=\"password\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.password}\r\n                      error={ !this.state.fieldValidation.password.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={70}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"confirm-password\"\r\n                      name=\"confirmPassword\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.confirmPassword}\r\n                      error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={130}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"float-right\">\r\n                <Button className=\"w200\" disabled={this.state.waiting}\r\n                  onClick={this.onSubmit}\r\n                  type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {this.state.message}\r\n          {\r\n            Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })\r\n          }\r\n        </div>\r\n      );\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ResetPasswordPage = connect()(Page);\r\nexport default ResetPasswordPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport API from '../../smartAPI';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      confirmEmailCode: null,\r\n      codeValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  render() {\r\n    if (this.state.confirmEmailCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.confirmEmail(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({confirmEmailCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({confirmEmailCode: id, codeValid: true, message: res.message});\r\n          }\r\n        });\r\n      }, 500);\r\n    }\r\n    return (\r\n      <div>\r\n        <h2>Confirming Email</h2>\r\n        {this.state.message}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst ConfirmEmailPage = connect()(Page);\r\nexport default ConfirmEmailPage;\r\n","import React, { Component } from \"react\";\r\nimport { \r\n  Route, \r\n  Switch } from \"react-router-dom\";\r\n  import { connect } from \"react-redux\";\r\nimport HomePage from \"./Home\";\r\nimport ForumMenuPage from \"./Forum/ForumMenu\";\r\nimport LoginPage from \"./User/Login\";\r\nimport UserEditPage from \"./User/Edit\";\r\nimport WorldDetailsPage from \"./World/Details\";\r\nimport WorldEditPage from \"./World/Edit\";\r\nimport CollaboratePage from \"./World/Collaborate\";\r\nimport EditCollaboratorsPage from \"./World/EditCollaborators\";\r\n// import WorldDeletePage from \"./World/Delete\";\r\nimport TypeDetailsPage from \"./Type/Details\";\r\nimport TypeEditPage from \"./Type/Edit\";\r\n// import TypeDeletePage from \"./Type/Delete\";\r\nimport ThingDetailsPage from \"./Thing/Details\";\r\nimport ThingEditPage from \"./Thing/Edit\";\r\nimport ResetPasswordPage from \"./User/ResetPassword\";\r\nimport ConfirmEmailPage from \"./User/ConfirmEmail\";\r\n// import ThingDeletePage from \"./Thing/Delete\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport LoginControl from './User/LoginControl';\r\nimport {\r\n  toggleLogin\r\n} from \"../redux/actions/index\";\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    loginOpen: state.app.loginOpen\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    toggleLogin: () => dispatch(toggleLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} className=\"h-100 margined\">\r\n        { this.props.loginOpen ?\r\n          <LoginControl onLogin={user => { \r\n            this.props.toggleLogin();\r\n          }}/>\r\n        :\r\n          <Switch>\r\n            {/* <Route exact path=\"/Template\" component={TemplatePage} /> */}\r\n            <Route exact path=\"/\" component={HomePage} />\r\n            <Route exact path=\"/home\" component={HomePage} />\r\n            <Route exact path=\"/User/Login\" component={LoginPage} />\r\n            <Route exact path=\"/User/resetPassword/:id\" component={ResetPasswordPage} />\r\n            <Route exact path=\"/User/confirmEmail/:id\" component={ConfirmEmailPage} />\r\n            <Route exact path=\"/profile\" component={UserEditPage} />\r\n            \r\n            {/* <Route exact path=\"/test/:testtext\" component={Test} /> */}\r\n            <Route exact path=\"/forums\" component={ForumMenuPage} />\r\n            <Route exact path=\"/world/details/:id\" component={WorldDetailsPage} />\r\n            <Route exact path=\"/world/create\" component={WorldEditPage} />\r\n            <Route exact path=\"/world/edit/:id\" component={WorldEditPage} />\r\n            <Route exact path=\"/world/collaborators/:id\" component={EditCollaboratorsPage} />\r\n            <Route exact path=\"/world/collaborate/:worldID/:collabID\" component={CollaboratePage} />\r\n            {/* <Route exact path=\"/world/delete/:id\" component={WorldDeletePage} /> */}\r\n            <Route exact path=\"/type/create\" component={TypeEditPage} />\r\n            <Route exact path=\"/type/details/:id\" component={TypeDetailsPage} />\r\n            <Route exact path=\"/type/edit/:id\" component={TypeEditPage} />\r\n            {/* <Route exact path=\"/type/delete/:id\" component={TypeDeletePage} /> */}\r\n            <Route exact path=\"/thing/create\" component={ThingEditPage} />\r\n            <Route exact path=\"/thing/create/:id\" component={ThingEditPage} />\r\n            <Route exact path=\"/thing/details/:id\" component={ThingDetailsPage} />\r\n            <Route exact path=\"/thing/edit/:id\" component={ThingEditPage} />\r\n            {/* <Route exact path=\"/thing/delete/:id\" component={ThingDeletePage} /> */}\r\n          </Switch>\r\n        }\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst MainPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default MainPage;\r\n","\nimport React, { Component } from \"react\";\nimport \"./assets/css/material-dashboard-react.css\";\nimport {\n  BrowserRouter as Router\n} from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport NavBar from \"./components/Navigation/Navbar\";\nimport Sidebar from \"./components/Navigation/Sidebar\";\nimport MainPage from \"./views/MainPage\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport { \n  setWidth,\n  setAPI\n} from \"./redux/actions/index\";\nimport API from \"./smartAPI\";\n\nconst mapStateToProps = state => {\n  return {\n    menuOpen: state.app.menuOpen,\n    api: state.app.api\n  };\n};\nfunction mapDispatchToProps(dispatch) {\n  return {\n    setWidth: width => dispatch(setWidth(width)),\n    setAPI: api => dispatch(setAPI(api))\n  };\n}\nclass AppLayout extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      version: \"0\",\n      width: 0,\n      marginLeft: 220\n    };\n    this.api = API.getInstance();\n  }\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    let w = window.innerWidth;\n    if (w >= 600) {\n      w -= 200;\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 220, innerWidth: window.innerWidth });\n    }\n    else {\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 0, innerWidth: window.innerWidth });\n    }\n  }\n\n  render() {\n    if (this.props.api === null) {\n      this.props.setAPI(this.api);\n    }\n    return (\n      <Router>\n        {this.props.menuOpen ? \n          <Box display={{ xs: 'none', sm: 'inline' }} className=\"Sidebar\">\n            <Sidebar className=\"\" logoText={\"Author's Notebook\"} />\n          </Box>\n        : \"\" }\n        <Grid container>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft : 0}px`, \n              width: `${this.props.menuOpen ? this.state.width : this.state.innerWidth}px` \n            }}>\n            <NavBar />\n          </Grid>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft + 10 : 10}px`, \n              width: `${this.props.menuOpen ? this.state.width - 20 : this.state.innerWidth - 20}px`,\n              marginRight: \"10px\",\n              marginTop: \"10px\" \n            }}>\n            <MainPage />\n          </Grid>\n        </Grid>\n      </Router>\n    );\n  }\n}\n\nconst App = connect(mapStateToProps, mapDispatchToProps)(AppLayout);\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\r\n  UPDATE_INDEX_EXPANDED_PANEL,\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOG_OUT,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  // UPDATE_ATTRIBUTES_ARR,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_ATTRIBUTES,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  TOGGLE_LOGIN,\r\n  NOT_FROM_LOGIN,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH\r\n} from \"../constants/actionTypes\";\r\n\r\nconst initialState = {\r\n  indexExpandedPanel: false,\r\n  api: null,\r\n  articles: [],\r\n  user: null,\r\n  loginError: \"\",\r\n  worlds: [],\r\n  publicWorlds: [],\r\n  followingWorlds: [],\r\n  selectedWorld: null,\r\n  selectedWorldID: null,\r\n  types: [],\r\n  things: [],\r\n  selectedType: null,\r\n  // attributesArr: [],\r\n  // attributes: [],\r\n  attributesByID: {},\r\n  attributesByName: {},\r\n  selectedThing: null,\r\n  loadIt: true,\r\n  menuOpen: true,\r\n  loginOpen: false,\r\n  fromLogin: false,\r\n  width: 0\r\n};\r\nfunction rootReducer(state = initialState, action) {\r\n  if (action.type === UPDATE_INDEX_EXPANDED_PANEL) {\r\n    return Object.assign({}, state, {\r\n      indexExpandedPanel: action.payload\r\n    });\r\n  } else if (action.type === LOAD_FROM_STORAGE) {\r\n    const user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n    // const worlds = JSON.parse(sessionStorage.getItem(\"worlds\"));\r\n    // const publicWorlds = JSON.parse(sessionStorage.getItem(\"publicWorlds\"));\r\n    const selectedWorld = JSON.parse(sessionStorage.getItem(\"selectedWorld\"));\r\n    const selectedWorldID = sessionStorage.getItem(\"selectedWorldID\");\r\n    const types = JSON.parse(sessionStorage.getItem(\"types\"));\r\n    const things = JSON.parse(sessionStorage.getItem(\"things\"));\r\n    const followingWorlds = JSON.parse(sessionStorage.getItem(\"followingWorlds\"));\r\n    // const attributes = JSON.parse(sessionStorage.getItem(\"attributes\"));\r\n    const attributesByID = JSON.parse(sessionStorage.getItem(\"attributesByID\"));\r\n    const attributesByName = JSON.parse(sessionStorage.getItem(\"attributesByName\"));\r\n    \r\n    return Object.assign({}, state, {\r\n      user: user,\r\n      // worlds: worlds === null ? [] : worlds,\r\n      // publicWorlds: publicWorlds === null ? [] : publicWorlds,\r\n      selectedWorld,\r\n      selectedWorldID,\r\n      types: types === null ? [] : types,\r\n      things: things === null ? [] : things,\r\n      followingWorlds: followingWorlds === null ? [] : followingWorlds,\r\n      // attributes: attributes === null ? [] : attributes,\r\n      attributesByID: attributesByID === null ? {} : attributesByID,\r\n      attributesByName: attributesByName === null ? {} : attributesByName,\r\n    });\r\n  } else if (action.type === SET_API) {\r\n    return Object.assign({}, state, {\r\n      api: action.payload\r\n    });\r\n  } else if (action.type === ADD_ARTICLE) {\r\n    return Object.assign({}, state, {\r\n      articles: state.articles.concat(action.payload)\r\n    });\r\n  } else if (action.type === LOGIN) {\r\n    sessionStorage.setItem(\"user\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload.followingWorlds));\r\n    return Object.assign({}, state, {\r\n      user: action.payload, \r\n      followingWorlds: action.payload.followingWorlds\r\n    });\r\n  } else if (action.type === LOG_OUT) {\r\n    sessionStorage.removeItem(\"user\");\r\n    return Object.assign({}, state, {\r\n      user: null\r\n    });\r\n  } else if (action.type === SET_WORLDS) {\r\n    if (action.payload.error === undefined){\r\n      // sessionStorage.setItem(\"worlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            selectedWorld: world,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          worlds: action.payload,\r\n          // attributes: [],\r\n          // attributesByID: {},\r\n          // attributesByName: {}\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === SET_PUBLIC_WORLDS) {\r\n    if (action.payload.error === undefined){\r\n      // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload,\r\n            selectedWorld: world,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          publicWorlds: action.payload\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === ADD_WORLD) {\r\n    if (action.payload.Public) {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      const publicWorlds = state.publicWorlds.concat(action.payload);\r\n      // sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      // const worlds = state.worlds.concat(action.payload);\r\n      // sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      return Object.assign({}, state, {\r\n        worlds: state.worlds.concat(action.payload)\r\n      });\r\n    }\r\n  } else if (action.type === UPDATE_WORLD) {\r\n    const worlds = [...state.worlds];\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = worlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Name = action.payload.Name;\r\n    const wasPublic = world.Public;\r\n    world.Public = action.payload.Public;\r\n    world.AcceptingCollaborators = action.payload.AcceptingCollaborators;\r\n    world.Collaborators = action.payload.Collaborators;\r\n    // sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n    if (world.Public) {\r\n      if (wasPublic) {\r\n        // It was already public so we just need to update the name\r\n        const publicWorld = publicWorlds.filter(t => t._id === world._id)[0];\r\n        publicWorld.Name = world.Name;\r\n      }\r\n      else {\r\n        // It's been changed to public, so we need to add it\r\n        publicWorlds = publicWorlds.concat(world);\r\n      }\r\n      // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      if (wasPublic) {\r\n        // It used to be public, so we need to remove it\r\n        publicWorlds = publicWorlds.filter(t => t._id !== world._id);\r\n        // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n        return Object.assign({}, state, {\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      }\r\n      else {\r\n        // It's still not public, so we can leave it\r\n        return Object.assign({}, state, {\r\n          worlds\r\n        });\r\n      }\r\n    }\r\n  } else if (action.type === UPDATE_PUBLIC_WORLD_COLLAB) {\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = publicWorlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Collaborators = action.payload.Collaborators;\r\n    // sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n    return Object.assign({}, state, {\r\n      publicWorlds\r\n    });\r\n  } else if (action.type === SELECT_WORLD) {\r\n    let world = state.worlds.filter(world => world._id === action.payload);\r\n    if (world.length === 0)\r\n      world = state.publicWorlds.filter(world => world._id === action.payload);\r\n    if (world.length > 0) {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world[0]));\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: world[0],\r\n        // attributes: [],\r\n        attributesByID: {},\r\n        attributesByName: {}\r\n      });\r\n    } else {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.removeItem(\"selectedWorld\");\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: null,\r\n        // attributes: [],\r\n        attributesByID: {},\r\n        attributesByName: {}\r\n      });\r\n    }\r\n  } else if (action.type === SET_ATTRIBUTES) {\r\n    const attributesByID = {};\r\n    const attributesByName = {};\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      // attributes: action.payload,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === UPDATE_ATTRIBUTES) {\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      // attributes: action.payload,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === ADD_ATTRIBUTES) {\r\n    // const attributes = state.attributes.concat(action.payload);\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(attributes));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n    \r\n    return Object.assign({}, state, {\r\n      // attributes: attributes,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === SET_TYPES) {\r\n    sessionStorage.setItem(\"types\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      types: action.payload\r\n    });\r\n  } else if (action.type === ADD_TYPE) {\r\n    const types = state.types.concat(action.payload);\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  } else if (action.type === SET_THINGS) {\r\n    sessionStorage.setItem(\"things\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      things: action.payload\r\n    });\r\n  } else if (action.type === ADD_THING) {\r\n    const things = state.things.concat(action.payload);\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === UPDATE_SELECTED_TYPE) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedType = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedType: changedType\r\n    });\r\n  } else if (action.type === UPDATE_TYPE) {\r\n    const types = [...state.types];\r\n    const type = types.filter(t => t._id === action.payload._id)[0];\r\n    type.Name = action.payload.Name;\r\n    type.Description = action.payload.Description;\r\n    type.Supers = action.payload.Supers;\r\n    type.AttributesArr = action.payload.AttributesArr;\r\n    type.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  // } else if (action.type === UPDATE_ATTRIBUTES_ARR) {\r\n  //   return Object.assign({}, state, {\r\n  //     attributesArr: action.payload\r\n  //   });\r\n  } else if (action.type === UPDATE_SELECTED_THING) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedThing = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedThing: changedThing\r\n    });\r\n  } else if (action.type === UPDATE_THING) {\r\n    const things = [...state.things];\r\n    const thing = things.filter(t => t._id === action.payload._id)[0];\r\n    thing.Name = action.payload.Name;\r\n    thing.Description = action.payload.Description;\r\n    thing.Types = action.payload.Types;\r\n    thing.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === TOGGLE_MENU) {\r\n    return Object.assign({}, state, {\r\n      menuOpen: !state.menuOpen\r\n    });\r\n  } else if (action.type === TOGGLE_LOGIN) {\r\n    return Object.assign({}, state, {\r\n      fromLogin: state.loginOpen,\r\n      loginOpen: !state.loginOpen\r\n    });\r\n  } else if (action.type === NOT_FROM_LOGIN) {\r\n    return Object.assign({}, state, {\r\n      fromLogin: false\r\n    });\r\n  } else if (action.type === SET_WIDTH) {\r\n    return Object.assign({}, state, {\r\n      width: action.payload\r\n    });\r\n  } else if (action.type === SET_FOLLOWING_WORLDS) {\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      followingWorlds: action.payload\r\n    });\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default rootReducer;\r\n\r\nexport const login = (user, history) => {};\r\n\r\nexport const logout = history => {};\r\n","import { createStore, combineReducers } from \"redux\";\r\nimport { sessionService, sessionReducer } from \"redux-react-session\";\r\nimport rootReducer from \"../reducers/index\";\r\nconst reducers = {\r\n  app: rootReducer,\r\n  session: sessionReducer\r\n};\r\n\r\nconst reducer = combineReducers(reducers);\r\nconst store = createStore(reducer);\r\nconst validateSession = session => {\r\n  // check if your session is still valid\r\n  return true;\r\n};\r\nconst options = {\r\n  refreshFromLocalStorage: true,\r\n  refreshOnCheckAuth: true,\r\n  redirectPath: \"/home\",\r\n  driver: \"COOKIES\",\r\n  validateSession\r\n};\r\n\r\nsessionService\r\n  .initSessionService(store, options)\r\n  .then(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and a session was refreshed from your storage\"\r\n    )\r\n  )\r\n  .catch(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and there is no session in your storage\"\r\n    )\r\n  );\r\nexport default store;\r\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store/index\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}
{"version":3,"sources":["assets/img/ANB.png","redux/actions/index.js","redux/constants/actionTypes.js","api.js","views/Home.js","views/Template.js","components/Navigation/routes.js","components/Navigation/MobileMenu.js","components/Navigation/Navbar.js","components/Navigation/Sidebar.js","views/Forum/ForumMenu.js","views/User/LoginControl.js","views/User/Login.js","views/User/Edit.js","views/World/Index.js","views/World/Details.js","views/World/Edit.js","views/World/Collaborate.js","views/World/EditCollaborators.js","views/Type/Details.js","views/Type/AttributeControl.js","views/Type/AttributeDefaultControl.js","views/Type/AttributesControl.js","views/Type/Edit.js","views/Thing/Details.js","views/Thing/AttributeControl.js","views/Thing/AttributesControl.js","views/Thing/Edit.js","views/User/ResetPassword.js","views/User/ConfirmEmail.js","views/MainPage.js","App.js","serviceWorker.js","redux/reducers/index.js","redux/store/index.js","index.js"],"names":["module","exports","setWorlds","payload","type","updateWorld","setPublicWorlds","selectWorld","setAttributes","setTypes","addType","setThings","addThing","updateType","updateSelectedType","updateThing","updateSelectedThing","toggleMenu","setFollowingWorlds","UnauthorizedError","message","this","name","prototype","Error","API","instance","getInstance","APIClass","logErrorReason","reason","console","log","Promise","reject","checkStatus","response","status","unauthorizedError","statusText","error","getVersion","a","real","fetchData","processResponse","version","getAllUsers","_id","email","username","login","user","postData","logout","register","confirmEmail","code","patchData","sendReset","checkResetPasswordCode","resetPassword","newPassword","emailTest","updateUser","getWorldsForUser","OwnerID","Name","Public","getPublicWorlds","createWorld","world","deleteWorld","worldID","deleteData","generateCollabLink","addNewCollaborator","userID","emailCollaborator","deleteCollab","collabID","updateCollaboratorPermission","editPermission","checkCollabID","requestToCollaborate","declineCollabInvite","acceptCollabInvite","getAttributesForWorld","getAttribute","attrID","Description","Attributes","createAttribute","attribute","upsertAttributes","attributes","getTypesForWorld","getType","typeID","createType","deleteType","getThingsForWorld","getThing","thingID","Types","createThing","thing","deleteThing","path","options","fetch","mode","credentials","headers","Accept","then","catch","data","method","body","JSON","stringify","putData","json","Page","props","state","Component","HomePage","connect","className","TemplatePage","selectedPage","app","dispatch","menuRoutes","icon","Home","component","Forum","Menu","toggleFollow","follow","followingWorlds","push","index","indexOf","splice","api","handleUserInput","e","target","value","checked","setState","browse","Filter","res","worlds","undefined","map","prop","key","ListItem","to","onClick","_","style","width","activeClassName","button","Icon","ListItemText","primary","otherWorlds","publicWorlds","forEach","w","toLowerCase","includes","Grid","container","spacing","direction","item","FormControl","variant","fullWidth","InputLabel","htmlFor","OutlinedInput","id","autoComplete","onChange","labelWidth","List","Fab","size","color","Star","links","display","Tooltip","title","Search","Add","myWorlds","MobileMenu","worldIDs","Bar","menuClick","loadFromStorage","AppBar","position","Toolbar","xs","IconButton","aria-label","selectedWorld","mobileMenuOpen","Box","sm","NavBar","menuOpen","setTimeout","src","logo","alt","logoText","brand","Divider","light","Sidebar","window","location","pathname","ForumMenuPage","Control","componentDidMount","validateField","remember","inputBlur","validation","fieldValidation","valid","handleClickShowPassword","showPassword","handleMouseDownPassword","event","preventDefault","fieldName","match","length","password","allUsers","filter","u","validateForm","respond","emailValid","confirmEmailValid","passwordValid","confirmPasswordValid","usernameValid","formMode","formValid","confirmPassword","onSubmit","waiting","submitThroughAPI","trim","errors","loginError","show","cookies","Cookies","set","userLogin","onLogin","err","loginClick","registerClick","passwordClick","emailCookie","get","passCookie","onBlur","FormHelperText","endAdornment","InputAdornment","onMouseDown","edge","FormControlLabel","control","Checkbox","label","Link","Button","disabled","Object","keys","i","LoginControl","redirectTo","Helmet","LoginPage","UserEditPage","Index","handleChange_old","panel","isExpanded","expandedPanel","handleChange","things","TypeIDs","majorLess","t","Major","majorless","ExpansionPanel","expanded","ExpansionPanelSummary","expandIcon","types","ExpansionPanelDetails","editButtons","Owner","Collaborators","c","createButtons","maxWidth","j","ThingIndex","delete","selectedWorldID","modalOpen","getModalStyle","top","Math","round","innerHeight","left","innerWidth","transform","load","getAttributes","updatePublicWorldForCollab","respondToInvite","invite","getTypes","Supers","SuperIDs","sID","concat","t2","AttributesArr","attr","attributesByID","AttributeType","Options","DefinedType","ListType","defHash","Defaults","def","DefaultsHash","getThings","tID","params","People","AcceptingCollaborators","Modal","aria-labelledby","aria-describedby","open","onClose","WorldDetailsPage","a11yProps","nameValid","addWorld","ArrowBack","marginLeft","WorldEditPage","accept","accepted","submitAccept","getWorlds","onLoginAccept","decline","submitDecline","codeValid","CollaboratePage","TabPanel","children","p","selectedUser","collabs","inviteMessage","inviteEmail","collaborator","permission","collabLink","collabLinkCopied","collab","copyCollabLink","generatedLink","select","document","execCommand","newCollaborators","newCollabTab","collabTab","invites","requests","userMenuItems","MenuItem","Tabs","newValue","Tab","Select","labelId","ref","input","multiline","FileCopyOutlined","fontColor","direcion","EditCollaboratorPage","finishLoading","selectedType","references","ReferenceIDs","inheritedAttributes","superType","definedType","option","DefaultValue","DefaultListValues","defaultValue","subTypes","sub","instances","TypeDetails","attributesByName","handleDefinedTypeChange","onNewType","newType","handleOptionsChange","AttributeControl","useState","changeName","attributeTypes","listTypes","selectedListType","selectedDefinedType","handleTypeChange","chips","handleListTypeChange","onDelete","AttributeDefaultControl","changeValue","attributeType","listOptions","listOptionValues","o","onNewThing","newThing","placeholder","handleTextListChange","selectedValues","onSelect","selectedItem","addOption","onRemove","selectedList","removeOption","displayValue","removeType","Label","styled","newAttribute","uuid","changeAttribute","changeDefault","FromTypeID","blurAttribute","deleteAttributeOld","attributesArr","deleteAttribute","defaults","addNewType","typeModalOpen","modalSubmit","addNewThing","thingModalOpen","newThingType","saveNewType","saveNewThing","submitThingThroughAPI","typeIDs","s","defaultsMode","AttributesControl","resetForm","resetting","attr2","attrArrValid","addMore","superIDs","typeAttributes","res2","DefaultReferenceIDs","supersChange","supers","addSuperOld","s2","FromSupers","matches","superID","addSuper","removeSuper","removedItem","removeUs","checkMe","loaded","TypeEditPage","addAttributes","attrs","Value","ListValues","selectedThing","listValue","ThingDetails","FromTypes","optionsChange","createThingFromTypeOld","nameMatches","createThingFromType","newAttributes","finishResettingForm","substring","attrValid","v","typesChange","addTypeOld","newTypes","removeTypeOld","Things","typeStr","renderHeader","ThingEditPage","resetPasswordCode","ResetPasswordPage","confirmEmailCode","ConfirmEmailPage","exact","EditCollaboratorsPage","TypeDetailsPage","ThingDetailsPage","MainPage","AppLayout","updateDimensions","addEventListener","bind","removeEventListener","setWidth","setAPI","marginRight","marginTop","App","Boolean","hostname","initialState","articles","loadIt","rootReducer","reducers","action","parse","sessionStorage","getItem","assign","setItem","removeItem","worldArr","wasPublic","publicWorld","changedType","changedAt","Date","now","changedThing","session","sessionReducer","reducer","combineReducers","store","createStore","refreshFromLocalStorage","refreshOnCheckAuth","redirectPath","driver","validateSession","sessionService","initSessionService","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.25505181.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import {\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOG_OUT,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH\r\n} from \"../constants/actionTypes\";\r\n\r\nexport function setAPI(payload) {\r\n  return { type: SET_API, payload };\r\n}\r\nexport function addArticle(payload) {\r\n  return { type: ADD_ARTICLE, payload };\r\n}\r\nexport function userLogin(payload) {\r\n  return { type: LOGIN, payload };\r\n}\r\nexport function logOut(payload) {\r\n  return { type: LOG_OUT, payload };\r\n}\r\nexport function setWorlds(payload) {\r\n  return { type: SET_WORLDS, payload };\r\n}\r\nexport function addWorld(payload) {\r\n  return { type: ADD_WORLD, payload };\r\n}\r\nexport function updateWorld(payload) {\r\n  return { type: UPDATE_WORLD, payload };\r\n}\r\nexport function updatePublicWorldForCollab(payload) {\r\n  return { type: UPDATE_PUBLIC_WORLD_COLLAB, payload };\r\n}\r\nexport function setPublicWorlds(payload) {\r\n  return { type: SET_PUBLIC_WORLDS, payload };\r\n}\r\nexport function selectWorld(payload) {\r\n  return { type: SELECT_WORLD, payload };\r\n}\r\nexport function setAttributes(payload) {\r\n  return { type: SET_ATTRIBUTES, payload };\r\n}\r\nexport function addAttributes(payload) {\r\n  return { type: ADD_ATTRIBUTES, payload };\r\n}\r\nexport function setTypes(payload) {\r\n  return { type: SET_TYPES, payload };\r\n}\r\nexport function addType(payload) {\r\n  return { type: ADD_TYPE, payload };\r\n}\r\nexport function setThings(payload) {\r\n  return { type: SET_THINGS, payload };\r\n}\r\nexport function addThing(payload) {\r\n  return { type: ADD_THING, payload };\r\n}\r\nexport function updateType(payload) {\r\n  return { type: UPDATE_TYPE, payload };\r\n}\r\nexport function updateSelectedType(payload) {\r\n  return { type: UPDATE_SELECTED_TYPE, payload };\r\n}\r\nexport function updateThing(payload) {\r\n  return { type: UPDATE_THING, payload };\r\n}\r\nexport function updateSelectedThing(payload) {\r\n  return { type: UPDATE_SELECTED_THING, payload };\r\n}\r\nexport function loadFromStorage(payload) {\r\n  return { type: LOAD_FROM_STORAGE, payload };\r\n}\r\nexport function toggleMenu(payload) {\r\n  return { type: TOGGLE_MENU, payload };\r\n}\r\nexport function setFollowingWorlds(payload) {\r\n  return { type: SET_FOLLOWING_WORLDS, payload };\r\n}\r\nexport function setWidth(payload) {\r\n  return { type: SET_WIDTH, payload };\r\n}\r\n","\r\nexport const SET_API = \"SET_API\";\r\nexport const ADD_ARTICLE = \"ADD_ARTICLE\";\r\nexport const LOGIN = \"LOGIN\";\r\nexport const LOG_OUT = \"LOG_OUT\";\r\nexport const SET_WORLDS = \"SET_WORLDS\";\r\nexport const SET_PUBLIC_WORLDS = \"SET_PUBLIC_WORLDS\";\r\nexport const ADD_WORLD = \"ADD_WORLD\";\r\nexport const UPDATE_WORLD = \"UPDATE_WORLD\";\r\nexport const UPDATE_PUBLIC_WORLD_COLLAB = \"UPDATE_PUBLIC_WORLD_COLLAB\";\r\nexport const SELECT_WORLD = \"SELECT_WORLD\";\r\nexport const SET_TYPES = \"SET_TYPES\";\r\nexport const ADD_TYPE = \"ADD_TYPE\";\r\nexport const SET_THINGS = \"SET_THINGS\";\r\nexport const ADD_THING = \"ADD_THING\";\r\nexport const UPDATE_TYPE = \"UPDATE_TYPE\";\r\n// export const UPDATE_ATTRIBUTES_ARR = \"UPDATE_ATTRIBUTES_ARR\";\r\nexport const SET_ATTRIBUTES = \"SET_ATTRIBUTES\";\r\nexport const ADD_ATTRIBUTES = \"ADD_ATTRIBUTES\";\r\nexport const UPDATE_SELECTED_TYPE = \"UPDATE_SELECTED_TYPE\";\r\nexport const UPDATE_THING = \"UPDATE_THING\";\r\nexport const UPDATE_SELECTED_THING = \"UPDATE_SELECTED_THING\";\r\nexport const LOAD_FROM_STORAGE = \"LOAD_FROM_STORAGE\";\r\nexport const TOGGLE_MENU = \"TOGGLE_MENU\";\r\nexport const SET_FOLLOWING_WORLDS = \"SET_FOLLOWING_WORLDS\";\r\nexport const SET_WIDTH = \"SET_WIDTH\";\r\n","\r\n// This is our special type of Error that represents\r\n// when a request got a 401 Unauthorized response\r\nfunction UnauthorizedError(message) {\r\n  this.name = \"UnauthorizedError\";\r\n  this.message = message;\r\n}\r\nUnauthorizedError.prototype = new Error();\r\n\r\nvar API = (function() {\r\n  var instance;\r\n\r\n  function createInstance() {\r\n    var api = new APIClass();\r\n    return api;\r\n  }\r\n\r\n  return {\r\n    getInstance: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nclass APIClass {\r\n  constructor() {\r\n    this.real = true;\r\n  }\r\n\r\n  logErrorReason = reason => {\r\n    // log the error reason but keep the rejection\r\n    console.log(\"Response error reason:\", reason);\r\n    return Promise.reject(reason);\r\n  };\r\n\r\n  checkStatus = response => {\r\n    if (response.status >= 200 && response.status < 300) {\r\n      return response;\r\n    } else if (response.status === 401) {\r\n      var unauthorizedError = new UnauthorizedError(response.statusText);\r\n      unauthorizedError.response = response;\r\n      return Promise.reject(unauthorizedError);\r\n    } else {\r\n      var error = new Error(response.statusText);\r\n      error.response = response;\r\n      return Promise.reject(error);\r\n    }\r\n  };\r\n\r\n  getVersion = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/version\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return { version: \"0.0.1\" };\r\n    }\r\n  };\r\n\r\n  // User\r\n  getAllUsers = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/user/getAllUsers\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      }];\r\n    }\r\n  };\r\n\r\n  login = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/login\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  logout = async user => {\r\n    if (this.real) {\r\n      await this.postData(\"/api/user/logout\");\r\n    }\r\n  };\r\n\r\n  register = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/register\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  confirmEmail = async (code) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/confirmEmail\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  sendReset = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/sendReset\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkResetPasswordCode = async code => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/checkResetPasswordCode\", {code});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  resetPassword = async (code, newPassword) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/resetPassword\", {code, newPassword});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  emailTest = async user => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/user/emailTest\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  updateUser = async user => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/user/update\", user);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: \"-1\",\r\n        email: \"fake@fakemail.com\",\r\n        username: \"Liar Liar\"\r\n      };\r\n    }\r\n  };\r\n\r\n  // World\r\n  getWorldsForUser = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getWorldsForUser`);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  getPublicWorlds = async () => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\"/api/world/getPublicWorlds\");\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [\r\n        { _id: -1, OwnerID: -1, Name: \"Alice in Wonderland\", Public: true }\r\n      ];\r\n    }\r\n  };\r\n\r\n  createWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createWorld\", { world: world });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteWorld\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateWorld = async (world) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateWorld\", { world: world });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  generateCollabLink = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/generateCollabLink\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  addNewCollaborator = async (worldID, userID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/addNewCollaborator\", { worldID, userID, email });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  emailCollaborator = async (worldID, email) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/emailCollaborator\", { worldID, email });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  deleteCollab = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteCollab\", { worldID, collabID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateCollaboratorPermission = async (worldID, collabID, editPermission) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateCollaboratorPermission\", { worldID, collabID, editPermission });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  checkCollabID = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/checkCollabID\", {worldID, collabID});\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  requestToCollaborate = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/requestToCollaborate\", { worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  declineCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/declineCollabInvite\", { worldID, collabID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  acceptCollabInvite = async (worldID, collabID) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/acceptCollabInvite\", { worldID, collabID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  selectWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/selectWorld\", { worldID: worldID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Attribute\r\n  getAttributesForWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttributesForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getAttribute = async (worldID, attrID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getAttribute/${worldID}/${attrID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createAttribute = async (attribute) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createAttribute\", { attribute: attribute });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  // deleteAttribute = async (worldID, attrID) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.deleteData(\"/api/world/deleteAttribute\", { worldID: worldID, attrID: attrID });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  // updateAttribute = async (attribute) => {\r\n  //   if (this.real) {\r\n  //     const response = await this.patchData(\"/api/world/updateAttribute\", { attribute: attribute });\r\n  //     return this.processResponse(response);\r\n  //   } else {\r\n  //     return \"success\";\r\n  //   }\r\n  // };\r\n\r\n  upsertAttributes = async (worldID, attributes) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/upsertAttributes\", { worldID, attributes: attributes });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  // Type\r\n  getTypesForWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getTypesForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Character\" }];\r\n    }\r\n  };\r\n\r\n  getType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getType/${worldID}/${typeID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Name: \"Character\",\r\n        Description: \"\",\r\n        // AttributesArr: {},\r\n        Attributes: {}\r\n      };\r\n    }\r\n  };\r\n\r\n  createType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createType\", { type: type });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteType = async (worldID, typeID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteType\", { worldID: worldID, typeID: typeID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateType = async (type) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateType\", { type: type });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Thing\r\n  getThingsForWorld = async (worldID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/world/getThingsForWorld/${worldID}`\r\n      );\r\n      return this.processResponse(response);\r\n    } else {\r\n      return [{ _id: -1, worldID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  getThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(`/api/world/getThing/${worldID}/${thingID}`);\r\n      return this.processResponse(response);\r\n    } else {\r\n      return {\r\n        _id: -1,\r\n        worldID: -1,\r\n        Types: [-1],\r\n        Name: \"Alice\",\r\n        Description: \"\"\r\n      };\r\n    }\r\n  };\r\n\r\n  createThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/world/createThing\", { thing: thing });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteThing = async (worldID, thingID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/world/deleteThing\", { worldID: worldID, thingID: thingID });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateThing = async (thing) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/world/updateThing\", { thing: thing });\r\n      return this.processResponse(response);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  fetchData = async (path, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        ...options.headers\r\n      }\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  postData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  putData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  patchData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  deleteData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"DELETE\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  processResponse = async response => {\r\n    const body = await response.json();\r\n    if (response.status !== 200) throw Error(body.message);\r\n    else return body;\r\n  };\r\n}\r\n\r\nexport default API;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h3>Author's Notebook</h3>\r\n        <p>\r\n          This is something that I've been wanting to build for a while. It's\r\n          purpose is to provide a place for keeping track of various aspects of\r\n          books that an author is writing. It is able to keep track of details\r\n          about characters, organizations, systems, and even storylines. I would\r\n          like to make it so it's publicly available, and that any authors\r\n          (aspiring and published) can use it to help them organize their\r\n          stories. I want to make it automate a number of things, but the\r\n          biggest part is to make it very dynamic and to allow for storage of\r\n          all different kinds of notes. In order to make it publicly available\r\n          however, it needs to at least be able to pay for itself. I'm not\r\n          talking about the time I spent/spend working on it, but the costs of\r\n          hosting the website, the db, and the url. Until I'm sure it's capable\r\n          of doing those things, I can't let everyone have access to it.\r\n        </p>\r\n        <p>\r\n          This is version 1 of instructions of how to use it. If I make it\r\n          available for anyone, I'll update it with some video instructions.\r\n        </p>\r\n        <p>\r\n          One thing you need to know is that this is a hobby project of mine.\r\n          I'm working on it by myself for now. I've got a real job, and I've got\r\n          a family, so this isn't my top priority, but that being said I do care\r\n          about this probject, and I do plan to get to all the things that are\r\n          on my to do list.\r\n        </p>\r\n        <p>\r\n          If you want to do more than just look at the things others have put on\r\n          (and which they're allowing you to see), then you'll have to register.\r\n          Making it use Facebook and/or Google authentication is on my to do\r\n          list. I know how to do that, but I just haven't gotten around to it.\r\n          So, for now, just register and login. It currently doesn't send any\r\n          emails, so if you forget your password or something, you'll have to\r\n          reach out to me, and I can straighten it out. Again, that kind of\r\n          thing is also on my to do list.\r\n        </p>\r\n        <p>\r\n          Once you're logged in then you're able to start keeping track of\r\n          things.\r\n        </p>\r\n        <p>\r\n          The first thing you create is currently called a World. This is a\r\n          holdover from when I was calling this my World Building App because I\r\n          was aiming it for Fantasy/Sci-Fi authors (like me), but I realized\r\n          that it could be used for anything really. If anyone has any\r\n          suggestions for something to call this instead of World, I'm open to\r\n          considering other options. Currently I'm considering changing it to\r\n          'Project', and I may do that before showing it to anyone other than\r\n          family and close friends. Anyway, a World is basically the root of\r\n          everything. Different Worlds aren't connected to each other. Each\r\n          World has a Name, and you can choose whether or not to make it Public.\r\n          If it's not Public then only the Owner (whoever created it) is able to\r\n          see it. If it is Public then anyone can see it, but only the Owner can\r\n          edit it. (Planned Future Features: When you create a new world you can\r\n          use a template which will include generic Types common to that type of\r\n          World, such as Character, Location, etc. I'm also planning to add the\r\n          ability for Owners to add Collaborators to their World. Collaborators\r\n          would be able to see the World, and the Owner would be able to control\r\n          their other permissions as well (create/edit type, delete type,\r\n          create/edit thing, and delete thing.). Only the Owner will have the\r\n          ability to Edit or Delete the World itself, but they will be able to\r\n          make someone else the Owner.)\r\n        </p>\r\n        <p>\r\n          Within a World you are able to define Types. Basically a Type is just\r\n          that. It's a Type of Thing that you want to keep track of. In each\r\n          Type you are able to define attributes which that Type of Thing share,\r\n          such as Characters having Age, Race, Gender, Height, Weight, Skin\r\n          Color, Eye Color, etc. Types can also be hierarchical through\r\n          inheritance. For example, in Harry Potter I would have a 'Character'\r\n          Type with all the attributes I listed above, but then I could have a\r\n          'Witch or Wizard' Type which has 'Character' as a Super Type. This\r\n          means that 'Witch or Wizard' already has all those same Attributes as\r\n          'Character', but you can add more Attributes like Wand, Known Spells,\r\n          etc. The way to set the Super Types for a type is with a control\r\n          called a Multi Select. It's basically a textbox, but as you type it\r\n          gives you suggestions. You click a suggestion and it adds a chip\r\n          showing it as selected. Clicking the x on the right of the chip\r\n          unselects it. When selecting a Type to be a Super Type it adds all the\r\n          Attributes of that Type to the Type you're creating or editing, but\r\n          they are greyed out and disabled for editing. The reason they're grey\r\n          and disabled is that they come from a Super Type, so their definition\r\n          is there. If a Super Type is removed then the Attributes remain, but\r\n          are no longer grey and disabled. They can then be edited. There are a\r\n          few more things to note however. First is that when adding a Super\r\n          Type which has Super Types, those Super Types will be added as well.\r\n          An example of this could be the 'Animagus' Type in Harry Potter.\r\n          'Animagus' has the Super Type 'Witch or Wizard', which has the Super\r\n          Type 'Character', so when defining 'Animagus' I could add 'Witch or\r\n          Wizard' as a Super Type, and that will automatically add 'Character'\r\n          as well. Removing a Super Type of other Super Types will remove all\r\n          Sub Types of the Super Type removed. An example of that would be\r\n          removing 'Character' from 'Animagus'. This would automatically remove\r\n          'Witch or Wizard' as well. It doesn't make sense to do that for\r\n          'Animagus', but it may be necessary for you if you want to rethink how\r\n          you're organizing things. The last thing to note about removing Super\r\n          Types is that so long as a single Super Type exists which has an\r\n          Attribute with that name, it will be greyed out and disabled. Another\r\n          note about Attributes is that their names have to be unique on the\r\n          Type (or Thing). It's generally a good idea to make sure that any\r\n          Attributes you define with the same name also have the same Attribute\r\n          type as well, otherwise you may run into Attribute name collisions.\r\n          One last thing about Types. I've added an option to Types called Major\r\n          Type. If it's checked then the Type is considered a Major Type and\r\n          will show up in places of the UI where a regular Type will not. This\r\n          makes finding, creating, and editing Things of that Type easier. I\r\n          would make 'Character' a Major Type, but 'Witch or Wizard' and\r\n          'Animagus' would be regular Types. (Planned Future Features: Template\r\n          Types like I have above for Template Worlds, but they're individual\r\n          Types. Also add Plural Name field which will be used in the UI for\r\n          places where we put the plural name of something. Currently it just\r\n          adds an 's' to the end of the Type name, and I want to continue to do\r\n          that if the Plural Name is left empty, but if it's not empty then\r\n          display the Plural Name instead.)\r\n        </p>\r\n        <p>\r\n          Types have Attributes (as mentioned above). Things (which I'll get\r\n          into more below) also have Attributes. The same Attributes really. In\r\n          the Harry Potter World the Attributes on the 'Character' Type would\r\n          then be given to every character you create afterward, but now instead\r\n          of naming the Attribute and saying what type of Attribute it is, you\r\n          get to specify a value for the Attribute.\r\n        </p>\r\n        <p>\r\n          An Attribute is anything you may wish to keep track of for anything.\r\n          These do not include Name or Description, because all Types and Things\r\n          always have Name and Description by default. Attributes are for\r\n          anything else you want to keep track of. It could be a relationship\r\n          like 'Friend', 'Family Member', 'Significant Other', 'Coworker', etc.\r\n          It could be skills and abilities, or possessions, or jobs, or home\r\n          address, or work or school schedule. Really anything you want to keep\r\n          track of which is part of something can be an Attribute. Currently\r\n          there are six types of Attributes that are supported: Text, Number,\r\n          True/False, Options, Type, and List. Text is just that. A Text\r\n          Attribute gives you a textbox where you can type anything you want to\r\n          keep track of. Number gives you a number box, which is like a textbox\r\n          but it only accepts numbers, and it has arrows on the right which can\r\n          be used to increment or decrement the number. True/False gives you a\r\n          checkbox. Options allows you to specify possible choices for the\r\n          Attribute, and then they show up in a drop down list (A quick example\r\n          of this could be 'Gender' having 'Male', 'Female', and others if you\r\n          wanted. They can have as many options as you want, and it can be used\r\n          for whatever Attribute you want.). Specifying the choices is done\r\n          using a control called a Chip Input. This looks like a regular\r\n          textbox, but whenever you hit enter the text in it is added as a chip.\r\n          Chips show the text, but have an x on their right which can be used to\r\n          remove them. It's basically like the Multiselect except without the\r\n          suggestions. The Chips are the choices that will be in the drop down\r\n          list which the user has when creating or editing a Thing with that\r\n          Attribute.\r\n        </p>\r\n        <p>The last two Attribute types are a little more complicated.</p>\r\n        <p>\r\n          When adding Attributes to a Type, the 'Type' Attribute type allows you\r\n          to then choose from the various Types you've defined for the World,\r\n          and then when you're creating or editing a Thing (such as the\r\n          'Character' 'Harry Potter') you would get all the Things of that Type\r\n          as choices in a drop down list. For example you could have a 'Best\r\n          Friend' Attribute which has the Attribute type of 'Type' and uses the\r\n          Defined Type of 'Character'. Then when editing Harry you would have a\r\n          drop down list which shows all the 'Characters' you've added to the\r\n          World as possible 'Best Friends'. You would of course then choose 'Ron\r\n          Weasley' (Sorry, Hermione, but you're a close second.).\r\n        </p>\r\n        <p>\r\n          The Attribute Type 'List' is still more complicated than 'Type'. It\r\n          allows you to decide which type of 'List' it's going to be. For now it\r\n          only supports 'Text', 'Options', and 'Type'. (I'm not planning to add\r\n          any others, but if it's requested I may consider it. A List of Text\r\n          could be anything really, so other types shouldn't be necessary.) If\r\n          an Attribute is defined as a List of Text then when creating or\r\n          editing a Thing the Attribute gives a Chip Input, which works the same\r\n          as it does for Options (described above). A List of Options allows you\r\n          to define the choices when creating or editing the Type, the same as\r\n          with a regular Options Attribute, and then when creating or editing a\r\n          Thing of that Type it gives a Multiselect which works the same as when\r\n          choosing Super Types (described above) with the Options defined\r\n          previously on the Type as the suggestions. A List of 'Type' allows you\r\n          to choose a Defined Type (like with the Attribute type 'Type'), but\r\n          when creating or editing a Thing it gives you a Multiselect instead of\r\n          a regular drop down list so you can select more than one. With all\r\n          'List' Attributes, the items in the list are displayed separated by\r\n          commas when looking at the details page rather than creating or\r\n          editing.\r\n        </p>\r\n        <p>\r\n          One last note about Attributes of type 'Type' or 'List' of 'Type'.\r\n          I've made it so that if you want to choose a Defined Type which you\r\n          haven't defined yet you can choose '+ Create New Type' and it opens a\r\n          quick little window (modal for those who care) which lets you define a\r\n          Type using just the name you want it to have. You'll have to edit that\r\n          Type later to give it any Super Types or Attributes it should have,\r\n          but you can create it there so you can continue defining the Type\r\n          you're already working on rather than having to leave and come back to\r\n          it. The same thing can be done when creating or editing a Thing with\r\n          an Attribute of type 'Type' or 'List' of 'Type', but for Things the\r\n          Type has already been chosen. Now you will be creating a Thing of that\r\n          Type. An example of this would be if you're editing the 'Character'\r\n          'Harry Potter', but when you get to 'Best Friend' you realize you\r\n          haven't added the 'Ron Weasley' 'Character' yet. You would choose '+\r\n          Create New Character', and then in the quick little window you would\r\n          type 'Ron Weasley'. He would get added as a blank character with just\r\n          his Name, but he would then be selected as Harry's 'Best Friend', and\r\n          you could finish defining Harry, and get to Ron later.\r\n        </p>\r\n        <p>\r\n          And one more thing about Attributes in general.  I added the ability to\r\n          set Default values for attributes on the Type.  Default Values will \r\n          automatically be set on any Things of that Type.  I made it as user \r\n          friendly as I could think to make it.\r\n        </p>\r\n        <p>\r\n          (Planned Future Features: Other Attribute types, including: Image,\r\n          Event, and External Link. If you have any suggestions of others, feel\r\n          free to recommend them.  Also need to put in validation to detect \r\n          Name and Default collisions.)\r\n        </p>\r\n        <p>\r\n          And that brings us to Things. If you've gotten to this point, then you\r\n          probably already understand what Things are, but I'll outline it\r\n          anyway. The generic term Thing is used to mean any actual thing you're\r\n          keeping track of. This would be your Characters, your Places, your\r\n          Items, Spells, whatever. When creating or editing a Thing you are able\r\n          to choose Types for the Thing (works the same as Super Types for\r\n          Types), and all the Attributes of those Types are added to the Thing,\r\n          but now you're able to give values for them. Again remember to avoid\r\n          Attribute Name collisions (If for some reason you've defined 2\r\n          unrelated Types with an Attribute that has the same name but different\r\n          Attribute types then you won't be able to have a Thing of both\r\n          Types.). If a Type is edited to remove an Attribute, Things which use\r\n          that Type and existed already will still have that Attribute. It will\r\n          just be an orphaned Attribute. Currently there's no way to remove\r\n          Attributes from Things. If a Type is edited to add Attributes then\r\n          Things which already existed will gain those Attributes as soon as\r\n          they're edited again. If a Type is edited and an Attribute is\r\n          changed... I'm not actually sure what would happen to Things that\r\n          already exist which have that Type. I'll have to test that. That's\r\n          really it for Things. They're the simple part. (Planned Future\r\n          Features: I'm planning to add the ability to add/remove/edit orphaned\r\n          Attributes for Things. When I do, I'll probably try to find a way to\r\n          make it so with adding/editing orphaned Attributes you'll be able to\r\n          add the Attribute to a selected Type already on the Thing.)\r\n        </p>\r\n        <p>I probably should have put Attributes below Things, but oh well.</p>\r\n        <p>Other Planned Future Features:</p>\r\n        <div>\r\n          <p>\r\n            Forums: I'm going to have a General Site Forum, and each World will\r\n            automatically get its own Forum.\r\n          </p>\r\n          <p>\r\n            Direct Messages: I'll add a simple messaging system to allow people\r\n            to communicate directly with one another.\r\n          </p>\r\n          <p>\r\n            Auto-links: For both Forums and DMs I'll allow users to put links to\r\n            pages through a simple system similar to hashtags in Social Media.\r\n            I'm thinking I also want to add this capability to Descriptions on\r\n            Types and Things.\r\n          </p>\r\n          <p>\r\n            Following Public Worlds: Currently all Public Worlds are listed in\r\n            the menu, but I should make it so only those that the user follows\r\n            are shown there, and have a button to pull up the full list, and add\r\n            a button for people who neither own or collaborate on a Public World\r\n            to 'Follow' the World.\r\n          </p>\r\n          <p>\r\n            Home Page content: I'm planning to have actual Home Page content.\r\n            This will have a link to a video tutorial for new users (which I\r\n            have yet to make, and will need occasional updating after it's\r\n            made), as well as things like recent software changes. I also want\r\n            to make it so it can automatically have links to recently added or\r\n            edited Types or Things and recent Forum posts which may be of\r\n            interest to the user.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst HomePage = connect()(Page);\r\nexport default HomePage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-12\">\r\n        Template Page\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst TemplatePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TemplatePage;\r\n","\r\nimport Home from \"@material-ui/icons/Home\";\r\nimport Forum from \"@material-ui/icons/Forum\";\r\nimport HomePage from \"../../views/Home\";\r\nimport TemplatePage from \"../../views/Template\";\r\n\r\n\r\nconst menuRoutes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home\",\r\n    icon: Home,\r\n    component: HomePage,\r\n  },\r\n  {\r\n    path: \"/Forums\",\r\n    name: \"Forums\",\r\n    icon: Forum,\r\n    component: TemplatePage,\r\n  }\r\n];\r\n\r\nexport default menuRoutes;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport StarBorderIcon from \"@material-ui/icons/StarBorder\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds,\r\n  toggleMenu\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds,\r\n    width: state.app.width\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs)),\r\n    toggleMenu: () => dispatch(toggleMenu({}))\r\n  };\r\n}\r\nclass Menu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds().then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    if (this.props.user !== null) {\r\n      this.api.getWorldsForUser().then(res => {\r\n        if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n      });\r\n    }\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      <div>\r\n        {menuRoutes.map((prop, key) => (\r\n          <ListItem key={key} className=\"curvedButton\">\r\n            <NavLink\r\n              to={prop.path}\r\n              onClick={_ => {\r\n                this.props.toggleMenu();\r\n              }}\r\n              style={{\r\n                width: `${this.props.width}px`\r\n              }}\r\n              className=\"MyButton\"\r\n              activeClassName=\"active\"\r\n            >\r\n              <ListItem button>\r\n                {typeof prop.icon === \"string\" ? (\r\n                  <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n                ) : (\r\n                  <prop.icon className=\"marginLeft\" />\r\n                )}\r\n                &nbsp;\r\n                <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n              </ListItem>\r\n            </NavLink>\r\n          </ListItem>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (\r\n      this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined\r\n    ) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (\r\n            this.state.Filter === \"\" ||\r\n            w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())\r\n          ) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            } else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {followingWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/world/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, false);\r\n                    }}\r\n                  >\r\n                    <Star />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n              {otherWorlds.map((w, key) => (\r\n                <ListItem key={key} className=\"curvedButton\">\r\n                  <NavLink\r\n                    to={`/world/details/${w._id}`}\r\n                    onClick={_ => {\r\n                      this.props.toggleMenu();\r\n                    }}\r\n                    style={{\r\n                      width: `${this.props.width - 80}px`\r\n                    }}\r\n                    className=\"MySmallerButton\"\r\n                    activeClassName=\"active\"\r\n                  >\r\n                    <ListItem button>\r\n                      <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                    </ListItem>\r\n                  </NavLink>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={e => {\r\n                      this.toggleFollow(w._id, true);\r\n                    }}\r\n                  >\r\n                    <StarBorderIcon />\r\n                  </Fab>\r\n                </ListItem>\r\n              ))}\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return followingWorlds.map((w, key) => (\r\n      <ListItem key={key} className=\"curvedButton\">\r\n        <NavLink\r\n          to={`/world/details/${w._id}`}\r\n          onClick={_ => {\r\n            this.props.toggleMenu();\r\n          }}\r\n          style={{\r\n            width: `${this.props.width}px`\r\n          }}\r\n          className=\"MyButton\"\r\n          activeClassName=\"active\"\r\n        >\r\n          <ListItem button>\r\n            <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n          </ListItem>\r\n        </NavLink>\r\n      </ListItem>\r\n    ));\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => (\r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink\r\n                  to={`/world/details/${w._id}`}\r\n                  onClick={_ => {\r\n                    this.props.toggleMenu();\r\n                  }}\r\n                  style={{\r\n                    width: `${this.props.width}px`\r\n                  }}\r\n                  className=\"MyButton\"\r\n                  activeClassName=\"active\"\r\n                >\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            ));\r\n      return worldLinks;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Tooltip title={`Browse Public Worlds`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        <ListItem>\r\n          <ListItemText primary={\"My Worlds\"} />\r\n        </ListItem>\r\n        <ListItem className=\"curvedButton\">\r\n          <NavLink\r\n            to={`/world/create`}\r\n            onClick={_ => {\r\n              this.props.toggleMenu();\r\n            }}\r\n            style={{\r\n              width: `${this.props.width}px`\r\n            }}\r\n            className=\"MyButton\"\r\n            activeClassName=\"active\"\r\n          >\r\n            <ListItem button>\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst MobileMenu = connect(mapStateToProps, mapDispatchToProps)(Menu);\r\nexport default MobileMenu;\r\n","import React, { Component } from \"react\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  setWorlds,\r\n  loadFromStorage,\r\n  toggleMenu\r\n} from \"../../redux/actions/index\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport API from \"../../api\";\r\nimport MobileMenu from \"./MobileMenu\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    user: state.app.user,\r\n    selectedWorld: state.app.selectedWorld,\r\n    mobileMenuOpen: !state.app.menuOpen // This defaults to closed instead of open\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    loadFromStorage: () => dispatch(loadFromStorage({})),\r\n    toggleMenu: () => dispatch(toggleMenu({}))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.loadFromStorage();\r\n  }\r\n\r\n  menuClick = () => {\r\n    this.props.toggleMenu();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Grid container spacing={0}>\r\n            <Grid item xs>\r\n              <IconButton\r\n                style={{ color: \"white\" }}\r\n                aria-label=\"Menu\"\r\n                onClick={this.menuClick}\r\n              >\r\n                <MenuIcon />\r\n              </IconButton>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <ListItem className=\"curvedButton\">\r\n                <ListItemText\r\n                  primary={\r\n                    this.props.selectedWorld === null\r\n                      ? \"Welcome!\"\r\n                      : this.props.selectedWorld.Name\r\n                  }\r\n                />\r\n              </ListItem>\r\n            </Grid>\r\n            <Grid item xs>\r\n              <NavLink\r\n                className=\"float-right blue whiteFont\"\r\n                to=\"/User/Login\"\r\n                activeClassName=\"active\"\r\n              >\r\n                <ListItem className=\"curvedButton float-right\">\r\n                  <Icon>person</Icon>\r\n                  <ListItemText\r\n                    primary={\r\n                      this.props.user === null ||\r\n                      this.props.user.username === undefined\r\n                        ? \" Login/Register\"\r\n                        : ` ${this.props.user.username}`\r\n                    }\r\n                  />\r\n                </ListItem>\r\n              </NavLink>\r\n            </Grid>\r\n          </Grid>\r\n        </Toolbar>\r\n        {this.props.mobileMenuOpen ? \r\n          <Box display={{ xs: 'inline', sm: 'none' }}>\r\n            <MobileMenu />\r\n          </Box>\r\n        : \"\" }\r\n      </AppBar>\r\n    );\r\n  }\r\n}\r\n\r\nconst NavBar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default NavBar;\r\n","import React, { Component } from \"react\";\r\nimport \"../../App.css\";\r\n// import logo from \"../../logo.svg\";\r\nimport logo from \"../../assets/img/ANB.png\";\r\nimport {\r\n  // Button,\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Icon,\r\n  Divider,\r\n  FormControl,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Fab,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport { Add, Star, Search } from \"@material-ui/icons\";\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport menuRoutes from \"./routes\";\r\nimport {\r\n  setWorlds,\r\n  setPublicWorlds,\r\n  setFollowingWorlds\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    user: state.app.user,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Bar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      browse: false,\r\n      Filter: \"\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.api.getPublicWorlds().then(res => {\r\n      this.props.setPublicWorlds(res.worlds);\r\n    });\r\n    // These kinds of things can also be done in render,\r\n    // but I prefer to put it here because it's only run once.\r\n    // The downside is that it's run before props gets populated\r\n    // so, it needs to be put into setTimeout to give the props\r\n    // a chance to get populated.\r\n    setTimeout(() => {\r\n      if (this.props.user !== null) {\r\n        this.api.getWorldsForUser().then(res => {\r\n          if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n        });\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  links() {\r\n    return (\r\n      menuRoutes.map((prop, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={prop.path} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              {typeof prop.icon === \"string\" ? (\r\n                <Icon className=\"marginLeft\">{prop.icon}</Icon>\r\n              ) : (\r\n                <prop.icon className=\"marginLeft\" />\r\n              )}\r\n              &nbsp;\r\n              <ListItemText primary={prop.name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  brand() {\r\n    return (\r\n      <NavLink to={`/`} className=\"BlackTextButton\" activeClassName=\"active\">\r\n        <ListItem>\r\n          <img src={logo} alt=\"logo\" className=\"App-logo\" />\r\n          <ListItemText primary={this.props.logoText} />\r\n        </ListItem>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  toggleFollow = (worldID, follow) => {\r\n    let followingWorlds = [...this.props.followingWorlds];\r\n    if (follow) {\r\n      followingWorlds.push(worldID);\r\n    } else {\r\n      const index = followingWorlds.indexOf(worldID);\r\n      followingWorlds.splice(index, 1);\r\n    }\r\n    if (this.props.user !== null) {\r\n      const user = { ...this.props.user };\r\n      user.followingWorlds = followingWorlds;\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n      this.api.updateUser(user);\r\n    } else {\r\n      this.props.setFollowingWorlds(followingWorlds);\r\n    }\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  publicWorlds() {\r\n    const followingWorlds = [];\r\n    const otherWorlds = [];\r\n    if (this.props.publicWorlds !== undefined &&\r\n      this.props.publicWorlds !== null &&\r\n      this.props.publicWorlds.error === undefined) {\r\n      this.props.publicWorlds.forEach(w => {\r\n        if (this.state.browse) {\r\n          if (this.state.Filter === \"\" || w.Name.toLowerCase().includes(this.state.Filter.toLowerCase())) {\r\n            if (this.props.followingWorlds.includes(w._id)) {\r\n              followingWorlds.push(w);\r\n            }\r\n            else {\r\n              otherWorlds.push(w);\r\n            }\r\n          }\r\n        } else if (this.props.followingWorlds.includes(w._id)) {\r\n          followingWorlds.push(w);\r\n        }\r\n      });\r\n    }\r\n    if (this.state.browse) {\r\n      return (\r\n        <Grid container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"filter\">Filter</InputLabel>\r\n              <OutlinedInput\r\n                id=\"filter\"\r\n                name=\"Filter\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                value={this.state.Filter}\r\n                onChange={this.handleUserInput}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <List>\r\n              {\r\n                followingWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/world/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, false);\r\n                      }}\r\n                    >\r\n                      <Star />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n              {\r\n                otherWorlds.map((w, key) => \r\n                  <ListItem key={key} className=\"curvedButton\">\r\n                    <NavLink to={`/world/details/${w._id}`} className=\"MySmallerButton\" activeClassName=\"active\">\r\n                      <ListItem button>\r\n                        <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                      </ListItem>\r\n                    </NavLink>\r\n                    <Fab\r\n                      size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={e => {\r\n                        this.toggleFollow(w._id, true);\r\n                      }}\r\n                    >\r\n                      <StarBorderIcon />\r\n                    </Fab>\r\n                  </ListItem>\r\n                )\r\n              }\r\n            </List>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n    return (\r\n      followingWorlds.map((w, key) => \r\n        <ListItem key={key} className=\"curvedButton\">\r\n          <NavLink to={`/world/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n      )\r\n    );\r\n  }\r\n\r\n  myWorlds() {\r\n    if (this.props.user === null || this.props.user === undefined) {\r\n      return \"\";\r\n    } else {\r\n      const worldLinks =\r\n        this.props.worlds === undefined\r\n          ? \"\"\r\n          : this.props.worlds.map((w, key) => \r\n              <ListItem key={key} className=\"curvedButton\">\r\n                <NavLink to={`/world/details/${w._id}`} className=\"MyButton\" activeClassName=\"active\">\r\n                  <ListItem button>\r\n                    <ListItemText primary={w.Name} className=\"marginLeft\" />\r\n                  </ListItem>\r\n                </NavLink>\r\n              </ListItem>\r\n            );\r\n      return (worldLinks);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <List>\r\n        {this.brand()}\r\n        <Divider light />\r\n        {this.links()}\r\n        <ListItem>\r\n          <ListItemText display=\"none\" primary={\"Public Worlds\"} />\r\n          <Tooltip title={`Browse Public Worlds`}>\r\n            <Fab\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={e => {\r\n                this.setState({ browse: !this.state.browse });\r\n              }}\r\n            >\r\n              <Search />\r\n            </Fab>\r\n          </Tooltip>\r\n        </ListItem>\r\n        {this.publicWorlds()}\r\n        <ListItem>\r\n          <ListItemText primary={\"My Worlds\"} />\r\n        </ListItem>\r\n        <ListItem className=\"curvedButton\">\r\n          <NavLink to={`/world/create`} className=\"MyButton\" activeClassName=\"active\">\r\n            <ListItem button>\r\n              <Add />\r\n              <ListItemText primary={\"Create New\"} />\r\n            </ListItem>\r\n          </NavLink>\r\n        </ListItem>\r\n        {this.myWorlds()}\r\n      </List>\r\n    );\r\n  }\r\n}\r\n\r\nconst Sidebar = connect(mapStateToProps, mapDispatchToProps)(Bar);\r\nexport default Sidebar;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\n// import { selectPage } from \"../../redux/actions/index\";\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    if (\r\n      this.props.selectedPage === null ||\r\n      `/${this.props.selectedPage}` === window.location.pathname\r\n    ) {\r\n      return (\r\n        <div className=\"col-sm-12\">\r\n          Forum Menu Page!\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <Redirect\r\n          to={`/${this.props.selectedPage}`}\r\n        />\r\n      );\r\n    }\r\n  }\r\n}\r\nconst ForumMenuPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ForumMenuPage;\r\n","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport { userLogin, setWorlds, setFollowingWorlds } from \"../../redux/actions/index\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Cookies from \"universal-cookie\";\r\nimport API from '../../api';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return { \r\n    // selectedPage: state.app.selectedPage, \r\n    user: state.app.user, \r\n    loginError: state.app.loginError,\r\n    followingWorlds: state.app.followingWorlds\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    userLogin: user => dispatch(userLogin(user)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setFollowingWorlds: worldIDs => dispatch(setFollowingWorlds(worldIDs))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const cookies = new Cookies();\r\n    const emailCookie = cookies.get('email');\r\n    const passCookie = cookies.get('password');\r\n    this.state = {\r\n      formMode: \"login\",\r\n      email: (emailCookie === undefined ? \"\" : emailCookie),\r\n      password: (passCookie === undefined ? \"\" : passCookie),\r\n      confirmEmail: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        email: { valid: true, message: \"\" }, \r\n        password: { valid: true, message: \"\" }, \r\n        confirmEmail: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" },\r\n        username: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      remember: false,\r\n      message: \"\",\r\n      username: \"\",\r\n      // redirectTo: null,\r\n      allUsers: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    if (this.state.email) {\r\n      this.validateField(\"email\");\r\n      this.validateField(\"password\");\r\n      this.setState({remember: true});\r\n    }\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        if (valid && this.state.allUsers.filter(u=>u.username === value).length !== 0) {\r\n          valid = false;\r\n          message = \"This Username is taken\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const emailValid = this.validateField(\"email\");\r\n    let confirmEmailValid = { valid: true, message: \"\" };\r\n    let passwordValid = { valid: true, message: \"\" };\r\n    let confirmPasswordValid = { valid: true, message: \"\" };\r\n    let usernameValid = { valid: true, message: \"\" };\r\n    switch (this.state.formMode) {\r\n      case \"Login\":\r\n        passwordValid = this.validateField(\"password\");\r\n        break;\r\n      case \"Register\":\r\n        confirmEmailValid = this.validateField(\"confirmEmail\");\r\n        passwordValid = this.validateField(\"password\");\r\n        confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n        usernameValid = this.validateField(\"username\");\r\n      break;\r\n      default:\r\n      break;\r\n    }\r\n    const formValid = \r\n      emailValid.valid && \r\n      passwordValid.valid && \r\n      confirmEmailValid.valid && \r\n      confirmPasswordValid.valid && \r\n      usernameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.email = emailValid;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmEmail = confirmEmailValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    fieldValidation.username = usernameValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const user = {\r\n      email: this.state.email.trim(),\r\n      password: this.state.password,\r\n      username: this.state.username.trim(),\r\n      followingWorlds: this.props.followingWorlds\r\n    };\r\n    if (this.state.formMode === \"login\") {\r\n      this.api.login(user).then(res => {\r\n        if (res.user === null) {\r\n          let errors = this.state.fieldValidation;\r\n          errors.loginError = { message: res.error, valid: false, show: true };\r\n          this.setState({ fieldValidation: errors, waiting: false });\r\n        }\r\n        else {\r\n          if (this.state.remember) {\r\n            const cookies = new Cookies();\r\n            cookies.set('email', this.state.email);\r\n            cookies.set('password', this.state.password);\r\n          }\r\n          this.props.userLogin(res.user);\r\n          this.api.getWorldsForUser(res.user._id).then(res => {\r\n            this.props.setWorlds(res.worlds);\r\n            this.props.onLogin(res.user);\r\n            // this.setState({ redirectTo: \"/\" });\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"register\") {\r\n      this.api.register(user).then(res => {\r\n        if (res.error === undefined) {\r\n          this.setState({ \r\n            message: res.message, \r\n            formMode: \"login\", \r\n            fieldValidation: { \r\n              email: { valid: true, message: \"\" }, \r\n              password: { valid: true, message: \"\" }, \r\n              confirmEmail: { valid: true, message: \"\" }, \r\n              confirmPassword: { valid: true, message: \"\" },\r\n              username: { valid: true, message: \"\" }\r\n            },\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({ \r\n            message: res.error,\r\n            waiting: false\r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n    } else if (this.state.formMode === \"password\") {\r\n      this.api.sendReset(user).then(res => {\r\n        this.setState({ message: res.message, \r\n          formMode: \"login\", \r\n          fieldValidation: { \r\n            email: { valid: true, message: \"\" }, \r\n            password: { valid: true, message: \"\" }, \r\n            confirmEmail: { valid: true, message: \"\" }, \r\n            confirmPassword: { valid: true, message: \"\" },\r\n            username: { valid: true, message: \"\" }\r\n          },\r\n          waiting: false \r\n        });\r\n      })\r\n      .catch(err => console.log(err));\r\n    }\r\n  }\r\n\r\n  loginClick = () => {\r\n    this.setState({ formMode: \"login\" });\r\n  };\r\n\r\n  registerClick = () => {\r\n    this.setState({ formMode: \"register\" });\r\n  };\r\n\r\n  passwordClick = () => {\r\n    this.setState({ formMode: \"password\" });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.allUsers === null) {\r\n      this.api.getAllUsers().then(res => {\r\n        this.setState({allUsers: res});\r\n      });\r\n      return (<div></div>);\r\n    }\r\n    // else if (this.state.redirectTo !== null && \r\n    //   this.props.user !== null && \r\n    //   this.props.user !== undefined && \r\n    //   this.props.user.username !== undefined && \r\n    //   this.props.user.username !== \"\") {\r\n    //   return (<Redirect to={this.state.redirectTo} />);\r\n    // }\r\n    else {\r\n      if (this.state.formMode === \"login\") {\r\n        return (\r\n          <div>\r\n            <h2>Login</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        value={this.state.email}\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControlLabel\r\n                      control={\r\n                        <Checkbox\r\n                          checked={this.state.remember}\r\n                          onChange={this.handleUserInput}\r\n                          name=\"remember\"\r\n                          color=\"primary\"\r\n                        />\r\n                      }\r\n                      label=\"Remember Me\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"register\") {\r\n        return (\r\n          <div>\r\n            <h2>Register</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"username\">Username</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"username\"\r\n                            name=\"username\"\r\n                            type=\"text\"\r\n                            value={this.state.username}\r\n                            error={ !this.state.fieldValidation.username.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={80}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.username.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-sm-6\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                            fullWidth>\r\n                          <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={this.state.email}\r\n                            error={ !this.state.fieldValidation.email.valid }\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={40}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                      <div className=\"col-sm-12 margined\">\r\n                        <FormControl variant=\"outlined\"\r\n                          fullWidth>\r\n                          <InputLabel htmlFor=\"confirmEmail\">Confirm Email</InputLabel>\r\n                          <OutlinedInput\r\n                            id=\"confirmEmail\"\r\n                            name=\"confirmEmail\"\r\n                            type=\"email\"\r\n                            error={ !this.state.fieldValidation.confirmEmail.valid }\r\n                            value={this.state.confirmEmail}\r\n                            onChange={this.handleUserInput}\r\n                            onBlur={this.inputBlur}\r\n                            labelWidth={100}\r\n                            fullWidth\r\n                          />\r\n                          <FormHelperText>{ this.state.fieldValidation.confirmEmail.message }</FormHelperText>\r\n                        </FormControl>\r\n                      </div>\r\n                    </div>\r\n                  </div> \r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        name=\"password\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.password}\r\n                        error={ !this.state.fieldValidation.password.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"confirm-password\"\r\n                        name=\"confirmPassword\"\r\n                        type={this.state.showPassword ? 'text' : 'password'}\r\n                        value={this.state.confirmPassword}\r\n                        error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={this.handleClickShowPassword}\r\n                              onMouseDown={this.handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={130}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.passwordClick}\r\n                  >\r\n                    Forgot Password\r\n                  </Link>{\" \"}\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      } else if (this.state.formMode === \"password\") {\r\n        return (\r\n          <div>\r\n            <h2>Forgot Password?</h2>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-sm-12 margined\">\r\n                    <FormControl variant=\"outlined\"\r\n                        fullWidth>\r\n                      <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"email\"\r\n                        value={this.state.email}\r\n                        error={ !this.state.fieldValidation.email.valid }\r\n                        onChange={this.handleUserInput}\r\n                        onBlur={this.inputBlur}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                      <FormHelperText>{ this.state.fieldValidation.email.message }</FormHelperText>\r\n                    </FormControl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-sm-12\">\r\n                <div className=\"float-left\">\r\n                  <Link\r\n                    onClick={this.registerClick}\r\n                  >\r\n                    Register\r\n                  </Link>{\" \"}\r\n                  <Link\r\n                    onClick={this.loginClick}\r\n                  >\r\n                    Login\r\n                  </Link>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                  <Button className=\"w-200\" \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.onSubmit}\r\n                    type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.state.message}\r\n            {\r\n              Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                  return (\r\n                    <p className=\"redFont\" key={i}>\r\n                      {this.state.fieldValidation[fieldName].message}\r\n                    </p>\r\n                  );\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              })\r\n            }\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default LoginControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { Helmet } from 'react-helmet';\r\nimport LoginControl from './LoginControl';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    // if (this.state.email) {\r\n    //   this.validateField(\"email\");\r\n    //   this.validateField(\"password\");\r\n    //   this.setState({remember: true});\r\n    // }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return (<Redirect to={this.state.redirectTo} />);\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <Helmet>\r\n            <title>Author's Notebook: Login</title>\r\n          </Helmet>\r\n          <LoginControl onLogin={user => { this.setState({redirectTo: \"/\"}); }}/>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst LoginPage = connect()(Page);\r\nexport default LoginPage;\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n// import { selectPage } from \"../../redux/actions/index\";\r\n\r\n// This is a template to use when creating pages.\r\n// It's recommended not to make your own base component classes,\r\n// but I have just a couple things I want to add to my 'page'\r\n// components.  I'll copy this template whenever creating a\r\n// new 'page' component.\r\n\r\nconst mapStateToProps = state => {\r\n  return { selectedPage: state.app.selectedPage };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // selectPage: page => dispatch(selectPage(page))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  componentDidMount() {\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-12\">\r\n        Profile Page\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst UserEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default UserEditPage;\r\n","import React, { Component } from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\r\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\r\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n// import { Fab } from \"@material-ui/core\";\r\n\r\n/* \r\n  This component will be used by the WorldDetails component.  It will\r\n  have a link at the top for creating new Things, and will list all\r\n  Things in the selected World, allowing navigation to their Details.  \r\n  The List will have pagination and filtering controls to make it \r\n  easier to manage.\r\n*/\r\nconst mapStateToProps = state => {\r\n  return { \r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorld: state.app.selectedWorld,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n  };\r\n}\r\nclass Index extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      expandedPanel: false,\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  handleChange_old = panel => (event, isExpanded) => {\r\n    this.setState({expandedPanel: isExpanded ? panel : false});\r\n  };\r\n  handleChange = panel => {\r\n    this.setState({expandedPanel: this.state.expandedPanel === panel ? false : panel });\r\n  };\r\n\r\n  renderListForType(type) {\r\n    // TODO: Add a PluralName field to types so I can use it here.  It may end up being useful other places too.\r\n    const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n              <Add/><ListItemText primary={`Create New ${type.Name}`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            things.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMajorTypelessThings() {\r\n    const majorLess = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n    return (\r\n      <div className=\"Things\">\r\n        <List style={{ width: \"240px\" }}>\r\n          <ListItem>\r\n            <Button \r\n              fullWidth variant=\"contained\" color=\"primary\" \r\n              onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n              <Add/><ListItemText primary={`Create New Thing`} />\r\n            </Button>\r\n          </ListItem>\r\n          {\r\n            majorLess.map((thing, i) => {\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Button \r\n                    fullWidth variant=\"contained\" color=\"primary\" \r\n                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                    <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                  </Button>\r\n                </ListItem>\r\n              );\r\n            })\r\n          }\r\n        </List>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render_old() {\r\n    const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n\r\n    return (\r\n      <div>\r\n        <ExpansionPanel expanded={this.state.expandedPanel === \"TYPES\"} onChange={this.handleChange(\"TYPES\")}>\r\n          <ExpansionPanelSummary\r\n            expandIcon={<ExpandMoreIcon />}\r\n          >\r\n            Types ({this.props.types.length})\r\n          </ExpansionPanelSummary>\r\n          <ExpansionPanelDetails>\r\n            <List style={{ width: \"240px\" }}>\r\n              <ListItem>\r\n                <Button \r\n                  fullWidth variant=\"contained\" color=\"primary\" \r\n                  onClick={ _ => {this.setState({redirectTo:`/type/create`})}}>\r\n                  <Add/><ListItemText primary={`Create New Type`} />\r\n                </Button>\r\n              </ListItem>\r\n              {\r\n                this.props.types.map((type, i) => {\r\n                  return (\r\n                    <ListItem key={i}>\r\n                      <Button \r\n                        fullWidth variant=\"contained\" color=\"primary\" \r\n                        onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                        <ListItemText primary={type.Name} className=\"marginLeft\" />\r\n                      </Button>\r\n                    </ListItem>\r\n                  );\r\n                })\r\n              }\r\n            </List>\r\n          </ExpansionPanelDetails>\r\n        </ExpansionPanel>\r\n        { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n          const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n          return (\r\n          <ExpansionPanel key={i} expanded={this.state.expandedPanel === type._id} onChange={this.handleChange(type._id)}>\r\n            <ExpansionPanelSummary\r\n              expandIcon={<ExpandMoreIcon />}\r\n            >\r\n              {type.Name}s ({things.length})\r\n            </ExpansionPanelSummary>\r\n            <ExpansionPanelDetails>\r\n                <List style={{ width: \"240px\" }}>\r\n                  <ListItem>\r\n                    <Button \r\n                      fullWidth variant=\"contained\" color=\"primary\" \r\n                      onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                      <Add/><ListItemText primary={`Create New ${type.Name}`} />\r\n                    </Button>\r\n                  </ListItem>\r\n                  {\r\n                    things.map((thing, i) => {\r\n                      return (\r\n                        <ListItem key={i}>\r\n                          <Button \r\n                            fullWidth variant=\"contained\" color=\"primary\" \r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                            <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                          </Button>\r\n                        </ListItem>\r\n                      );\r\n                    })\r\n                  }\r\n                </List>\r\n            </ExpansionPanelDetails>\r\n          </ExpansionPanel>\r\n          );\r\n        })}\r\n        <ExpansionPanel expanded={this.state.expandedPanel === \"OTHER\"} onChange={this.handleChange(\"OTHER\")}>\r\n          <ExpansionPanelSummary\r\n            expandIcon={<ExpandMoreIcon />}\r\n          >\r\n            Other Things ({majorless.length})\r\n          </ExpansionPanelSummary>\r\n          <ExpansionPanelDetails>\r\n            <List style={{ width: \"240px\" }}>\r\n              <ListItem>\r\n                <Button \r\n                  fullWidth variant=\"contained\" color=\"primary\" \r\n                  onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n                  <Add/><ListItemText primary={`Create New Thing`} />\r\n                </Button>\r\n              </ListItem>\r\n              {\r\n                majorless.map((thing, i) => {\r\n                  return (\r\n                    <ListItem key={i}>\r\n                      <Button \r\n                        fullWidth variant=\"contained\" color=\"primary\" \r\n                        onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                        <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                      </Button>\r\n                    </ListItem>\r\n                  );\r\n                })\r\n              }\r\n            </List>\r\n          </ExpansionPanelDetails>\r\n        </ExpansionPanel>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    }\r\n    else {\r\n      const majorless = this.props.things.filter(thing => thing.Types.filter(t=>t.Major).length === 0);\r\n      const editButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n      const createButtons = this.props.selectedWorld !== null && \r\n        this.props.user !== null && \r\n        (this.props.selectedWorld.Owner === this.props.user._id || \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0);\r\n\r\n      return (\r\n        <div>\r\n          <List>\r\n            <ListItem>\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  {this.state.expandedPanel === \"TYPES\" ? \r\n                      <Tooltip title={`Collapse Types`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                            <KeyboardArrowDownIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                    :\r\n                      <Tooltip title={`Expand Types`}>\r\n                        <Button \r\n                          onClick={_ => {this.handleChange(\"TYPES\")}}>\r\n                          <KeyboardArrowRightIcon/>\r\n                        </Button>\r\n                      </Tooltip>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Types (${this.props.types.length})`}</span>\r\n                  { createButtons ?\r\n                    <Tooltip title={`Create New Type`}>\r\n                      <Button \r\n                        onClick={ _ => {this.setState({redirectTo:`/type/create`})}}>\r\n                        <Add/>\r\n                      </Button>\r\n                    </Tooltip> \r\n                  : \"\" }\r\n                </Grid>\r\n                {this.state.expandedPanel === \"TYPES\" ? \r\n                  <Grid item>\r\n                    <List style={{ maxWidth: \"300px\" }}>\r\n                      {\r\n                        this.props.types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Tooltip title={`Details for ${type.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                                  <ListItemText primary={type.Name} className=\"marginLeft\" />\r\n                                </Button>\r\n                              </Tooltip>\r\n                              { createButtons ?\r\n                                <Grid container spacing={0} direction=\"row\">\r\n                                  <Grid item xs={6}>\r\n                                    <Tooltip title={`Create New ${type.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                                        <Add/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                  <Grid item xs={6}>\r\n                                    <Tooltip title={`Edit ${type.Name}`}>\r\n                                      <Button \r\n                                        onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                                        <Edit/>\r\n                                      </Button>\r\n                                    </Tooltip>\r\n                                  </Grid>\r\n                                </Grid>\r\n                              : \"\" }\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                : \"\" }\r\n              </Grid>\r\n            </ListItem>\r\n            { this.props.types.filter(t=>t.Major).map((type, i) => {\r\n              const things = this.props.things.filter(thing => thing.TypeIDs.includes(type._id));\r\n              return (\r\n                <ListItem key={i}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      {this.state.expandedPanel === type._id ? \r\n                        <Tooltip title={`Collapse ${type.Name}s`}>\r\n                          <Button \r\n                            onClick={_ => {this.handleChange(type._id)}}>\r\n                            <KeyboardArrowDownIcon/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                        :\r\n                        <Tooltip title={`Expand ${type.Name}s`}>\r\n                          <Button \r\n                            onClick={_ => {this.handleChange(type._id)}}>\r\n                            <KeyboardArrowRightIcon/>\r\n                          </Button>\r\n                        </Tooltip>\r\n                      }\r\n                      <Tooltip title={`Details for ${type.Name}`}>\r\n                        <Button \r\n                          onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}>\r\n                          <ListItemText>{type.Name}s ({things.length})</ListItemText>\r\n                        </Button>\r\n                      </Tooltip>\r\n                      { createButtons ?\r\n                        <span>\r\n                          <Tooltip title={`Create New ${type.Name}`}>\r\n                            <Button \r\n                              onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${type._id}`})}}>\r\n                              <Add/>\r\n                            </Button>\r\n                          </Tooltip>\r\n                          <Tooltip title={`Edit ${type.Name}`}>\r\n                            <Button \r\n                              onClick={ _ => {this.setState({redirectTo:`/type/edit/${type._id}`})}}>\r\n                              <Edit/>\r\n                            </Button>\r\n                          </Tooltip>\r\n                        </span>\r\n                      : \"\" }\r\n                    </Grid>\r\n                    {this.state.expandedPanel === type._id ? \r\n                      <Grid item>\r\n                        <List style={{ maxWidth: \"300px\" }}>\r\n                          {\r\n                            things.map((thing, j) => {\r\n                              return (\r\n                                <ListItem key={j}>\r\n                                  <Tooltip title={`Details for ${thing.Name}`}>\r\n                                    <Button \r\n                                      fullWidth variant=\"contained\" color=\"primary\" \r\n                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                      <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                    </Button>\r\n                                  </Tooltip>\r\n                                  { editButtons ?\r\n                                  <Tooltip title={`Edit ${thing.Name}`}>\r\n                                    <Button \r\n                                      onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                      <Edit/>\r\n                                    </Button>\r\n                                  </Tooltip>\r\n                                  : \"\" }\r\n                                </ListItem>\r\n                              );\r\n                            })\r\n                          }\r\n                        </List>\r\n                      </Grid>\r\n                    : \"\" }\r\n                  </Grid>\r\n                </ListItem>\r\n              );\r\n            })}\r\n            <ListItem>\r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid item>\r\n                  {this.state.expandedPanel === \"OTHER\" ? \r\n                    <Tooltip title={`Collapse Other Things`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                        <KeyboardArrowDownIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                    :\r\n                    <Tooltip title={`Expand Other Things`}>\r\n                      <Button \r\n                        onClick={_ => {this.handleChange(\"OTHER\")}}>\r\n                        <KeyboardArrowRightIcon/>\r\n                      </Button>\r\n                    </Tooltip>\r\n                  }\r\n                  <span className={\"MuiTypography-root MuiListItemText-primary MuiTypography-body1\"}>{`Other Things (${majorless.length})`}</span>\r\n                  { createButtons ?\r\n                  <Tooltip title={`Create New Thing`}>\r\n                    <Button \r\n                      onClick={ _ => {this.setState({redirectTo:`/thing/create`})}}>\r\n                      <Add/>\r\n                    </Button>\r\n                  </Tooltip>\r\n                  : \"\" }\r\n                </Grid>\r\n                {this.state.expandedPanel === \"OTHER\" ? \r\n                  <Grid item>\r\n                    <List style={{ maxWidth: \"300px\" }}>\r\n                      {\r\n                        majorless.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Tooltip title={`Details for ${thing.Name}`}>\r\n                                <Button \r\n                                  fullWidth variant=\"contained\" color=\"primary\" \r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}>\r\n                                  <ListItemText primary={thing.Name} className=\"marginLeft\" />\r\n                                </Button>\r\n                              </Tooltip>\r\n                              { editButtons ?\r\n                              <Tooltip title={`Edit ${thing.Name}`}>\r\n                                <Button \r\n                                  onClick={ _ => {this.setState({redirectTo:`/thing/edit/${thing._id}`})}}>\r\n                                  <Edit/>\r\n                                </Button>\r\n                              </Tooltip>\r\n                              : \"\" }\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                : \"\" }\r\n              </Grid>\r\n            </ListItem>\r\n          </List>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingIndex = connect(mapStateToProps, mapDispatchToProps)(Index);\r\nexport default ThingIndex;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  selectWorld, setTypes, setThings, setWorlds, \r\n  setPublicWorlds, updatePublicWorldForCollab,\r\n  setAttributes\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\nimport Index from \"./Index\";\r\nimport Edit from \"@material-ui/icons/Edit\";\r\nimport Delete from \"@material-ui/icons/Delete\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { Fab } from \"@material-ui/core\";\r\nimport { People } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    publicWorlds: state.app.publicWorlds,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setThings: things => dispatch(setThings(things)),\r\n    setWorlds: worlds => dispatch(setWorlds(worlds)),\r\n    setPublicWorlds: worlds => dispatch(setPublicWorlds(worlds)),\r\n    updatePublicWorldForCollab: world => dispatch(updatePublicWorldForCollab(world)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      world: null,\r\n      modalOpen: false,\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n  componentDidMount() {\r\n  }\r\n\r\n  getAttributes() {\r\n    this.api.getAttributesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // We store the attributes in two hashes, by name and by id\r\n        this.props.setAttributes(res.attributes);\r\n        this.getTypes();\r\n      }\r\n    });\r\n  }\r\n\r\n  getTypes() {\r\n    this.api.getTypesForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        // Add Supers to each type\r\n        const types = res.types;\r\n        types.forEach(t=> {\r\n          t.Supers = [];\r\n          t.SuperIDs.forEach(sID=> {\r\n            t.Supers = t.Supers.concat(types.filter(t2=>t2._id === sID));\r\n          });\r\n          t.AttributesArr = [];\r\n          t.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            t.AttributesArr.push({\r\n              index: t.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID\r\n            });\r\n          });\r\n          const defHash = {};\r\n          if (t.Defaults !== undefined) {\r\n            t.Defaults.forEach(def => {\r\n              defHash[def.attrID] = def;\r\n            });\r\n          }\r\n          t.DefaultsHash = defHash;\r\n        });\r\n        this.props.setTypes(types);\r\n        this.getThings();\r\n      }\r\n    });\r\n  }\r\n\r\n  getThings() {\r\n    this.api.getThingsForWorld(this.props.selectedWorldID).then(res => {\r\n      if (res !== undefined && res.error === undefined) {\r\n        const things = res.things;\r\n        things.forEach(t=> {\r\n          t.Types = [];\r\n          t.TypeIDs.forEach(tID=> {\r\n            t.Types = t.Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n          });\r\n        });\r\n        this.props.setThings(things);\r\n      }\r\n    });\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteWorld(this.props.selectedWorldID).then(res=>{\r\n      let worlds = this.props.worlds.filter(t=>t._id!==this.props.selectedWorldID);\r\n      this.props.setWorlds(worlds);\r\n      worlds = this.props.publicWorlds.filter(t=>t._id!==this.props.selectedWorldID);\r\n      this.props.setPublicWorlds(worlds);\r\n      this.api.selectWorld(null);\r\n      this.props.selectWorld(null);\r\n      this.setState({modalOpen: false, redirectTo: `/`});\r\n    });\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.props.selectWorld(id);\r\n      this.api.selectWorld(id).then(res => {\r\n        this.getAttributes();\r\n      });\r\n    }, 500);\r\n  }\r\n\r\n  requestToCollaborate = () => {\r\n    this.api.requestToCollaborate(this.props.selectedWorldID).then(res => {\r\n      const world = this.props.selectedWorld;\r\n      world.Collaborators.push(res);\r\n      this.props.updatePublicWorldForCollab(world);\r\n    });\r\n  }\r\n\r\n  respondToInvite = () => {\r\n    const invite = this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\")[0];\r\n    this.setState({ redirectTo: `/world/collaborate/${this.props.selectedWorldID}/${invite.collabID}` });\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.props.selectedWorldID === null || this.props.selectedWorldID !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          {this.props.selectedWorld === null ? (\r\n            \"\"\r\n          ) : (\r\n            <Grid item container spacing={0} direction=\"row\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item xs={9}>\r\n                <h2>{this.props.selectedWorld.Name}</h2>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                { this.props.user !== null && this.props.user !== null && this.props.selectedWorld.Owner === this.props.user._id ?\r\n                  <List>\r\n                    <ListItem>\r\n                      <Tooltip title={`Edit ${this.props.selectedWorld.Name}`}>\r\n                        <Fab size=\"small\" color=\"primary\"\r\n                          onClick={ _ => {this.setState({redirectTo:`/world/edit/${this.props.selectedWorldID}`})}}\r\n                        >\r\n                        <Edit />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </ListItem>\r\n                    <ListItem>\r\n                      <Tooltip title={`Edit Collaborators`}>\r\n                        <Fab size=\"small\" color=\"primary\"\r\n                          onClick={ _ => {this.setState({redirectTo:`/world/collaborators/${this.props.selectedWorldID}`})}}\r\n                        >\r\n                        <People />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </ListItem>\r\n                    <ListItem>\r\n                      <Tooltip title={`Delete ${this.props.selectedWorld.Name}`}>\r\n                        <Fab size=\"small\" color=\"primary\"\r\n                          onClick={e => {this.setState({modalOpen: true})}}\r\n                        >\r\n                          <Delete />\r\n                        </Fab>\r\n                      </Tooltip>\r\n                    </ListItem>\r\n                  </List>\r\n                : \r\n                  <List>\r\n                    { this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id).length === 0 ?\r\n                      <ListItem>\r\n                        { this.props.selectedWorld.AcceptingCollaborators && \r\n                          <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={this.requestToCollaborate}\r\n                            type=\"button\"\r\n                          >\r\n                            Request to Collaborate\r\n                          </Button>\r\n                        }\r\n                      </ListItem>\r\n                    : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"request\").length > 0 ?\r\n                      <ListItem>\r\n                        Waiting on Collaboration Request\r\n                      </ListItem>\r\n                    : this.props.selectedWorld.Collaborators.filter(c=> c.userID === this.props.user._id && c.type === \"invite\").length > 0 &&\r\n                      <ListItem>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.respondToInvite}\r\n                          type=\"button\"\r\n                        >\r\n                          You've been invited to Collaborate\r\n                        </Button>\r\n                      </ListItem>\r\n                    }\r\n                  </List>\r\n                }\r\n              </Grid>\r\n            </Grid>\r\n          )}\r\n          <Grid item>\r\n            <Index />\r\n          </Grid>\r\n          {/* <Grid item container spacing={0} direction=\"row\">\r\n            <Grid item xs={6}>\r\n              <TypeIndex />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <ThingIndex />\r\n            </Grid>\r\n          </Grid> */}\r\n          <Modal\r\n              aria-labelledby=\"delete-thing-modal\"\r\n              aria-describedby=\"delete-thing-modal-description\"\r\n              open={this.state.modalOpen}\r\n              onClose={e => {this.setState({modalOpen: false})}}\r\n            >\r\n              <div style={this.getModalStyle()} className=\"paper\">\r\n                <Grid container spacing={1} direction=\"column\">\r\n                  <Grid item>\r\n                    Are you sure you want to delete {this.props.selectedWorld !== null ? this.props.selectedWorld.Name : \"\"}?\r\n                  </Grid>\r\n                  <Grid item>\r\n                    (All external references to it will be left alone and may not work correctly)\r\n                  </Grid>\r\n                  <Grid item container spacing={1} direction=\"row\">\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={this.delete}\r\n                      >\r\n                        Yes\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <Button\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        onClick={e => {this.setState({modalOpen: false})}}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </Modal>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\nconst WorldDetailsPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldDetailsPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  selectWorld,\r\n  addWorld,\r\n  updateWorld\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, Tooltip, Fab\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n    addWorld: world => dispatch(addWorld(world)),\r\n    updateWorld: world => dispatch(updateWorld(world))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Public: false,\r\n      AcceptingCollaborators: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        const { id } = this.props.match.params;\r\n        let world = this.props.worlds.filter(w => w._id === id);\r\n        if (world.length > 0) {\r\n          world = world[0];\r\n          this.setState({\r\n            Name: world.Name,\r\n            Public: world.Public,\r\n            AcceptingCollaborators: world.AcceptingCollaborators === undefined || world.AcceptingCollaborators === null ? false : world.AcceptingCollaborators,\r\n            _id: id\r\n          });\r\n          this.api.selectWorld(id);\r\n          this.props.selectWorld(id);\r\n        }\r\n      } else {\r\n        this.api.selectWorld(null);\r\n        this.props.selectWorld(null);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in World Names\";\r\n        else if (value.length < 4) {\r\n          valid = false;\r\n          message = \"World Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.worlds.filter(\r\n              w => w.Name === value && w._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This World Name is already in use\";\r\n        }\r\n        break;\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const world = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Public: this.state.Public,\r\n      AcceptingCollaborators: this.state.AcceptingCollaborators,\r\n      Owner: this.props.user._id\r\n    };\r\n\r\n    if (world._id === null) {\r\n      this.api\r\n        .createWorld(world)\r\n        .then(res => {\r\n          if (res.error  !== undefined) {\r\n            this.setState({ message: res.error });\r\n          }\r\n          else {\r\n            world._id = res.worldID;\r\n            this.props.addWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${res.worldID}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateWorld(world)\r\n        .then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({ message: res.error });\r\n          }\r\n          else {\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              waiting: false,\r\n              redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n            });\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  render() {\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name}` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              { this.props.selectedWorld !== null &&\r\n                <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                  <Fab size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>\r\n              }\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>\r\n                {this.state._id === null ? \"Create New World\" : \"Edit World\"}\r\n              </h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n              <OutlinedInput\r\n                id=\"name\"\r\n                name=\"Name\"\r\n                type=\"text\"\r\n                autoComplete=\"Off\"\r\n                error={!this.state.fieldValidation.Name.valid}\r\n                value={this.state.Name}\r\n                onChange={this.handleUserInput}\r\n                onBlur={this.inputBlur}\r\n                labelWidth={43}\r\n                fullWidth\r\n              />\r\n              <FormHelperText>\r\n                {this.state.fieldValidation.Name.message}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.Public}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"Public\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Public\"\r\n            />\r\n            { this.state.Public ?\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.AcceptingCollaborators}\r\n                  onChange={this.handleUserInput}\r\n                  name=\"AcceptingCollaborators\"\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Accepting Collaborator Requests\"\r\n            /> : \"\" }\r\n          </Grid>\r\n          <Grid item>\r\n            <div className=\"float-right\">\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"w-200\"\r\n                disabled={this.state.waiting}\r\n                onClick={this.onSubmit}\r\n                type=\"submit\"\r\n              >\r\n                {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                style={{ marginLeft: \"4px\" }}\r\n                disabled={this.state.waiting}\r\n                onClick={_ => {\r\n                  this.setState({\r\n                    redirectTo: this.state._id === null ? `/` : `/world/details/${this.state._id}`\r\n                  });\r\n                }}\r\n                type=\"button\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst WorldEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default WorldEditPage;","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Button,\r\n  Grid\r\n} from \"@material-ui/core\";\r\nimport LoginControl from '../User/LoginControl';\r\nimport {\r\n  setWorlds\r\n} from \"../../redux/actions/index\";\r\nimport API from '../../api';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    setWorlds: worlds => dispatch(setWorlds(worlds))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      worldID: null,\r\n      collabID: null,\r\n      codeValid: false,\r\n      accepted: null,\r\n      message: \"Please wait.  Validating code.\",\r\n      world: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  accept = () => {\r\n    if (this.props.user === null) {\r\n      this.setState({waiting: false, accepted: true});\r\n    }\r\n    else {\r\n      this.setState({waiting: true},\r\n        this.submitAccept\r\n      );\r\n    }\r\n  }\r\n\r\n  submitAccept = () => {\r\n    this.api.acceptCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: true}, this.getWorlds);\r\n    });\r\n  }\r\n\r\n  getWorlds = () => {\r\n    this.api.getWorldsForUser().then(res => {\r\n      if (res.worlds !== undefined) this.props.setWorlds(res.worlds);\r\n    });\r\n  }\r\n\r\n  onLoginAccept = (user) => {\r\n    this.setState({waiting: true},\r\n      this.submitAccept\r\n    );\r\n  }\r\n\r\n  decline = () => {\r\n    this.setState({waiting: true},\r\n      this.submitDecline\r\n    );\r\n  }\r\n\r\n  submitDecline = () => {\r\n    this.api.declineCollabInvite(this.state.worldID, this.state.collabID).then(res => {\r\n      this.setState({waiting: false, accepted: false});\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.collabID === null) {\r\n      const { worldID, collabID } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkCollabID(worldID, collabID).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({collabID, worldID, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({collabID, worldID, world: res.world, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      if (this.state.accepted === null) {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              <h2>You've been invited to collaborate on {this.state.world.Name}</h2>\r\n            </Grid>\r\n            <Grid item xs={12} container spacing={1}>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.accept}\r\n                  type=\"button\">\r\n                  Accept\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button className=\"w-200\" \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={this.state.waiting}\r\n                  onClick={this.decline}\r\n                  type=\"button\">\r\n                  Decline\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n      else if (this.state.accepted) {\r\n        if (this.props.user === null) {\r\n          return (\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <h2>Please log in (or register and then log in if you're new) so we can add you as a collaborator on {this.state.world.Name}.</h2>\r\n              </Grid>\r\n              <Grid item>\r\n                <LoginControl onLogin={this.onLoginAccept}/>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n        else {\r\n          return (\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={12}>\r\n                <h2>Congratulations! You can now collaborate on {this.state.world.Name}</h2>\r\n              </Grid>\r\n            </Grid>\r\n          );\r\n        }\r\n      }\r\n      else {\r\n        return (\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={12}>\r\n              Okay.  Well, we hope you enjoy working on other worlds.\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      }\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>{this.state.message}</h2>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst CollaboratePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default CollaboratePage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateWorld, selectWorld\r\n} from \"../../redux/actions/index\";\r\nimport { Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Grid, \r\n  ListItem, ListItemText, \r\n  Tooltip, Fab, AppBar, Tabs, Tab, Box, \r\n  InputAdornment, IconButton,\r\n  Select, MenuItem\r\n} from \"@material-ui/core\";\r\nimport { Add, ArrowBack, FileCopyOutlined, Delete } from \"@material-ui/icons\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a World.  It will allow the use of Template Worlds\r\n  which come with preloaded Template Types.\r\n*/\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index } = props;\r\n\r\n  return (\r\n    <div>{value === index && <Box p={3}>{children}</Box>}</div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    worlds: state.app.worlds,\r\n    user: state.app.user\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateWorld: world => dispatch(updateWorld(world)),\r\n    selectWorld: worldID => dispatch(selectWorld(worldID)),\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Collaborators: [],\r\n      allUsers: null,\r\n      fieldValidation: {\r\n        inviteEmail: { valid: true, message: \"\" }\r\n      },\r\n      message: \"\",\r\n      redirectTo: null,\r\n      newCollaborators: false,\r\n      newCollabTab: 0,\r\n      collabTab: 0,\r\n      collabLink: null,\r\n      collabLinkCopied: false,\r\n      selectedUser: \"\",\r\n      inviteEmail: \"\",\r\n      inviteMessage: \"\", \r\n      waiting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      const { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        const { id } = this.props.match.params;\r\n        let world = this.props.worlds.filter(w => w._id === id);\r\n        if (world.length > 0) {\r\n          world = world[0];\r\n          this.setState({\r\n            Name: world.Name,\r\n            Public: world.Public,\r\n            AcceptingCollaborators: world.AcceptingCollaborators === undefined || world.AcceptingCollaborators === null ? false : world.AcceptingCollaborators,\r\n            Collaborators: world.Collaborators === undefined ? [] : world.Collaborators,\r\n            _id: id\r\n          });\r\n          this.api.selectWorld(id);\r\n          this.props.selectWorld(id);\r\n        }\r\n      } else {\r\n        this.api.selectWorld(null);\r\n        this.props.selectWorld(null);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  a11yProps = (index) => {\r\n    return {\r\n      id: `simple-tab-${index}`,\r\n      'aria-controls': `simple-tabpanel-${index}`,\r\n    };\r\n  }\r\n\r\n  validateField = fieldName => {\r\n    let value = this.state[fieldName];\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"inviteEmail\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  addNewCollaborator = () => {\r\n    function respond() {\r\n      this.api.addNewCollaborator(this.props.selectedWorldID, this.state.selectedUser._id, this.state.selectedUser.email).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, \r\n            inviteMessage: \"Invite Sent\",\r\n            selectedUser: \"\",\r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  emailCollaborator = () => {\r\n    const emailValid = this.validateField(\"inviteEmail\");\r\n    if (emailValid) {\r\n      function respond() {\r\n        this.api.emailCollaborator(this.props.selectedWorldID, this.state.inviteEmail).then(res => {\r\n          if (res.error === undefined) {\r\n            const collabs = [...this.state.Collaborators];\r\n            collabs.push(res);\r\n            const world = this.props.selectedWorld;\r\n            world.Collaborators = collabs;\r\n            this.props.updateWorld(world);\r\n            this.setState({\r\n              Collaborators: collabs, \r\n              inviteMessage: \"Email Sent\", \r\n              inviteEmail: \"\",\r\n              waiting: false\r\n            });\r\n          }\r\n          else {\r\n            this.setState({message: res.error, waiting: false});\r\n          }\r\n        });\r\n      }\r\n      this.setState({waiting: true}, respond);\r\n    }\r\n  }\r\n\r\n  updateCollaboratorPermission = (collaborator, permission) => {\r\n    collaborator.editPermission = permission;\r\n    function respond() {\r\n      this.api.updateCollaboratorPermission(this.props.selectedWorldID, collaborator.collabID, permission).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          const collab = collabs.filter(c=>c.collabID === collaborator.collabID)[0];\r\n          collab.editPermission = permission;\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            Collaborators: collabs, waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Creates a collab invite on the world, but no user or email associated\r\n  generateCollabLink = () => {\r\n    function respond() {\r\n      this.api.generateCollabLink(this.props.selectedWorldID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = [...this.state.Collaborators];\r\n          collabs.push(res);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  deleteCollab = (collab) => {\r\n    function respond() {\r\n      this.api.deleteCollab(this.props.selectedWorldID, collab.collabID).then(res => {\r\n        if (res.error === undefined) {\r\n          const collabs = this.state.Collaborators.filter(c=>c.collabID !== collab.collabID);\r\n          const world = this.props.selectedWorld;\r\n          world.Collaborators = collabs;\r\n          this.props.updateWorld(world);\r\n          this.setState({\r\n            collabLink: res.collabLink, \r\n            collabLinkCopied: false,\r\n            Collaborators: collabs, \r\n            waiting: false\r\n          });\r\n        }\r\n        else {\r\n          this.setState({message: res.error, waiting: false});\r\n        }\r\n      });\r\n    }\r\n    this.setState({waiting: true}, respond);\r\n  }\r\n\r\n  // Copies the collaborator link to the user's clipboard\r\n  copyCollabLink = () => {\r\n    const el = this.generatedLink;\r\n    const textarea = el.children[0];\r\n    textarea.select();\r\n    document.execCommand(\"copy\");\r\n    this.setState({collabLinkCopied: true});\r\n  }\r\n\r\n  render() {\r\n    if (this.state.allUsers === null) {\r\n      this.api.getAllUsers().then(res => {\r\n        this.setState({allUsers: res});\r\n      });\r\n      return (<div></div>);\r\n    }\r\n    else if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && (this.props.user === null || this.props.selectedWorld.Owner !== this.props.user._id)) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const collabs = this.state.Collaborators.filter(c=>c.type===\"collab\");\r\n      const invites = this.state.Collaborators.filter(c=>c.type===\"invite\");\r\n      const requests = this.state.Collaborators.filter(c=>c.type===\"request\");\r\n      const selectUsers = this.state.allUsers.filter(u=>u._id !== this.props.selectedWorld.Owner && this.state.Collaborators.filter(c=>c.userID === u._id).length === 0);\r\n      const userMenuItems = selectUsers.map((u, i) => {\r\n        return (\r\n          <MenuItem key={i} value={u}>\r\n            {u.username}\r\n          </MenuItem>\r\n        );\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          <Helmet>\r\n            <title>{ this.state._id === null ? `Author's Notebook: Create New World` : `Author's Notebook: Edit ${this.props.selectedWorld.Name} Collaborators` }</title>\r\n          </Helmet>\r\n          <Grid item container spacing={1} direction=\"row\">\r\n            <Grid item xs={1}>\r\n              <Tooltip title={`Back to ${this.props.selectedWorld.Name} Details`}>\r\n                <Fab size=\"small\"\r\n                  color=\"primary\"\r\n                  onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                >\r\n                  <ArrowBack />\r\n                </Fab>\r\n              </Tooltip>\r\n            </Grid>\r\n            <Grid item xs={11}>\r\n              <h2>Edit Collaborators</h2>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item>\r\n            <ListItem style={{maxWidth: \"200px\"}}>\r\n              <ListItemText primary=\"Collaborators\" />\r\n              { this.state.newCollaborators ?\r\n                <Tooltip title={`Manage Existing Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: false });\r\n                    }}\r\n                  >\r\n                    <ArrowBack />\r\n                  </Fab>\r\n                </Tooltip>  :\r\n                <Tooltip title={`Add New Collaborators`}>\r\n                  <Fab\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={_ => {\r\n                      this.setState({ newCollaborators: true });\r\n                    }}\r\n                  >\r\n                    <Add />\r\n                  </Fab>\r\n                </Tooltip> \r\n              }\r\n            </ListItem>\r\n          </Grid>\r\n          { this.state.newCollaborators ?\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.newCollabTab} onChange={(_, newValue) => { this.setState({newCollabTab: newValue, inviteMessage: \"\"})}} aria-label=\"Add Collaborator Method\">\r\n                    <Tab label=\"Find Existing User\" {...this.a11yProps(0)} />\r\n                    <Tab label=\"Invite via Email\" {...this.a11yProps(1)} />\r\n                    <Tab label=\"Get an Invite Link\" {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.newCollabTab} index={0}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"user-select\" id=\"user-select-label\">\r\n                          Select a User\r\n                        </InputLabel>\r\n                        <Select\r\n                          labelId=\"user-select-label\"\r\n                          id=\"user-select\"\r\n                          value={this.state.selectedUser}\r\n                          onChange={e => {\r\n                            this.setState({selectedUser: e.target.value, inviteMessage: \"\" })\r\n                          }}\r\n                          labelWidth={90}\r\n                        >\r\n                          {userMenuItems}\r\n                        </Select>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.selectedUser === \"\" || this.state.waiting}\r\n                        onClick={this.addNewCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={1}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel htmlFor=\"inviteEmail\">Collaborator Email</InputLabel>\r\n                        <OutlinedInput\r\n                          id=\"inviteEmail\"\r\n                          name=\"inviteEmail\"\r\n                          type=\"email\"\r\n                          autoComplete=\"Off\"\r\n                          error={!this.state.fieldValidation.inviteEmail.valid}\r\n                          value={this.state.inviteEmail}\r\n                          onChange={this.handleUserInput}\r\n                          onBlur={this.inputBlur}\r\n                          labelWidth={140}\r\n                          fullWidth\r\n                        />\r\n                        <FormHelperText>\r\n                          {this.state.fieldValidation.inviteEmail.message}\r\n                        </FormHelperText>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.emailCollaborator}\r\n                      >\r\n                        Send Invite\r\n                      </Button> \r\n                      { this.state.inviteMessage }\r\n                    </Grid>\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.newCollabTab} index={2}>\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Generate a single use link to send someone yourself\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={this.state.waiting}\r\n                        onClick={this.generateCollabLink}\r\n                      >\r\n                        Generate Link\r\n                      </Button> \r\n                    </Grid>\r\n                      { this.state.collabLink !== null && \r\n                        <Grid item>\r\n                          <OutlinedInput\r\n                            id=\"generatedLink\"\r\n                            name=\"generatedLink\"\r\n                            ref={(input) => this.generatedLink = input}\r\n                            type=\"text\"\r\n                            multiline={true}\r\n                            value={this.state.collabLink}\r\n                            // disabled={true}\r\n                            endAdornment={\r\n                              <InputAdornment position=\"end\">\r\n                                <IconButton\r\n                                  aria-label=\"copy to clipboard\"\r\n                                  onClick={this.copyCollabLink}\r\n                                  edge=\"end\"\r\n                                >\r\n                                  <FileCopyOutlined />\r\n                                </IconButton>\r\n                              </InputAdornment>\r\n                            }\r\n                            labelWidth={70}\r\n                            fullWidth\r\n                          />\r\n                          { this.state.collabLinkCopied && \r\n                            <span style={{fontColor: \"red\"}}>\r\n                              Link Copied to Clipboard\r\n                            </span>\r\n                          }\r\n                        </Grid>\r\n                      }\r\n                  </Grid>\r\n                  \r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid> :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <AppBar position=\"static\">\r\n                  <Tabs value={this.state.collabTab} onChange={(_, newValue) => { this.setState({collabTab: newValue})}} aria-label=\"Collaborators\">\r\n                    <Tab label={`Collaborators (${collabs.length})`} {...this.a11yProps(0)} />\r\n                    <Tab label={`Invites (${invites.length})`} {...this.a11yProps(1)} />\r\n                    <Tab label={`Requests (${requests.length})`} {...this.a11yProps(2)} />\r\n                  </Tabs>\r\n                </AppBar>\r\n                <TabPanel value={this.state.collabTab} index={0}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { collabs.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={3}>\r\n                            {this.state.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <FormControlLabel\r\n                              control={\r\n                                <Checkbox \r\n                                  checked={c.editPermission} \r\n                                  disabled={this.state.waiting}\r\n                                  onChange={e => {\r\n                                    this.updateCollaboratorPermission(c, e.target.checked);\r\n                                  }}\r\n                                  color=\"primary\" />\r\n                              }\r\n                              label=\"Full Permissions\"\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Remove Collaborator`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={1}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { invites.map((c, key) => {\r\n                      let user = this.state.allUsers.filter(u=>u._id === c.userID);\r\n                      if (user.length === 0)\r\n                        user = null;\r\n                      else {\r\n                        user = user[0];\r\n                      }\r\n                      return (\r\n                        <Grid item container spacing={1} direction=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={9} container spacing={1} direction=\"column\">\r\n                            { user !== null &&\r\n                              <Grid item>\r\n                                Username: {user.username}\r\n                              </Grid>\r\n                            }\r\n                            { c.email !== \"\" &&\r\n                              <Grid item>\r\n                                Email: {c.email}\r\n                              </Grid>\r\n                            }\r\n                            <Grid item>\r\n                              Invite Link: {c.collabLink}\r\n                            </Grid>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Invite`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>  \r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n                <TabPanel value={this.state.collabTab} index={2}>\r\n                  <Grid container spacing={3} direction=\"column\">\r\n                    { requests.map((c, key) => {\r\n                      return (\r\n                        <Grid item container spacing={1} direcion=\"row\" key={key}>\r\n                          <Grid item xs={12} sm={9}>\r\n                            {this.state.allUsers.filter(u=>u._id === c.userID)[0].username}\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={3}>\r\n                            <Tooltip title={`Delete Request`}>\r\n                              <Fab size=\"small\"\r\n                                color=\"primary\"\r\n                                disabled={this.state.waiting}\r\n                                onClick={e => {this.deleteCollab(c)}}\r\n                              >\r\n                                <Delete />\r\n                              </Fab>\r\n                            </Tooltip>\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })}\r\n                  </Grid>\r\n                </TabPanel>\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          <Grid item>{this.state.message}</Grid>\r\n          <Grid item>\r\n            {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (\r\n                this.state.fieldValidation[fieldName] !== undefined &&\r\n                this.state.fieldValidation[fieldName].message.length > 0\r\n              ) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })}\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst EditCollaboratorPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default EditCollaboratorPage;","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  setTypes,\r\n  setAttributes\r\n} from \"../../redux/actions/index\";\r\nimport { Edit, Delete, Add, ArrowBack } from \"@material-ui/icons\";\r\nimport { Fab, Modal, Grid, Button, Tooltip, List, ListItem, ListItemText } from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  const type = state.app.selectedType;\r\n  const subTypes =\r\n    type === null\r\n      ? []\r\n      : state.app.types.filter(t => t.SuperIDs.includes(type._id));\r\n  const things =\r\n    type === null\r\n      ? []\r\n      : state.app.things.filter(t => t.TypeIDs.includes(type._id));\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: type,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    subTypes: subTypes,\r\n    instances: things,\r\n    user: state.app.user,\r\n    things: state.app.things,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName,\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    setTypes: types => dispatch(setTypes(types)),\r\n    setAttributes: attributes => dispatch(setAttributes(attributes))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Supers: [],\r\n      Major: false,\r\n      Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n    // load();\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteType(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      const types = this.props.types.filter(t=>t._id!==this.state._id);\r\n      this.props.setTypes(types);\r\n      this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    // const { id } = this.props.match.params;\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (id !== undefined) { // When I move to storing more in session, this is the kind of place where I'll check.\r\n      this.api.getType(this.props.selectedWorldID, id).then(res => {\r\n        if (res.error === undefined) {\r\n          res.Supers = [];\r\n          res.SuperIDs.forEach(sID=> {\r\n            res.Supers = res.Supers.concat(this.props.types.filter(t2=>t2._id === sID));\r\n          });\r\n          res.AttributesArr = [];\r\n          res.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            res.AttributesArr.push({\r\n              index: res.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID\r\n            });\r\n          });\r\n          const defHash = {};\r\n          if (res.Defaults !== undefined) {\r\n            res.Defaults.forEach(def => {\r\n              defHash[def.attrID] = def;\r\n            });\r\n          }\r\n          res.DefaultsHash = defHash;\r\n          this.setState({\r\n            Name: res.Name,\r\n            Description: res.Description,\r\n            _id: id,\r\n            Supers: res.Supers,\r\n            Major: res.Major\r\n          });\r\n          this.props.updateSelectedType(res);\r\n        }\r\n        else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    } else {\r\n      this.props.updateSelectedType({\r\n        _id: null,\r\n        Name: \"\",\r\n        Description: \"\",\r\n        Supers: [],\r\n        AttributesArr: [],\r\n        Attributes: [],\r\n        Major: false\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else if (this.props.selectedType === undefined || this.props.selectedType === null) {\r\n      return (<span>Loading</span>);\r\n    } else {\r\n      const references = this.props.types.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      const inheritedAttributes = [];\r\n      this.props.selectedType.Supers.forEach(superType => {\r\n        superType.AttributesArr.forEach(attribute => {\r\n          if (inheritedAttributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n        });\r\n      });\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={5}>\r\n                  <h2>{this.state.Name}</h2>\r\n                </Grid>\r\n                <Grid item sm={3} xs={6}>\r\n                  <h3>{this.state.Major ? \"Major Type\" : \"\"}</h3>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Create New ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/create/type_id_${this.state._id}`})}}\r\n                          >\r\n                            <Add />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/type/edit/${this.state._id}`})}}\r\n                          >\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                  </List>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n                  <Grid item>{this.state.Description}</Grid>\r\n                  <Grid item>\r\n                    Attributes\r\n                    <List>\r\n                      { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n                        inheritedAttributes.map((attribute, i) => {\r\n                          let definedType = this.props.types.filter(t=>t._id === attribute.DefinedType);\r\n                          definedType = definedType.length === 0 ? {Name:\"\"} : definedType[0];\r\n                          const def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <ListItemText>\r\n                                {attribute.Name}:&nbsp;\r\n                                {attribute.AttributeType === \"Options\" ? (\r\n                                  <span>\r\n                                    Options:\r\n                                    {attribute.Options.map((option, j) => {\r\n                                      return (\r\n                                        <span key={j}>\r\n                                          {j === 0 ? \" \" : \", \"}\r\n                                          {option}\r\n                                        </span>\r\n                                      );\r\n                                    })}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    }\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"Type\" ? (\r\n                                  <span>\r\n                                    <Button\r\n                                      variant=\"contained\"\r\n                                      color=\"primary\"\r\n                                      onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                    >\r\n                                      <ListItemText primary={definedType.Name}/>\r\n                                    </Button>\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${this.props.things.filter(t=>t._id === def.DefaultValue)[0].Name})`\r\n                                    }\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"List\" ? (\r\n                                  <span>\r\n                                    List:&nbsp;\r\n                                    {attribute.ListType === \"Options\" ? (\r\n                                      <span>\r\n                                        Options:\r\n                                        {attribute.Options.map((option, j) => {\r\n                                          return (\r\n                                            <span key={j}>\r\n                                              {j === 0 ? \" \" : \", \"}\r\n                                              {option}\r\n                                            </span>\r\n                                          );\r\n                                        })}\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {defaultValue}\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    ) : attribute.ListType === \"Type\" ? (\r\n                                      <span>\r\n                                        <Button\r\n                                          variant=\"contained\"\r\n                                          color=\"primary\"\r\n                                          onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                        >\r\n                                          <ListItemText primary={definedType.Name}/>\r\n                                        </Button>\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {attribute.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  <Button\r\n                                                    variant=\"contained\"\r\n                                                    color=\"primary\"\r\n                                                    onClick={ _ => {this.setState({redirectTo:`/thing/details/${defaultValue}`})}}\r\n                                                  >\r\n                                                    <ListItemText primary={this.props.things.filter(t=>t._id === defaultValue)[0].Name}/>\r\n                                                  </Button>\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    ) : (\r\n                                      <span>\r\n                                        {attribute.ListType}\r\n                                        { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                          <span>\r\n                                            &nbsp;(Defaults:\r\n                                            {def.DefaultListValues.map((defaultValue, j) => {\r\n                                              return (\r\n                                                <span key={j}>\r\n                                                  {j === 0 ? \" \" : \", \"}\r\n                                                  {defaultValue}\r\n                                                </span>\r\n                                              );\r\n                                            })}\r\n                                            )\r\n                                          </span>\r\n                                        }\r\n                                      </span>\r\n                                    )}\r\n                                  </span>\r\n                                ) : attribute.AttributeType === \"True/False\" ? (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" ?\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    : \" (Default: False)\"}\r\n                                  </span>\r\n                                ) : (\r\n                                  <span>\r\n                                    {attribute.AttributeType}\r\n                                    { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                      ` (Default: ${def.DefaultValue})`\r\n                                    }\r\n                                  </span>\r\n                                )}\r\n                              </ListItemText>\r\n                            </ListItem>\r\n                          );\r\n                        })\r\n                      }\r\n                      { this.props.selectedType !== null &&\r\n                        this.props.selectedType !== undefined && \r\n                          this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                            let definedType = this.props.types.filter(t=>t._id === attribute.DefinedType);\r\n                            definedType = definedType.length === 0 ? {Name:\"\"} : definedType[0];\r\n                            const def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                            return (\r\n                              <ListItem key={i}>\r\n                                <ListItemText>\r\n                                  {attribute.Name}:&nbsp;\r\n                                  {attribute.AttributeType === \"Options\" ? (\r\n                                    <span>\r\n                                      Options:\r\n                                      {attribute.Options.map((option, j) => {\r\n                                        return (\r\n                                          <span key={j}>\r\n                                            {j === 0 ? \" \" : \", \"}\r\n                                            {option}\r\n                                          </span>\r\n                                        );\r\n                                      })}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      }\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"Type\" ? (\r\n                                    <span>\r\n                                      <Button\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                        onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                      >\r\n                                        <ListItemText primary={definedType.Name}/>\r\n                                      </Button>\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${this.props.things.filter(t=>t._id === def.DefaultValue)[0].Name})`\r\n                                      }\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"List\" ? (\r\n                                    <span>\r\n                                      List:&nbsp;\r\n                                      {attribute.ListType === \"Options\" ? (\r\n                                        <span>\r\n                                          Options:\r\n                                          {attribute.Options.map((option, j) => {\r\n                                            return (\r\n                                              <span key={j}>\r\n                                                {j === 0 ? \" \" : \", \"}\r\n                                                {option}\r\n                                              </span>\r\n                                            );\r\n                                          })}\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    {defaultValue}\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      ) : attribute.ListType === \"Type\" ? (\r\n                                        <span>\r\n                                          <Button\r\n                                            variant=\"contained\"\r\n                                            color=\"primary\"\r\n                                            onClick={ _ => {this.setState({redirectTo:`/type/details/${attribute.DefinedType}`})}}\r\n                                          >\r\n                                            <ListItemText primary={definedType.Name}/>\r\n                                          </Button>\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {attribute.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    <Button\r\n                                                      variant=\"contained\"\r\n                                                      color=\"primary\"\r\n                                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${defaultValue}`})}}\r\n                                                    >\r\n                                                      <ListItemText primary={this.props.things.filter(t=>t._id === defaultValue)[0].Name}/>\r\n                                                    </Button>\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      ) : (\r\n                                        <span>\r\n                                          {attribute.ListType}\r\n                                          { def !== undefined && def.DefaultListValues !== undefined && def.DefaultListValues.length > 0 &&\r\n                                            <span>\r\n                                              &nbsp;(Defaults:\r\n                                              {def.DefaultListValues.map((defaultValue, j) => {\r\n                                                return (\r\n                                                  <span key={j}>\r\n                                                    {j === 0 ? \" \" : \", \"}\r\n                                                    {defaultValue}\r\n                                                  </span>\r\n                                                );\r\n                                              })}\r\n                                              )\r\n                                            </span>\r\n                                          }\r\n                                        </span>\r\n                                      )}\r\n                                    </span>\r\n                                  ) : attribute.AttributeType === \"True/False\" ? (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" ?\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      : \" (Default: False)\"}\r\n                                    </span>\r\n                                  ) : (\r\n                                    <span>\r\n                                      {attribute.AttributeType}\r\n                                      { def !== undefined && def.DefaultValue !== undefined && def.DefaultValue !== \"\" &&\r\n                                        ` (Default: ${def.DefaultValue})`\r\n                                      }\r\n                                    </span>\r\n                                  )}\r\n                                </ListItemText>\r\n                              </ListItem>\r\n                            );\r\n                          })\r\n                      }\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n                  {this.state.Supers.length === 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Super Types\"} />\r\n                        </ListItem>\r\n                        {this.state.Supers.map((superType, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${superType._id}`})}}\r\n                              >\r\n                                <ListItemText primary={superType.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.subTypes.length === 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Sub Types\"} />\r\n                        </ListItem>\r\n                        {this.props.subTypes.map((sub, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${sub._id}`})}}\r\n                              >\r\n                                <ListItemText primary={sub.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {references.length !== 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {this.props.instances.length === 0 && (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Instances\"} />\r\n                        </ListItem>\r\n                        {this.props.instances.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-type-modal\"\r\n                aria-describedby=\"delete-type-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.state.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport DeleteForever from \"@material-ui/icons/DeleteForever\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ChipInput from \"material-ui-chip-input\";\r\n\r\nconst handleTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"AttributeType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleDefinedTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond(newType) {\r\n      attr[\"DefinedType\"] = newType._id;\r\n      props.onChange(attr);\r\n    }\r\n    props.onNewType(respond);\r\n  }\r\n  else \r\n    props.onChange(attr);\r\n};\r\n\r\nconst handleListTypeChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr[\"ListType\"] = e.target.value;\r\n  props.onChange(attr);\r\n};\r\n\r\nconst handleOptionsChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.Options = e;\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [name, changeName] = useState(props.attribute.Name);\r\n\r\n  const attributeTypes = [\r\n    \"Text\",\r\n    \"Number\",\r\n    \"True/False\",\r\n    \"Options\", \r\n    \"Type\", \r\n    \"List\"\r\n  ];\r\n  const listTypes = [\r\n    \"Text\",\r\n    \"Options\", \r\n    \"Type\"\r\n  ];\r\n\r\n  const selectedType =\r\n    props.attribute.AttributeType === undefined || props.attribute.AttributeType === null || props.attribute.AttributeType === \"\" ? attributeTypes[0] : props.attribute.AttributeType;\r\n\r\n  const selectedListType =\r\n    props.attribute.ListType === undefined || props.attribute.ListType === \"\" ? listTypes[0] : props.attribute.ListType;\r\n\r\n  const selectedDefinedType =\r\n    props.attribute.DefinedType === undefined || props.attribute.DefinedType === \"\" ? \"\" : props.attribute.DefinedType;\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}>Name</InputLabel>\r\n          <OutlinedInput\r\n            disabled={props.disabled}\r\n            id={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            name={`AttrName_${props.attribute.attrID}_${props.attribute.index}`}\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={name}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeName(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = props.attribute;\r\n              attr.Name = name;\r\n              // const attr = {\r\n              //   index: props.attribute.index,\r\n              //   Name: name,\r\n              //   Type: props.attribute.AttributeType,\r\n              //   Options: props.attribute.Options,\r\n              //   ListType: props.attribute.ListType,\r\n              //   FromSupers: props.attribute.FromSupers,\r\n              //   DefinedType: props.attribute.DefinedType,\r\n              //   AttributeTypes: props.attribute.AttributeTypes,\r\n              //   DefaultValue: defaultValue,\r\n              //   DefaultListValues: defaultListValues\r\n              // };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={43}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"attribute-type\" id=\"attribute-type-label\">\r\n            Attribute Type\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"attribute-type-label\"\r\n            id=\"attribute-type\"\r\n            disabled={props.disabled}\r\n            // disabled={props.attribute.FromSupers.length > 0} \r\n            value={selectedType}\r\n            onChange={e => {handleTypeChange(e, props)}}\r\n            fullWidth\r\n            labelWidth={100}\r\n          >\r\n            {attributeTypes.map((type, i) => {\r\n              return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n          {selectedType === \"Options\" ? (\r\n            <ChipInput\r\n              variant=\"outlined\"\r\n              disabled={props.disabled}\r\n              // disabled={props.attribute.FromSupers.length > 0}\r\n              defaultValue={props.attribute.Options}\r\n              onChange={chips => handleOptionsChange(chips, props)}\r\n            />\r\n          ) : selectedType === \"Type\" ? (\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                Defined Type\r\n              </InputLabel>\r\n              <Select\r\n                labelId=\"definedType-label\"\r\n                id=\"definedType\"\r\n                disabled={props.disabled}\r\n                // disabled={props.attribute.FromSupers.length > 0} \r\n                value={selectedDefinedType}\r\n                onChange={e => {handleDefinedTypeChange(e, props)}}\r\n                fullWidth\r\n                labelWidth={100}\r\n              >\r\n                <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                {props.types.map((type, i) => {\r\n                  return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                })}\r\n              </Select>\r\n            </FormControl>\r\n          ) : selectedType === \"List\" ? (\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"list-type\" id=\"list-type-label\">\r\n                    List Type\r\n                  </InputLabel>\r\n                  <Select\r\n                    labelId=\"list-type-label\"\r\n                    id=\"list-type\"\r\n                    disabled={props.disabled}\r\n                    // disabled={props.attribute.FromSupers.length > 0} \r\n                    value={selectedListType}\r\n                    onChange={e => {handleListTypeChange(e, props)}}\r\n                    fullWidth\r\n                    labelWidth={70}\r\n                  >\r\n                    {listTypes.map((type, i) => {\r\n                      return (<MenuItem key={i} value={type}>{type}</MenuItem>);\r\n                    })}\r\n                  </Select>\r\n                </FormControl>\r\n              </Grid>\r\n              { props.attribute.ListType === \"Type\" ? \r\n                (\r\n                  <Grid item>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"definedType\" id=\"definedType-label\">\r\n                        Defined Type\r\n                      </InputLabel>\r\n                      <Select\r\n                        labelId=\"definedType-label\"\r\n                        id=\"definedType\"\r\n                        disabled={props.disabled}\r\n                        // disabled={props.attribute.FromSupers.length > 0} \r\n                        value={selectedDefinedType}\r\n                        onChange={e => {handleDefinedTypeChange(e, props)}}\r\n                        fullWidth\r\n                        labelWidth={100}\r\n                      >\r\n                        <MenuItem value=\"new\">+ Create New Type</MenuItem>\r\n                        {props.types.map((type, i) => {\r\n                          return (<MenuItem key={i} value={type._id}>{type.Name}</MenuItem>);\r\n                        })}\r\n                      </Select>\r\n                    </FormControl>\r\n                  </Grid>\r\n                ) : props.attribute.ListType === \"Options\" ?\r\n                (\r\n                  <Grid item>\r\n                    <ChipInput\r\n                      variant=\"outlined\"\r\n                      disabled={props.disabled}\r\n                      // disabled={props.attribute.FromSupers.length > 0}\r\n                      defaultValue={props.attribute.Options}\r\n                      onChange={chips => handleOptionsChange(chips, props)}\r\n                    />\r\n                  </Grid>\r\n                ) : \"\"\r\n              }\r\n            </Grid>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </Grid>\r\n      <Grid item sm={3} xs={12}>\r\n        <Button\r\n          variant=\"contained\" color=\"primary\"\r\n          className=\"w200\" fullWidth\r\n          disabled={props.disabled}\r\n          // disabled={props.attribute.FromSupers.length > 0}\r\n          onClick={_ => props.onDelete(props.attribute)}\r\n          type=\"submit\"\r\n        >\r\n          <DeleteForever />\r\n        </Button>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = e;\r\n  props.onChange(def);\r\n};\r\nconst handleDefinedTypeChange = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond2(newThing) {\r\n      // attr[\"DefinedType\"] = newType._id;\r\n      // props.onChange(attr);\r\n      respond(newThing._id);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues.push(selectedItem.Name);\r\n  props.onChange(def);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o.Name);\r\n  });\r\n  props.onChange(def);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    function respond2(newThing) {\r\n      const def = props.def;\r\n      def.DefaultListValues.push(newThing._id);\r\n      props.onChange(def);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    const def = props.def;\r\n    def.DefaultListValues.push(selectedItem._id);\r\n    props.onChange(def);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const def = props.def;\r\n  def.DefaultListValues = [];\r\n  selectedList.forEach(o => {\r\n    def.DefaultListValues.push(o._id);\r\n  });\r\n  props.onChange(def);\r\n};\r\n\r\nexport default function AttributeDefaultControl(props) {\r\n  // I'm passing in attribute and def.\r\n  const [value, changeValue] = useState(props.def.DefaultValue);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n  \r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.def.DefaultListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n    props.things\r\n      .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n      .forEach(t => {\r\n        listOptions.push({ Name: t.Name, _id: t._id });\r\n      });\r\n    listOptions\r\n      .filter(t => props.def.DefaultListValues.includes(t._id))\r\n      .forEach(t => {\r\n        listOptionValues.push(t);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={1} direction=\"row\">\r\n      <Grid item xs={12}>\r\n        {attributeType === \"Text\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"textField\">{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id=\"textField\"\r\n              name=\"textField\"\r\n              type=\"text\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"Number\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"numField\">{props.attribute.Name} Default Value</InputLabel>\r\n            <OutlinedInput\r\n              id=\"numField\"\r\n              name=\"numField\"\r\n              type=\"number\"\r\n              error={props.error}\r\n              value={value}\r\n              autoComplete=\"off\"\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n              fullWidth\r\n            />\r\n            <FormHelperText>{props.message}</FormHelperText>\r\n          </FormControl>\r\n        ) : attributeType === \"True/False\" ? (\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox checked={props.def.DefaultValue===\"True\"} onChange={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = e.target.checked ? \"True\" : \"False\";\r\n                props.onChange(def);\r\n              }}\r\n              color=\"primary\" />\r\n            }\r\n            label={`${props.attribute.Name} Default True`}\r\n          />\r\n        ) : attributeType === \"Options\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"options-select-label\"\r\n              id=\"options-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                changeValue(e.target.value);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              {props.attribute.Options.map((option, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={option}>\r\n                    {option}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"Type\" ? (\r\n          <FormControl variant=\"outlined\" fullWidth>\r\n            <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n              {props.attribute.Name} Default Value\r\n            </InputLabel>\r\n            <Select\r\n              labelId=\"type-select-label\"\r\n              id=\"type-select\"\r\n              value={value}\r\n              onChange={e => {\r\n                handleDefinedTypeChange(e, props, changeValue);\r\n              }}\r\n              onBlur={e => {\r\n                const def = props.def;\r\n                def.DefaultValue = value;\r\n                props.onChange(def);\r\n              }}\r\n              fullWidth\r\n              labelWidth={props.attribute.Name.length * 9 + 100}\r\n            >\r\n              <MenuItem value=\"new\">\r\n                + Create New{\" \"}\r\n                {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n              </MenuItem>\r\n              {props.things\r\n                .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n                .map((thing, i) => {\r\n                  return (\r\n                    <MenuItem key={i} value={thing._id}>\r\n                      {thing.Name}\r\n                    </MenuItem>\r\n                  );\r\n                })}\r\n            </Select>\r\n          </FormControl>\r\n        ) : attributeType === \"List\" ? (\r\n          <span>\r\n            {props.attribute.ListType === \"Text\" ? (\r\n              <ChipInput\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                variant=\"outlined\"\r\n                defaultValue={props.def.DefaultListValues}\r\n                onChange={chips => handleTextListChange(chips, props)}\r\n              />\r\n            ) : props.attribute.ListType === \"Options\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addOption(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeOption(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : props.attribute.ListType === \"Type\" ? (\r\n              <Multiselect\r\n                placeholder={`${props.attribute.Name} Default Values`}\r\n                options={listOptions}\r\n                selectedValues={listOptionValues}\r\n                onSelect={(_, selectedItem) => {\r\n                  addType(selectedItem, props);\r\n                }}\r\n                onRemove={(selectedList, _) => {\r\n                  removeType(selectedList, props);\r\n                }}\r\n                displayValue=\"Name\"\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport styled from \"styled-components\";\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport uuid from 'react-uuid';\r\nimport {\r\n  updateSelectedType,\r\n  // updateAttributesArr,\r\n  addType,\r\n  addThing\r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport AttributeDefaultControl from \"./AttributeDefaultControl\";\r\nimport API from \"../../api\";\r\n\r\nconst Label = styled(\"label\")`\r\n  padding: 0 0 4px;\r\n  line-height: 1.5;\r\n  display: block;\r\n`;\r\n\r\n// It will let you add and remove attributes.\r\n// Each needs to have a unique name as part of validation.\r\n// Each also needs to have a valid type.\r\n// The type can be string, integer, double, enum, any Type\r\n// already defined for this world, or a list of any of the\r\n// other types.\r\n// In future versions I will add support for additional types:\r\n// Color, DateTime, Schedule.\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedType: state.app.selectedType,\r\n    // attributesArr: state.app.attributesArr,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    // updateAttributesArr: arr => dispatch(updateAttributesArr(arr)),\r\n    addType: type => dispatch(addType(type)),\r\n    addThing: thing => dispatch(addThing(thing))\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      typeModalOpen: false,\r\n      thingModalOpen: false,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      defaultsMode: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const type = this.props.selectedType;\r\n    // type.AttributesArr.push({\r\n    //   index: type.AttributesArr.length,\r\n    //   _id: null,\r\n    //   Name: \"\",\r\n    //   AttributeType: \"Text\",\r\n    //   Options: [],\r\n    //   DefinedType: \"\",\r\n    //   ListType: \"\",\r\n    //   FromSupers: [],\r\n    //   AttributeTypes: [\"Text\", \"Number\", \"True/False\", \"Options\", \"Type\", \"List\"]\r\n    // });\r\n    type.AttributesArr.push({\r\n      index: type.AttributesArr.length,\r\n      attrID: `null_${uuid()}`,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"\",\r\n      // FromSuper: null,\r\n      // AttributeTypes: [\"Text\", \"Number\", \"True/False\", \"Options\", \"Type\", \"List\"]\r\n    });\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    // type.AttributesArr[value.index] = {\r\n    //   index: value.index,\r\n    //   _id: value._id,\r\n    //   Name: value.Name,\r\n    //   Attribute: value.AttributeType,\r\n    //   Options: value.Options,\r\n    //   DefinedType: value.DefinedType,\r\n    //   ListType: value.ListType,\r\n    //   FromSupers: value.FromSupers,\r\n    //   AttributeTypes: [\"Text\", \"Number\", \"True/False\", \"Options\", \"Type\", \"List\"],\r\n    //   DefaultValue: value.DefaultValue,\r\n    //   DefaultListValues: value.DefaultListValues\r\n    // };\r\n    type.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n      // FromSuper: value.FromSuper,\r\n      // AttributeTypes: [\"Text\", \"Number\", \"True/False\", \"Options\", \"Type\", \"List\"],\r\n      // DefaultValue: value.DefaultValue,\r\n      // DefaultListValues: value.DefaultListValues\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  changeDefault = value => {\r\n    const type = this.props.selectedType;\r\n    type.DefaultsHash[value.attrID] = {\r\n      attrID: value.attrID,\r\n      DefaultValue: value.DefaultValue,\r\n      DefaultListValues: value.DefaultListValues,\r\n      FromTypeID: value.FromTypeID\r\n    };\r\n    this.props.updateSelectedType(type);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttributeOld = value => {\r\n    const type = this.props.selectedType;\r\n    const attributesArr = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributesArr.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributesArr;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const type = this.props.selectedType;\r\n    const attributes = [];\r\n    type.AttributesArr.forEach(t => {\r\n      if (t.index !== value.index) {\r\n        if (t.index > value.index)\r\n          t.index--;\r\n        attributes.push(t);\r\n      }\r\n    });\r\n    type.AttributesArr = [];\r\n    let defaults = {...type.DefaultsHash};\r\n    if (defaults[value.attrID] !== undefined) {\r\n      delete defaults[value.attrID];\r\n    }\r\n    type.DefaultsHash = {};\r\n    this.props.updateSelectedType(type);\r\n    setTimeout(() => {\r\n      type.AttributesArr = attributes;\r\n      type.DefaultsHash = defaults;\r\n      this.props.updateSelectedType(type);\r\n    }, 500);\r\n  };\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  addNewType = (respond) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({typeModalOpen: true, modalSubmit: respond});\r\n  }\r\n\r\n  addNewThing = (respond, type) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({thingModalOpen: true, modalSubmit: respond, newThingType: type});\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          if (this.state.thingModalOpen) {\r\n            message = this.state.newThingType.Name + \" Name is too short\"\r\n          }\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewType = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const type = {\r\n      _id: null,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      SuperIDs: [],\r\n      AttributesArr: [],\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID,\r\n      Major: false\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createType(type)\r\n      .then(res => {\r\n        if (res.typeID !== undefined) {\r\n          type._id = res.typeID;\r\n          // Adds to props \r\n          this.props.addType(type);\r\n          // Calls respond back to Attribute to set the type\r\n          this.state.modalSubmit(type);\r\n          this.setState({\r\n            waiting: false, \r\n            typeModalOpen: false\r\n          });\r\n        }\r\n        else if (res.error !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.error \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThingThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThingThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      // AttributesArr: [],\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            thingModalOpen: false\r\n          });\r\n        }\r\n        else if (res.error !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.error \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    // I should move this somewhere else so it's not happening on every render.\r\n    const inheritedAttributes = [];\r\n    this.props.selectedType.SuperIDs.forEach(s => {\r\n      let superType = this.props.types.filter(t => t._id === s);\r\n      if (superType.length > 0) {\r\n        superType = superType[0];\r\n        superType.AttributesArr.forEach(attribute => {\r\n          if (inheritedAttributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n            inheritedAttributes.push(attribute);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    return (\r\n      <Grid item xs={12} container spacing={0} direction=\"column\">\r\n        <Grid item>\r\n          <Label>Attributes</Label>\r\n        </Grid>\r\n        <Grid item>\r\n          <List>\r\n            <ListItem>\r\n              <Grid container spacing={0} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button disabled={this.state.defaultsMode} variant=\"contained\" color=\"primary\" onClick={this.newAttribute}>\r\n                    <Add />\r\n                    <ListItemText primary={\"Create New\"} />\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button variant=\"contained\" color=\"primary\" onClick={e => { this.setState({defaultsMode: !this.state.defaultsMode}) }}>\r\n                    <ListItemText primary={ this.state.defaultsMode ? \"Set Attribute Types\" : \"Set Defaults\"} />\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </ListItem>\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              inheritedAttributes.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.state.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        disabled={true}\r\n                        attribute={attribute}\r\n                        // onChange={this.changeAttribute}\r\n                        // onDelete={this.deleteAttribute}\r\n                        // onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n            { this.props.selectedType !== null && this.props.selectedType !== undefined &&\r\n              this.props.selectedType.AttributesArr.map((attribute, i) => {\r\n                let def = this.props.selectedType.DefaultsHash[attribute.attrID];\r\n                if (def === undefined)\r\n                  def = { attrID: attribute.attrID, DefaultValue: \"\", DefaultListValues: [] };\r\n                \r\n                return (\r\n                  <ListItem key={i}>\r\n                    { this.state.defaultsMode ? \r\n                      <AttributeDefaultControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        def={def}\r\n                        onChange={this.changeDefault}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewThing={this.addNewThing}\r\n                      /> : \r\n                      <AttributeControl\r\n                        typeID={this.props.selectedType._id}\r\n                        attribute={attribute}\r\n                        onChange={this.changeAttribute}\r\n                        onDelete={this.deleteAttribute}\r\n                        onBlur={this.blurAttribute}\r\n                        types={this.props.types}\r\n                        things={this.props.things}\r\n                        onNewType={this.addNewType}\r\n                      /> \r\n                    }\r\n                  </ListItem>\r\n                );\r\n              })\r\n            }\r\n          </List>\r\n        </Grid>\r\n        <Modal\r\n          aria-labelledby=\"new-type-modal\"\r\n          aria-describedby=\"new-type-modal-description\"\r\n          open={this.state.typeModalOpen}\r\n          onClose={e => {this.setState({typeModalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new Type a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewType}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({typeModalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.thingModalOpen}\r\n          onClose={e => {this.setState({thingModalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({thingModalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { \r\n  Grid, Button, Checkbox, FormControl, FormControlLabel,\r\n  OutlinedInput, InputLabel, FormHelperText, Tooltip, Fab \r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport {\r\n  updateSelectedType,\r\n  addType,\r\n  updateType,\r\n  addAttributes,\r\n  setAttributes\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Type.  It will allow the use of Template Types\r\n  and Super Types to make the process faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedType: state.app.selectedType,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID,\r\n    attributesByName: state.app.attributesByName\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedType: type => dispatch(updateSelectedType(type)),\r\n    addType: type => dispatch(addType(type)),\r\n    updateType: type => dispatch(updateType(type)),\r\n    addAttributes: attrs => dispatch(addAttributes(attrs)),\r\n    setAttributes: attrs => dispatch(setAttributes(attrs))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Supers: [],\r\n      Attributes: [],\r\n      Major: false,\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: false,\r\n      resetting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined) {\r\n        this.setState({\r\n          resetting: false, \r\n          redirectTo: `/type/create`});\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        });\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Type Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Type Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.types.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Type Name is already in use\";\r\n        }\r\n        break;\r\n      // case \"AttributesArr\":\r\n      //   valid = true;\r\n      //   value = this.props.selectedType[fieldName];\r\n      //   message = \"\";\r\n      //   for (let i = 0; i < value.length; i++) {\r\n      //     if (value.filter(attr2 => attr2.Name === value[i].Name).length > 1) {\r\n      //       valid = false;\r\n      //       message = \"Attribute Names must be unique\";\r\n      //       break;\r\n      //     }\r\n      //     else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n      //       valid = false;\r\n      //       message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n      //       break;\r\n      //     }\r\n      //     else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n      //       valid = false;\r\n      //       message = `At least one Option must be set for ${value[i].Name}.`;\r\n      //       break;\r\n      //     }\r\n      //   } \r\n      //   break;\r\n      case \"Attributes\":\r\n        valid = true;\r\n        value = this.props.selectedType[fieldName];\r\n        message = \"\";\r\n        for (let i = 0; i < value.length; i++) {\r\n          if (value.filter(attr2 => attr2.Name === value[i].Name).length > 1) {\r\n            valid = false;\r\n            message = \"Attribute Names must be unique\";\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Type\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Type\")) && (value[i].DefinedType === undefined || value[i].DefinedType === null || value[i].DefinedType === \"\")) {\r\n            valid = false;\r\n            message = `A Defined Type must be selected for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n          else if ((value[i].AttributeType === \"Options\" || (value[i].AttributeType === \"List\" && value[i].ListType === \"Options\")) && (value[i].Options === undefined || value[i].Options === null || value[i].Options.length === 0)) {\r\n            valid = false;\r\n            message = `At least one Option must be set for ${value[i].Name}.`;\r\n            break;\r\n          }\r\n        } \r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrArrValid = this.validateField(\"AttributesArr\");\r\n    // const attrValid = this.validateField(\"Attributes\");\r\n    const formValid = nameValid.valid && attrArrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.AttributesArr = attrArrValid;\r\n    // fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true, addMore: addMore }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const superIDs = this.state.Supers.map(s => {\r\n      return s._id;\r\n    });\r\n\r\n    const attributes = this.props.selectedType.AttributesArr.map(a => {\r\n      return {\r\n        _id: a.attrID,\r\n        Name: a.Name.trim(),\r\n        AttributeType: a.AttributeType,\r\n        Options: a.Options,\r\n        DefinedType: a.DefinedType,\r\n        ListType: a.ListType\r\n      };\r\n    });\r\n    \r\n    this.api.upsertAttributes(this.props.selectedWorldID, attributes).then(res => {\r\n      const typeAttributes = [];\r\n      this.props.selectedType.AttributesArr.forEach(a => {\r\n        const id = a.attrID.includes(\"null\") ? res.attributes[a.Name] : a.attrID;\r\n        typeAttributes.push({\r\n          attrID: id,\r\n          index: a.index,\r\n          // Name: a.Name,\r\n          // AttributeType: a.AttributeType,\r\n          // Options: a.Options,\r\n          // DefinedType: a.DefinedType,\r\n          // ListType: a.ListType\r\n        });\r\n      });\r\n\r\n      this.api.getAttributesForWorld(this.props.selectedWorldID).then(res2 => {\r\n        if (res2 !== undefined && res2.error === undefined) {\r\n          // We store the attributes in two hashes, by name and by id\r\n          this.props.setAttributes(res2.attributes);\r\n        }\r\n          \r\n        const type = {\r\n          _id: this.state._id,\r\n          Name: this.state.Name,\r\n          Description: this.state.Description,\r\n          SuperIDs: superIDs,\r\n          // AttributesArr: this.props.selectedType.AttributesArr,\r\n          Attributes: typeAttributes,\r\n          Defaults: [],\r\n          worldID: this.props.selectedWorld._id,\r\n          Major: this.state.Major,\r\n          ReferenceIDs: [],\r\n          DefaultReferenceIDs: []\r\n        };\r\n        // this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n        //   if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n        //     type.ReferenceIDs.push(a.DefinedType);\r\n        //   }\r\n        // });\r\n        this.props.selectedType.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n          if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n            type.ReferenceIDs.push(a.DefinedType);\r\n          }\r\n        });\r\n        this.props.selectedType.Supers.forEach(s=> {\r\n          s.AttributesArr.filter(a=>a.AttributeType === \"Type\" || (a.AttributeType === \"List\" && a.ListType === \"Type\")).forEach(a=>{\r\n            if (!type.ReferenceIDs.includes(a.DefinedType)) {\r\n              type.ReferenceIDs.push(a.DefinedType);\r\n            }\r\n          });\r\n        });\r\n        Object.keys(this.props.selectedType.DefaultsHash).forEach(attrID => {\r\n          const def = this.props.selectedType.DefaultsHash[attrID];\r\n          type.Defaults.push({\r\n            attrID, \r\n            FromTypeID: def.FromTypeID, \r\n            DefaultValue: def.DefaultValue, \r\n            DefaultListValues: def.DefaultListValues \r\n          });\r\n        });\r\n    \r\n        if (type._id === null) {\r\n          this.api\r\n            .createType(type)\r\n            .then(res => {\r\n              if (res.typeID !== undefined) {\r\n                type._id = res.typeID;\r\n                type.Supers = [];\r\n                type.SuperIDs.forEach(sID=> {\r\n                  type.Supers = type.Supers.concat(this.props.types.filter(t2=>t2._id === sID));\r\n                });\r\n                this.props.addType(type);\r\n                if (this.state.addMore) {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false\r\n                  });\r\n                  this.setState({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    Attributes: [],\r\n                    Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    redirectTo: null,\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true\r\n                  }, this.resetForm);\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              }\r\n              else if (res.error !== undefined) {\r\n                this.setState({\r\n                  waiting: false, \r\n                  message: res.error \r\n                });\r\n              }\r\n            })\r\n            .catch(err => console.log(err));\r\n        } else {\r\n          this.api\r\n            .updateType(type)\r\n            .then(res => {\r\n              if (res.error === undefined) {\r\n                type.Supers = [];\r\n                type.SuperIDs.forEach(sID=> {\r\n                  type.Supers = type.Supers.concat(this.props.types.filter(t2=>t2._id === sID));\r\n                });\r\n                type.AttributesArr = [];\r\n                type.Attributes.forEach(a => {\r\n                  const attr = this.props.attributesByID[a.attrID];\r\n                  type.AttributesArr.push({\r\n                    index: type.AttributesArr.length,\r\n                    Name: attr.Name,\r\n                    AttributeType: attr.AttributeType,\r\n                    Options: attr.Options,\r\n                    DefinedType: attr.DefinedType,\r\n                    ListType: attr.ListType,\r\n                    attrID: a.attrID\r\n                  });\r\n                });\r\n                const defHash = {};\r\n                if (type.Defaults !== undefined) {\r\n                  type.Defaults.forEach(def => {\r\n                    defHash[def.attrID] = def;\r\n                  });\r\n                }\r\n                type.DefaultsHash = defHash;\r\n                this.props.updateType(type);\r\n                if (this.state.addMore) {\r\n                  this.props.updateSelectedType({\r\n                    _id: null,\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    AttributesArr: [],\r\n                    Attributes: [],\r\n                    Major: false\r\n                  });\r\n                  this.setState({\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Supers: [],\r\n                    Attributes: [],\r\n                    Major: false,\r\n                    fieldValidation: {\r\n                      Name: { valid: true, message: \"\" },\r\n                      AttributesArr: { valid: true, message: \"\" },\r\n                      Attributes: { valid: true, message: \"\" }\r\n                    },\r\n                    formValid: false,\r\n                    message: \"\",\r\n                    waiting: false,\r\n                    addMore: false,\r\n                    resetting: true, \r\n                    redirectTo: `/type/create`\r\n                  });\r\n                }\r\n                else {\r\n                  this.setState({\r\n                    waiting: false,\r\n                    redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n                  });\r\n                }\r\n              }\r\n              else {\r\n                this.setState({\r\n                  waiting: false, \r\n                  message: res.error \r\n                });\r\n              }\r\n            })\r\n            .catch(err => console.log(err));\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  supersChange = (e, value) => {\r\n    let supers = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      supers.push(t);\r\n      supers = supers.concat(t.Supers);\r\n    }\r\n    this.setState({ Supers: supers });\r\n  };\r\n\r\n  addSuperOld = (selectedList, selectedItem) => {\r\n    selectedItem.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) selectedList.push(s);\r\n    });\r\n    const type = this.props.selectedType;\r\n    let attributes = [...type.AttributesArr];\r\n    for (let i = 0; i < selectedItem.AttributesArr.length; i++) {\r\n      const attribute = selectedItem.AttributesArr[i];\r\n      attribute.FromSupers.push(selectedItem._id);\r\n      const matches = attributes.filter(a => a.Name === attribute.Name);\r\n      if (matches.length === 0) {\r\n        // It's a new attribute.\r\n        attribute.index = attributes.length;\r\n        attributes.push(attribute);\r\n      } else {\r\n        // It's an existing attribute,\r\n        // so we just need to add the appropriate ids to FromSupers.\r\n        // TODO: I also need to make sure the type and details match.\r\n        const superIDs = [...matches[0].FromSupers];\r\n        for (let i = 0; i < attribute.FromSupers.length; i++) {\r\n          const superID = attribute.FromSupers[i];\r\n          if (!superIDs.includes(superID)) {\r\n            superIDs.push(superID);\r\n          }\r\n        }\r\n        matches[0].FromSupers = superIDs;\r\n      }\r\n    }\r\n    this.setState({ Supers: selectedList });\r\n    type.AttributesArr = attributes;\r\n    this.props.updateSelectedType(type);\r\n  }\r\n\r\n  addSuper = (selectedList, selectedItem) => {\r\n    const type = this.props.selectedType;\r\n    type.SuperIDs.push(selectedItem._id);\r\n    selectedItem.Supers.forEach(s => {\r\n      if (selectedList.filter(s2 => s2._id === s._id).length === 0) {\r\n        selectedList.push(s);\r\n        type.SuperIDs.push(s._id);\r\n      }\r\n    });\r\n    type.Supers = selectedList;\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ Supers: selectedList });\r\n  }\r\n  \r\n  removeSuper = (selectedList, removedItem) => {\r\n    let supers = [];\r\n    let superIDs = [];\r\n    let removeUs = [removedItem._id];\r\n    const type = this.props.selectedType;\r\n    for (let i = 0; i < this.state.Supers.length; i++) {\r\n      const checkMe = this.props.types.filter(\r\n        t => t._id === this.state.Supers[i]._id\r\n      )[0];\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else {\r\n        supers.push(checkMe);\r\n        superIDs.push(checkMe._id);\r\n      }\r\n    }\r\n    type.Supers = supers;\r\n    type.SuperIDs = superIDs;\r\n    this.props.updateSelectedType(type);\r\n    this.setState({ Supers: supers });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (id !== null) {\r\n      this.api.getType(this.props.selectedWorldID, id).then(res => {\r\n        if (res.error === undefined) {\r\n          const supers = this.props.types.filter(type =>\r\n            res.SuperIDs.includes(type._id)\r\n          );\r\n          res.Supers = supers;\r\n          res.AttributesArr = [];\r\n          res.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            res.AttributesArr.push({\r\n              index: res.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID\r\n            });\r\n          });\r\n          const defHash = {};\r\n          if (res.Defaults !== undefined) {\r\n            res.Defaults.forEach(def => {\r\n              defHash[def.attrID] = def;\r\n            });\r\n          }\r\n          res.DefaultsHash = defHash;\r\n\r\n          this.props.updateSelectedType(res);\r\n          this.setState({\r\n            Name: res.Name,\r\n            Description: res.Description,\r\n            _id: id,\r\n            Supers: supers,\r\n            Major: res.Major,\r\n            loaded: true\r\n          });\r\n        }\r\n        else {\r\n          this.setState({ message: res.error, loaded: true });\r\n        }\r\n      });\r\n    } else {\r\n      this.props.updateSelectedType({\r\n        _id: null,\r\n        Name: \"\",\r\n        Description: \"\",\r\n        Supers: [],\r\n        SuperIDs: [],\r\n        AttributesArr: [],\r\n        Attributes: [],\r\n        Major: false,\r\n        DefaultsHash: {}\r\n      });\r\n      this.setState({ loaded: true });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined)\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const types =\r\n        this.props.types === undefined || this.state._id === null\r\n          ? this.props.types\r\n          : this.props.types.filter(type => type._id !== this.state._id);\r\n      \r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={11}>\r\n                  <h2>{this.state._id === null ? \"Create New Type\" : \"Edit Type\"}</h2>\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"description\">Description</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"description\"\r\n                    name=\"Description\"\r\n                    type=\"text\"\r\n                    multiline={true}\r\n                    value={this.state.Description}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={82}\r\n                    fullWidth\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Checkbox\r\n                      checked={this.state.Major}\r\n                      onChange={this.handleUserInput}\r\n                      name=\"Major\"\r\n                      color=\"primary\"\r\n                    />\r\n                  }\r\n                  label=\"Major Type\"\r\n                />\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.resetting ? \"\" :\r\n                  <Multiselect\r\n                    placeholder=\"Super Types\"\r\n                    options={types}\r\n                    selectedValues={this.state.Supers}\r\n                    onSelect={this.addSuper}\r\n                    onRemove={this.removeSuper}\r\n                    displayValue=\"Name\"\r\n                  />\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.loaded &&\r\n                  <AttributesControl />\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                  if (\r\n                    this.state.fieldValidation[fieldName] !== undefined &&\r\n                    this.state.fieldValidation[fieldName].message.length > 0\r\n                  ) {\r\n                    return (\r\n                      <p className=\"redFont\" key={i}>\r\n                        {this.state.fieldValidation[fieldName].message}\r\n                      </p>\r\n                    );\r\n                  } else {\r\n                    return \"\";\r\n                  }\r\n                })}\r\n              </Grid>\r\n              <Grid item>\r\n                <div className=\"float-right\">\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(true);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    className=\"w-200\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(false);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={_ => {\r\n                      if (this.props.selectedType._id === null) {\r\n                        this.setState({\r\n                          redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                        });\r\n                      }\r\n                      else {\r\n                        this.setState({\r\n                          redirectTo: `/type/details/${this.props.selectedType._id}`\r\n                        });\r\n                      }\r\n                    }}\r\n                    type=\"button\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst TypeEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default TypeEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { ArrowBack, Edit, Delete } from \"@material-ui/icons\";\r\nimport { \r\n  Fab, Tooltip, Modal, Grid, Button, \r\n  List, ListItem, ListItemText\r\n} from \"@material-ui/core\";\r\nimport { Helmet } from 'react-helmet';\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing,\r\n  setThings\r\n} from \"../../redux/actions/index\";\r\nimport API from \"../../api\";\r\n\r\nconst mapStateToProps = state => {\r\n  const thing = state.app.selectedThing;\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: thing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    types: state.app.types,\r\n    things: state.app.things,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing)),\r\n    setThings: things => dispatch(setThings(things))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      AttributesArr: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        AttributesArr: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      modalOpen: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  delete = e => {\r\n    this.api.deleteThing(this.props.selectedWorldID, this.state._id).then(res=>{\r\n      const things = this.props.things.filter(t=>t._id!==this.state._id);\r\n      this.props.setThings(things);\r\n      this.setState({redirectTo: `/world/details/${this.props.selectedWorldID}`})\r\n    });\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    const id = this.state._id;\r\n    if (id !== undefined) {\r\n      this.api.getThing(this.props.selectedWorldID, id).then(res => {\r\n        if (res.error === undefined) {\r\n          let Types = [];\r\n          res.TypeIDs.forEach(tID=> {\r\n            Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n          });\r\n          res.AttributesArr = [];\r\n          res.Attributes.forEach(a => {\r\n            const attr = this.props.attributesByID[a.attrID];\r\n            res.AttributesArr.push({\r\n              index: res.AttributesArr.length,\r\n              Name: attr.Name,\r\n              AttributeType: attr.AttributeType,\r\n              Options: attr.Options,\r\n              DefinedType: attr.DefinedType,\r\n              ListType: attr.ListType,\r\n              attrID: a.attrID,\r\n              Value: a.Value,\r\n              ListValues: a.ListValues\r\n            });\r\n          });\r\n          this.setState({\r\n            Name: res.Name,\r\n            Description: res.Description,\r\n            _id: id,\r\n            Types: Types\r\n          });\r\n          this.props.updateSelectedThing(res);\r\n        }\r\n        else {\r\n          console.log(res.error);\r\n        }\r\n      });\r\n    } else {\r\n      this.props.updateSelectedThing({\r\n        _id: null,\r\n        Name: \"\",\r\n        Description: \"\",\r\n        Types: [],\r\n        AttributesArr: []\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { id } = this.props.match.params;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\").length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      const references = this.props.things.filter(t=>t.ReferenceIDs !== undefined && t.ReferenceIDs.includes(this.state._id));\r\n      return (\r\n        <Grid item xs={12} container spacing={0} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <div>\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={8}>\r\n                  <h2>{this.state.Name}</h2>\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <List>\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Edit ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={ _ => {this.setState({redirectTo:`/thing/edit/${this.state._id}`})}}\r\n                          >\r\n                            <Edit />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                    { (this.props.user !== null && \r\n                      this.props.selectedWorld !== null && \r\n                      (this.props.selectedWorld.Owner === this.props.user._id || \r\n                        this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length > 0)) &&\r\n                      <ListItem>\r\n                        <Tooltip title={`Delete ${this.state.Name}`}>\r\n                          <Fab size=\"small\"\r\n                            color=\"primary\"\r\n                            onClick={e => {this.setState({modalOpen: true})}}\r\n                          >\r\n                            <Delete />\r\n                          </Fab>\r\n                        </Tooltip>\r\n                      </ListItem>\r\n                    }\r\n                  </List> \r\n                </Grid>\r\n              </Grid>\r\n              <Grid item container spacing={0} direction=\"row\">\r\n                <Grid item sm={9} xs={12} container spacing={0} direction=\"column\">\r\n                  <Grid item>{this.state.Description}</Grid>\r\n                  <Grid item>\r\n                    Attributes\r\n                    <List>\r\n                      {this.props.selectedThing === null ||\r\n                      this.props.selectedThing === undefined\r\n                        ? \"\"\r\n                        : this.props.selectedThing.AttributesArr.map(\r\n                            (attribute, i) => {\r\n                              return (\r\n                                <ListItem key={i}>\r\n                                  <ListItemText>\r\n                                    {attribute.Name}:&nbsp;\r\n                                    {attribute.AttributeType === \"Type\" && attribute.Value !== \"\" ?\r\n                                    <Button\r\n                                      variant=\"contained\"\r\n                                      color=\"primary\"\r\n                                      onClick={ _ => {this.setState({redirectTo:`/thing/details/${attribute.Value}`})}}\r\n                                    >\r\n                                      <ListItemText primary={this.props.things.filter(t=>t._id === attribute.Value)[0].Name}/>\r\n                                    </Button>\r\n                                    : attribute.AttributeType === \"List\" ?\r\n                                      attribute.ListValues.map(\r\n                                        (listValue, i) => {\r\n                                          return (\r\n                                          <span key={i}>\r\n                                            {\r\n                                              attribute.ListType === \"Type\" ?\r\n                                              <span>\r\n                                                <Button\r\n                                                  variant=\"contained\"\r\n                                                  color=\"primary\"\r\n                                                  onClick={ _ => {this.setState({redirectTo:`/thing/details/${listValue}`})}}\r\n                                                >\r\n                                                  <ListItemText primary={this.props.things.filter(t=>t._id === listValue)[0].Name}/>\r\n                                                </Button> \r\n                                                &nbsp;\r\n                                              </span>\r\n                                              :\r\n                                              i > 0 ? `, ${listValue}` : `${listValue}`\r\n                                            }\r\n                                          </span>\r\n                                          );\r\n                                        })\r\n                                    : attribute.Value}\r\n                                  </ListItemText>\r\n                                </ListItem>\r\n                              );\r\n                            }\r\n                          )}\r\n                    </List>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item sm={3} xs={12} container spacing={0} direction=\"column\">\r\n                  {this.state.Types.length === 0 ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Types\"} />\r\n                        </ListItem>\r\n                        {this.state.Types.map((type, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/type/details/${type._id}`})}}\r\n                              >\r\n                                <ListItemText primary={type.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                  {references.length === 0 ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <Grid item>\r\n                      <List>\r\n                        <ListItem>\r\n                          <ListItemText primary={\"Referenced in:\"} />\r\n                        </ListItem>\r\n                        {references.map((thing, i) => {\r\n                          return (\r\n                            <ListItem key={i}>\r\n                              <Button fullWidth\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={ _ => {this.setState({redirectTo:`/thing/details/${thing._id}`})}}\r\n                              >\r\n                                <ListItemText primary={thing.Name} />\r\n                              </Button>\r\n                            </ListItem>\r\n                          );\r\n                        })}\r\n                      </List>\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n              <Modal\r\n                aria-labelledby=\"delete-thing-modal\"\r\n                aria-describedby=\"delete-thing-modal-description\"\r\n                open={this.state.modalOpen}\r\n                onClose={e => {this.setState({modalOpen: false})}}\r\n              >\r\n                <div style={this.getModalStyle()} className=\"paper\">\r\n                  <Grid container spacing={1} direction=\"column\">\r\n                    <Grid item>\r\n                      Are you sure you want to delete {this.state.Name}?\r\n                    </Grid>\r\n                    <Grid item>\r\n                      (All references to it will be left alone and may not work correctly)\r\n                    </Grid>\r\n                    <Grid item container spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={this.delete}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <Button\r\n                          fullWidth\r\n                          variant=\"contained\"\r\n                          onClick={e => {this.setState({modalOpen: false})}}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </div>\r\n              </Modal>\r\n            </div>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingDetails = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingDetails;\r\n","/* eslint-disable no-use-before-define */\r\nimport React, { useState } from \"react\";\r\n\r\nimport {\r\n  Grid,\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\n\r\nimport ChipInput from \"material-ui-chip-input\";\r\nimport { Multiselect } from \"multiselect-react-dropdown\";\r\n\r\nconst handleTextListChange = (e, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = e;\r\n  props.onChange(attr);\r\n};\r\nconst handleDefinedTypeChange = (e, props, respond) => {\r\n  // const attr = props.attribute;\r\n  // attr[\"DefinedType\"] = e.target.value;\r\n  if (e.target.value === \"new\") {\r\n    function respond2(newThing) {\r\n      // attr[\"DefinedType\"] = newType._id;\r\n      // props.onChange(attr);\r\n      respond(newThing._id);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    // props.onChange(attr);\r\n    respond(e.target.value);\r\n  }\r\n};\r\nconst addOption = (selectedItem, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues.push(selectedItem.Name);\r\n  props.onChange(attr);\r\n};\r\nconst removeOption = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o.Name);\r\n  });\r\n  props.onChange(attr);\r\n};\r\nconst addType = (selectedItem, props) => {\r\n  if (selectedItem._id === \"new\") {\r\n    function respond2(newThing) {\r\n      const attr = props.attribute;\r\n      attr.ListValues.push(newThing._id);\r\n      props.onChange(attr);\r\n    }\r\n    props.onNewThing(\r\n      respond2,\r\n      props.types.filter(t => t._id === props.attribute.DefinedType)[0]\r\n    );\r\n  } else {\r\n    const attr = props.attribute;\r\n    attr.ListValues.push(selectedItem._id);\r\n    props.onChange(attr);\r\n  }\r\n};\r\nconst removeType = (selectedList, props) => {\r\n  const attr = props.attribute;\r\n  attr.ListValues = [];\r\n  selectedList.forEach(o => {\r\n    attr.ListValues.push(o._id);\r\n  });\r\n  props.onChange(attr);\r\n};\r\n\r\nexport default function AttributeControl(props) {\r\n  const [value, changeValue] = useState(props.attribute.Value);\r\n  const attributeType = props.attribute.AttributeType === \"\" ? \"Text\" : props.attribute.AttributeType;\r\n\r\n  const listOptions = [];\r\n  const listOptionValues = [];\r\n  if (attributeType === \"List\" && props.attribute.ListType === \"Options\") {\r\n    props.attribute.Options.forEach(o => {\r\n      listOptions.push({ Name: o });\r\n    });\r\n    props.attribute.ListValues.forEach(o => {\r\n      listOptionValues.push({ Name: o });\r\n    });\r\n  } else if (attributeType === \"List\" && props.attribute.ListType === \"Type\") {\r\n    const definedType = props.types.filter(t => t._id === props.attribute.DefinedType)[0];\r\n    listOptions.push({ Name: `+ Create New ${definedType.Name}`, _id: \"new\" });\r\n    props.things\r\n      .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n      .forEach(t => {\r\n        listOptions.push({ Name: t.Name, _id: t._id });\r\n      });\r\n    listOptions\r\n      .filter(t => props.attribute.ListValues.includes(t._id))\r\n      .forEach(t => {\r\n        listOptionValues.push(t);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Grid item>\r\n      {attributeType === \"Text\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"textField\">{props.attribute.Name}</InputLabel>\r\n          <OutlinedInput\r\n            id=\"textField\"\r\n            name=\"textField\"\r\n            type=\"text\"\r\n            error={props.error}\r\n            value={value}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeValue(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                attrID: props.attribute.attrID,\r\n                Name: props.attribute.Name,\r\n                AttributeType: props.attribute.AttributeType,\r\n                Options: props.attribute.Options,\r\n                DefinedType: props.attribute.DefinedType,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={props.attribute.Name.length * 9}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      ) : attributeType === \"Number\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"numField\">{props.attribute.Name}</InputLabel>\r\n          <OutlinedInput\r\n            id=\"numField\"\r\n            name=\"numField\"\r\n            type=\"number\"\r\n            error={props.error}\r\n            value={value}\r\n            autoComplete=\"off\"\r\n            onChange={e => {\r\n              changeValue(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                attrID: props.attribute.attrID,\r\n                Name: props.attribute.Name,\r\n                AttributeType: props.attribute.AttributeType,\r\n                Options: props.attribute.Options,\r\n                DefinedType: props.attribute.DefinedType,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            labelWidth={props.attribute.Name.length * 9}\r\n            fullWidth\r\n          />\r\n          <FormHelperText>{props.message}</FormHelperText>\r\n        </FormControl>\r\n      ) : attributeType === \"True/False\" ? (\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox checked={props.attribute.Value===\"True\"} onChange={e => {\r\n              const attr = props.attribute;\r\n              attr.Value = e.target.checked ? \"True\" : \"False\";\r\n              props.onChange(attr);\r\n            }}\r\n            color=\"primary\" />\r\n          }\r\n          label={props.attribute.Name}\r\n        />\r\n      ) : attributeType === \"Options\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"options-select\" id=\"options-select-label\">\r\n            {props.attribute.Name}\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"options-select-label\"\r\n            id=\"options-select\"\r\n            value={value}\r\n            onChange={e => {\r\n              changeValue(e.target.value);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                attrID: props.attribute.attrID,\r\n                Name: props.attribute.Name,\r\n                AttributeType: props.attribute.AttributeType,\r\n                Options: props.attribute.Options,\r\n                DefinedType: props.attribute.DefinedType,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            fullWidth\r\n            labelWidth={props.attribute.Name.length * 9}\r\n          >\r\n            {props.attribute.Options.map((option, i) => {\r\n              return (\r\n                <MenuItem key={i} value={option}>\r\n                  {option}\r\n                </MenuItem>\r\n              );\r\n            })}\r\n          </Select>\r\n        </FormControl>\r\n      ) : attributeType === \"Type\" ? (\r\n        <FormControl variant=\"outlined\" fullWidth>\r\n          <InputLabel htmlFor=\"type-select\" id=\"type-select-label\">\r\n            {props.attribute.Name}\r\n          </InputLabel>\r\n          <Select\r\n            labelId=\"type-select-label\"\r\n            id=\"type-select\"\r\n            value={value}\r\n            onChange={e => {\r\n              handleDefinedTypeChange(e, props, changeValue);\r\n            }}\r\n            onBlur={e => {\r\n              const attr = {\r\n                index: props.attribute.index,\r\n                attrID: props.attribute.attrID,\r\n                Name: props.attribute.Name,\r\n                AttributeType: props.attribute.AttributeType,\r\n                Options: props.attribute.Options,\r\n                DefinedType: props.attribute.DefinedType,\r\n                ListType: props.attribute.ListType,\r\n                FromTypes: props.attribute.FromTypes,\r\n                Value: value,\r\n                ListValues: props.attribute.ListValues\r\n              };\r\n              props.onChange(attr);\r\n            }}\r\n            fullWidth\r\n            labelWidth={props.attribute.Name.length * 9}\r\n          >\r\n            <MenuItem value=\"new\">\r\n              + Create New{\" \"}\r\n              {props.types.filter(t => t._id === props.attribute.DefinedType)[0].Name}\r\n            </MenuItem>\r\n            {props.things\r\n              .filter(t => t.TypeIDs.includes(props.attribute.DefinedType))\r\n              .map((thing, i) => {\r\n                return (\r\n                  <MenuItem key={i} value={thing._id}>\r\n                    {thing.Name}\r\n                  </MenuItem>\r\n                );\r\n              })}\r\n          </Select>\r\n        </FormControl>\r\n      ) : attributeType === \"List\" ? (\r\n        <span>\r\n          {props.attribute.ListType === \"Text\" ? (\r\n            <ChipInput\r\n              placeholder={props.attribute.Name}\r\n              variant=\"outlined\"\r\n              defaultValue={props.attribute.ListValues}\r\n              onChange={chips => handleTextListChange(chips, props)}\r\n            />\r\n          ) : props.attribute.ListType === \"Options\" ? (\r\n            <Multiselect\r\n              placeholder={props.attribute.Name}\r\n              options={listOptions}\r\n              selectedValues={listOptionValues}\r\n              onSelect={(_, selectedItem) => {\r\n                addOption(selectedItem, props);\r\n              }}\r\n              onRemove={(selectedList, _) => {\r\n                removeOption(selectedList, props);\r\n              }}\r\n              displayValue=\"Name\"\r\n            />\r\n          ) : props.attribute.ListType === \"Type\" ? (\r\n            <Multiselect\r\n              placeholder={props.attribute.Name}\r\n              options={listOptions}\r\n              selectedValues={listOptionValues}\r\n              onSelect={(_, selectedItem) => {\r\n                addType(selectedItem, props);\r\n              }}\r\n              onRemove={(selectedList, _) => {\r\n                removeType(selectedList, props);\r\n              }}\r\n              displayValue=\"Name\"\r\n            />\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </span>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { \r\n  Grid, Modal, FormControl, InputLabel, \r\n  OutlinedInput, FormHelperText, Button \r\n} from \"@material-ui/core\";\r\n// import uuid from 'react-uuid';\r\nimport { \r\n  updateSelectedThing, addThing \r\n} from \"../../redux/actions/index\";\r\nimport AttributeControl from \"./AttributeControl\";\r\nimport API from \"../../api\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedThing: state.app.selectedThing,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    selectedWorldID: state.app.selectedWorldID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n  };\r\n}\r\nclass Control extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n      Name: \"\",\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      waiting: false,\r\n      newThingType: null\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  newAttribute = () => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.push({\r\n      index: thing.AttributesArr.length,\r\n      _id: null,\r\n      Name: \"\",\r\n      AttributeType: \"Text\",\r\n      Options: [],\r\n      DefinedType: \"\",\r\n      ListType: \"Text\",\r\n      FromTypes: [],\r\n      Value: \"\",\r\n      ListValues: [],\r\n    });\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  changeAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr[value.index] = {\r\n      index: value.index,\r\n      attrID: value.attrID,\r\n      Name: value.Name,\r\n      AttributeType: value.AttributeType,\r\n      Options: value.Options,\r\n      DefinedType: value.DefinedType,\r\n      ListType: value.ListType,\r\n      FromTypes: value.FromTypes,\r\n      Value: value.Value,\r\n      ListValues: value.ListValues,\r\n    };\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  blurAttribute = e => {\r\n  };\r\n\r\n  deleteAttribute = value => {\r\n    const thing = this.props.selectedThing;\r\n    thing.AttributesArr.splice(value.index);\r\n    this.props.updateSelectedThing(thing);\r\n  };\r\n\r\n  optionsChange = (e, props) => {\r\n  }\r\n\r\n  addNewThing = (respond, type) => {\r\n    // Opens a Modal where they enter a name.\r\n    this.setState({modalOpen: true, modalSubmit: respond, newThingType: type});\r\n  }\r\n  \r\n  getModalStyle = () => {\r\n    const top = Math.round(window.innerHeight / 2) - 50;\r\n    const left = Math.round(window.innerWidth / 2) - 200;\r\n  \r\n    return {\r\n      top: `${top}%`,\r\n      left: `${left}%`,\r\n      transform: `translate(${left}px, ${top}px)`,\r\n    };\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const formValid = nameValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  saveNewThing = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true }, this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const types = this.props.types.filter(t=> t._id === this.state.newThingType._id || this.state.newThingType.SuperIDs.includes(t._id));\r\n    const typeIDs = types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Description: \"\",\r\n      TypeIDs: typeIDs,\r\n      AttributesArr: [],\r\n      worldID: this.props.selectedWorldID\r\n    };\r\n\r\n    // Calls API\r\n    this.api\r\n      .createThing(thing)\r\n      .then(res => {\r\n        if (res.thingID !== undefined) {\r\n          thing._id = res.thingID;\r\n          thing.Types = types;\r\n          // Adds to props \r\n          this.props.addThing(thing);\r\n          // Calls respond back to Attribute to set the thing\r\n          this.state.modalSubmit(thing);\r\n          this.setState({\r\n            waiting: false, \r\n            modalOpen: false\r\n          });\r\n        }\r\n        else if (res.message !== undefined) {\r\n          this.setState({\r\n            waiting: false, \r\n            message: res.message \r\n          });\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} container spacing={1} direction=\"column\">\r\n        <Grid item>Attributes</Grid>\r\n        {this.props.selectedThing === null || this.props.selectedThing === undefined ? \"\"\r\n          : this.props.selectedThing.AttributesArr.map((attribute, i) => {\r\n            return (\r\n              <AttributeControl\r\n                key={i}\r\n                thingID={this.props.selectedThing._id}\r\n                attribute={attribute}\r\n                onChange={this.changeAttribute}\r\n                onDelete={this.deleteAttribute}\r\n                onBlur={this.blurAttribute}\r\n                things={this.props.things}\r\n                types={this.props.types}\r\n                onNewThing={this.addNewThing}\r\n              />\r\n            );\r\n          })\r\n        }\r\n        <Modal\r\n          aria-labelledby=\"new-thing-modal\"\r\n          aria-describedby=\"new-thing-modal-description\"\r\n          open={this.state.modalOpen}\r\n          onClose={e => {this.setState({modalOpen: false})}}\r\n        >\r\n          <div style={this.getModalStyle()} className=\"paper\">\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Just give the new {this.state.newThingType === null ? \"\" : this.state.newThingType.Name} a name.\r\n              </Grid>\r\n              <Grid item>\r\n                (You can do the rest later.)\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={this.saveNewThing}\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    onClick={e => {this.setState({modalOpen: false})}}\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst AttributesControl = connect(mapStateToProps, mapDispatchToProps)(Control);\r\nexport default AttributesControl;\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  updateSelectedThing,\r\n  addThing,\r\n  updateThing\r\n} from \"../../redux/actions/index\";\r\nimport { \r\n  Button, FormControl, OutlinedInput, InputLabel, \r\n  FormHelperText, Grid, Fab, Tooltip \r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport AttributesControl from \"./AttributesControl\";\r\nimport { Multiselect } from 'multiselect-react-dropdown';\r\nimport { Helmet } from 'react-helmet';\r\nimport API from \"../../api\";\r\n\r\n/* \r\n  This component will take the main portion of the page and is used for\r\n  creating or editing a Thing.  It will allow the use of Types to make\r\n  it faster.\r\n*/\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    selectedPage: state.app.selectedPage,\r\n    selectedThing: state.app.selectedThing,\r\n    selectedWorld: state.app.selectedWorld,\r\n    selectedWorldID: state.app.selectedWorldID,\r\n    things: state.app.things,\r\n    types: state.app.types,\r\n    user: state.app.user,\r\n    attributesByID: state.app.attributesByID\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    updateSelectedThing: thing => dispatch(updateSelectedThing(thing)),\r\n    addThing: thing => dispatch(addThing(thing)),\r\n    updateThing: thing => dispatch(updateThing(thing))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      _id: undefined,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      // AttributesArr: [],\r\n      Attributes: [],\r\n      fieldValidation: {\r\n        Name: { valid: true, message: \"\" },\r\n        // AttributesArr: { valid: true, message: \"\" },\r\n        Attributes: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"\",\r\n      redirectTo: null,\r\n      waiting: false,\r\n      addMore: false,\r\n      resetting: false,\r\n      loaded: true,\r\n      errors: []\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  createThingFromTypeOld = type => {\r\n    let types = [];\r\n    types.push(type);\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n          types.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      AttributesArr: []\r\n    };\r\n    let attributes = [];\r\n    const errors = [];\r\n    for (let i = 0; i < type.AttributesArr.length; i++) {\r\n      const attribute = {...type.AttributesArr[i]};\r\n      attribute.FromTypes = [...attribute.FromSupers];\r\n      delete attribute.FromSupers;\r\n      attribute.FromTypes.push(type._id);\r\n      const matches = attributes.filter(a => a._id === attribute._id);\r\n      const nameMatches = attributes.filter(a => a.Name === attribute.Name);\r\n      if (matches.length === 0 && nameMatches.length === 0) {\r\n        // It's a new attribute.\r\n        // Thing Attributes have Values, so we need to add that field.\r\n        // In the future I'll have List Types, in which case this will be more complicated.\r\n        // Also I'll be adding default values.\r\n        if (attribute.DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = attribute.DefaultValue;\r\n          attribute.ListValues = attribute.DefaultListValues;\r\n        }\r\n        attribute.index = attributes.length;\r\n        attributes.push(attribute);\r\n      } else if (matches.length === 0) {\r\n        // It's a new attribute, but there's an existing attribute with the same name\r\n        // Check the attribute type data to see if it's a match.\r\n        // If not then we need to alert the user that it's a name collision\r\n        if (nameMatches[0].AttributeType !== attribute.AttributeType || \r\n          (attribute.AttributeType === \"List\" && \r\n            attribute.ListType !== nameMatches[0].ListType) ||\r\n          (attribute.AttributeType === \"Type\" && \r\n            attribute.DefinedType !== nameMatches[0].DefinedType) ||\r\n          (attribute.AttributeType === \"List\" && \r\n            attribute.ListType === \"Type\" &&\r\n            attribute.DefinedType !== nameMatches[0].DefinedType)) {\r\n          // Name collision\r\n          errors.push(`Attribute ${attribute.Name} has a Name Collision.  Please resolve it.`);\r\n        }\r\n      } else if (nameMatches.length === 0) {\r\n        // It's an existing attribute, but the name was changed on the type.\r\n        // Update the name to match.\r\n        errors.push(`Attribute ${attribute.Name} has been changed on its Type to `);\r\n        attribute.Name = matches[0].Name;\r\n      } else {\r\n        // It's an existing attribute,\r\n        // so we just need to add the appropriate ids to FromTypes.\r\n        const typeIDs = [...matches[0].FromTypes];\r\n        for (let i = 0; i < attribute.FromTypes.length; i++) {\r\n          const typeID = attribute.FromTypes[i];\r\n          if (!typeIDs.includes(typeID)) {\r\n            typeIDs.push(typeID);\r\n          }\r\n        }\r\n        matches[0].FromTypes = typeIDs;\r\n      }\r\n    }\r\n    thing.AttributesArr = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n    this.setState({ _id: null, Types: types, loaded: true, errors });\r\n  };\r\n\r\n  createThingFromType = type => {\r\n    let types = [];\r\n    types.push(type);\r\n    type.Supers.forEach(s=>{\r\n      if (types.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n          types.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = {\r\n      _id: null,\r\n      Name: \"\",\r\n      Description: \"\",\r\n      Types: [],\r\n      Attributes: []\r\n    };\r\n    let newAttributes = [];\r\n    types.forEach(type=> {\r\n      for (let i = 0; i < type.Attributes.length; i++) {\r\n        const attribute = {...type.Attributes[i]};\r\n        if (thing.Attributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n          attribute.FromTypeID = type._id;\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          newAttributes.push(attribute);\r\n        }\r\n      }\r\n    });\r\n    types.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    thing.AttributesArr = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n    this.setState({ _id: null, Types: types, loaded: true }); //, errors });\r\n  };\r\n\r\n  resetForm = () => {\r\n    setTimeout(() => {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined && !id.includes(\"type_id_\")) {\r\n        this.setState({\r\n          resetting: false, \r\n          redirectTo: `/thing/create`\r\n        });\r\n      }\r\n      else {\r\n        this.setState({\r\n          resetting: false\r\n        }, this.finishResettingForm);\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  finishResettingForm = () => {\r\n    const { id } = this.props.match.params;\r\n    if (id !== undefined && id.includes(\"type_id_\")) {\r\n      // We're creating it from a type rather than from blank\r\n      const typeID = id.substring(8);\r\n      let type = this.props.types.filter(t=> t._id === typeID);\r\n      if (type.length > 0) {\r\n        type = type[0];\r\n        this.createThingFromType(type);\r\n      }\r\n      else {\r\n        this.setState({ message: \"Invalid Type\" });\r\n      }\r\n    }\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value =\r\n      e.target.type === \"checkbox\" ? e.target.checked : e.target.value;\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (\r\n      fieldValidation[name] !== undefined &&\r\n      fieldValidation[name].valid !== validation.valid\r\n    ) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  };\r\n\r\n  validateField = fieldName => {\r\n    let value = null;\r\n    let valid = true;\r\n    let message = \"\";\r\n    switch (fieldName) {\r\n      case \"Name\":\r\n        value = this.state[fieldName];\r\n        valid = value.match(/^[a-zA-Z0-9 ]*$/i) !== null;\r\n        if (!valid)\r\n          message = \"Only Letters, Numbers, and Spaces allowed in Thing Names\";\r\n        else if (value.length < 2) {\r\n          valid = false;\r\n          message = \"Thing Name is too short\";\r\n        } else {\r\n          valid =\r\n            this.props.things.filter(\r\n              t => t.Name === value && t._id !== this.state._id\r\n            ).length === 0;\r\n          if (!valid) message = \"This Thing Name is already in use\";\r\n        }\r\n        break;\r\n      case \"AttributesArr\":\r\n        valid = true;\r\n        value = this.props.selectedThing[fieldName];\r\n        value.forEach(a => {\r\n          if (valid && value.filter(attr2 => attr2.Name === a.Name).length > 1) {\r\n            valid = false;\r\n          }\r\n        });\r\n        message = valid ? \"\" : \"Attribute Names must be unique\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = respond => {\r\n    const nameValid = this.validateField(\"Name\");\r\n    const attrValid = this.validateField(\"AttributesArr\");\r\n    const formValid = nameValid.valid && attrValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.Name = nameValid;\r\n    fieldValidation.Attributes = attrValid;\r\n    this.setState(\r\n      {\r\n        formValid: formValid,\r\n        fieldValidation: fieldValidation\r\n      },\r\n      respond\r\n    );\r\n  };\r\n\r\n  onSubmit = (addMore) => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ \r\n          waiting: true, \r\n          addMore: addMore \r\n        }, \r\n        this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    const typeIDs = this.state.Types.map(s => {\r\n      return s._id;\r\n    });\r\n    const thing = {\r\n      _id: this.state._id,\r\n      Name: this.state.Name.trim(),\r\n      Description: this.state.Description.trim(),\r\n      TypeIDs: typeIDs,\r\n      // AttributesArr: this.props.selectedThing.AttributesArr,\r\n      Attributes: [],\r\n      worldID: this.props.selectedWorld._id,\r\n      ReferenceIDs: []\r\n    };\r\n    this.props.selectedThing.AttributesArr.forEach(a => {\r\n      thing.Attributes.push({\r\n        attrID: a.attrID,\r\n        index: a.index,\r\n        Value: a.Value.trim(),\r\n        ListValues: a.ListValues\r\n      });\r\n      if (a.AttributeType === \"Type\") {\r\n        if (!thing.ReferenceIDs.includes(a.Value)) {\r\n          thing.ReferenceIDs.push(a.Value);\r\n        }\r\n      }\r\n      if (a.AttributeType === \"List\" && a.ListType === \"Type\") {\r\n        a.ListValues.forEach(v=> {\r\n          if (!thing.ReferenceIDs.includes(v)) {\r\n            thing.ReferenceIDs.push(v);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    if (thing._id === null) {\r\n      this.api\r\n        .createThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined){\r\n            thing._id = res.thingID;\r\n            thing.Types = this.state.Types;\r\n            this.props.addThing(thing);\r\n            if (this.state.addMore) {\r\n              this.props.updateSelectedThing({\r\n                _id: null,\r\n                Name: \"\",\r\n                Description: \"\",\r\n                Types: [],\r\n                Attributes: []\r\n              });\r\n              this.setState({\r\n                _id: null,\r\n                Name: \"\",\r\n                Description: \"\",\r\n                Types: [],\r\n                Attributes: [],\r\n                fieldValidation: {\r\n                  Name: { valid: true, message: \"\" },\r\n                  Attributes: { valid: true, message: \"\" }\r\n                },\r\n                formValid: false,\r\n                message: \"\",\r\n                waiting: false,\r\n                resetting: true\r\n              }, this.resetForm);\r\n            }\r\n            else {\r\n              this.setState({\r\n                waiting: false,\r\n                redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n              });\r\n            }\r\n          }\r\n          else {\r\n            this.setState({message: res.error});\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      this.api\r\n        .updateThing(thing)\r\n        .then(res => {\r\n          if (res.error === undefined){\r\n            thing.Types = this.state.Types;\r\n            this.props.updateThing(thing);\r\n            if (this.state.addMore) {\r\n              this.props.updateSelectedThing({\r\n                _id: null,\r\n                Name: \"\",\r\n                Description: \"\",\r\n                Types: [],\r\n                Attributes: []\r\n              });\r\n              this.setState({\r\n                Name: \"\",\r\n                Description: \"\",\r\n                Types: [],\r\n                Attributes: [],\r\n                fieldValidation: {\r\n                  Name: { valid: true, message: \"\" },\r\n                  Attributes: { valid: true, message: \"\" }\r\n                },\r\n                formValid: false,\r\n                message: \"\",\r\n                waiting: false,\r\n                addMore: false,\r\n                resetting: true\r\n              }, this.resetForm);\r\n            }\r\n            else {\r\n              this.setState({\r\n                waiting: false,\r\n                redirectTo: `/world/details/${this.props.selectedWorld._id}`\r\n              });\r\n            }\r\n          }\r\n          else {\r\n            this.setState({message: res.error});\r\n          }\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  };\r\n\r\n  typesChange = (e, value) => {\r\n    let types = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n      const t = value[i];\r\n      types.push(t);\r\n      types = types.concat(t.Types);\r\n    }\r\n    this.setState({ Types: types });\r\n  };\r\n\r\n  addTypeOld = (selectedList, selectedItem) => {\r\n    selectedItem.Supers.forEach(s=>{\r\n      if (selectedList.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0)\r\n        selectedList.push(superType[0]);\r\n      }\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.AttributesArr];\r\n    for (let i = 0; i < selectedItem.AttributesArr.length; i++) {\r\n      const attribute = selectedItem.AttributesArr[i];\r\n      if (attribute.FromTypes === undefined)\r\n        attribute.FromTypes = [];\r\n      attribute.FromTypes.push(selectedItem._id);\r\n      const matches = attributes.filter(a => a.Name === attribute.Name);\r\n      if (matches.length === 0) {\r\n        // It's a new attribute.\r\n        // Thing Attributes have Values, so we need to add that field.\r\n        // In the future I'll have List Types, in which case this will be more complicated.\r\n        // Also I'll be adding default values.\r\n        if (attribute.DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = attribute.DefaultValue;\r\n          attribute.ListValues = attribute.DefaultListValues;\r\n        }\r\n        attributes.push(attribute);\r\n      } else {\r\n        // It's an existing attribute,\r\n        // so we just need to add the appropriate ids to FromTypes.\r\n        // Unless the attribute has a default, and the Thing doesn't have a value already.\r\n        const typeIDs = [...matches[0].FromTypes];\r\n        for (let i = 0; i < attribute.FromTypes.length; i++) {\r\n          const typeID = attribute.FromTypes[i];\r\n          if (!typeIDs.includes(typeID)) {\r\n            typeIDs.push(typeID);\r\n          }\r\n        }\r\n        if (matches[0].AttributeType !== \"List\" && (matches[0].Value === undefined || matches[0].Value === \"\") && attribute.DefaultValue !== undefined && attribute.DefaultValue !== \"\") {\r\n          matches[0].Value = attribute.DefaultValue;\r\n        }\r\n        else if (matches[0].AttributeType === \"List\" && attribute.DefaultListValues !== undefined) {\r\n          attribute.DefaultListValues.forEach(v=> {\r\n            if (!matches[0].ListValues.includes(v))\r\n              matches[0].ListValues.push(v);\r\n          });\r\n        }\r\n        matches[0].FromTypes = typeIDs;\r\n      }\r\n    }\r\n    this.setState({ Types: selectedList });\r\n    thing.AttributesArr = attributes;\r\n    thing.AttributesArr = [];\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.AttributesArr = attributes;\r\n      this.props.updateSelectedThing(thing);\r\n    }, 500);\r\n  }\r\n\r\n  addType = (selectedList, selectedItem) => {\r\n    const thing = this.props.selectedThing;\r\n    const newTypes = [];\r\n    selectedItem.Supers.forEach(s=>{\r\n      if (selectedList.filter(t=>t._id === s._id).length === 0) {\r\n        let superType = this.props.types.filter(t=>t._id === s._id);\r\n        if (superType.length > 0 && selectedList.filter(t=>t._id === superType[0]._id).length === 0){\r\n          selectedList.push(superType[0]);\r\n          newTypes.push(superType[0]);\r\n        }\r\n      }\r\n      if (this.state.Types.filter(t=>t._id === s._id).length === 0){\r\n        newTypes.push(s);\r\n      }\r\n    });\r\n    let newAttributes = [];\r\n    newTypes.forEach(type=> {\r\n      for (let i = 0; i < type.Attributes.length; i++) {\r\n        const attribute = {...type.Attributes[i]};\r\n        if (thing.Attributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n          attribute.FromTypeID = type._id;\r\n          attribute.index = type.Attributes.length + newAttributes.length;\r\n          // attribute.attrID = \r\n          newAttributes.push(attribute);\r\n        }\r\n      }\r\n    });\r\n    newTypes.forEach(type=> {\r\n      newAttributes.forEach(attribute => {\r\n        if (type.DefaultsHash === undefined || type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n          attribute.Value = \"\";\r\n          attribute.ListValues = [];\r\n        }\r\n        else {\r\n          attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n          attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n        }\r\n      })\r\n    });\r\n    let attributes = [...thing.Attributes, ...newAttributes];\r\n    this.setState({ Types: selectedList });\r\n    thing.Attributes = attributes;\r\n    thing.Attributes = [];\r\n    this.props.updateSelectedThing(thing);\r\n    setTimeout(() => {\r\n      thing.Attributes = attributes;\r\n      this.props.updateSelectedThing(thing);\r\n    }, 500);\r\n  }\r\n  \r\n  removeTypeOld = (selectedList, removedItem) => {\r\n    // TODO: Add a confirmation before doing this\r\n    // to let them know it will also remove sub-types.\r\n    let types = [];\r\n    let removeUs = [];\r\n    this.state.Types.forEach(checkMe => {\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else types.push(checkMe);\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.AttributesArr];\r\n    for (let i = 0; i < attributes.length; i++) {\r\n      const attribute = attributes[i];\r\n      if (attribute.FromTypes === undefined) {\r\n        // TODO: Remove this once all attributes have been changed to include the field\r\n        attribute.FromTypes = [];\r\n      }\r\n      let j = 0;\r\n      while (j < attribute.FromTypes.length) {\r\n        const checkMe = attribute.FromTypes[j];\r\n        if (removeUs.includes(checkMe)) {\r\n          attribute.FromTypes.splice(j, 1);\r\n        } else {\r\n          j++;\r\n        }\r\n      }\r\n    }\r\n    this.setState({ Types: types });\r\n    thing.AttributesArr = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n  \r\n  removeType = (selectedList, removedItem) => {\r\n    // TODO: Add a confirmation before doing this\r\n    // to let them know it will also remove sub-types.\r\n    let types = [];\r\n    let removeUs = [];\r\n    this.state.Types.forEach(checkMe => {\r\n      if (checkMe._id === removedItem._id || checkMe.SuperIDs.includes(removedItem._id))\r\n        removeUs.push(checkMe._id);\r\n      else types.push(checkMe);\r\n    });\r\n    const thing = this.props.selectedThing;\r\n    let attributes = [...thing.Attributes];\r\n    for (let i = 0; i < attributes.length; i++) {\r\n      const attribute = attributes[i];\r\n      if (removeUs.includes(attribute.FromTypeID))\r\n        attribute.FromTypeID = null;\r\n    }\r\n    this.setState({ Types: types });\r\n    thing.Attributes = attributes;\r\n    this.props.updateSelectedThing(thing);\r\n  }\r\n\r\n  renderHeader() {\r\n    let typeStr = \"Thing\";\r\n    this.state.Types.forEach(t=>{\r\n      if (t.Major) { \r\n        if (typeStr === \"Thing\") {\r\n          typeStr = t.Name;\r\n        }\r\n        else {\r\n          typeStr += \"/\" + t.Name;\r\n        }\r\n      }\r\n    });\r\n    return <h2>{this.state._id === null ? `Create New ${typeStr}` : `Edit ${typeStr}`}</h2>;\r\n  }\r\n\r\n  load = (id) => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        _id: id,\r\n        redirectTo: null,\r\n        loaded: false\r\n      }, this.finishLoading);\r\n    }, 500);\r\n  }\r\n\r\n  finishLoading = () => {\r\n    if (this.state._id !== null) {\r\n      // We're editing an existing Thing\r\n      this.api.getThing(this.props.selectedWorldID, this.state._id).then(res => {\r\n        const things = this.props.things.filter(\r\n          thing => res._id !== thing._id\r\n        );\r\n        let Types = [];\r\n        res.TypeIDs.forEach(tID=> {\r\n          Types = Types.concat(this.props.types.filter(t2=>t2._id === tID));\r\n        });\r\n        let newAttributes = [];\r\n        Types.forEach(type=> {\r\n          for (let i = 0; i < type.Attributes.length; i++) {\r\n            const attribute = {...type.Attributes[i]};\r\n            if (res.Attributes.filter(a=>a.attrID === attribute.attrID).length === 0) {\r\n              attribute.FromTypeID = type._id;\r\n              attribute.index = res.Attributes.length + newAttributes.length;\r\n              newAttributes.push(attribute);\r\n            }\r\n          }\r\n        });\r\n        Types.forEach(type=> {\r\n          newAttributes.forEach(attribute => {\r\n            if (type.DefaultsHash[attribute.attrID] === undefined || type.DefaultsHash[attribute.attrID].DefaultValue === undefined) {\r\n              attribute.Value = \"\";\r\n              attribute.ListValues = [];\r\n            }\r\n            else {\r\n              attribute.Value = type.DefaultsHash[attribute.attrID].DefaultValue;\r\n              attribute.ListValues = type.DefaultsHash[attribute.attrID].DefaultListValues;\r\n            }\r\n          })\r\n        });\r\n        let attributes = [...res.Attributes, ...newAttributes];\r\n        res.Attributes = attributes;\r\n        res.AttributesArr = [];\r\n        res.Attributes.forEach(a => {\r\n          const attr = this.props.attributesByID[a.attrID];\r\n          res.AttributesArr.push({\r\n            index: res.AttributesArr.length,\r\n            Name: attr.Name,\r\n            AttributeType: attr.AttributeType,\r\n            Options: attr.Options,\r\n            DefinedType: attr.DefinedType,\r\n            ListType: attr.ListType,\r\n            attrID: a.attrID,\r\n            Value: a.Value,\r\n            ListValues: a.ListValues\r\n          });\r\n        });\r\n        this.props.updateSelectedThing(res);\r\n        this.setState({\r\n          Name: res.Name,\r\n          Description: res.Description,\r\n          Things: things,\r\n          Types: Types,\r\n          loaded: true\r\n        });\r\n      });\r\n    } else {\r\n      let { id } = this.props.match.params;\r\n      if (id !== undefined && id.includes(\"type_id_\")) {\r\n        // We're creating it from a type rather than from blank\r\n        const typeID = id.substring(8);\r\n        let type = this.props.types.filter(t=> t._id === typeID);\r\n        if (type.length > 0) {\r\n          type = type[0];\r\n          this.createThingFromType(type);\r\n        }\r\n        else {\r\n          this.setState({ message: \"Invalid Type\", loaded: true });\r\n        }\r\n      }\r\n      else {\r\n        // We're creating a new thing from blank.\r\n        this.props.updateSelectedThing({\r\n          _id: null,\r\n          Name: \"\",\r\n          Description: \"\",\r\n          Types: [],\r\n          Attributes: []\r\n        });\r\n        this.setState({ loaded: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let { id } = this.props.match.params;\r\n    if (id === undefined || id.includes(\"type_id_\"))\r\n      id = null;\r\n    if (this.state._id !== id) {\r\n      this.load(id);\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else if (this.props.selectedWorld !== null && \r\n      !this.props.selectedWorld.Public && \r\n      (this.props.user === null || \r\n        (this.props.selectedWorld.Owner !== this.props.user._id && \r\n          this.props.selectedWorld.Collaborators.filter(c=>c.userID === this.props.user._id && c.type === \"collab\" && c.editPermission).length === 0))) {\r\n      return <Redirect to=\"/\" />;\r\n    } else {\r\n      return (\r\n        <Grid item xs={12} container spacing={1} direction=\"column\">\r\n          { this.props.selectedWorld === null ? \"\" :\r\n            <Grid item container spacing={1} direction=\"column\">\r\n              <Helmet>\r\n                <title>{ `Author's Notebook: ${this.props.selectedWorld.Name}` }</title>\r\n              </Helmet>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={1}>\r\n                  <Tooltip title={`Back to ${this.props.selectedWorld.Name}`}>\r\n                    <Fab size=\"small\"\r\n                      color=\"primary\"\r\n                      onClick={ _ => {this.setState({redirectTo:`/world/details/${this.props.selectedWorldID}`})}}\r\n                    >\r\n                      <ArrowBack />\r\n                    </Fab>\r\n                  </Tooltip>\r\n                </Grid>\r\n                <Grid item xs={11}>\r\n                  {this.renderHeader()}\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"name\">Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"name\"\r\n                    name=\"Name\"\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    error={!this.state.fieldValidation.Name.valid}\r\n                    value={this.state.Name}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={43}\r\n                    fullWidth\r\n                  />\r\n                  <FormHelperText>\r\n                    {this.state.fieldValidation.Name.message}\r\n                  </FormHelperText>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor=\"description\">Description</InputLabel>\r\n                  <OutlinedInput\r\n                    id=\"description\"\r\n                    name=\"Description\"\r\n                    type=\"text\"\r\n                    multiline={true}\r\n                    value={this.state.Description}\r\n                    onChange={this.handleUserInput}\r\n                    onBlur={this.inputBlur}\r\n                    labelWidth={82}\r\n                    fullWidth\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item>\r\n                { this.state.resetting ? \"\" :\r\n                  <Multiselect\r\n                    placeholder=\"Types\"\r\n                    options={this.props.types}\r\n                    selectedValues={this.state.Types}\r\n                    onSelect={this.addType}\r\n                    onRemove={this.removeType}\r\n                    displayValue=\"Name\"\r\n                  />\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                { !this.state.resetting && this.state.loaded &&\r\n                  <AttributesControl />\r\n                }\r\n                <FormHelperText>\r\n                  {this.state.fieldValidation.Attributes.message}\r\n                </FormHelperText>\r\n              </Grid>\r\n              <Grid item>\r\n                <div className=\"float-right\">\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(true);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit and Create Another\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\" color=\"primary\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    className=\"w200\"\r\n                    disabled={this.state.waiting}\r\n                    onClick={e => {this.onSubmit(false);}}\r\n                    type=\"submit\"\r\n                  >\r\n                    {this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    style={{marginLeft: \"4px\"}}\r\n                    disabled={this.state.waiting}\r\n                    onClick={_ => {\r\n                      if (this.props.selectedThing._id === null) {\r\n                        this.setState({\r\n                          redirectTo: `/world/details/${this.props.selectedWorldID}`\r\n                        });\r\n                      }\r\n                      else {\r\n                        this.setState({\r\n                          redirectTo: `/thing/details/${this.props.selectedThing._id}`\r\n                        });\r\n                      }\r\n                    }}\r\n                    type=\"button\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </Grid>\r\n              <Grid item>{this.state.message}</Grid>\r\n              <Grid item>\r\n                {this.state.errors.map((e, key) => {\r\n                  return (<div key={key}>{e}</div>);\r\n                })}\r\n              </Grid>\r\n              <Grid item>\r\n                {Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n                  if (\r\n                    this.state.fieldValidation[fieldName] !== undefined &&\r\n                    this.state.fieldValidation[fieldName].message.length > 0\r\n                  ) {\r\n                    return (\r\n                      <p className=\"redFont\" key={i}>\r\n                        {this.state.fieldValidation[fieldName].message}\r\n                      </p>\r\n                    );\r\n                  } else {\r\n                    return \"\";\r\n                  }\r\n                })}\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ThingEditPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default ThingEditPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport API from '../../api';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      resetPasswordCode: null,\r\n      codeValid: false,\r\n      password: \"\",\r\n      confirmPassword: \"\",\r\n      fieldValidation: { \r\n        password: { valid: true, message: \"\" }, \r\n        confirmPassword: { valid: true, message: \"\" }\r\n      },\r\n      formValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  handleUserInput = e => {\r\n    const name = e.target.name;\r\n    const value = (e.target.type === \"checkbox\" ? e.target.checked : e.target.value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  inputBlur = e => {\r\n    const name = e.target.name;\r\n    const validation = this.validateField(name);\r\n    const fieldValidation = this.state.fieldValidation;\r\n    if (fieldValidation[name].valid !== validation.valid) {\r\n      fieldValidation[name].valid = validation.valid;\r\n      fieldValidation[name].message = validation.message;\r\n      this.setState({ fieldValidation: fieldValidation });\r\n    }\r\n  }\r\n\r\n  handleClickShowPassword = () => {\r\n    this.setState({ showPassword: !this.state.showPassword });\r\n  };\r\n\r\n  handleMouseDownPassword = event => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  validateField = (fieldName) => {\r\n    let valid = true;\r\n    let message = \"\";\r\n    let value = this.state[fieldName];\r\n    switch (fieldName) {\r\n      case \"email\":\r\n        valid = value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) !== null;\r\n        message = valid ? \"\" : \"Email is invalid\";\r\n        break;\r\n      case \"password\":\r\n        valid = value.length >= 6;\r\n        message = valid ? \"\" : \"Password is too short\";\r\n        break;\r\n      case \"confirmEmail\":\r\n        valid = value === this.state.email;\r\n        message = valid ? \"\" : \"Confirm Email doesn't match Email\";\r\n        break;\r\n      case \"confirmPassword\":\r\n        valid = value === this.state.password;\r\n        message = valid ? \"\" : \"Confirm Password doesn't match Password\";\r\n        break;\r\n      case \"username\":\r\n        valid = value.length >= 2;\r\n        message = valid ? \"\" : \"Username is too short\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    const response = { valid: valid, message: message };\r\n    return response;\r\n  };\r\n\r\n  validateForm = (respond) => {\r\n    const passwordValid = this.validateField(\"password\");\r\n    const confirmPasswordValid = this.validateField(\"confirmPassword\");\r\n    const formValid = \r\n      passwordValid.valid && \r\n      confirmPasswordValid.valid;\r\n    const fieldValidation = this.state.fieldValidation;\r\n    fieldValidation.password = passwordValid;\r\n    fieldValidation.confirmPassword = confirmPasswordValid;\r\n    this.setState({ \r\n      formValid: formValid,\r\n      fieldValidation: fieldValidation\r\n    }, respond);\r\n  }\r\n\r\n  onSubmit = () => {\r\n    function respond() {\r\n      if (this.state.formValid) {\r\n        this.setState({ waiting: true },\r\n          this.submitThroughAPI);\r\n      }\r\n    }\r\n\r\n    this.validateForm(respond);\r\n  };\r\n\r\n  submitThroughAPI = () => {\r\n    this.api.resetPassword(this.state.resetPasswordCode, this.state.password).then(res => {\r\n      this.setState({ \r\n        message: res.message,\r\n        waiting: false\r\n      });\r\n    })\r\n    .catch(err => console.log(err));\r\n  }\r\n\r\n  render() {\r\n    if (this.state.resetPasswordCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.checkResetPasswordCode(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({resetPasswordCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({resetPasswordCode: id, codeValid: true, message: \"\"});\r\n          }\r\n        });\r\n      }, 500);\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n    else if (this.state.codeValid) {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"outlined-adornment-password\">Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"outlined-adornment-password\"\r\n                      name=\"password\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.password}\r\n                      error={ !this.state.fieldValidation.password.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={70}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.password.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm-12 margined\">\r\n                  <FormControl variant=\"outlined\"\r\n                      fullWidth>\r\n                    <InputLabel htmlFor=\"confirm-password\">Confirm Password</InputLabel>\r\n                    <OutlinedInput\r\n                      id=\"confirm-password\"\r\n                      name=\"confirmPassword\"\r\n                      type={this.state.showPassword ? 'text' : 'password'}\r\n                      value={this.state.confirmPassword}\r\n                      error={ !this.state.fieldValidation.confirmPassword.valid }\r\n                      onChange={this.handleUserInput}\r\n                      onBlur={this.inputBlur}\r\n                      endAdornment={\r\n                        <InputAdornment position=\"end\">\r\n                          <IconButton\r\n                            aria-label=\"toggle password visibility\"\r\n                            onClick={this.handleClickShowPassword}\r\n                            onMouseDown={this.handleMouseDownPassword}\r\n                            edge=\"end\"\r\n                          >\r\n                            {this.state.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      }\r\n                      labelWidth={130}\r\n                      fullWidth\r\n                    />\r\n                    <FormHelperText>{ this.state.fieldValidation.confirmPassword.message }</FormHelperText>\r\n                  </FormControl>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-sm-12\">\r\n              <div className=\"float-right\">\r\n                <Button className=\"w200\" disabled={this.state.waiting}\r\n                  onClick={this.onSubmit}\r\n                  type=\"submit\">{this.state.waiting ? \"Please Wait\" : \"Submit\"}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {this.state.message}\r\n          {\r\n            Object.keys(this.state.fieldValidation).map((fieldName, i) => {\r\n              if (this.state.fieldValidation[fieldName] !== undefined && this.state.fieldValidation[fieldName].message.length > 0) {\r\n                return (\r\n                  <p className=\"redFont\" key={i}>\r\n                    {this.state.fieldValidation[fieldName].message}\r\n                  </p>\r\n                );\r\n              } else {\r\n                return \"\";\r\n              }\r\n            })\r\n          }\r\n        </div>\r\n      );\r\n    }\r\n    else {\r\n      return (\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          {this.state.message}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst ResetPasswordPage = connect()(Page);\r\nexport default ResetPasswordPage;\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport API from '../../api';\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      confirmEmailCode: null,\r\n      codeValid: false,\r\n      message: \"Please wait.  Validating code.\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n  }\r\n\r\n  render() {\r\n    if (this.state.confirmEmailCode === null) {\r\n      const { id } = this.props.match.params;\r\n      setTimeout(() => {\r\n        this.api.confirmEmail(id).then(res => {\r\n          if (res.error !== undefined) {\r\n            this.setState({confirmEmailCode: id, codeValid: false, message: res.error});\r\n          }\r\n          else {\r\n            this.setState({confirmEmailCode: id, codeValid: true, message: res.message});\r\n          }\r\n        });\r\n      }, 500);\r\n    }\r\n    return (\r\n      <div>\r\n        <h2>Confirming Email</h2>\r\n        {this.state.message}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst ConfirmEmailPage = connect()(Page);\r\nexport default ConfirmEmailPage;\r\n","import React, { Component } from \"react\";\r\nimport { \r\n  Route, \r\n  Switch } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport HomePage from \"./Home\";\r\nimport ForumMenuPage from \"./Forum/ForumMenu\";\r\nimport LoginPage from \"./User/Login\";\r\nimport UserEditPage from \"./User/Edit\";\r\nimport WorldDetailsPage from \"./World/Details\";\r\nimport WorldEditPage from \"./World/Edit\";\r\nimport CollaboratePage from \"./World/Collaborate\";\r\nimport EditCollaboratorsPage from \"./World/EditCollaborators\";\r\n// import WorldDeletePage from \"./World/Delete\";\r\nimport TypeDetailsPage from \"./Type/Details\";\r\nimport TypeEditPage from \"./Type/Edit\";\r\n// import TypeDeletePage from \"./Type/Delete\";\r\nimport ThingDetailsPage from \"./Thing/Details\";\r\nimport ThingEditPage from \"./Thing/Edit\";\r\nimport ResetPasswordPage from \"./User/ResetPassword\";\r\nimport ConfirmEmailPage from \"./User/ConfirmEmail\";\r\n// import ThingDeletePage from \"./Thing/Delete\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\n\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Grid item xs={12} className=\"h-100 margined\">\r\n        <Switch>\r\n          {/* <Route exact path=\"/Template\" component={TemplatePage} /> */}\r\n          <Route exact path=\"/\" component={HomePage} />\r\n          <Route exact path=\"/home\" component={HomePage} />\r\n          <Route exact path=\"/User/Login\" component={LoginPage} />\r\n          <Route exact path=\"/User/resetPassword/:id\" component={ResetPasswordPage} />\r\n          <Route exact path=\"/User/confirmEmail/:id\" component={ConfirmEmailPage} />\r\n          <Route exact path=\"/profile\" component={UserEditPage} />\r\n          \r\n          {/* <Route exact path=\"/test/:testtext\" component={Test} /> */}\r\n          <Route exact path=\"/forums\" component={ForumMenuPage} />\r\n          <Route exact path=\"/world/details/:id\" component={WorldDetailsPage} />\r\n          <Route exact path=\"/world/create\" component={WorldEditPage} />\r\n          <Route exact path=\"/world/edit/:id\" component={WorldEditPage} />\r\n          <Route exact path=\"/world/collaborators/:id\" component={EditCollaboratorsPage} />\r\n          <Route exact path=\"/world/collaborate/:worldID/:collabID\" component={CollaboratePage} />\r\n          {/* <Route exact path=\"/world/delete/:id\" component={WorldDeletePage} /> */}\r\n          <Route exact path=\"/type/create\" component={TypeEditPage} />\r\n          <Route exact path=\"/type/details/:id\" component={TypeDetailsPage} />\r\n          <Route exact path=\"/type/edit/:id\" component={TypeEditPage} />\r\n          {/* <Route exact path=\"/type/delete/:id\" component={TypeDeletePage} /> */}\r\n          <Route exact path=\"/thing/create\" component={ThingEditPage} />\r\n          <Route exact path=\"/thing/create/:id\" component={ThingEditPage} />\r\n          <Route exact path=\"/thing/details/:id\" component={ThingDetailsPage} />\r\n          <Route exact path=\"/thing/edit/:id\" component={ThingEditPage} />\r\n          {/* <Route exact path=\"/thing/delete/:id\" component={ThingDeletePage} /> */}\r\n        </Switch>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst MainPage = connect()(Page);\r\nexport default MainPage;\r\n","\nimport React, { Component } from \"react\";\nimport \"./assets/css/material-dashboard-react.css\";\nimport {\n  BrowserRouter as Router\n} from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport NavBar from \"./components/Navigation/Navbar\";\nimport Sidebar from \"./components/Navigation/Sidebar\";\nimport MainPage from \"./views/MainPage\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport { \n  setWidth,\n  setAPI\n} from \"./redux/actions/index\";\nimport API from \"./api\";\n\nconst mapStateToProps = state => {\n  return {\n    menuOpen: state.app.menuOpen,\n    api: state.app.api\n  };\n};\nfunction mapDispatchToProps(dispatch) {\n  return {\n    setWidth: width => dispatch(setWidth(width)),\n    setAPI: api => dispatch(setAPI(api))\n  };\n}\nclass AppLayout extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      version: \"0\",\n      width: 0,\n      marginLeft: 220\n    };\n    this.api = API.getInstance();\n  }\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    let w = window.innerWidth;\n    if (w >= 600) {\n      w -= 200;\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 220, innerWidth: window.innerWidth });\n    }\n    else {\n      this.props.setWidth(w);\n      this.setState({ width: w, marginLeft: 0, innerWidth: window.innerWidth });\n    }\n  }\n\n  render() {\n    if (this.props.api === null) {\n      this.props.setAPI(this.api);\n    }\n    return (\n      <Router>\n        {this.props.menuOpen ? \n          <Box display={{ xs: 'none', sm: 'inline' }} className=\"Sidebar\">\n            <Sidebar className=\"\" logoText={\"Author's Notebook\"} />\n          </Box>\n        : \"\" }\n        <Grid container>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft : 0}px`, \n              width: `${this.props.menuOpen ? this.state.width : this.state.innerWidth}px` \n            }}>\n            <NavBar />\n          </Grid>\n          <Grid item xs={12}\n            style={{ \n              marginLeft: `${this.props.menuOpen ? this.state.marginLeft + 10 : 10}px`, \n              width: `${this.props.menuOpen ? this.state.width - 20 : this.state.innerWidth - 20}px`,\n              marginRight: \"10px\",\n              marginTop: \"10px\" \n            }}>\n            <MainPage />\n          </Grid>\n        </Grid>\n      </Router>\n    );\n  }\n}\n\nconst App = connect(mapStateToProps, mapDispatchToProps)(AppLayout);\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\r\n  SET_API,\r\n  ADD_ARTICLE,\r\n  LOGIN,\r\n  LOG_OUT,\r\n  SET_WORLDS,\r\n  SET_PUBLIC_WORLDS,\r\n  ADD_WORLD,\r\n  UPDATE_WORLD,\r\n  UPDATE_PUBLIC_WORLD_COLLAB,\r\n  SELECT_WORLD,\r\n  SET_TYPES,\r\n  ADD_TYPE,\r\n  SET_THINGS,\r\n  ADD_THING,\r\n  UPDATE_TYPE,\r\n  // UPDATE_ATTRIBUTES_ARR,\r\n  SET_ATTRIBUTES,\r\n  ADD_ATTRIBUTES,\r\n  UPDATE_SELECTED_TYPE,\r\n  UPDATE_THING,\r\n  UPDATE_SELECTED_THING,\r\n  LOAD_FROM_STORAGE,\r\n  TOGGLE_MENU,\r\n  SET_FOLLOWING_WORLDS,\r\n  SET_WIDTH\r\n} from \"../constants/actionTypes\";\r\n\r\nconst initialState = {\r\n  api: null,\r\n  articles: [],\r\n  user: null,\r\n  loginError: \"\",\r\n  worlds: [],\r\n  publicWorlds: [],\r\n  followingWorlds: [],\r\n  selectedWorld: null,\r\n  selectedWorldID: null,\r\n  types: [],\r\n  things: [],\r\n  selectedType: null,\r\n  // attributesArr: [],\r\n  // attributes: [],\r\n  attributesByID: {},\r\n  attributesByName: {},\r\n  selectedThing: null,\r\n  loadIt: true,\r\n  menuOpen: true,\r\n  width: 0\r\n};\r\nfunction rootReducer(state = initialState, action) {\r\n  if (action.type === LOAD_FROM_STORAGE) {\r\n    const user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n    const worlds = JSON.parse(sessionStorage.getItem(\"worlds\"));\r\n    const publicWorlds = JSON.parse(sessionStorage.getItem(\"publicWorlds\"));\r\n    const selectedWorld = JSON.parse(sessionStorage.getItem(\"selectedWorld\"));\r\n    const selectedWorldID = sessionStorage.getItem(\"selectedWorldID\");\r\n    const types = JSON.parse(sessionStorage.getItem(\"types\"));\r\n    const things = JSON.parse(sessionStorage.getItem(\"things\"));\r\n    const followingWorlds = JSON.parse(sessionStorage.getItem(\"followingWorlds\"));\r\n    // const attributes = JSON.parse(sessionStorage.getItem(\"attributes\"));\r\n    const attributesByID = JSON.parse(sessionStorage.getItem(\"attributesByID\"));\r\n    const attributesByName = JSON.parse(sessionStorage.getItem(\"attributesByName\"));\r\n    \r\n    return Object.assign({}, state, {\r\n      user: user,\r\n      worlds: worlds === null ? [] : worlds,\r\n      publicWorlds: publicWorlds === null ? [] : publicWorlds,\r\n      selectedWorld,\r\n      selectedWorldID,\r\n      types: types === null ? [] : types,\r\n      things: things === null ? [] : things,\r\n      followingWorlds: followingWorlds === null ? [] : followingWorlds,\r\n      // attributes: attributes === null ? [] : attributes,\r\n      attributesByID: attributesByID === null ? {} : attributesByID,\r\n      attributesByName: attributesByName === null ? {} : attributesByName,\r\n    });\r\n  } else if (action.type === SET_API) {\r\n    return Object.assign({}, state, {\r\n      api: action.payload\r\n    });\r\n  } else if (action.type === ADD_ARTICLE) {\r\n    return Object.assign({}, state, {\r\n      articles: state.articles.concat(action.payload)\r\n    });\r\n  } else if (action.type === LOGIN) {\r\n    sessionStorage.setItem(\"user\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload.followingWorlds));\r\n    return Object.assign({}, state, {\r\n      user: action.payload, \r\n      followingWorlds: action.payload.followingWorlds\r\n    });\r\n  } else if (action.type === LOG_OUT) {\r\n    sessionStorage.removeItem(\"user\");\r\n    return Object.assign({}, state, {\r\n      user: null\r\n    });\r\n  } else if (action.type === SET_WORLDS) {\r\n    if (action.payload.error === undefined){\r\n      sessionStorage.setItem(\"worlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            selectedWorld: world,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            worlds: action.payload,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          worlds: action.payload,\r\n          // attributes: [],\r\n          // attributesByID: {},\r\n          // attributesByName: {}\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === SET_PUBLIC_WORLDS) {\r\n    if (action.payload.error === undefined){\r\n      sessionStorage.setItem(\"publicWorlds\", JSON.stringify(action.payload));\r\n      if (state.selectedWorldID !== null && state.selectedWorld === null) {\r\n        const worldArr = action.payload.filter(\r\n          world => world._id === state.selectedWorldID\r\n        );\r\n        if (worldArr.length > 0) {\r\n          let world = worldArr[0];\r\n          sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world));\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload,\r\n            selectedWorld: world,\r\n            // attributes: [],\r\n            // attributesByID: {},\r\n            // attributesByName: {}\r\n          });\r\n        } else {\r\n          return Object.assign({}, state, {\r\n            publicWorlds: action.payload\r\n          });\r\n        }\r\n      } else {\r\n        return Object.assign({}, state, {\r\n          publicWorlds: action.payload\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      return Object.assign({}, state, {});\r\n    }\r\n  } else if (action.type === ADD_WORLD) {\r\n    if (action.payload.Public) {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      const publicWorlds = state.publicWorlds.concat(action.payload);\r\n      sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      const worlds = state.worlds.concat(action.payload);\r\n      sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n      return Object.assign({}, state, {\r\n        worlds: state.worlds.concat(action.payload)\r\n      });\r\n    }\r\n  } else if (action.type === UPDATE_WORLD) {\r\n    const worlds = [...state.worlds];\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = worlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Name = action.payload.Name;\r\n    const wasPublic = world.Public;\r\n    world.Public = action.payload.Public;\r\n    world.AcceptingCollaborators = action.payload.AcceptingCollaborators;\r\n    world.Collaborators = action.payload.Collaborators;\r\n    sessionStorage.setItem(\"worlds\", JSON.stringify(worlds));\r\n    if (world.Public) {\r\n      if (wasPublic) {\r\n        // It was already public so we just need to update the name\r\n        const publicWorld = publicWorlds.filter(t => t._id === world._id)[0];\r\n        publicWorld.Name = world.Name;\r\n      }\r\n      else {\r\n        // It's been changed to public, so we need to add it\r\n        publicWorlds = publicWorlds.concat(world);\r\n      }\r\n      sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n      return Object.assign({}, state, {\r\n        worlds,\r\n        publicWorlds\r\n      });\r\n    } else {\r\n      if (wasPublic) {\r\n        // It used to be public, so we need to remove it\r\n        publicWorlds = publicWorlds.filter(t => t._id !== world._id);\r\n        sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n        return Object.assign({}, state, {\r\n          worlds,\r\n          publicWorlds\r\n        });\r\n      }\r\n      else {\r\n        // It's still not public, so we can leave it\r\n        return Object.assign({}, state, {\r\n          worlds\r\n        });\r\n      }\r\n    }\r\n  } else if (action.type === UPDATE_PUBLIC_WORLD_COLLAB) {\r\n    let publicWorlds = [...state.publicWorlds];\r\n    const world = publicWorlds.filter(t => t._id === action.payload._id)[0];\r\n    world.Collaborators = action.payload.Collaborators;\r\n    sessionStorage.setItem(\"publicWorlds\", JSON.stringify(publicWorlds));\r\n    return Object.assign({}, state, {\r\n      publicWorlds\r\n    });\r\n  } else if (action.type === SELECT_WORLD) {\r\n    let world = state.worlds.filter(world => world._id === action.payload);\r\n    if (world.length === 0)\r\n      world = state.publicWorlds.filter(world => world._id === action.payload);\r\n    if (world.length > 0) {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.setItem(\"selectedWorld\", JSON.stringify(world[0]));\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: world[0],\r\n        // attributes: [],\r\n        attributesByID: {},\r\n        attributesByName: {}\r\n      });\r\n    } else {\r\n      sessionStorage.setItem(\"selectedWorldID\", action.payload);\r\n      sessionStorage.removeItem(\"selectedWorld\");\r\n      return Object.assign({}, state, {\r\n        selectedWorldID: action.payload,\r\n        selectedWorld: null,\r\n        // attributes: [],\r\n        attributesByID: {},\r\n        attributesByName: {}\r\n      });\r\n    }\r\n  } else if (action.type === SET_ATTRIBUTES) {\r\n    const attributesByID = {};\r\n    const attributesByName = {};\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(action.payload));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n\r\n    return Object.assign({}, state, {\r\n      // attributes: action.payload,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === ADD_ATTRIBUTES) {\r\n    // const attributes = state.attributes.concat(action.payload);\r\n    const attributesByID = state.attributesByID;\r\n    const attributesByName = state.attributesByName;\r\n    action.payload.forEach(attribute => {\r\n      attributesByID[attribute._id] = attribute;\r\n      attributesByName[attribute.Name] = attribute;\r\n    });\r\n    \r\n    // sessionStorage.setItem(\"attributes\", JSON.stringify(attributes));\r\n    sessionStorage.setItem(\"attributesByID\", JSON.stringify(attributesByID));\r\n    sessionStorage.setItem(\"attributesByName\", JSON.stringify(attributesByName));\r\n    \r\n    return Object.assign({}, state, {\r\n      // attributes: attributes,\r\n      attributesByID: attributesByID,\r\n      attributesByName: attributesByName\r\n    });\r\n  } else if (action.type === SET_TYPES) {\r\n    sessionStorage.setItem(\"types\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      types: action.payload\r\n    });\r\n  } else if (action.type === ADD_TYPE) {\r\n    const types = state.types.concat(action.payload);\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  } else if (action.type === SET_THINGS) {\r\n    sessionStorage.setItem(\"things\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      things: action.payload\r\n    });\r\n  } else if (action.type === ADD_THING) {\r\n    const things = state.things.concat(action.payload);\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === UPDATE_SELECTED_TYPE) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedType = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedType: changedType\r\n    });\r\n  } else if (action.type === UPDATE_TYPE) {\r\n    const types = [...state.types];\r\n    const type = types.filter(t => t._id === action.payload._id)[0];\r\n    type.Name = action.payload.Name;\r\n    type.Description = action.payload.Description;\r\n    type.Supers = action.payload.Supers;\r\n    type.AttributesArr = action.payload.AttributesArr;\r\n    type.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"types\", JSON.stringify(types));\r\n    return Object.assign({}, state, {\r\n      types: types\r\n    });\r\n  // } else if (action.type === UPDATE_ATTRIBUTES_ARR) {\r\n  //   return Object.assign({}, state, {\r\n  //     attributesArr: action.payload\r\n  //   });\r\n  } else if (action.type === UPDATE_SELECTED_THING) {\r\n    // This is because Redux won't cause a rerender\r\n    // on changes to arrays.\r\n    const changedThing = { ...action.payload, changedAt: Date.now() };\r\n    return Object.assign({}, state, {\r\n      selectedThing: changedThing\r\n    });\r\n  } else if (action.type === UPDATE_THING) {\r\n    const things = [...state.things];\r\n    const thing = things.filter(t => t._id === action.payload._id)[0];\r\n    thing.Name = action.payload.Name;\r\n    thing.Description = action.payload.Description;\r\n    thing.Types = action.payload.Types;\r\n    thing.Attributes = action.payload.Attributes;\r\n    sessionStorage.setItem(\"things\", JSON.stringify(things));\r\n    return Object.assign({}, state, {\r\n      things: things\r\n    });\r\n  } else if (action.type === TOGGLE_MENU) {\r\n    return Object.assign({}, state, {\r\n      menuOpen: !state.menuOpen\r\n    });\r\n  } else if (action.type === SET_WIDTH) {\r\n    return Object.assign({}, state, {\r\n      width: action.payload\r\n    });\r\n  } else if (action.type === SET_FOLLOWING_WORLDS) {\r\n    sessionStorage.setItem(\"followingWorlds\", JSON.stringify(action.payload));\r\n    return Object.assign({}, state, {\r\n      followingWorlds: action.payload\r\n    });\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default rootReducer;\r\n\r\nexport const login = (user, history) => {};\r\n\r\nexport const logout = history => {};\r\n","import { createStore, combineReducers } from \"redux\";\r\nimport { sessionService, sessionReducer } from \"redux-react-session\";\r\nimport rootReducer from \"../reducers/index\";\r\nconst reducers = {\r\n  app: rootReducer,\r\n  session: sessionReducer\r\n};\r\n\r\nconst reducer = combineReducers(reducers);\r\nconst store = createStore(reducer);\r\nconst validateSession = session => {\r\n  // check if your session is still valid\r\n  return true;\r\n};\r\nconst options = {\r\n  refreshFromLocalStorage: true,\r\n  refreshOnCheckAuth: true,\r\n  redirectPath: \"/home\",\r\n  driver: \"COOKIES\",\r\n  validateSession\r\n};\r\n\r\nsessionService\r\n  .initSessionService(store, options)\r\n  .then(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and a session was refreshed from your storage\"\r\n    )\r\n  )\r\n  .catch(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and there is no session in your storage\"\r\n    )\r\n  );\r\nexport default store;\r\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store/index\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}